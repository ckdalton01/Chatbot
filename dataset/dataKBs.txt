{"url": "https://patchmypc.com/kb/", "title": "Patch Management, Endpoint Security, IT Operations, Cloud Patching", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 2 \u2026 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/software-updates-eval-sccm/", "title": "Software Updates Compliance Security Evaluations", "raw_text": "Understanding the Software Updates Deployment Evaluation Cycle in SCCM TheSoftware Updates Deployment Evaluation Cycleis a critical process in SCCM thatdetermineshowfrequentlyclient devices evaluate whether they have the required software updates installed. This is critical in ensuring devices areup-to-datewith security patches and other important updates as required by the organization. What is theSoftware UpdatesDeployment EvaluationCycle? The Software UpdatesDeployment EvaluationCycleinSCCMis a setting thatdetermineshowfrequentlyclient devices evaluate whether they have the required software updates installed. This is critical in ensuring devices areup-to-datewith security patches and other important updates as required by the organization. The component evaluation serves a vital purpose by ensuring that clients regularly check and verify the installation status of software updates deployed to them. If an update is missing or was not successfully installed, the evaluation process detects this and prompts the client to attempt the installation again, following the deployment configurations. This ensures compliance and helps maintain the integrity of the update deployment process. What does it do? Ensures ComplianceRegular evaluations ensure that all devices are compliant with the organization\u2019s update policies. Ensures ComplianceRegular evaluations ensure that all devices are compliant with the organization\u2019s update policies. Reduces Security VulnerabilitiesBy frequently evaluating updates, SCCM minimizes the risk of security breaches from unpatched software. Reduces Security VulnerabilitiesBy frequently evaluating updates, SCCM minimizes the risk of security breaches from unpatched software. Automatic RemediationIf an update fails or is missing, the evaluation schedule will detect this and reattempt installation without requiring manual intervention. Automatic RemediationIf an update fails or is missing, the evaluation schedule will detect this and reattempt installation without requiring manual intervention. How the cycle works The SCCM client initiates theSoftware Update Deployment Evaluation Cycleon a predefined schedule (default is every 7 days). During each cycle, the client: Contacts the SCCM Management PointThe client connects to the SCCM management point to retrieve the list of available updates based on the policies and deployment configurations defined in SCCM. Downloads Update PoliciesThe client downloads any update-related policies, which include details about required updates, installation deadlines, user interaction settings, and deployment configurations. Evaluates Update ComplianceThe client compares the list of required updates with the updates already installed on the device. During this evaluation:Missing UpdatesIdentifies updates that are required but not yet installed.Failed UpdatesFlags updates that were previously attempted but failed to install.Outdated UpdatesDetects updates that need to be replaced by newer, superseding updates. Missing UpdatesIdentifies updates that are required but not yet installed. Failed UpdatesFlags updates that were previously attempted but failed to install. Outdated UpdatesDetects updates that need to be replaced by newer, superseding updates. Flags Updates for ActionBased on the evaluation, the client flags any updates that need to be installed or reinstalled. This ensures all required updates are identified for remediation. Downloads Required UpdatesFor flagged updates, the client begins downloading the necessary files from the designated distribution point. This process adheres to bandwidth settings and preferred caching locations. Installs Updates as ConfiguredAfter downloading, the client initiates the installation process for the required updates. It respects SCCM deployment rules, such as:Installation during a defined maintenance window.Enforcement of restart policies.Handling of user interaction prompts (if required). Installation during a defined maintenance window. Enforcement of restart policies. Handling of user interaction prompts (if required). Reports Compliance StatusOnce the updates are installed, the client verifies the installation and reports the compliance status back to the SCCM server. This information includes details about successfully installed, pending, or failed updates, allowing administrators to monitor and address compliance gaps. Ways to manually invoke theSoftware Update Deployment EvaluationCycle Although the cycle runs automatically, administrators can also manually trigger it on individual clients to speed up policy application. There are numerous ways this can be invoked manually. 1. From the Client Side One method is by using the Control PanelConfiguration ManagerApplet: Open theControl Panelon the client device. Go toSystem and Security> Configuration Manager. In the Actions tab, selectSoftware Update Deployment EvaluationCycleand clickRun Now. 2. Using WMI The other method of manually invoking the scan cycle from a client is by using PowerShell: Open PowerShell as Administrator Run this command:Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000108}\u201d Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000108}\u201d 3. From the SCCM Console Open the ConfigMgr console and navigate toAssets and Compliance>Devices. Locate the device and right-click on it. In theClient Notificationsection, chooseDownload Computer Policy. Relevant logs to monitor on the client side If you want to monitor the evaluation of this action, it can be done using these logs located on the client side in the %WinDir%\\CCM\\Logs folder: UpdatesDeployment.logTracks the evaluation and installation of updates on the client. This log records details about which updates are required, whether they are downloaded, and the results of the installation process. Tracks the evaluation and installation of updates on the client. This log records details about which updates are required, whether they are downloaded, and the results of the installation process. UpdatesHandler.logRecords the execution of software update installation, including initiation, progress, and completion. It also logs retry attempts if the installation fails. Records the execution of software update installation, including initiation, progress, and completion. It also logs retry attempts if the installation fails. CAS.log(Content Access Service)Logs the download of update files from distribution points to the client cache. It provides insights into the content retrieval process, including errors or delays. Logs the download of update files from distribution points to the client cache. It provides insights into the content retrieval process, including errors or delays. WUAHandler.logLogs the interaction between SCCM and the Windows Update Agent (WUA). This log records scan results, including whether updates are applicable, and errors encountered during the scan. Logs the interaction between SCCM and the Windows Update Agent (WUA). This log records scan results, including whether updates are applicable, and errors encountered during the scan. LocationServices.logRecords the process of finding management points and distribution points. This log helps identify issues if the client cannot locate a content source for updates. Records the process of finding management points and distribution points. This log helps identify issues if the client cannot locate a content source for updates. DataTransferService.logLogs the actual download of update files to the client, including progress and transfer errors. Logs the actual download of update files to the client, including progress and transfer errors. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/patch-my-pc-publisher-supportability/", "title": "Patch, Publisher, Supportability, Releases", "raw_text": "Patch My PC Publisher Supportability for Older Releases The supportability of older releases of thePatch My PC Publisheris covered in this article. The cadence of Patch My PC Publisher Releases Our goal is to continually improve our software to meet customer needs based on feedback from our customers on ourUserVoice portal. Generally, we release a new build of our publisherat least once a monthto address feature requests, improvements, and bug fixes. You can review our past release history for production builds using the following resourcePatch My PC Publisher Production Release History. You can also review ourpublic roadmapto stay up to date on features under development. Supportability for Old Versions of the Publisher We only support a Publisher releaseup to 4 months after it was first releasedto ourproduction release channel. We will ask you to upgrade to a supported build if you are running an unsupported build to receive support. Note:Patch My PC does not recommend disabling the self-update feature in the About tab unless required. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/delete-apps-configmgr-manager/", "title": "SCCM Application Management Patch My PC Deletion", "raw_text": "How to Delete Applications Created by Patch My PC in SCCM In this article, we will review how to delete applications created by Patch My PC from SCCM. There are a few scenarios where you may want to do this. Youno longer need Patch My PCfor application management There was an update in the publishing service tofix an application-specific issuethat requires recreation of an application to take effect The followingtwo methodsare available for application deletion: Method 1 \u2013 SCCM Application Manager Utility Method 2 \u2013 Manual Application Deletion Method 1 \u2013 SCCM Application Manager Utility Step 1: Delete the Applications Using the Utility Step 2: Recreation of All Applications (optional) Note:Whenusing the SCCM Application Manager to delete applications, we will alsoremove the source files automatically. The steps for manually deleting the application include the process for manually deleting application source files. The manual deletion shouldnotbe needed when using the SCCM Application Manager. Step 1: Delete the Applications Using the Utility Within the Publisher, you can navigate through the UI as shown below. ConfigMgr Apps Options Run SCCM Application Manager Utility Delete ApplicationsNote:Only the applications you have highlighted will be deleted. You can hold CTRL and select multiple applications for deletion. Note:Only the applications you have highlighted will be deleted. You can hold CTRL and select multiple applications for deletion. Step 2: Recreation of All Applications (optional) Please refer to the recreation stephere. Method 2 \u2013 Manual Application Deletion Manual deletion is a multi-step process covered below. Step 1: Deleting the Application Source Content Step 2: Delete the Application(s) from SCCM Step 3: Recreation of All Applications (optional) Step 1: Deleting the Application Source Content If you only need to delete a single application, the easiest method is to delete the source content and application from SCCM manually. In this example, we will be deleting the source content for7-Zip 19.00 (MSI-x64). Open the application\u2019s deployment type in the SCCM console Copy the content location path from the Content tab of the deployment type Open the folder in file explorer and delete the GUID folder for the application If you need to delete all application content, you can remove all the vendor folders from the application source directory that was defined in the application options in the publishing service. Find the source folder specified in the base install options of the publishing service Go to this directory in file explorer to find the applications subfolder and delete all of the vendor folders within Step 2: Delete the Application(s) from SCCM To delete individual applications in the SCCM console: Go to theApplications nodein the Software Library Right-clickthe desired application and clickDelete To delete all applications in the SCCM console: Click the blue tab in the top left corner of the console andConnect Via Windows Powershell Run the following command in the Powershell windowGet-CMApplication | Where-Object {($_.SDMPackageXML -like \u2018*PatchMyPC-ScriptRunner.exe*\u2019)} | Remove-CMApplication -Force -Verbose Get-CMApplication | Where-Object {($_.SDMPackageXML -like \u2018*PatchMyPC-ScriptRunner.exe*\u2019)} | Remove-CMApplication -Force -Verbose The following verbose logging will show each application being deleted: Any active deployments or task sequence references must be removed before the application can be successfully deleted. If an application is deployed or referenced in a task sequence, you will get the following error: Step 3: Recreation of All Applications (optional) If applications were deleted due to a recommendation from the Patch My PC support team due to a bug in a previous version, here is the process to quickly recreate the applications. Manually run a publishing service sync in the Sync Schedule tab of the publishing service Monitor the sync process by opening the PatchMyPC.log in the General Settings tab Once all applications are recreated, verify in the console under the Comments column of the application that the \u201cCreated by Patch My PC\u2026\u201d version matches the version in the About tab in the publishing service Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/machine-policy-eval-sccm/", "title": "Machine Policy Retrieval Evaluation Cycle SCCM Configuration Policies Updates", "raw_text": "Understanding the Machine Policy Retrieval & Evaluation Cycle in SCCM TheMachine Policy Retrieval & Evaluation Cycleis a critical process in SCCM that ensures clients receive and apply the latest policies from the management server. This article provides a breakdown of what the policy does, how to invoke it and which logs to use for troubleshooting. What is theMachine Policy Retrieval & Evaluation Cycle? The Machine Policy Retrieval & Evaluation Cycle inConfigMgris a process through whichtheSCCM client devices check for new or updated policies and evaluate their applicability. This cycledetermineswhat actions the client needs to perform based on the policies assigned by the ConfigMgr server. What does it do? The Machine Policy Retrieval & Evaluation Cycle is essential for keeping SCCM client settings up to date. It helps enforce configuration policies, software deployments, compliance settings, and other management tasks. The cycle enables the client to periodically communicate with the SCCM server to download any new policies or updates, apply those policies, and determine any required actions. This process ensures that the client remains aligned with IT policies and software distribution schedules set by administrators. How the cycle works The SCCM client initiates the Machine Policy Retrieval & Evaluation Cycle on a predefined schedule (default is every 60 minutes). During each cycle, the client: Contacts the SCCM Management PointThe client requests updated policy information from the SCCM management point. Downloads PoliciesIf there are new or modified policies, the client downloads them. These policies may include settings, configurations, deployments, or compliance rules. Evaluates PoliciesAfter downloading, the client evaluates the policies to see if there are any specific actions it needs to take. For exampleSoftware Installations or Updates:Determine if new software or updates are required.Configuration Baselines:Check if configuration items match the baseline defined by the organization.Compliance and Security Settings:Apply new security configurations or compliance rules. Software Installations or Updates:Determine if new software or updates are required. Configuration Baselines:Check if configuration items match the baseline defined by the organization. Compliance and Security Settings:Apply new security configurations or compliance rules. Performs Actions as NeededBased on the evaluation, the client takes actions such as installing software, enforcing configurations, or generating compliance reports. Ways to manually invoke the Machine Policy Retrieval & Evaluation Cycle Although the cycle runs automatically, administrators can also manually trigger it on individual clients to speed up policy application. There are numerous ways this can be invoked manually. 1. From the Client Side One method is by using the Control PanelConfiguration ManagerApplet: Open theControl Panelon the client device. Go toSystem and Security> Configuration Manager. In the Actions tab, selectMachine Policy Retrieval & Evaluation Cycleand clickRun Now. 2. Using WMI The other method of manually invoking the scan cycle from a client is by using PowerShell: Open PowerShell as Administrator Run this command:Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000021}\u201d Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000021}\u201d 3. From the SCCM Console Open the ConfigMgr console and navigate toAssets and Compliance>Devices. Locate the device and right-click on it. In theClient Notificationsection, chooseDownload Computer Policy. 4. Using Advanced Insights Advanced Insightsis an innovative reporting and patch compliance solution for SCCM offered by Patch My PC. To trigger the cycle from Advanced Insights, follow these steps: Access the Advanced Insights reporting website Navigate toResources > Devices > Manageddevicesand locate your device using the Quick Search option. From theActionsdropdown, select theDownload Computer Policyoption. Relevant logs to monitor on the client side If you want to monitor the evaluation of this action, it can be done using these logs located on the client side in the %WinDir%\\CCM\\Logs folder: PolicyAgent.log:Records the actions of the client processing and applying policies received from the SCCM server. This includes policy requests, downloads, and enforcement activities related to software deployments, compliance settings, and other client configuration tasks. ClientLocation.log:Tracks the client\u2019s process of locating and selecting a management point or distribution point in the SCCM hierarchy. This log is useful for troubleshooting issues related to client site assignment and communication with management points. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sdp-database-not-found/", "title": "WSUS Migration Error, PatchMyPC log, Third Party Updates", "raw_text": "An error occurred while getting the SDP: The specified item could not be found in the database This article will describe an error you may see in thePatchMyPC.logafter migrating to a new WSUS server and not performing a full WSUS backup and restore to the new WSUS serverper this guide. Determine if You are Affected If you are affected, you will see the following error line in thePatchMyPC.log. An error occurred while getting the SDP: The specified item could not be found in the database. Why Does this Logging Error Line Occur? When migrating to a new Software Update Point (WSUS Server), companies will often add a new SUP that initially synchronizes with the original SUP. Once the new software update point is synchronized, the original SUP is removed from the site, andthe new SUP is set as the primary SUP. A small subset of metadata for third-party updates doesn\u2019tsynchronize during this process, resulting in this error line in thePatchMyPC.logwhen we query already published updates. Important:The third-party updates will still scan and install successfully on client devices. This log line can be ignored. How to Resolve the Error by Declining and Republishing All Patch My PC Updates Although this error can be safely ignored, there is a way to resolve the error if you prefer. This process can take multiple hours to decline and republish all updates. Perform the steps belowon the new WSUS server using the Patch My PC Publisher. Declineall \u201cPatch My PC\u201d updates using theModify Updates Wizardas shown in the GIF below. Next, Republishall Patch My PC updates at theAll Productslevel. ChooseYesto both of the prompts. Next, triggerPublisher Service Syncin theSync Scheduletab. Monitor thePatchMyPC.logfor the sync to complete. Note:Since you are republishing all third-party updates, this process can take many hours to complete depending on the number of products you enabled. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-compliance-over-100/", "title": "WSUS Compliance Anomaly Installation Error Percentages", "raw_text": "WSUS Compliance \u2013 Installed / Not Applicable Exceeds 100% Windows Server Update Services (WSUS) administrators may occasionally encounter a puzzling scenario where the Installed / Not Applicable column percentages exceed 100%. This anomaly can be confusing and lead to questions about data compliance integrity . Determine if You are Affected In a standalone WSUS configuration, where the Configuration Manager Software Update Point (SUP) site system role is not configured, administrators rely on the WSUS console for reporting. To analyze update compliance for individual computers, follow these steps: Open the WSUS Console Navigate to the \u201cAll Computers\u201d node or a specific Computer Group. The computer status summary will display multiple columns, some of which may be hidden by default. Right-click any column header and select additional columns to include:Installed/Not Applicable Percentage \u2013 Displays the percentage of updates that are installed out of those marked as applicable.Needed Count \u2013 The number of updates that are required but not installed.Installed Count \u2013 The number of updates that are applicable and are installed.Failed Count \u2013 The number of updates that attempted installation but failed.Not Applicable Count \u2013 The number of updates that are not applicable. Installed/Not Applicable Percentage \u2013 Displays the percentage of updates that are installed out of those marked as applicable. Needed Count \u2013 The number of updates that are required but not installed. Installed Count \u2013 The number of updates that are applicable and are installed. Failed Count \u2013 The number of updates that attempted installation but failed. Not Applicable Count \u2013 The number of updates that are not applicable. When reviewing these columns, you may notice that in some cases, the Installed/Not Applicable (%) column exceeds 100%. This anomaly can cause confusion regarding update compliance and is typically the result of WSUS miscalculating the percentage based on update applicability rules. You might expect that the Installed/Not Applicable Percentage value for each computer is calculated the following way:- Installed + Not Applicable / (Installed + Needed + Not Applicable) * 100 In this example, for computer cm2.lab2.local, that would be 5 + 159 / (5 + 2 + 159) * 100 = 99%But instead of 99% it indicates the Installed/Not Applicable percentage is 110% The reason this occurs is because the Not Applicable count data is not summarised correctly for some computers. Cause We can see the summarization data that causes the anomoly by viewing data in thetbComputerSummaryForMicrosoftUpdatestable. A negative value in the unknown column is still counted and contributes to the Not Applicable count. Executing the Stored Proceduredbo.spGetSummariesPerComputerindicates this further. Specifically, data that has aSummarizationStateof zero. dbo.spGetSummariesPerComputeris actually called to display the summary data in the WSUS console. You can see this if you run SQL Profiler and refresh the view in the WSUS console. Here is an example of an XML passed to the Stored Procedure The Stored Procedure creates various temporary tables and filters updates incorrectly based on Summarization States \u2013 which is the cause for the miscalculations outlined in this KB. Summarization inconsistencies can occur when clients report on update states for updates that have been declined/deleted since their last scan/report time. Resolution WSUS includes another Stored Procedure that can reset the summary data in this scenario.spResetOnlineSummaryTablescalculates update status summaries across all computers by counting updates by state (Unknown, NotInstalled, Downloaded, Installed, Failed, InstalledPendingReboot). To execute this Stored Procedure using SQL Server Management Studio (SSMS):- Open SQL Server Management Studio (SSMS) Connect to your SQL Server instance Enter your server name and authentication details Click \u201cConnect\u201d Navigate to the stored procedure in Object Explorer Expand \u201cDatabases\u201d Expand \u201cSUSDB\u201d Expand \u201cProgrammability\u201d Expand \u201cStored Procedures\u201d Finddbo.spResetOnlineSummaryTablesin the list Right-click ondbo.spResetOnlineSummaryTables Select \u201cExecute Stored Procedure\u201d Click \u201cOK\u201d The summarization of the data should now reflect accuratly in the WSUS console. Below is aBefore (1)andAfter (2)when running the Stored Procedure. In this example, 17 counts have been removed from some rows which now results in an accurate compliance calcualtion. Note:Deleting individual computers from the WSUS console will also fix the problem on a per-computer basis. When the computer reports back in, the compliance will be accurately reflected in the Installed / Not Applicable column. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/patch-my-pc-unable-connect/", "title": "WSUS issue, Patch My PC Publisher, troubleshooting guide", "raw_text": "Patch My PC Publisher \u2013 Unable to connect to WSUS When starting the Patch My PC Publisher, you get an error message stating that it is \u201cUnable to Connect to WSUS\u201d.This issue usually appears due to a WSUS misconfiguration, and the cause might vary. The most common causes are documented in this article. Ensure that the PMPC Publisher is installed on the top-most SUP The PatchMyPC Publisher need to be installed on the top-most Software Update Point, as documented in therequirementspage. Ensure it is installed on the top-most SUP.In case you don\u2019t know how to find out what the name of your top-most SUP is, you can usethisscript. Basic troubleshooting Before doing anything else, we need to ensure that theWsusPoolandWSUS Serviceare running. For theWsusPool, go to theIIS Manager\u2013>Application Pool\u2013> check the status.If it isStopped, right-click it and chooseStart. Once ensured that the WsusPool is running, go toservices.mscand ensure that theWSUS Serviceis also running.If it\u2019s not running, right-click the service and start it. The WsusPool stops immediately after being started Make sure that the WSUS AppPool in IIS is optimized for better performance, as described inthis article. The issue exists with https configured while the WsusPool is running Ensure the SSL Certificate is bound to the WSUS Administration site and was not dropped for some reason: On the WSUS server, open Internet Information Services (IIS) Manager. Go toSites>WSUS Administration. SelectBindingsfrom either the action menu or by right-clicking on the site. In theSite Bindingswindow, select the line for https, then selectEdit\u2026. Note: Don\u2019t remove the HTTP site binding even if HTTPS is configured. WSUS uses HTTP to update content files. 6. Under theSSL certificateoption, choose the certificate to bind to the WSUS Administration site if the option is set toNot Selected. The certificate\u2019s friendly name is shown in the drop-down menu. If a friendly name wasn\u2019t specified, then the certificate\u2019s IssuedTo field is shown. If you\u2019re not sure which certificate to use, select View and verify the thumbprint matches the one you obtained. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/telemetry-data-collected-when-using/", "title": "Telemetry Data Collection Catalog Download Count Publisher Software Version List of Selected Products .NET Version WSUS Builds Cleanup Information", "raw_text": "Telemetry Data Collected when Using the Publisher Patch My PC will collectbasic telemetry datawhen ourPublisher softwareis used toimprove our products and services. This article will describe in detail the specific data collected by Patch My PC and, more importantly, thereason we collect it. The Number of Times the Catalog is Downloaded The Version Number of the Publisher Software The List of Selected Products .NET Version Number where the Publisher Software is installed Are Preview and Self-Updates Enabled Is ConfigMgr Application Creation Enabled Is Intune Application Creation Enabled The Error Description if an Update or Application Publishing Fails The Configuration Manager Site Version The WSUS Build Number The WSUS Database Type WSUS Updates Cleanup Information WSUS Maintenance Configuration The Number of Products Enabled and Published Heartbeat Certificate Validation Errors Feature Usage Cloud Attached Alert Configuration ConfigMgr Application Metadata How Data is Transferred Data collected from our Installer(s) Disclaimer and More Information The Number of Times the Catalog is Downloaded Each time the catalog is download via anHTTPS request, we will increment the number of times it was downloaded. The data type for this is aninteger. We will also report the next scheduled sync time as aDateTime. Reason:The download count and next sync time are collected because we believe this gives critical insights to understand if a specific customer has been able toutilize our products and services effectively. The Version Number of the Publisher Software Thecurrently installed versionof the Publisher is reported as astringvalue. Reason:Theinstalled versionis helpful to understand how ourself-updates are progressingand if any notifications may need to be sent based on notices for customers on aspecific-build. The List of Selected Products The list ofselected productsin the Publisher is reported as a list of product identifiers and product types. Reason:The list ofselected productsis essential to help us understand the usage of our catalog, and ensure we are able to reach out to customers regarding specific products. .NET Version Number where the Publisher Software is installed Theversionof .NET where the Publisher Software is installed. Reason:Theversionof .NET where the Publisher is installed is important to help us understand if future releases of the Publisher, and any code changes, will be supported. Are Preview and Self-Updates Updates Enabled Thepreview update statuswithin the Publisher will be reported using abooleantype. Theself-updatestatus will be reported as aboolean. Reason:We collect this data to understand what customers have enabledpreview updates enabledorself-updates disabled. This state may be helpful to notify customers of any specific actions that may need to be taken. Is ConfigMgr Application Creation Enabled The Publisher will report if the checkbox toenable the creation of ConfigMgr appsis enabled as aboolean. Reason:This data is helpful to understand if a customer is making use ofall the features they may be entitled towithin their subscription. Is Intune Application Creation Enabled The Publisher will report if the checkbox toenable the creation of Intune appsis enabled as aboolean. Reason:This data is helpful to understand if a customer is making use ofall the features they may be entitled towithin their subscription. The Error Description if an Update or Application Publishing Fails The Publisher will report the specific error returned if an update or application fails to create. This applies to theUpdates,ConfigMgr Apps,Intune Apps, andIntune Updates tab.The error description is astringvalue. Error description reporting can be disabled with the following registry value: REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v DisableErrorReporting /t REG_DWORD /d 1 /f REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v DisableErrorReporting /t REG_DWORD /d 1 /f Reason:This data helps us see any issues a customer is having whenapplicationsorupdates fail to create. Our goal is to be able to proactively reach out to customers who are experiencing known publishing issues. The Configuration Manager Site Version The Publisher will report back theConfiguration Manager site versionif the SMSProvider is defined as astringvalue. Reason:The Configuration Managersite versionis important to know what versions of ConfigMgr are installed for compatibility and supportability. If we are aware of anycompatibility issueswith a specific Configuration Manager build, this data will allow us to contact affected customers. The WSUS Build Number The Publisher will report back theWSUS build numberas astringvalue. Reason:This data helps us identifyWSUS API\u2019swe need to test, support, or depreciate. The WSUS Database Type The Publisher will report back thetype of WSUS Database, whether WID or SQL. Reason:This data helps us better understand how our customers use WSUS which can impact how our software works. WSUS Updates Cleanup Information The Publisher will perform some WSUS cleanup during a sync. Thenumber of updates, size of the updates,andfolder countcleaned up are reported back asintegervalues. Reason:This data helps us better understand hard disk usage for the Publisher. WSUS Maintenance Configuration The Publisher will report back the current WSUS Maintenance configuration from the respective tab in Configuration Manager, which includes the following: Decline expired updates in WSUS According to supersedence rules Decline expired updates in WSUS According to supersedence rules Add non-clustered indexes to the WSUS database Add non-clustered indexes to the WSUS database Remove obsolete updates from the WSUS database Remove obsolete updates from the WSUS database Reason:This data helps us better understand how our customers use WSUS which can impact how our software works. The Number of Products Enabled and Published The Publisher will report the specific number of products enabled within each of the following tabs:Updates,ConfigMgr Apps,Intune Apps, andIntune Updatesas aninteger. The publisher will also report the number of updates, applications, and CVE\u2019s published as an integer. Reason:This data helps us see thepercentageof enabled vs. available products and how many products are being published. Heartbeat The Publisher sends a heartbeat every 4 hours. This simply is used as an indication that the Patch My PC service is running. Reason:This data helps us determine if an instance of the Publisher is active. The data is used in troubleshooting failed upgrades and understanding Publisher usage. Certificate Validation Errors The Publisher performscertificate validationwhen communicating with Patch My PC servers. If an error occurs, thecontent of the erroris reported as astringvalue. Reason:This data helps us ensure the security and availability of the connection between the Publisher and Patch My PC servers. Feature Usage The enablement of features, such as thePause Feature, Proxy enablement other features added to the Publisher are reported back asbooleanvalues. Reason:This data helps us determine theusage of new featureswithin the Publisher andhelps us contact customersin the event a bug may affect them. Cloud Attached Thestatus of thecloud connectionis reported back as abooleanvalue indicating if there is configured connection between the Publisher and Patch My PC Cloud. Reason:This datahelps us validate the connectionbetween the Publisher and Patch My PC Cloud toensure the availabilityof cloud-enabled features. Alert Configuration Theenablementof alerts, such asSMTPalerts, orTeams alertswithin the Publisher is reported back as abooleanvalue. Reason:This data helps us determinehow customers can be notifiedof changes, actions or errors within the Publisher. ConfigMgr Application Metadata The list ofConfigMgr Applicationsand relatedmetadatais reported back as a JSON payload. This includes information such as the installation command line, uninstallation command line, detection method, file names, file hashes, display info, and other application-related information. The collection of this information is dependent on the Publisher being cloud-connected and the Migration feature being enabled. Reason:This data is used to allow for the ConfigMgr to Patch My PC Cloud Migration feature. The data collected is analyzed to determine which applications are eligible for migration. How Data is Transferred The data listed above would betransportedandencryptedusingTLS 1.2. Data collected from our Installer(s) We collect \u201cInstaller Analytics\u201d which is part of Advanced Installer \u2013Installer Analytics (advancedinstaller.com) Advanced Installer is what we use to create the installers for both Advanced Insights and the Patch My PC Publisher. The data collected is:- Was the application installed or uninstalled? Was the application installed or uninstalled? The version of the app that is installed The version of the app that is installed Were there any exceptions during the installation? Were there any exceptions during the installation? The OS that the app was installed on The OS that the app was installed on The version of .NET, IIS, Java runtimes The version of .NET, IIS, Java runtimes Is the device x64 or x86? Is the device x64 or x86? The geographic location of the installation (e.g. US, UK, Germany) The geographic location of the installation (e.g. US, UK, Germany) Were the prerequisites met? Were the prerequisites met? Disclaimer and More Information The list above is current throughAugust 20, 2024. We will try to keep this list updated, but it may not contain every instance of data collection. Please contacttechnical supportwith any questions or you can review ourTerms of Service. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-does-microsoft-intune-multi/", "title": "Microsoft Intune, Multi Admin Approval, Patch My PC, Win32", "raw_text": "How does the Microsoft Intune Multi Admin Approval feature affect Patch My PC products The Microsoft IntuneMulti Admin Approval(MAA) feature introduces the option for administrators to add an additional layer of security when creating or modifying scripts and apps in Intune by requiring admin approval before changes become effective. MAAdoes notimpact the ability for any Patch My PC products to succesfully create and modify Win32 apps in Intune. Patch My PC continues to operate seamlessly with Intune, and no adjustments are needed when using the MAA feature. This article will provide an overview of why this Intune feature has no effect on Patch My PC\u2019s functionality Why are Patch My PC products not affected by MAA? Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/subscription-statuses-overdue-invoices/", "title": "Overdue Invoices, Subscription Status, Suspended Status, Payment Overdue", "raw_text": "Subscription Statuses for Overdue Invoices Subscription Statuses for Overdue Invoices In this article, we are going to review different subscription states when invoices are overdue. At-Risk Subscription Status If payment is overdue to 60 days, your subscription will be marked asat-risk.An at-risk subscription means you are at risk of beingsuspendeddue to a lack of payment. When a subscription isat-risk, you will receive the following notifications within our publisher tool. If you click theAt-risk of suspensionlabel, you will receive a message about why your subscription was marked asat-risk. IfMicrosoft TeamsorEmailalerts are enabled within the Publisher, you will also receive the following warnings. Microsoft Teams Notification Email Notification Note:Anat-risksubscription will still function and allow the catalog to be processed and publish new third-party software updates or applications to Microsoft Intune or Configuration Manager. Suspended Subscription Status Generally, a subscription may besuspendedwhen the payment of an invoice is over 90 days overdue. When a subscription is suspended, access to our catalog will be removed. You will be unable to publish any new third-party updates or applications to your Microsoft Intune or Configuration Manager environment. When a subscription issuspended, you will receive the following notifications within our publisher tool. If you click theSubscription suspendedlabel, you will receive a message about why your subscription wassuspended. IfMicrosoft Teams alertsare enabled, you will see the following message: Ifemail alertsare enabled, you will see the following email: Note:If your subscription has beensuspended, you will no longer be able to use our services to publish new third-party software updates or applications. Terms of Service Regarding Suspensions For information about suspensions, please seeSection 5: Fees, Payments, and Refundsof ourTerms of Service Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/customize-content-download-log-save/", "title": "Customize Temporary Downloads, Content Location, Folder Options, Log Storage", "raw_text": "Customize Content Download and Log Save Location In this article, we are to review the option customize content download and log save locationin the Advanced tab of the publisher. This feature was requested on our UserVoice portalOption to Change Default Temporary Download from %WinDir%temp to a Custom Folder Use a Custom Folder for Temporary Downloads By default, content files are downloaded temporarily to%temp%during publishing operations. Since the service runs under system context,%temp%generally will translate toC:\\Windows\\Temp. After the publishing operations are completed, these files will be automatically deleted. Optionally, you can define a custom folder in theAdvanced tabfor where these content files are downloaded. When this setting is configured, the temporary content downloads will take place in the random subfolder of the folder defined. Use Case:The option to define a custom folder for temporary content downloads can be helpful in the following situations. You need to make anti-virus exclusions and prefer not to exclude theC:\\Windows\\Tempdirectory. Instead, the defined folder can be excluded. Low disk space concerns on the system drive Use a Custom Folder for the PatchMyPC.log By default, the PatchMyPC.log file is stored in the%InstallDir%of the Publisher. This configuration is generally recommended, but there may be some cases where you may want to define a custom folder for the log file for collection and monitoring reasons. If you set a custom folder, the computer account of the device running the publisher will need permissions to write to the folder. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-rollback-uninstall-third-party-update-in-configmgr/", "title": "ConfigMgr, Updates, Uninstall, Rolling Back", "raw_text": "How to Rollback or Uninstall Third-Party Software Updates in ConfigMgr This article describes how torollback/uninstall a third-party software update in Configuration Manager (ConfigMgr). We get asked:how do I rollback a third-party update if there are issues in my environment. This guide will describe your options and some limitations that exist. No Native Support to Rolling Back Any Updates in ConfigMgr (Including Windows Updates) It\u2019s important to understand that thesoftware update featurein Configuration Manager doesn\u2019t natively support the uninstall/rollback of any updates, including Microsoft updates. If you needed to uninstall a Microsoft update, you would need to create a task sequence or package that runs thewusa.exeuninstall command manually. An example of this process is available atUninstall Windows Update Using SCCM. How to Rollback a Third-Party Update to a Previous Version in ConfigMgr To rollback a third-party software update, you can use theapplication management featureavailable in Patch My PC. You can useapplication supersedencein ConfigMgr torevert an application to a previous version. In the example below, we will show how torevert Google Chrome 87.0.4280.66 (x64)toGoogle Chrome 84.0.4147.105 (x64). To perform a rollback, you will need to have an application you want to rollback to as well as the version you want to revert from (the software update that was installed). Note:If you are using theUpdate existing application\u2019s metadata, deployment type, detection method, and content files (Default), you can enable theretain up to X previously created applicationsin theConfigMgr application optionsto provide you with a rollback option. Otherwise, previous application versions would not be available from Patch My PC. To revert to an older version, go to thepropertiesof the application you want to revert to and perform the following actions: Click theSupersedencetab > clickAdd\u2026> ClickBrowse\u2026 > Select thelatest applicationyour want to uninstall > Select the deployment type in theNew Deployment Typedrop-down > and Check theUninstallcheckbox. You can nowdeploy the applicationyou want to revert to, and the deployment will automatically uninstall the latest update before the rollback. Note:These rollback instructions apply to arequireddeployment. It is not recommended to apply these steps to anavailablerollback deployment. All the Patch My PC detection methods check for software versions greater than or equal to the desired version. Theoldapplication will return detected when thenewversion is installed. This can cause supersedence relationships to be unexpectedly evaluated during an available deployment. Perform an Uninstall of a Third-Party Application in ConfigMgr If you want to remove a third-partyapplication entirely, you can use theuninstall featureof theapplication management feature. Almost all applications created by Patch My PC will have the uninstall program defined in the applicationsdeployment type. You can deploy the application you want to remove as anuninstall deploymentto remove it from a device collection. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/path-denied-sccm/", "title": "Content Source Permissions Configuration, Patch My PC Publisher, SMS Provider Connection, Folder Permissions", "raw_text": "Access to the Path Is Denied \u2013 Configuring Content Source Permissions In this article, we will cover the necessarypermissions required for the Patch My PC Publisher to manage contentfor the Applications which are published to Configuration Manager. This article is useful when you arereceiving errors such as the belowfrom the Patch My PC Publisher. Step 1: IdentifyWhoTo Grant Permissions To ThePatchMyPCServiceis the identity that will perform all content-based actions. This, by default, will run as theLocal Systemon the machine which runs the Publisher. This is generally your top-level Software Update Point, which may, or may not also be your primary site server. In our example,thewhowill be ourConfiguration Manager Site Server, namedSCCM. In other environments, this may be the site server or the software update point. Whichever is hosting thepublisher. If you have navigated the Base Install options, you might be familiar with an option to configure theSMS Provider connection. It is important to note the credentials in the below location arespecifically for interactions between the Publisher, and the SMS Provider, i.e. application publishing, content distribution, etc. For more details, seethis article.Otherwise,all of the file-based operations for managing the sources will happen as the Local System, as shown in the Services screenshot above. Step 2: IdentifyWhatTo Grant Permissions To The sources location which the service will need permissions to can be found within the settings of the Publisher. See below for the location of this setting. Note:You do not need to share out the direct folder which the settings reference. It just needs to be a folder that sits within a shared folder. For example, the share can be \u201c\\\\sccm\\sources\u201d while your source folder below can be \u201csccm\\sourcesPatchMyPC\u201d if you prefer. For our example, the share happens to be the same folder as the sources. Step 3: Configure the Permissions \u2013 Both Share, and NTFS The effective permissions of your sources folder will be the result of combining both your NTFS, and your Share permissions with the more restrictive being the effective permission. To simplify the management of permissions, the Share permissions are typically set to \u2018Everyone Full Control\u2019 as shown below. Don\u2019t worry, the effective permissions will be restricted by your NTFS permissions. As noted above, the share which you grant permissions on may not be the exact path specified in the settings. But the sources folder should be a subfolder of the share. With share permissions set, we can configure the NTFS permissions. This is where thewho,and thewherecomes into play, which we determined earlier to be the computer account which runs the Publisher, and the UNC path configured in the Publishing Tool. At a minimum, the computer account needs read, write, and modify permissions on the folder structure which will host the source content. This should also propagate to all subfolders and files. Because this is more restrictive than the \u2018Everyone Full Control\u2019 permission set on the share, this will be our effective permission for the SCCM principal. Other Considerations: Processes Locking Source Content Sometimes an \u2018Access Denied\u2019 does not mean the permissions are setup incorrectly. Instead, there can be a separate process that is locking the files. The typical culprits in this scenario are outlined below. Content distribution actively updating your content libraryProblem:Configuration Manager will take a \u2018snapshot\u2019 of the source directory in order to determine what needs copied into the content library. This can cause a file lock.Solution:Wait for content distribution to complete, and attempt another synchronization Problem:Configuration Manager will take a \u2018snapshot\u2019 of the source directory in order to determine what needs copied into the content library. This can cause a file lock. Solution:Wait for content distribution to complete, and attempt another synchronization Admin actively editing fileProblem:Administrative user has the file openSolution:Open the MMC on the server hosting your shares, and add the \u2018Shared Folders\u2019 snap-in. Within this snap-in, there is an \u2018Open Files\u2019 section where you can \u2018Close Open File\u2019 Problem:Administrative user has the file open Solution:Open the MMC on the server hosting your shares, and add the \u2018Shared Folders\u2019 snap-in. Within this snap-in, there is an \u2018Open Files\u2019 section where you can \u2018Close Open File\u2019 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/package-sign-error-2148204810/", "title": "WSUS error, WSUS signing certificate", "raw_text": "Failed to sign package; error was: 2148204810 In this article, we will be reviewing an error that can occur when trying to publish third-party software updates toWSUS. Determine if You are Affected If you are affected by this error, you will see the following error(s) in thePatchMyPC.logorSoftwareDistribution.log An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2148204810 PublishPackage(): Operation Failed with Error: Failed to sign package; error was: 2148204810 This error generally will occur when the software update is beingtimestamped, but the WSUS Signing Certificate is not trusted on the WSUS Server. Note:Error code2148204810translates toA certificate chain could not be built to a trusted root authority. Check if the WSUS Signing Certificate is Trusted On the WSUS Server, opencertlm.mscfrom aRunprompt. In theWSUS certificate store, double click your WSUS Signing Certificate and click theCertification Authoritytab. The most common root cause forerror 2148204810is theWSUS Signing Certificate is not trusted at theroot levelfor the CA the issued the certificate. You will need to determine why the root certificates are not trusted on the server. It\u2019s possible automatic root certificate updates weredisabled via GPO. Known Issue when Using Sectigo Code-Signing Certificate We have worked with customers using a WSUS code-signing certificateissued from Sectigo. There\u2019s a known issue where if you don\u2019t have thelatest Sectigo Root CA and Code Signing certificates imported, you will receive this error after May 30, 2020. Please review the following article from Sectigo for information about this issue: Sectigo AddTrust External CA Root Expiring May 30, 2020 How to Download & Install Sectigo Intermediate Certificates \u2013 RSA Is the WSUS Signing Certificate Expired? Another possible reason you may receiveFailed to sign package; error was: 2148204810is theWSUS Signing Certificate may be expired. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-move-wsus-content-folder/", "title": "WSUS Content Move, WSUSUtil, Disk Space Management", "raw_text": "How to Move the WSUS Content Folder to a New Location The WSUSContent folder is where WSUS stores information regarding Microsoft software update EULA\u2019s, third-party software update content, and Microsoft update content when using WSUS standalone without SCCM. There are a few reasons why you may want to move the WSUSContent folder to a new location, including: Low disk space on the current volume Corrupted or misconfigured shares for (WsusContent, UpdateServicesPackages, or WSUSTemp) How to Use WSUSUtil.exe to Move the WSUSContent Folder to a New Location To move the WSUSContent folder to a new location, you will need to use theWSUSUtil.exetool located in theC:\\Program Files\\Update Services\\Toolsdirectory. In our example, we will move the WSUSContent folder fromC:\\WSUStoJ:\\WSUS Here is a list of available command lines forWSUSUtil.exe: There are two possible options you can use when moving the WSUSContent folder: The first option is to move file\u2019s in the current WSUSContent folder to the new location. We recommend using this option if you have already published third-party software updates to your WSUS server and want to migrate those published updates. Example:\u201cC:\\Program Files\\Update Services\\Tools\\WsusUtil.exe\u201d movecontentJ:\\WSUSC:\\WSUSmove.log The second option includes the -skipcopy parameter and does not copy the existing file\u2019s in the current WSUSContent folder to the new location. This option can save time if you haven\u2019t published any third-party updates before or don\u2019t want to migrate previous content. Example:\u201cC:\\Program Files\\Update Services\\Tools\\WsusUtil.exe\u201d movecontentJ:\\WSUS-skipcopy C:\\WSUSmove.log Validate WSUSContent Move was Successful There are three different places where the WSUSContent configuration is utilized. If configured correctly,all these locations should point to the same path. In the registry on the WSUS server, HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Update Services\\Server\\Setup:ContentDir In IIS > Sites > WSUS Administration >Content InSQL Server Management Studio, run the following query against theSUSDBrun the following query:Select LocalContentCacheLocation from tbConfigurationB InComputer Management, review theShared Foldersnode and validate theFolder Path How to Use WSUSUtil.exe to Move the WSUSContent Folder to a New Location (Video) If you would like to watch the video guide, this goes into a more detailed explanation about how to move the WSUSContent folder, and all the locations to validate, including the registry, IIS, shared folders, and the SUSDB. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/pass-variables-into-pre-post/", "title": "Patch Variables Scripts Configuration", "raw_text": "Pass Variables into Pre and Post Scripts This article covers the feature to pass variables into pre and post scripts using Patch My PC. Topic 1: Pass Variables into Pre and Post Scripts Starting with the Patch My PC Publisher Preview Release 2.1.6.35 and Production Release 2.1.7.0, variables are now able to be passed into pre/post scripts defined in theAdd custom pre/post scriptsfeature.These variables can be passed into the Pre/Post scripts by including them in the arguments list of the Pre/Post script. Example of creating a post script with variables. With release 2.1.6.35 and 2.1.7.0 the following variables can be passed into Pre/Post Scripts defined in Patch My PC: Vendor NameThe name of the Vendor as defined in Patch My PC(in Base64)below The name of the Vendor as defined in Patch My PC(in Base64)below Product NameThe name of the Product as defined in Patch My PC(in Base64)below The name of the Product as defined in Patch My PC(in Base64)below VersionThe version of the application or update being installed The version of the application or update being installed PackageIDThe ConfigMgr PackageID The ConfigMgr PackageID Return Code (Post Script Only)The return code of the main installer process The return code of the main installer process Topic 2: Using the Product and Vendor names in Pre/Post Scripts Patch My PC passes the Product and Vendor names to scripts in Base64 to avoid issues with escape characters and long names. Therefore to use the Product or Vendor names in post scripts, they will need to be converted back to a human readable string. The following PowerShell script gives an example of a script that can convert the Pre/Post script variables to a human readable string. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/adr-error-0x87d20417/", "title": "Automatic Deployment Rule, ConfigMgr Errors, WSUS Content Folder", "raw_text": "Automatic Deployment Rule Error 0X87D20417 or 0x80070194 There are a few reasons you may see an automatic deployment rule fail with error code0X87D20417/0x80070194or a third-party update fail todownload to a deployment packagein the ConfigMgr console with errorThe cloud file provider exited unexpectedly. These two scenarios are a result of the sameroot causewhich is discussed below. Root Cause of Error 0x80070194 and 0X87D20417 These errors generally occur when the third-party update (.CAB) fie published to theWSUSContent folderis deleted, or the Content virtual directory in IIS is not configured properly. There are various reasons the update (.CAB) file for the published update(s) may not exist in the WSUSContent folder, including: CustomWSUS cleanup scripts removing contentfrom the WSUSContent directory The WSUSContent folder ismisconfigured in IIS The WSUSContent folder is pointing to aUNC network shareand the appropriate configurations and permissions weren\u2019t configured TheDeployment Package source pathdoes not have the neededNTFS or SMB permissionsconfigured Scenario 1: Automatic Deployment Rule Fails with Error 0X87D20417 or 0x80070194 Depending on the Configuration Manager build, you will see an ADR failure code of0X87D20417or0x80070194. Example of ADR withLast Error Codeof0x80070194 Example of ADR withLast Error Codeof0X87D20417 InPatchDownloader.log (For ADR), you will likely seeone of the following errorsin the log: HttpSendRequest failed HTTP_STATUS_NOT_FOUNDorHttpSendRequest failed 502 ERROR: DownloadContentFiles() failed with hr=0x80070194orERROR: DownloadUpdateContent() failed with hr=0x800701f6 Failed to create directory hostnamefolder.1_1.cab, error 5 CreateLinkToExistingFile() failed for ContentID . hRes = 0x80070005 ERROR: DownloadUpdateContent() failed with hr=0x80070005 Inruleengine.log,you may also see one of the following errors in the log: Failed to download the update content with ID from internet. Error = 5 Failed to download ContentID for UpdateID . Error code = 5 Scenario 2: In-Console Download Error: The cloud file provider exited unexpectedly. When downloading a third-party update in the ConfigMgr console to a deployment package you receive the following error \u201cError: The cloud file provider exited unexpectedly.\u201c InPatchDownloader.log (For Console Downloads), you will also see the following error in the log. HttpSendRequest failed HTTP_STATUS_NOT_FOUND ERROR: DownloadContentFiles() failed with hr=0x80070194 Error0x80070194translates to \u201cThe cloud file provider exited unexpectedly.\u201c Troubleshooting Step 1: Does the (.CAB Update Files) Exist in the WSUSContent Folder The first step you need to do is confirm the updates being downloaded exist in theWSUSContent folder. Here\u2019s a diagram that should help understand the data flow for the download of third-party updates. Determine the fulldownload URLbased on thePatchDownloader.log. Once the download URL is determined, you can check if thefolderandCAB fileactually exist in theWSUSContentfolder. Note:To match a missing .cab file to an Update in ConfigMgr or WSUS, please review the following articlehttps://patchmypc.com/associating-missing-cab-file-in-wsus-to-an-update If theCAB file doesn\u2019t exist, you will be unable to download and deploy that specific update(s) where the CAB file is deleted. Thepossible resolutionsfor this scenario are: Republish the update(s) as a new update and supersede the existing update Restore the CAB file is there is a backup of the WSUSContent folder that contains the CAB file If thetwo-character foldersin theWSUSContentfolder are deleted, we found the most common reason for this is when a deployment package in ConfigMgr uses the same path of the WSUSContent. This configuration will cause ConfigMgr to delete all folders, including published third-party updates periodically. Please review our articleIncorrectly configured deployment package to use the WSUSContent folder. If only theupdates (.CAB files) are missingfrom thetwo-character sub-foldersinWSUSContentand using a shared WSUS database with multiple WSUS servers, it may be a common certificate misconfiguration causing the .CAB deletion. Please reviewUpdate CAB Files Deleted from WSUSContent when Using Shared SUSDBif (.CAB) update files are automatically deleted right after publishing. Troubleshooting Step 2: Check if the WSUS Signing Certificate is Trusted on Site Server Another common reason ADRs may fail is theWSUS signing certificatehasn\u2019t properly been install on thesite server. If you have this issue, you will see the following errors. If failing to download when using ADRs, you should check thePatchDownloader.log (For ADR).You will likely see the following errors: Authentication of file C:\\UsersAppData\\Local\\TempCAB85AE.tmp failed, error 0x800b0004 ERROR: DownloadUpdateContent() failed with hr=0x80073633 If failing to download when using ADRs, you theRuleEngine.logwill likely see the following error: Failed to download the update content with ID 16777699 from internet. Error = 13875 0x800b0004 = The subject is not trusted for the specified action.0x80073633 = Invalid certificate signature13875 = Invalid certificate signature To check if the WSUS signing certificate is installed, perform thefollowing actions: 1. Downloadthe specific update CAB file failing to download using a web browser or copy directly from the WSUSContent folder. You can get the update download URL or folder/file path to the WSUSContent folder based on thePatchDownloader.log 2.Copythe .CAB file to the machine running theConfigMgr console if failing to download via consoleor to thesite server if using an ADR. Onpropertiesof the file, review theCertification Pathtab, and review if there are any trust errors. If the certificate shows anytrust errors, you will need todeploy this certificate to all machinesormanually installit toTrusted RootandTrusted Publisherson the affected machine if for testing only. Troubleshooting Step 3: Verify the Content Virtual Directory is Correct If you validated theCAB file existed in step 1, the next step is to validate theContent virtual directoryin theWSUS Administrationwebsite is correct. There is a bug in the WSUS setup process that can remove the leadingwhen using aUNC pathfor the WSUSContent folder. To check thePhysical Pathfor the Content virtual directory:Right-click Content>Manage Virtual Directory>Advanced Settings\u2026 Here\u2019s an example of the WSUS bug where the leadingare removed from the virtual directoryPhysical Path. Because the directory is invalid in the Content virtual directory updates will fail to download with error0x80070194or0X87D20417. If you are affected by this scenario, simply update the path to include the leadingas shown below and clickOK Troubleshooting Step 4: Is WSUSContent a UNC Share with the Default IUSR Authentication We also see customers where aUNC pathis being used, and the authentication identity hasn\u2019t been changed to use theApplication pool identityfor theContent virtual directory. Perform the following actions to review and resolve this issue if applicable: ClicktheContent virtual directory> Double ClickAuthenticationin theIIS Group Right-ClicktheAnonymous Authenticationand ClickEdit Here you can review theAnonymous user identityused for authenticating to the WSUSContent directory. By default, the authentication is set to use the specific user:IUSR. IUSR is a local user-specific to the WSUS server and will not have access to a authenticate to anyremote UNC share. In theEdit Anonymous Authentication Credentialsdialog for theAnonymous Authenticationensure it is set to use theApplication pool identity Note:This step would only be applicable if the WSUSContent folder uses aUNC pathfor thePhysical Pathin theContent virtual directory. Troubleshooting Step 5: ADR\u2019s may Fail for Third-Party Updates if a Proxy is Enabled If all theprevious settings are correct, another common reason ADR\u2019s will fail to download third-party updates is due to aproxy being enabled. First, review if the checkboxUse a proxy server when downloading content by using automatic deployment rulesis enabled in theSoftware update point Properties A proxy of often required todownload Microsoft updatesdirectly from the internet for ADRs. However, in some scenarios where thePatchDownloader componentwill use the proxyfor the downloads from the internal WSUS server. If theproxy server cannot resolve the internal WSUS server using DNSor afirewall blocking the proxy from downloading content from internal servers, it will cause third-party updates to fail to download. InPatchDownloader.log (For ADR), you will probably see ahttps error 502. Here\u2019s an example of what you may see inPatchDownloader.logif theproxy server can\u2019t resolve the WSUS server name. HttpSendRequest failed 502ERROR: DownloadUpdateContent() failed with hr=0x800701f6 In the image below, you can see details in thePatchDownload.logthatshows a proxy in use duringthe download of the software update. If you are affected by the proxy issue, we have a knowledge base article with workarounds atUpdates Fail to Download in ADR with Error HttpSendRequest failed 502 / 0x800701f6. Note:The specific HTTP error code can vary depending on how the proxy returns the download error, but the most common we have seen is502 errors. Troubleshooting Step 6: Is a Deployment Package Using the WSUSContent Folder? One issue that can cause files and folders to be deleted from theWSUS Content folderis when asoftware update deployment packageis using the WSUS Content folder as thepackage source location. Here\u2019s an example of a deployment package incorrectly using theWSUS Content folder(s)as the package source path. When a deployment package is configured to use the WSUS Content folder as the package source,Configuration Manager will automatically delete all files and foldersnot related to the deployment package, including thepublished third-party update CAB files. You can quickly check if any deployment packages are using the WSUS Content folder by performing the steps below: In the ConfigMgr console, navigate toSoftware Library>Software Updates>Deployment Packages Right-clickthe columns and addPkg Source Path In thesearch box, enter the wordwsusand click thesearch button. In our example below, we can see two deployment packages using the WSUS content folder(s) as thepackage source path. Your deployment package source path for Patch My PC updates should be a newdedicated folderthat isn\u2019t pointing to the WSUS Content folders at all. Here\u2019s an example of avalid pathandinvalid paths. If you had the WSUS Content pointing to the WSUS Content folders and theupdate CAB files where deleted, the workaround is therepublish the third-party updates affected. Please see the following knowledge base article:When and How to Republish Patch My PC Third-Party Updates Troubleshooting Step 7: Verify SMB and NTFS Permissions on Deployment Package Source Path This troubleshooting step mostly pertains to when you see \u201caccess denied\u201d type error messages or codes inPatchDownloader.logorruleengine.log, while also seeing the error code0X87D20417for your ADR in the SCCM console. The error codes you will likely see in the mentioned log files can be5or0x80070005. This particular issue revolves around trying to initiate the download for updates in to a Deployment Package. The likely root cause in this scenario is going to be insufficient permissions on the Deployment Package\u2019s source path. For ADRs to download updates to a Deployment Package, the SYSTEM account of the site server needs to be able to read and write to the source path. The solution is toreview the SMB and NTFS permissionsof the source path used for the Deployment Package. We have a seperate KB article dedicated to this topic:Failed to download content id . Error: Access is Denied. Troubleshooting Step 8: Recreate Automatic Deployment Rule and select \u201cDownload software updates from the Internet\u201d This troubleshooting step mostly pertains to when you see Failed to download the update content with ID XXXXXX from UNC content source. Error = 3 inruleengine.log, while also seeing the error code0X87D20417for your ADR in the SCCM console. This particular issue occurs when you select \u201cDownload software updates from a location on my network\u201d during Automatic Deployment Rule creation. The solution is to recreate the Automatic Deployment Rule and select \u201cDownload Software updates from the internet\u201d on the Download location section. Video Version of Troubleshooting Please review and video guide below to understand possible causes and resolutions for the errors listed below. ERROR: DownloadContentFiles() failed with hr=0x80070194 HttpSendRequest failed HTTP_STATUS_NOT_FOUND Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-global-options/", "title": "Intune Application, Patch My PC, Encryption Keys, Extraction", "raw_text": "Intune Global Options There is an option in the Patch My PC Publisher to store the encryption keys used to create the Intune package files (.intunewin). This is configurable in the advanced tab. With the keys stored, you can use theIntune Application Managerto download and extract the content of the Patch My PC published Intune applications and updates. Enable the option to track the encryption keys used to create Intune package files Navigate to theAdvancedtab in the Patch My PC Publisher and underIntune Global Optionscheck the box labelledWhen publishing an Intune package, locally keep track of encryption information to allow later extraction After you clickApply,this new setting will be reflected in theIntuneTenants RetainCryptoInfoelement in settings.xml. It will change fromFalsetoTrue Note:The default location for settings.xml is C:\\Program Files\\Patch My PCPatch My PC Publishing Service Using the Intune Application manager to download and extract applications and updates published by Patch My PC From either the Intune Apps or Intune Updates tab, open theIntune Application Manager Right click an application and selectExtract Content Note:If the Extract Content option is greyed out, it means that the encryption keys were not gathered when the app was published. This is most likely due to the feature being enabled \u201cafter\u201d the app or update had been published. Either enter anOutput Pathmanually or clickBrowseto choose the output directory. ClickExtract Explorer will open the window to the path specified and display the extracted content Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-deploy-wsus-signing-certificate/", "title": "WSUS Certificate Deployment, Third Party Software Updates, Configuration Manager", "raw_text": "How to Deploy the WSUS Signing Certificate for Third-Party Software Updates Deploying the WSUS Signing Certificate to devices is a requirement for devices to trust and install third-party software updates from standalone WSUS or a Configuration Manager environment. If the certificate is not installed within theTrusted RootandTrusted Publisherscertificate store, you will receive error code0x800b0109when attempting to install third-party software updates on devices. Here\u2019s thelist of optionscovered in the article fordeploying the WSUS Signing Certificateto devices: Use the Configuration Manager 1806+ Certificate Management FeatureValidate Client Setting Priority is Correct Validate Client Setting Priority is Correct Use Group Policy to Deploy the WSUS Signing Certificate Using a Configuration Manager Task Sequence During Imaging Use a Configuration Manager Configuration Item Option 1: Use the Configuration Manager 1806+ Certificate Management Feature If your Configuration Manager site and clients are running current branch 1806 or newer, the easiest option is to enable the new built-in option within the software update point forConfiguration Manager manages the updates. To enable this option,perform the steps below: In the Configuration Manager console, go to theAdministrationworkspace. ExpandSite Configuration, and select theSitesnode. Select the top-level site in the hierarchy. In the ribbon, clickConfigure Site Components, and selectSoftware Update Point. Switch to theThird-Party Updatestab. Select the optionConfiguration Manager manages the certificate. A new certificate of typeThird-party WSUS Signingwill be created in theCertificatesnode under theSecuritynode in theAdministrationworkspace. After performing the steps above,validate the certificate is created/imported: Trigger asoftware update point synchronizationby right-clicking the All Software Updates node, and clickingSynchronize Software Updates. If you review thewsyncmgr.log, you should see some details about the certificate being imported and created. If the certificate was configured successfully, if you re-open theThird Party Updates tab, you should see thecertificate details. Lastly, you need to enable the client settings toenable third party updates on clients: In the Configuration Manager console, go to theAdministrationworkspace and select theClient Settingsnode. Select the default client settings, an existing custom client setting, or create a new one. Select theSoftware Updatestab on the left-hand side. If you don\u2019t have this tab, make sure that theSoftware Updatesbox is enabled. Set theEnable third-party software updatestoYes. Validate the client settings isdeployed to all devices You can also review thestep-by-step video guidefor deploying the WSUS certificateusing Configuration Managerbelow: If your software update point isremotefrom yourtop-level site serverand the software update point isnot configured for SSL, the option within Configuration Manager toAutomatically manage the WSUS signing certificatewill not work and you will receive an error in wsyncmgr.logRemote WSUS connection is not HTTPS. This prevents software update point from getting the signing certificate for third-party updates. For more details about this scenario, please see the following Microsoft DocAdditional requirements when the SUP is remote from the top-level site server. Option 1.1: Validate Client Setting Priority is Correct If you enabled the client setting toenable third party software updates, performed amachine policy syncandsoftware update deployment evaluation cycle,and the client still didn\u2019t install the WSUS signing certificate, please perform the following check. View theresult client settingson the specific device, not installing the certificate from the ConfigMgr console\u2019sDevicesnode. If theresult client settingsshows the Enable third party software updates asNo, that means there another client setting taking priority of the policy you deployed to set this value to Yes. You can view all the client settings deployed to a specific device in theClient Settingstab. When troubleshooting client certificate installation issues, in addition to the client settings priority, you need to ensure theclient versionis alsoConfigMgr 1806ornewer. The client version for build 1806 is5.00.8692.1003 Important: By default, theEnable third party software updatessetting is configured toNofor any existing policies. This often causes machines where the policy is deployed to be overwritten by other client settings deployed to the same device. When you have multiple custom client settings, they are applied according to their order number. If there are any conflicts, the setting that has thelowest order number overrides the other settings. To change the order number, on theHometab, in theClient Settingsgroup, chooseMove Item UporMove Item Down. (Microsoft Docs) Option 2: Use Group Policy to Deploy the WSUS Signing Certificate You can also usegroup policy to deploy the WSUS Signing Certificateto devices within your environment. This option is helpful if you can\u2019t manage the certificateusing the Configuration Manager built-in option. Please see thePDF guide below for a step-by-stepguide for how to deploy the WSUS signing certificate using group policy to devices. Deploying the WSUS Signing Certificate Using GPO (PDF Guide) You can also review thestep-by-step video guidefor deploying the WSUS signing certificateusing GPObelow: Option 3: Using a Configuration Manager Task Sequence During Imaging Another option is to deploy the certificate within a Configuration Managertask sequence stepor apackage deploymentthat usescertutil.exeto import the WSUS Signing Certificate to theTrusted RootandTrusted Publisherscertificate store. For instructions using this method, please review the followingknowledge base article. Option 4: Use a Configuration Manager Configuration Item Another option is to deploy the certificate within a Configuration Manager using aconfiguration item. For instructions using this method, please review the followingknowledge base article. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/known-issues-considerations-when-using/", "title": "Patch My PC, Known Issues, Compatibility Problems", "raw_text": "Known Issues and Considerations when Using Patch My PC The article below shows known issues and considerationsto make when deploying specific products using Patch My PC. Patch My PC will periodically reevaluate product behavior and adjust these lists as necessary. Customers encounteringunexpected product behaviorshouldopen a support requestso that PatchMy PC can evaluate any possible issues. Products with Unique Install or Uninstall Behavior The following table contains a list of products that have unique installation or uninstallation behaviors. Known issues | Acrobat, Reader Fix Windows errors during Acrobat Reader updates System Error 1612 \u2013 The installation source for this product is not available. You can setManage conflicting processesfor this application toAuto-close conflicting application process before installation Add a custom pre-script to kill process if it\u2019s running via the right-click optionAdd custom pre/post scripts Products that Require Applications be Closed Before Installation The following products willfail to update if the process is openwhile the update installation is attempted. You can control how to close or notify the user using our feature tomanage conflicting processes when updating third-party applications.Note: These products will automatically have the Manage Conflicting Processes feature enabled and set to \u201cSkip\u201d by default when enabled in the Publisher. Products with Known Dependency Requirements The following products willfail to update or install if the listed dependency is not installed beforeinstallation is attempted. Patch My PC does not natively handle dependencies, however dependencies manually created in Intune or ConfigMgr can be carried over when Patch My PC updates applications. Products that Require a Manual Download The following products require manual download because their installer binaries are behind a paywall. For more details about how to use the local content repository, please see our guidelocal content repository for licensed applications that require manual download. List of Known Issues The table below lists any known issues we are tracking. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/right-click-options-available-updates/", "title": "Custom Right Click, Publishing Options, Software Updates", "raw_text": "Right-Click Options Available for Updates and Applications You can easily customize updates for third-party applications using our customright-click selection menu, including custom scripts, command lines, and more. This article details the custom right-click actions available within our publishing service.Right-click actionscan be applied at theAll Products,Vendor,andProductlevel with the products list in the Updates Rules and Application Rules tab. All the custom actions and based oncustomer feedback, and can be applied as needed to improve your software update or application installation experience. Any customizations applied will also be used for any future updates or applications published. Watch the Live Webinar Playback on Right-Click Options with Q&A You can review our webinar about all the available right-click options for customizing applications in the video below: Publishing with full-content or metadata only The right-click options for full content and metadata only can be used to configure how you want software updates to be published to WSUS. Full Content:publishes the full content of the update to WSUS. Full content includes metadata and the update binaries and is required to download and deploy the update in WSUS/SCCM. Metadata only:publish only the metadata; update binaries are not published. Metadata only allows you to view the compliance details in SCCM/WSUS for the update, but you will be unable to deploy unless it\u2019s re-published with full-content. Available At:All Products, Vendors, and Products Applicable To:Software Updates Show package info: title, command-line, download URL, etc. This option will show information for the currently synchronized catalog. Included Information: Title (Including version) File Name Command-line Download URL Digest Columns can be added or removed by right clicking the column headers. Additionally, the list can be exported using the \u201cExport\u2026\u201d button. You candouble-click an updateto view thedetection methodfor the software update. Available At: All Products, Vendors, and Products Applicable To: Applications, Software Updates Pause Product Updates This option allows you to temporarily stop publishing, of an application or update for a particular product, until a given date configured by you. For example, in the screenshot below, Adobe Acrobat Reader DC Continous (x64) is configured to not publish a new version until 01 September 2022. A new version (if available) will publish on this date. If a product is paused and there is a new version available, you will be notified via theAlertsthat the product is paused. This feature requires theEnterprise Plussubscription. Available At:Products Applicable To:Applications, Software Updates Manage conflicting processes When updating third-party applications, there may be cases where you need toclose an applicationthat is currently open by an end-user. Read more about this option:Manage Conflicting Processes when Updating Third-Party Applications Available At:All Products, Vendors, and Products Applicable To:Applications, Software Updates Set application requirements Control whether applications created by the Publisher can only be installed on workstations, servers or 32bit operating systems. This sets a requirement on the application in Intune or ConfigMgr (deployment type). Available At:Products Applicable To:Applications Add custom pre/post scripts This option allows you to insert custom scripts that can be set to run either before or after the product installation. When enabled, you can choose custom scripts by browsing out and selecting files to insert as a pre-install script, post-install script, pre-uninstall script, or post-uninstall script. Each script inserted includes a field for arguments if necessary. You can also insert any additional files or folders that the script(s) may need access to. Note:Any scripts, files, or folders you choose from the below will be included in the payload to the device. In other words, the script and any additional files and folders will be transferred locally to the device when the update or application is downloaded. Additionally, there are two checkboxes that change the behavior of the scripts. Don\u2019t attempt the software update if the pre-script returns an exit code other than 0 or 3010.If the provided pre-script exits with any exit other than 0 or 3010 then ScriptRunner will exit with code 32767 If the provided pre-script exits with any exit other than 0 or 3010 then ScriptRunner will exit with code 32767 Run the pre-update script before performing any auto-close or skip process checks.If you have a \u2018Manage Conflicting Process\u2018 option set and this box is checked then the pre-script will runbeforethe conflicting process check. If you have a \u2018Manage Conflicting Process\u2018 option set and this box is checked then the pre-script will runbeforethe conflicting process check. The file types supported for custom scripts are: .vbs .bat .cmd .ps1 .exe .msi Please note that if the product has already been published as an update, you will need torepublish the update. See the following two articles as examples on how to leverage scripts or additional files: How to customize your TeamViewer App or Update Advanced Application Configuration using Pre/Post Scripts Pass Variables into Pre and Post Scripts Available At:Products Applicable To:Applications, Software Updates Note:To include quotes in the arguments field for any of your pre/post scripts, wrap them indouble quotesescaped with abackslash. For example: Note:The pre/post scripts will be executed in whatever context the installation starts in.If an install/update will start in the SYSTEM context, so will the pre/post scripts. For user-based apps, the scripts will run in the USER context. Note:When specifying aPowerShell.ps1 script filefor either a pre or post-update script, and you attempt to pass anargument which accepts an array, you cannot use traditional PowerShell syntax. It helps to understand thatpowershell.exe is invoked from cmd.exeand therefore the syntax of-MyParameter \"Item1\",\"Item2\",\"Item3\"will not parse as you might intend when used in theArgumentfield. This is becausecmd.exe cannot interpert PowerShell arrays, it attempts to parse the second item in the array as a command or parameter. To workaround this, you could pass a string to your parameter with a delimiter and within your script split the string on the delimiter. Here is an example: Delete desktop shortcuts(s) created by this application This option will automatically delete any public desktop shortcut(s) created by a product\u2019s installer. Available At:All Products, Vendors, and Products Applicable To:Applications, Software Updates Disable self-updater This option will disable the product\u2019s auto-update feature if it exists. Available At:All Products, Vendors, and Products Applicable To:Applications, Software Updates Manage installation logging This option enables logging during the installation of the update on the client device. When enabled, the publishing service will create a directory (default path: C:\\Windows\\CCM\\LogsPatchMyPCInstallLogs) that will store the vendor\u2019s installation log for that product, providing greater detail if troubleshooting is necessary. There are additional checkbox options to enable verbose logging, prefix the log with the computer name of the client device, and to designate a backup location to store log files for failed installations. Available At:All Products, Vendors, and Products Applicable To:Applications, Software Updates Modify command line This allows you to modify the command line by inserting additional arguments. When enabled, a field will appear to insert additional arguments that will be appended to the existing silent command-line arguments for the product\u2019s installation. Available At:Products Applicable To:Applications, Software Updates Manage return codes This option allows the management of the return codes associated with the product. For example, a hard reboot or soft reboot can be suppressed by mapping the return codes to zero for success, as shown below. Other use cases include mapping a non-standard exit code, five for example, to Success. Default return codes Override return codes Available At:Products Applicable To:Applications, Software Updates Note:The management platform\u2019s client settings will also affect how the client devices respond to return codes. Review the relevant documentation forIntune,ConfigMgr, orWSUSto ensure return codes behave as expected. Add MST transformation file For products that use an MSI based-installer, you can apply aTransformsfile. A transform can modify information that is in any persistent table in theinstaller database. Within the MST file dialog, you need to select the (.MST) file and optionally a (.CAB) file, if required. Available At:Products that use MSI Based Installers Applicable To:Applications, Software Updates Note:The MST and/or Cab file are added into the update/app in the relative path. For an Application it will be in the app\u2019s content path, for an update the MST/Cab will be bundled in update cab file. MST/Cab file selections will persist through updates. Manage assignments Available At: All Products, Vendors, and Products Applicable To: Intune Apps, Intune Updates This option allows you to manage the assignments you would like created for your Win32 applications (Intune Apps, and Intune Updates). When you select toManage assignmentsa UI is presented as shown below where you canAdd assignment, Remove assignment,and configureOverride manual assignment changes. SelectingAdd assignmentwill present a window allowing the selection of an Azure AD Group as shown below. This is a live query of our Azure AD tenant for groups. There are some filtering options to assist with finding the desired group to target with an assignment. Once an assignment is created the Name, Mode, Notification, DO Priority, Availability, Deadline, or Restart grace period column content can be clicked to open theAssignment editor. Assignment Options Any changes made to assignment options here will be applied to the Intune application or updateduring the next Publisher synchronization. Mode cannot be configured for \u201cAll Users\u201d and \u201cAll Devices\u201d assignments. For other Azure AD groups, you can choose whether the group should beIncludedorExcludedfrom the assignment. TheNotificationcan be customized on all assignments. The configuration here will determine if and what toast notifications are popped by the Intune Management Extension as the app or update is installed or uninstalled. The options for notifications are:- Show All (Default) Show Restarts Hide All Delivery Optimization (DO)priority will dictate how quickly an application should be processed once the policy has been evaluated by the Intune Management Extension. The options for DO are:- Foreground Background (Default) For Patch My PC updates, typicallybackgroundis an acceptable setting for DO. If you deploy Patch My PC applications during auto-pilot, it is recommended to set DO toforeground The Availability setting will dictate the earliest time which the Win32 app is made available to the device. Once the availability time is reached, detection is run on the device and content immediately starts to download. The options for availability are:- ASAP (Default) A date and time in the future, from the date the Win32 app was published (max 120 days) TheDevice restart grace period (in minutes)setting will dictate the grace period allowed before the device will be rebooted. By default, the restart grace period is24 hours(1440 minutes). A toast notification will be popped to the end user informing them of the pending reboot. The optionSelect when to display the restart countdown..can be configured when to alert the user of the reboot. The default setting is to pop the toast notification is15 minutesbefore the reboot is enforced. Deadlinescan only be configured on Patch My PC Apps and Updates deployed with aRequiredintent. An availability datemustalso be configured ( The defaul value zero indicates the Win32 app is made available ASAP). Once the deadline is reached, the Win32 app will policy will be processed by the device. TheDevice restart grace period (in minutes)setting will dictate the grace period allowed before the device will be rebooted. By default, the restart grace period is24 hours(1440 minutes). A toast notification will be popped to the end user informing them of the pending reboot. The optionSelect when to display the restart countdown..can be configured when to alert the user of the reboot. The default setting is to pop the toast notification is15 minutesbefore the reboot is enforced. Filter Mode and Filter Name This feature requires the Enterprise Plus subscription. Available At: All Products Applicable To: Intune Updates Note:To Assign and manage filters you will require anEnterprise PlusorEnterprise Premiumlicense. If an assignment in Intune has filters applied to it, these will be copied across to new product versions regardless of license level. Clicking onFilter Modewill cycle through the available modes \u2013Include,Exclude & None. Clicking on theFilter Namewill bring up a filter selection window to allow you to select which filter to apply to the assignment. Note:To assign and manage filters you will need to update your AAD application registration with theDeviceManagementConfiguration.Read.Allapplication scoped API permission. Note:Only one filter can be applied at one time to an assignment. Note:Setting the filter mode toNonewill clear the filter association from the assignment. When this checkbox is checked for a product the Publisher willenforce theintent (required, available, uninstall), mode, notification, and restart grace periodconfiguration for the assignments. If this checkbox is checked and an assignment targeting a specific groupchanges intent(i.e. required to available) ormode(i.e. include to exclude) then the assignment will bedeleted and recreatedduring the next sync. This would include a new available and deadline time based on your configured settings, as it is a newly created assignment. If this checkbox is checked and thenotificationorrestart grace periodconfiguration is changed in the Publisher the settings will be applied during the next sync. Note:Changes made in theManage Assignmentsright-click option arenot immediate.They are applied during the Publisher synchronization. Note:Some settings will not apply until a new application is published unless theOverridecheckbox is checked, or it is anewly created assignmentfor a group without an existing assignment.See the Override section above for more details. Note:The Publisher willnever delete an assignment directly. If you remove an assignment from the list, it will not be recreated in the future, but it will not be deleted. It may also be copied from previous app versions depending on yourIntune application creation options. Manage dynamic assignments This option allows you to publish application updates to Intune that will dynamically assign to security groups based on pre-defined search criteria. Read more about this option:Manage Dynamic Assignments This feature requires the Enterprise Plus subscription. Available At: All Products Applicable To: Intune Updates Manage categories This option allows you to set the categories that will be assigned to applications. The categories displayed will include existing categories. You can create new categories within this same UI using the + button to the right. Managing Intune categories: Managing SCCM categories: Note:Categories will beaddedto existing applications and updates during the next publisher sync, but theywill not be removedfor existing applications and updates. Whenever anewapplication or update is created the Publisher will ensure thecurrently specified categories are in place. Available At: All Products, Vendors, and Products Applicable To: ConfigMgr Apps, Intune Apps, Intune Updates Manage security scopes This option allows you to set the Security Scopes an application in ConfigMgr should be associated with. The Publisher will set the Security Scopes for the applications during the sync. The security scopes are pulled from your ConfigMgr environment. You can refresh the list with the button in the top right corner. Additionally, you can right-click the headers to add or remove columns. The list can be filtered by using the \u2018Filter items\u2019 textbox as well. Optionally, you can check the box toEnforce selected security scopes. When checked, the Publisher will ensure only the selected scopes exist on the ConfigMgr application. If a scope is added outside of the Publisher, such as directly in the ConfigMgr console, then the Publisher will remove the extra scopes during synchronization. Note:Security scopes will require new permission, specifically Application > Set Security Scope, and Security Scopes > Read, which you may not have in your Security Role created for Patch My PC. You can follow the instructions inthis articleto either re-import an updated role or set the new permissions manually. If you choose to re-import the role it will simply overwrite the permissions and retain your existing role assignments. Available At:All Products, Vendors, and Products Applicable To:ConfigMgr Apps Manage ESP Profiles This option allows you to manage theEnrollment Status Page profileswhich any Win32 application can be associated with (Intune Apps). The ESP are pulled from Microsoft Intune for your configured tenant. Note that the profile must have \u2018Show app and profile configuration progress\u2018 set to \u2018Yes\u2018 in order to appear in the list for selection. An example list is shown below. Also, this feature will require your Azure App Registration to haveDeviceManagementServiceConfig.ReadWrite.Allpermissions set. Any Win32 application created by the publisher will be added to the ESP which are selected for the respective application. Old versions of Patch My PC-made Intune Win32 packages will be automatically removed, too, but only during the process of publishing/uploading the new Win32 package. In other words, the ESP association for the previous version of an Intune App will not be removed if you configure this after the fact, while the latest version is already in Intune. Available At: All Products, Vendors, and Products Applicable To: Intune Apps Manage Role Scope Tags This option allows you to manage therole scope tagswhich a Win32 application is associated with in Intune. The role scope tags are pulled from Microsoft Intune for your configured tenant. An example list is shown below. Also, this feature will require your Azure App Registration to haveDeviceManagementRBAC.Read.Allpermissions set. Any Win32 application created by the publisher will be assigned the role scope tags selected for the respective application. Note:Role scope tags will beaddedto existing applications during the next publisher sync, but theywill not be removedfor existing applications. Whenever anewapplication is created the Publisher will ensure thecurrently specified role scope tag associations are in place. Available At: All Products, Vendors, and Products Applicable To: Intune Apps, Intune Updates Override Win32 application options This option allows you to override the relevantWin32 application optionsfor the selected product. They can be configured globally in the Intune options and overridden per product or per vendor. It is not an option to override the code signing certificate. Applications and Updates each show the options that can be overridden. There is no ESP configuration option for Intune Updates, which is not shown when configuring an override for Intune Updates. Below is the override window for each product type. Updates Applications Available At: Vendors, and Products Applicable To: Intune Apps, Intune Updates Manage naming convention This option allows you to set acustom naming conventionfor the Win32 applications that are created by the publisher. (Intune Apps, and Intune Updates) There arevariables availablefor customizing the name that will be used for the Intune Win32 application as shown below. You can click the links of the variable names to insert them into your naming convention. The resulting applications can be seen in Intune with the naming standard set. Note:the%OriginalName%will be the default name that Patch My PC uses. It can be inserted as a variable if you want to build on the default name. If the pattern is empty, the default name is also used. Available At:All Products, Vendors, and Products Applicable To:Intune Applications*, Intune Updates * For Intune Applications at the product level, you will be able to manage naming convention in theSet custom application icon and propertiesright click option. Manage application user experience This option allows you to set customuser experience optionsfor the application. The ability to set Installation behavior is limited due to not all applications supporting a user based install. User-based installations will be a possibility for Applications in the catalog with this option going forward. If the \u2018Installation behavior\u2019 option is grayed out this means the application does not support a user based installation. The UI should prevent you from creating an unsupported Application User Experience. When enabled, the deployment type for any application created for the product will have the user experience tab populated according to the configuration set in the wizard above. Note that you are able to select which options are inherited when you set this option at theVendororAll Productslevel. See below for an example. Available At:All Products, Vendors, and Products Applicable To:ConfigMgr Apps Add the executable name(s) in the deployment type\u2019s install behavior This option, when enabled, allows the publishing service to define the executable files in theinstall behaviortab that must be closed by the user for available deployments, or close automatically for required deployments for the application installation to succeed. These file names will be set in SCCM under the Install Behavior tab in the application\u2019s deployment type properties. Available At:All Products, Vendors, and Products Applicable To:ConfigMgr Apps Move the application to a custom folder By default, all applications created will end up in the root of your applications folder within Configuration Manager. This option lets you choose a custom folder to move the published applications to. It is also possible to create a new folder using the+button or refresh the list with the refresh button. Available At:ConfigMgr Apps Options, Vendors, and Products Applicable To: ConfigMgr Apps Set custom application icon and properties By default, the application metadata and icon\u2019s will be based on the software vendor. This option allows you to customize the properties of the application, as it would be seen in the SCCM console and Software Center. You can customize the application name, localized application name, localized description, and even set a custom icon for the application. When enabled, the publishing service will use the defined properties during initial application creation or when an application is updated for the product. This option may be helpful if you need the application name and other settings to be static for certain task sequence installation scenarios. For ConfigMgr Apps, your options look like this: For Intune Apps, your options look like this: Available At:Products Applicable To:ConfigMgr Apps, Intune Apps Display as a featured application in Software Center and the Company Portal This option allows you to set an application as featured for the company portal or software center application. The following checkbox in the Software Center tab of an application will be automatically enabled. And for Intune, it will set the below-highlighted feature to \u2018Yes\u2019 Available At:Products Applicable To:ConfigMgr Apps, Intune Apps Exclude from auto-publishing rules Selecting this option will block the product from being enabled, even if the option toauto-enable products based on SCCM inventory scansis active, or the equivalent Intune option, and the product meets or exceeds the device count threshold for automatic publishing. Excluded products will be visually crossed out in the Update/Application Rules tab(s). Available At:Vendors, and Products Applicable To:Applications, Software Updates Note:Marking a vendor for exclusion is a point-in-time operation. If a new product is added to the catalog for this vendor it will not be automatically excluded. Republish during next sync schedule This option will enable the product to be republished during the next publishing service sync. More info on when, why, and how to republish third-party updates can be foundhere. Available At:All Products, Vendors, and Products Applicable To:Software Updates, ConfigMgr Apps, Intune Apps, Intune Updates Recreate detection script This option will force the Publisher to recreate the PowerShell detection script for the selected application(s). New code signing certificateIf you have a new code signing certificate for your WSUS server, this option lets you recreate and resign all the detection scripts used by the applications published by Patch My PC If you have a new code signing certificate for your WSUS server, this option lets you recreate and resign all the detection scripts used by the applications published by Patch My PC Detection script changesOccasionally we will make changes to the detection method script. This can be to improve logging, resolve bugs, or improve the accuracy of detection. Recreating the script will ensure the latest detection method script is used. Occasionally we will make changes to the detection method script. This can be to improve logging, resolve bugs, or improve the accuracy of detection. Recreating the script will ensure the latest detection method script is used. Available At:All Products, Vendors, and Products Applicable To:ConfigMgr Apps, Intune Apps, Intune Updates Manage application update and retention\u2026 This option allows you to define how to update a specific product when a new application update is released. This feature will take precedence over the options defined on theglobal level. Available At:Products Applicable To:ConfigMgr Apps Publish this product during the next manual sync. (Selective Sync) This option allows you to specify an individual, or list of product(s) to Publish during thenext manual syncinstead of all products during the next scheduled sync. When selecting the above right-click context menu option, you will be prompted to confirm your choice. When clicking \u201cRun Publishing Service Sync,\u201d you will be shown all products with selective sync enabled. ClickingOKwill run a manual sync and process the products marked for selective sync. ClickingCancelwill ask if you want to edit your selective sync choices or reset them and run a normal full sync. Available At: Vendors, and Products Applicable To: Software Updates, ConfigMgr Apps, Intune Apps, Intune Updates Note:If a manual sync has not been run before the next scheduled sync, all selective sync flags will be cleared, and a normal full sync will be run. Open local content repository The option will open your configuredlocal content repository. Available At: All Products, Vendors, and Products Applicable To: Applications, Software Updates Watch the Video Recording If you missed the Customizing Application deployments with Right-Click Options webinar you can watch the Video Recording below or on ourYouTube Channel. https://www.youtube.com/watch?v=je0KgiLNUR8 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-certificate-error/", "title": "Access Denied, WSUS, Certificate, Permissions", "raw_text": "An error occurred while extracting the certificate from WSUS: Access is denied Determine if You are Affected Publishing may fail on Server 2012 / 2016 with the following error message in thePatchMyPC.log: An error occurred while extracting the certificate from WSUS: C:\\Usersusername\\AppData\\Local\\Temp\\PMP-tempfolderrandomfolder.tmp : Access is deniedFailed to extract the certificate from WSUS Message This error can be caused by a lack of permissions on the WSUSCertServer Service. Workaround Add the Computer account of the Server that the Patch My PC Publisher is installed to the \u201cWSUS Administrators\u201d Group OpenRegeditand navigate to \u201cHKEY_CLASSES_ROOT\\AppID\\{8F5D3447-9CCE-455C-BAEF-55D42420143B}\u201c Right Click that key, select Permissions, then click Advanced. At the top of the Advanced Permissions window, change the Owner to \u201cWSUS Administrators\u201d and Click OK While in this properties window, also ensure that Administrations and SYSTEM have full control of that registry keyIn order to complete this step \u201cAdministrators\u201d may need to be made the owner before adding the \u201cFull Control\u201d permissions. Once the \u201cFull Control\u201d permissions are added, set the owner back to \u201cWSUS Administrators\u201d In order to complete this step \u201cAdministrators\u201d may need to be made the owner before adding the \u201cFull Control\u201d permissions. Once the \u201cFull Control\u201d permissions are added, set the owner back to \u201cWSUS Administrators\u201d Start dcomcnfg.exe as Administrator In the Tree select \u201cComponent Services\u201d ->\u201dMy Computer\u201d -> \u201cDCOM Config\u201c Scroll down and right click on WSusCertServer and click \u201cProperties\u201d, and navigate to the \u201cSecurity\u201d Tab Click \u201cCustomize\u201d under \u201cLaunch and Activation Permissions\u201d then click \u201cEdit\u201dEnsure \u201cLocal Launch\u201d, \u201cRemote Launch\u201d, \u201cLocal Activation\u201d, and \u201cRemote Activation\u201d are enabled for the following accounts: \u201cWSUS Administrators\u201c, \u201cSYSTEM\u201c, and \u201cAdministrators\u201c Ensure \u201cLocal Launch\u201d, \u201cRemote Launch\u201d, \u201cLocal Activation\u201d, and \u201cRemote Activation\u201d are enabled for the following accounts: \u201cWSUS Administrators\u201c, \u201cSYSTEM\u201c, and \u201cAdministrators\u201c Click \u201cCustomize\u201d under \u201cAccess Permissions\u201d then click \u201cEdit\u201dEnsure \u201cLocal Access\u201d and \u201cRemote Access\u201d are enabled for the following accounts: \u201cWSUS Administrators\u201c, \u201cSYSTEM\u201c, and \u201cAdministrators\u201c Ensure \u201cLocal Access\u201d and \u201cRemote Access\u201d are enabled for the following accounts: \u201cWSUS Administrators\u201c, \u201cSYSTEM\u201c, and \u201cAdministrators\u201c Click \u201cCustomize\u201d under \u201cConfiguration Permissions\u201d then click \u201cEdit\u201dEnsure the following accounts have \u201cFull Control\u201d: \u201cWSUS Administrators\u201d, \u201cSYSTEM\u201d, and \u201cAdministrators\u201d Ensure the following accounts have \u201cFull Control\u201d: \u201cWSUS Administrators\u201d, \u201cSYSTEM\u201d, and \u201cAdministrators\u201d Restart the WSUSCertServer Service from Services.msc Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/collect-sccm-intune-logs/", "title": "ConfigMgr Logs, Intune Logs, Patch My PC, Log Files", "raw_text": "Collecting Log Files to Send to Support for ConfigMgr and Intune To help us diagnose specific issues, you may need to send uslog filesfromConfigMgrorIntune. This article reviews the logs files required to allow our support team toanalyzeandtroubleshootdifferent scenarios. Please review the different scenarios below. When sending the logs files, please attach the logs as a ZIP file using ourtechnical support form. Server-Side Logs Software Updates \u2013 Failing to Publish Updates Using Patch My PC\u2019s Publisher When using the Patch My PCPublisher to published third-party updates to WSUS, we will need the following log files from the SUP/WSUS server where the service is installed. %PatchMyPCInstallDirectory%\\PatchMyPC.log %PatchMyPCInstallDirectory%\\PatchMyPC*.lo_ %PatchMyPCInstallDirectory%\\Settings.xml %PatchMyPCInstallDirectory%\\PatchMyPC-DownloadHistory.csv %PatchMyPCInstallDirectory%\\PatchMyPC-PublishingHistory.csv %SiteServerLogsFolder%\\Wsyncmgr*.log %SiteServerLogsFolder%\\WCM*.log The following log file may be neededupon request only due to large file size %ProgramFiles%\\Update Services\\LogFiles\\SoftwareDistribution.log Software Updates \u2013 Failing to Publish Updates Using ConfigMgr In-Console Publishing When using theConfigMgr in-console publishing, we will need the following log files from the SUP/WSUS server where the service is installed. %SiteSystemLogsFolder%\\SMS_ISVUPDATES_SYNCAGENT*.log %SiteServerLogsFolder%\\Wsyncmgr*.log %SiteServerLogsFolder%\\WCM*.log The following log file may be neededupon request only due to large file size %ProgramFiles%\\Update Services\\LogFiles\\SoftwareDistribution.log ConfigMgr Applications \u2013 Failing to Create/Update ConfigMgr Applications Using Patch My PC\u2019s Publisher When using the Patch My PCPublisher for ConfigMgr application creation, we will need the following log files to troubleshoot applications failing to create. %PatchMyPCInstallDirectory%\\PatchMyPC.log %PatchMyPCInstallDirectory%\\PatchMyPC*.lo_ %PatchMyPCInstallDirectory%\\Settings.xml %PatchMyPCInstallDirectory%\\PatchMyPC-DownloadHistory.csv %PatchMyPCInstallDirectory%\\PatchMyPC-PublishingHistory.csv %SCCMInstallFolder%\\Logs\\SMSProv*.log Intune Applications \u2013 Failing to Create/Update Applications Using Patch My PC\u2019s Publisher When using the Patch My PCPublisher for Intune application creation, we will need the following log files to troubleshoot applications failing to create. %PatchMyPCInstallDirectory%\\PatchMyPC.log %PatchMyPCInstallDirectory%\\PatchMyPC*.lo_ %PatchMyPCInstallDirectory%\\Settings.xml %PatchMyPCInstallDirectory%\\PatchMyPC-DownloadHistory.csv %PatchMyPCInstallDirectory%\\PatchMyPC-PublishingHistory.csv Client-Side Logs Intune Applications/Updates Failing to Install on Client Devices When troubleshootingIntune application installation errors on a client, we will need multiple client logs. Please include the following logs: %ProgramData%\\PatchMyPCIntuneLogs\\PatchMyPC-ScriptRunner.logThis may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Company Portal. This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Company Portal. %ProgramData%\\PatchMyPCIntuneLogs\\PatchMyPC-SoftwareDetectionScript.log %ProgramData%\\PatchMyPCIntuneLogs\\PatchMyPC-SoftwareUpdateDetectionScript.log %ProgramData%\\Microsoft\\IntuneManagementExtension\\Logs\\AgentExecutor*.log %ProgramData%\\Microsoft\\IntuneManagementExtension\\Logs\\IntuneManagementExtension*.log %ProgramData%\\Microsoft\\IntuneManagementExtension\\Logs\\AppWorkload*.log %ProgramData%\\PatchMyPC\\PatchMyPC-UserNotification.log %ProgramData%\\PatchMyPC\\UISettingsUINotificationSettings.xml If there are any rolled over logs, please include those, too. Note:Some Patch My PC log files listed above may be found in%WinDir%\\CCMfolder if that folder exists. ConfigMgr Applications Failing to Install on Client Devices When troubleshootingConfigMgr application installation errors on a client, we will need multiple client logs. Please include the following logs: %WinDir%\\CCM\\Logs\\AppDiscovery*.log %WinDir%\\CCM\\Logs\\AppEnforce*.log %WinDir%\\CCM\\Logs\\AppIntentEval*.log %WinDir%\\CCM\\Logs\\CAS*.log %WinDir%\\CCM\\Logs\\CIAgent.*log %WinDir%\\CCM\\Logs\\DataTransferService*.log %WinDir%\\CCM\\Logs\\PatchMyPC-ScriptRunner.logThis may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. %WinDir%\\CCM\\Logs\\PatchMyPC-SoftwareDetectionScript.logThis may be found in the %temp% of the user who clicked \u2018Install\u2019 in Software Center if it was an \u2018Available\u2019 deployment. This may be found in the %temp% of the user who clicked \u2018Install\u2019 in Software Center if it was an \u2018Available\u2019 deployment. %WinDir%\\CCM\\Logs\\StateMessage.log %ProgramData%\\PatchMyPC\\PatchMyPC-UserNotification.log %ProgramData%\\PatchMyPC\\UISettingsUINotificationSettings.xml Third-Party Software Updates Failing to Install on Client Devices When troubleshootingupdate installation errors on a client, we will need the following client logs: %WinDir%\\CCM\\Logs\\CAS*.log %WinDir%\\CCM\\Logs\\DeltaDownload*.log %WinDir%\\CCM\\Logs\\DataTransferService*.log %WinDir%\\CCM\\Logs\\PatchMyPC-ScriptRunner.log (If exist)This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. %WinDir%\\CCM\\Logs\\ScanAgent*.log %WinDir%\\CCM\\Logs\\StateMessage.log %WinDir%\\CCM\\Logs\\UpdatesDeployment*.log %WinDir%\\CCM\\Logs\\UpdatesHandler*.log %WinDir%\\CCM\\Logs\\UpdatesStore*.log %WinDir%\\CCM\\Logs\\WUAHandler*.log %WinDir%\\WindowsUpdate.logYou need to runGet-WindowsUpdateLog on Windows 8.1 and newerin PowerShell. You need to runGet-WindowsUpdateLog on Windows 8.1 and newerin PowerShell. %ProgramData%\\PatchMyPC\\PatchMyPC-UserNotification.log %ProgramData%\\PatchMyPC\\UISettingsUINotificationSettings.xml Download Stuck at 0% / Waiting to install / Preparing to download When troubleshootingupdate installation errors on a client, we will need the following client logs: %WinDir%\\CCM\\Logs\\CAS*.log %WinDir%\\CCM\\Logs\\CIAgent.*log %WinDir%\\CCM\\Logs\\ClientLocation*.log %WinDir%\\CCM\\Logs\\CMBITSManager*.log %WinDir%\\CCM\\Logs\\ContentTransferManager*.log %WinDir%\\CCM\\Logs\\DataTransferService*.log %WinDir%\\CCM\\Logs\\StateMessage.log %WinDir%\\CCM\\Logs\\LocationServices.log*.log %WinDir%\\CCM\\Logs\\UpdatesDeployment*.log %WinDir%\\CCM\\Logs\\UpdatesHandler*.log %WinDir%\\CCM\\Logs\\UpdatesStore*.log %WinDir%\\CCM\\Logs\\PatchMyPC-ScriptRunner.log (If exist)This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. This may be found in the %ProgramData%\\PatchMyPC if the Install was initiated by the user from Software Center. WSUS Specific Logs Server Side %ProgramFiles%\\Update Services\\LogFiles\\SoftwareDistribution.log Client Side %WinDir%\\WindowsUpdate.log or %USERPROFILE%\\Desktop\\WindowsUpdate.log**You need to runGet-WindowsUpdateLog on Windows 8.1 and newerin PowerShell to generate this log file *You need to runGet-WindowsUpdateLog on Windows 8.1 and newerin PowerShell to generate this log file Configuration Manager Specific Logs Automatic Deployment Rule Failing for Third-Party Updates When troubleshootingautomatic deployment rules failing for third-party updates, we will need the following server-side logs. In this example, we will assume the main SCCM installation directory is:C:\\Program Files\\Microsoft Configuration Manager C:\\Program Files\\Microsoft Configuration Manager\\Logs\\ruleengine*.log ThePatchDownloader.log(Location may vary)C:\\Program Files\\SMS_CCM\\Logs\\PatchDownloader*.log (Most common location)C:\\Program Files\\Microsoft Configuration Manager\\Logs\\PatchDownloader*.log (Possible location)%WinDir%\\CCM\\Logs (Possible location)Ifunable to locatea currentPatchDownloader.log, check HKLM\\SOFTWARE\\MicrosoftCCMLogging@Global:LogDirectory on thesite server C:\\Program Files\\SMS_CCM\\Logs\\PatchDownloader*.log (Most common location) C:\\Program Files\\Microsoft Configuration Manager\\Logs\\PatchDownloader*.log (Possible location) %WinDir%\\CCM\\Logs (Possible location) Ifunable to locatea currentPatchDownloader.log, check HKLM\\SOFTWARE\\MicrosoftCCMLogging@Global:LogDirectory on thesite server Updates Failing to Download to Deployment Package using ConfigMgr Console When troubleshootingupdates failing to download into a deployment package from the ConfigMgr console, we will need the following log from the machine running the ConfigMgr console: %temp%\\PatchDownloader*.logNote: if you are using anRDP session the patchdownloader.log may be in a numbered sub-folderin your users%temp%folder. Note: if you are using anRDP session the patchdownloader.log may be in a numbered sub-folderin your users%temp%folder. Patch My PC Publisher \u2013 How to Enable Debug Logging Enabling Debug logging is often helpful for troubleshooting unique issues with publishing. Follow the steps below to enable Debug logging: Open the Publisher Click on theGeneraltab In the dropdown underLogging OptionsselectDebug Close the Publisher Open Services.msc and locate thePatchMyPCService Right-click and Restart thePatchMyPCService Debug Logging is now enabled Advanced Insights Specific Logs Advanced Insights Log Collector In the installation directory, server-side, of Advanced Insights, is a standalone .exe which can collect all the necessary server-side log files useful for troubleshooting \u2013 bundled into a single .zip. You can read more aboutAdvancedInsightsLogDiag.exehere: Advanced Insights Log Collector | Getting Started (patchmypc.com) Installation When troubleshooting the installation for Advanced Insights, the installation creates a log file at: %temp%\\AdvInsights.log Services The following log files can be found installed server-side where you have installed Advanced Insights: %ProgramData%\\AdvancedInsightsLogs\\API*.log Application Windows Event LogCan be filtered on \u201c.NET Runtime\u201d source Can be filtered on \u201c.NET Runtime\u201d source Clients The following log files can be found client-side: %WinDir%\\CCM\\Logs\\PMPCInventory.log Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/osd-install-fail-sccm/", "title": "Application Deployment, Certificate Trust, Task Sequence Error, PowerShell Script", "raw_text": "Applications Fail in Task Sequence Error: AuthorizationManager check failed 0x87d00327 Since releasing our newapplication creation and management featurea few weeks back, we have noticed some customers opening cases with regards to trouble getting the applications to install during an operating system deploymenttask sequence. The most common reason applications may fail during a task sequence is the code-signing certificate isn\u2019t properly deployed ahead of theInstall Applicationstask sequence step. A Little Background \u2013 Our Applications and PowerShell Detection Method When our service creates applications in SCCM, we use a Powershell script for the detection method of the deployment type, as shown below. We also code-sign the Powershell detection method script by default using the WSUS Signing certificate. Determine if You are Affected When the device gets to theinstall application step, the device may fail to execute the detection method script if you are using a self-signed WSUS Signing certificate and the Powershell execution policy isnot ByPass. If the detection method script fails, it\u2019s because the WSUS Signing certificate used to code-sign it isn\u2019t trusted during the operating system deployment on the client-side. This trust failure is due to the fact that the device wouldn\u2019t have receivedgroup policyor theclient policyif you are deploying the certificateusing SCCMto add the certificate to theTrusted RootandTrusted Publisherscertificate stores. In the C:\\Windows\\CCM\\Logs\\AppDiscovery.log, you will also be able to see the failure when the SCCM agent tries to call the detection method script. It will contain lines similar to the image below. The Resolution \u2013 Install WSUS Signing Certificate as a Task Sequence Step Now that we see the cause, the resolution is pretty straight forward. You need to ensure the WSUS Signing Certificate you are using for third-party update publishing that is also used for signing the scripts is trusted before theinstall applicationstep in SCCM. The first thing to do isexport your WSUS Signing Certificatefrom the publishing service. In our example, we saved the file asWSUSSigningCertificate.cer Now that you have the certificate used for signing the detection method scripts, we need to import it on the client-side during the task sequence before the install applications step. Luckily this process is pretty easy, and we\u2019ll show you how. First, you can download our scriptImport-Certificates.cmdthat can be used for importing (.CER) files into theTrusted RootandTrusted Publishers. You will want to save theImport-Certificates.cmdfile in the same UNC folder as the exported (.CER) file. In our example, we used the folder path\\\\sccm\\sources\\Scripts\\Install-Certificates The batch script is very straight forward. It will importall(.CER) certificates that are in the same folder as the script to theTrusted RootandTrusted Publisherscertificate store. The REG ADD commandon line 5 is optional, but it can be helpful if you want to also install third-party software updates using the Install Software Updates step in the same task sequence. Next, you need to create a legacy package in SCCM (No programs required if you only want to install the certificates via task sequence). If you\u2019re going to deploy this using software distribution to existing clients outside a task sequence, you can create a new program for the package the runsImport-Certificates.cmdas thecommand line. When creating the package, use the UNC path that you saved your(.CER) certificateto as well as theImport-Certificates.cmd. In our example, we used the path mentioned above. This package is used for accessing the content in the task sequence. Lastly, you need to add aRun Command Linestep before theInstall Applicationstep. Within this step, be sure to set the command line toImport-Certificates.cmdand enable thePackageoption and reference the package you created in the previous step. That\u2019s it!Now that the certificate chain is trusted before the Install Applications step, you shouldn\u2019t receive the trust error when the detection method script is executed. Note:This process can also resolve the error0x800b0109during theInstall Software Updatesstep of a task sequence because the default certificate deployment options such asgroup policyorConfigMgr client settingswon\u2019t apply until after the task sequence is completed. Search Terms: In-line script returned error output: & : AuthorizationManager check failed.Script Execution returned error message: & : AuthorizationManager check failed.Script Execution Returned :1, Error Message: & : AuthorizationManager check failed.CScriptHandler::DiscoverApp failed (0x87d00327).Deployment type detection failed with error 0x87d00327.Failed to perform detection of app deployment type , revision 1) for system. Error 0x87d00327Applications in OSDInstall Applications OSD Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/packageid-found-does-not-find-an-application-with-matching-content-source-path/", "title": "Patch, ConfigMgr, Update, Deployment", "raw_text": "PackageId Found Does Not Find an Application With Matching Content Source Path The error \u201cA package.xml file is found in <new source path> that belongs to a package withcontent source path <old source path>\u201d can happen when the Patch My PC Publisher attempts to update a Configuration Manager application, butfails due to an unexpected folder structure. To fix it, delete the app and all its retained versions from both disk and ConfigMgr, and let the Publisher recreate it cleanly \u2013 continue reading more guidance and context on the issue. This article will discuss how you can identify if you\u2019re impacted, provide remediation guidance, and also an optional technical deep dive reference on how the Publisher updates Configuration Manager applications. Determine if You Are Affected Customers experiencing this failure will likely have the following application update mode configured: \u201cUpdate existing application\u2019s metadata, deployment type, detection method, and content files (Default)\u201d (also known as an \u201cin-place update\u201d, where the existing application is updated without creating a new one) \u2013 and have a retention value configured. If affected, you will see the below notification: InPatchMyPC.log, the error will read along the lines of: The error message is presented whenthe Publisher has found the source path for the application about to be updated does not match the Deployment Type\u2019s source folderwithin Configuration Manager. If you\u2019ve encountered this error message, it\u2019s likely due to your source folders for the application(s) failing to update are in anunexpected state. Applications managed by the Publisher can enter this state through a variety of reasons. While the Publisher is updating an application and managing retention, a copy of its application content on disk is attempted, and we have seen customerantivirus solutions cause file locks and access denied exceptions during this process. In older versions of the Patch My PC Publisher, this scenario was not handled gracefully and subsequently caused nested Retained Apps folders with duplicate content, and duplicate applications within Configuration Manager. We have since implemented more robust error handling in these circumstances to ensure we gracefully handle these errors that are typically caused by antivirus solutions. Sinceversion 2.1.36.0of the Patch My PC Publisher,an improvement was added to ensure we do not process an application update when we detect it\u2019s in a state that might exacerbate the issueand create duplicate folders/applications Remediation To remediate the issue, the recommended approach is to delete the application producing the error and the entire folder structure for the product. If you continue to experience this error after performing this remediation once,open a technical support caseas we are committed to ensuring this scenario doesn\u2019t happen again and we can\u2019treproduce all scenarios that cause the failures. Ensure a Publisher Sync Is Not In Progress Identify the Product on Disk and Delete It Delete the Applications in Console for the Product 1. Ensure a Publisher Sync Is Not In Progress It is recommended toensure a sync is currently not in progress before continuing. You can do this by viewing PatchMyPC.log and monitoring its activity. Avoid performing clean-up while the Publisher is actively syncing. 2. Identify the Product on Disk and Delete It Here you will need to delete all content disk for the application(s) failing to update; the current version and all retained versions, too. The parent source folder is configurable in the Publisher under theConfigMgr Appstab ->Options. Generally, application source folders resemble the following pattern: Beneath the<Product>folder, you should seeone GUID folder(representing that version\u2019s update ID) and a \u201cRetained Apps\u201d folder (if there are any retained versions). In your environment, you may see multiple GUID folders beneath the<Product>folder and multiple \u201cRetained Apps\u201d folders that are nested within each other. This malformed folder structure is one of the core reasons contributing to the problem. For products likeGoogle Chrome (MSI-x64)you can expect its parent source folder to be: The name of the<Product>folder is the same name as the product you see in the Patch My PC Publisher. However, in scenarios where we rename products in our catalogue, the name of the folder will be the product\u2019s former name as you once saw it in the Publisher. For that reason, you may not find the application(s) source folder via browsing File Explorer if you were searching based on the product\u2019s name as you see it today in the Publisher. To locate the correct folder, use the Deployment Type\u2019s source path in Configuration Manager. For example, if an application\u2019s source path resembles the structure like any of the below, you shuold delete the folder\\\\server\\share\\Applications\\Google, Inc.\\Google Chrome (x64)and all its contents: The above example with Google Chrome is a real world example, where the product name was onceGoogle Chrome (x64)and renamed toGoogle Chrome (MSI-x64)in October 2024. 3. Delete the Applications in Console for the Product After you have taken care of all the application sources on the file system, the next task is simpler:delete the failed application objects within the Configuration Manager console\u2013 this includes the current versionand all old retained versions, too. Before you can delete these you may need to remove their deployments and any associations from task sequences or dependency relationships. Thereafter, you can initiate a sync of the Patch My PC Publisher and it willrecreate the application(s) with a clean, predictable folder structure. At this point, you should not have: More than one application for the same product within the Configuration Manager console More than one GUID folder within the product\u2019s parent source folder This remediation action should be a one-time measure. However, if you encounter this issue again, it is likely you have an environmental factor that is causing the issue and is not yet handled gracefully by the Publisher. If you encounter this issue again, kindlyopen a technical support case. How the Publisher Updates Applications This section is optionaland provides technical insight into how Patch My PC Publisher handles in-place updates for applications in Configuration Manager.It\u2019s not required readingto resolve the issue \u2013 butit may help understand the product\u2019s logic. Detecting Existing Application Versions When the Publisher begins synchronising ConfigMgr Apps, it checks to see if the version already exists by checking: File System Check WMI Check (SMS_Content) Both conditions for the above must find the application. If the application\u2019s source exists on disk but not in WMI, then the Publisher deletes the content on disk \u2013 this is to make way for publishing of the app again on the next sync. The Publisher first begins searches for the source folder on disk by performing an exact match. For example, if the update was forGoogle Chrome 137.0.7151.41 (x64)and its update ID was80fadc14-8188-41b9-b326-3f0735bbc470, it will first check to see if the below path exists: Note:If theSource Folderyou provided contains an FQDN address for the shared folder inConfigMgr Apps->Options, the FQDN will be stripped to just the hostname and replaced with a wildcard. For example,\\\\server.contoso.com\\sharewill be replaced with\\\\server*\\share. If it cannot find the folder with the exact the path above, it will then begin a wider search using wildcards: This use of wildcard is intended to provide flexibility when products are renamed. InPatchMyPC.log, if the new version does not exist and the current version needs updating: If the latest version already exists: TheSMS_Content WMI classprovides content information about Configuration Items (CIs) within Configuration Manager. Applications share the same base model as CIs within Configuration Manager. The Publisher performs a similar search routine in WMI as it does on disk, however with the exception for the usage of the wildcard \u2013 it uses a wildcard for both the vendor and product part of the folder. Each instance ofSMS_Contentcontains aContentSourcepath; the query to finding matching instances in this class would be similar to the below in the same Google Chrome example: An example PowerShell command that is equivalent would be as follows: This should return no more than two instances \u2013 one or two instances is acceptable. Application Update Flow (In-Place) Once it has been established whether or not the latest version of an application currently exists, the Publisher will begin publishing the new version if available. At a high-level overview, this process involves: Download the update to the cache content folder. If the download fails, abort publishing and move onto the next application. Note: By default this is C:\\Windows\\temp but it is customisable. Read more here:Customize Content Download and Log Save Location \u2013 Patch My PC PatchMyPC.log: Copy the source folder for the current version to a subfolder namedRetained Apps Note:It has historically been this step of publishing which has failed and largely caused the issues for customers, resulting in creating this knowledge base article. PatchMyPC.log: Clone the application within Configuration Manager for the current version. If this step fails, the Publisher deletes the folder from the previous step. PatchMyPC.log: Modify Package.xml within the source directory for the newly cloned app to contain the Package ID from the previous step If you have the option enabled toMove applications to the following folder in the applications node of the console, the newly cloned application will be moved to the designated folder PatchMyPC.log: If you have the option enabled toAutomatically distribute content for any newly created applications, the content for the newly cloned application will be distributed to the designated Distribution Point Groups PatchMyPC.log: Copy the binary downloaded in step 1 to the original application\u2019s source directory PatchMyPC.log: Rename the original application\u2019s source directory GUID to represent the latest update\u2019s update ID. This step is attempted five times with a 20 seconds pause in between each attempt \u2013 this is an attempt to combat antivirus solutions causing file locks or *access denied* exceptions Delete the old installer in the original application\u2019s source directory if it wasn\u2019t overwritten in step 7 Update the PowerShell detection script in the original application\u2019s Deployment Type to represent the latest version\u2019s detection logic PatchMyPC.log: Various attributes and metadata are updated on the application, e.g. the Software Centre tab If the optionDo not include the version in the application name, so the application name doesn\u2019t change after updates is not enabled, then rename the original application to represent latest version\u2019s title If you have the option enabled toAutomatically distribute content for any newly created applications, the content for the original application will be distributed to the designated Distribution Point Groups PatchMyPC.log: If there any old versions available for deletion as per your retention setting (Retain up to X previously created applications), delete those applications from Configuration Manager and their associated content within theRetained Appsfolder PatchMyPC.log: Notifications are sent via webhookwith the result, whether it be success or failure PatchMyPC.log: Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/migrating-from-scup-patch-my/", "title": "System Center Updates Publisher, Patch My PC, Microsoft Configuration Manager, WSUS", "raw_text": "Migrating from SCUP to Patch My PC Publisher System Center Updates Publisher(SCUP) In-console publishingwithin Microsoft Configuration Manager Patch My PC Publisher (on-premises publishing tool) Microsoft announced the end-of-life of System Center Updates Publisher (SCUP) in January 2024. Customers who subscribe to our Basic licence and use SCUP should now transition to an alternative, supported, publishing method. You can read more about the SCUP deprecation athttps://patchmypc.com/system-center-update-publisher-deprecated Important While we strongly encourage customers to transition to using our on-premises publishing tool \u2018Patch My PC Publisher\u2019, this does not need to be an \u2018either-or\u2019 migration in your early testing phase. You can test and use the new solution side-by-side with SCUP as you gain familiarity with the new tooling. As Microsoft are no longer supporting SCUP, we do recommend customers to migrate to Patch My PC Publisher by January 31st, 2025. We do not know if/when Microsoft might release a breaking change to the operating system that SCUP is installed on. What is Patch My PC Publisher? Patch My PC Publisher is a comprehensive tool, installed on a single Windows operating system, used for customizing and publishing third-party applications and updates to WSUS, Configuration Manager and Intune. Some advantages of using the Patch My PC Publisher over SCUP include:- The ability to create applications in both Configuration Manager and Intune (requires an Enterprise Plus subscription). Manycustomization options. Modern features such as supportingcustom apps(requires an Enterprise Plus subscription), webhook notifications and more. Automatically detect software based on Configuration Manager hardware inventory and keep applications up-to-date automatically. Email and Webhook notifications. Multiple options to synchronize the catalog. Integration withPatch My PC Cloud(requires an Enterprise Plus subscription). No agent required for client devices. Single console installation on the Software Update Point (SUP). Automatically update applications in a Task Sequence. Automatically clean-up un-needed WSUS content. Current limitations of the Publisher include:- Publisher cannot publish updates to a remote WSUS server. * Console access to modify and customize updates is only possible from the Software Update Point where the Publisher tooling is installed (either directly or by using RDP). * While the Publisher cannot publish updates to a remote WSUS server, it is important to note that the Publisher can be installed on a remote Software Update Point (SUP). Feature Comparisons The following table highlights the feature differences between SCUP, In-Console Publishing method and Patch My PC Publisher:- Publisher Requirements There may be some additional requirements for the Publisher when you transition away from using SCUP, depending on your existing server specification. The Publisher installs on the top-level Software Update Point in your Configuration Manager hierarchy. The SUP must meet the following requirements:- Software Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 Microsoft .NET Framework 4.6.2. Windows Server Update Services (WSUS) installed and configured. (This feature should already be installed and configured if you are currently using SCUP). Environment Internet connection. Therelevant domain namesfor Patch My PC have been added to your firewall\u2019s allow list. Install the Publisher on the top-level WSUS/SUP server in the hierarchy. The Patch My PC Publisher will require the user launching the Publisher tool to be a local administrator on the server. Configuration Manager Console installed (Only required to communicate with the SMS Provider to initiate the SUP sync and create Configuration Manager application). Hardware CPU: 2 CPU or more. Memory: 8GB of RAM or more. Disk Space: 80GB of disk space or more. (The amount of disk space required will depend on the number of selected products). Migration Overview The transition from using SCUP to publishing third-party updates to Patch My PC Publisher is the recommended migration path for Patch My PC customers. Typically, customers would need a different license level which iscovered at the end of this article. For the most part, migration is relatively straight forward. There are a handful things to consider before migration, some of which are service affecting. Those items are covered in detail in the section below and in thevideoanddocumentationsections of this article. Migration Considerations Patch My PC engineers will help customers transition from SCUP to using the Patch My PC Publisher. Patch My PC will offer technical guidance over email or Teams and can assist with platform migration over a remote support session. The following items should be considered before transitioning from SCUP to Patch My PC Publisher:- Non Service-Affecting Considerations Existing updates from the Patch My PC catalog, published using SCUP, will not be removed from the WSUS or Configuration Manager database. If a newer version of an update is published using the Patch My PC Publisher, older updates already published to WSUS using SCUP will be superseded as normal/expected. API and URL endpoints remain unchanged. Existing WSUS SSL certificates do not need to be changed. Existing WSUS code-signing certificate does not need to be renewed ifeitherthe following conditions are met:-The private key of the certificate is marked as exportable.SCUP is already installed on the top-level SUP and the code-signing certificate is in the WSUS certificate store for the local computer. The private key of the certificate is marked as exportable. SCUP is already installed on the top-level SUP and the code-signing certificate is in the WSUS certificate store for the local computer. Service Affecting Considerations Any edits to the imported catalog to customize updates created by SCUP must be considered and manually added back when creating the updates using Patch My PC Publisher. Not all edits may be possible with the Publisher. Seehttps://patchmypc.com/custom-options-available-for-third-party-updates-and-applicationsto understand what customizations can be applied to updates using the Publisher. If a previous version of an update was customized using SCUP, and Patch My PC Publisher performs a synchronization, those customizations will be overwritten. The update will be revised if the version synchronized by Patch My PC Publisher matches the existing version that was previously published using SCUP. Anycustomizationsmade to updates of the same version, that have already been published using SCUP, will require the updates to bere-publishedfrom the Publisher. This is because additional content is required for the update. Patch My PC Publisher must be installed on the top-level SUP. This might be a CAS in the hierarchy. Access to the CAS might be limited in some environments to configure the Patch My PC Publisher. If customers are unable to access the CAS, consideration should be given to moving to thein-console publishing methodinstead. Customizations to updates and/or applications applied using the Patch My PC Publisher will result in small Patch My PC \u201chelper\u201d binaries being packaged inside the update CAB file and/or application source folder. These binaries are used to customize the installation of third-party updates and applications. Environments that utilize whitelisting technologies such as Microsoft AppLocker or Windows Defender Application Control might need to trust the Publisher of these helper binaries. Note: All Patch My PC helper binaries are signed by Patch My PC. Customers must choose whether they want to deploy meta-data only or full content when synchronizing updates using the Patch My PC Publisher. Unlike SCUP, there is not a threshold configuration that will automatically deploy content to WSUS for updates based on the number of devices that require the update in the customers environment. Migration \u2013 Video In this 25 minute long video we take a look at what is involved moving from SCUP to Patch My PC Publisher and discuss some of the features of the Publisher too. Note:Some features mentioned in this video, such as creating Configuration Manager applications, require theEnterprise Pluslicense subscription. Migration Documentation Detailed documentation for both SCUP and In-Console Publishing to Patch My PC Publisher migrations can be found atChanges-for-Publishing-Updates-to-Configuration-Manager-Using-Third-Party-Catalogs.docx Licensing Customers publishing updates using SCUP are typically subscribed to ourBasicsubscription. At the announcement of the deprecation of SCUP by Microsoft in January 2024, Patch My PC will no longer be renewing customers at this subscription level or offering it to new customers. The Basic subscription, used with SCUP, had many limitations, not least limited to:- It does not provide automated publishing of third-party software updates or applications. SCUP\u2019s configuration is saved, per-user, in %AppData%. It does not permit the creation of third party apps in Configuration Manager, only software updates. It does not permit the creation of third party apps or updates in Intune. Update customization is very limited using SCUP and customizations do not persist across new update version. SCUP does not support un-signed third-party binary installers. No new features. Customers will not be able to leverage any of the Patch My PC Right-Click customizations or new features such as Custom Apps.https://patchmypc.com/custom-options-available-for-third-party-updates-and-applicationshttps://docs.patchmypc.com/patch-my-pc-cloud/custom-apps It is not possible to re-sign existing third-party updates in WSUS with SCUP. Reportiong: A noteworthy mentionThe Enterprise Patch subscription also includes outPatch Insightsreporting solution for software updates in Configuration Manager. Patch Insights offers a high-level overview dashboard, updates report, update groups report, update deployments statistics, OS upgrade report, and verbose computer status report. SubscriptionsThe current subscriptions offered by Patch My PC are:- Basic(no longer offered) Enterprise Patch Enterprise Plus Enterprise Premium The minimum subscription required when changing the publishing method highlighted in this document can be found in the table below:- * Customers may choose to migrate from using SCUP to theIn-Console method in Configuration Managerif publishing updates to a remote WSUS server is a hard requirement. This could be because access to the top-level SUP in the hierarchy is not accessible for the system admin responsible for patching. The in-console publishing method, while missing out on some of the great innovations that Publisher brings, is still a supported publishing method. In-Console publishing requires an Enterprise Patch subscription. Customers using the Basic subscription should have already been contacted by Patch My PC. If you have not, please reach out to[email protected]to speak with an Account Executive to understand how the deprecation of SCUP affects your current license subscription. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/uninstall-software-configmgr-intune/", "title": "Patch My PC Deployment ConfigMgr Uninstall", "raw_text": "How to leverage Patch My PC to uninstall software from devices using ConfigMgr or Intune If you want to deploy Patch My PC Packaged software to uninstall it from managed devices, this article shows what you need to take into consideration. Introduction Sometimes, customers use Patch My PC Publisher to package software for deployment with uninstall intent. This means they want to remove software that shouldn\u2019t be on their corporate devices. While software packaged by our Publisher can be deployed with uninstall intent, there are some conditions for the uninstall to work effectively. What do I need to know? The uninstall feature for software published by Patch My PC only works if the version you\u2019re deploying, or a newer one, is already installed on the targeted device. If the device has an older version installed, the uninstall won\u2019t work. This limitation is because of the comparison operators used in our PowerShell detection scripts. To address this issue, follow the steps listed below, based on the platform you are using \u2013 either thePatch My PC OnPrem Publisheror thePatch My PC Cloud Portal. Patch My PC Publisher console If you are working with the OnPrem Patch My PC Publisher, you\u2019ll have to follow these steps: Select the Same Software: From theUpdatestab (for ConfigMgr) orIntuneUpdatestab (for Intune), choose the software you want to uninstall from your devices. Deploy the Update: Deploy the update to your devices to patch the software to the latest version. Deploy the App with Uninstall Intent: At the same time, select the software from theConfigMgrAppsorIntuneAppstab and deploy it with uninstall intent. Once the software is patched by the update on devices that have it installed, the uninstall of the app will be triggered, and the software will be removed. Even if users manually install the software again, this process will repeat itself as long as the deployments remain active. Patch My PC Cloud portal If you are publishing software from thePatch My PC cloud portal, you\u2019ll have to follow these steps: You will have todeploythe software from the portal. If you are not familiar with deployments from the Cloud portal, you can find more informationhere. Assign the deployment withUpdate onlyandUninstallintent and targed the group of devices / users you want to get the software uninstalled from. When the software is published to Intune, you will have two win32 apps. One of the will be the update \u2013 it will patch the software to the latest version on devices that have the software installed. The other one is the app, which will uninstall the software as soon as it\u2019s patched by the update mentioned above. If the assignments remain active, the process will be automatically repeated by Intune if the user manually installs the software again. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/republish-pmpc-apps/", "title": "Republish, Intune, Updates, ConfigMgr", "raw_text": "Republish Patch My PC ConfigMgr Apps, Intune Apps and Intune Updates In this article, the topic of republishing non-WSUS updates in Patch My PC will be explained in detail. What is Republishing Republishing an app or update means that the selected app or update(s) content will berecreated in the assocated management system without changing the object ID. This means that the app or update will have any new right-click options applied as well as the most up-to-date applicability and detection scripts. Why Would an Update Need Republishing There are four scenarios that would require an update to be republished. Those scenarios, and the reason the republish is needed, are below. Aright-click optionis used thatadds content to an Intune app or Intune updateAdd custom pre/post update installation scriptsAdd MST transformation fileBranding/logo changed forManage conflicting processes\u2026Auto close application processes before installationSkip installation when the application is in useDelete desktop shortcut(s) created by this applicationDisable self-updaterManage installation loggingModify command line Add custom pre/post update installation scripts Add MST transformation file Branding/logo changed forManage conflicting processes\u2026 Auto close application processes before installation Skip installation when the application is in use Delete desktop shortcut(s) created by this application Disable self-updater Manage installation logging Modify command line Updated detection or applicability rules have been released by Patch My PCThis occasionally occurs when Patch My PC revises an update shortly after release, Patch My PC support may ask you to republish an app or update in this case This occasionally occurs when Patch My PC revises an update shortly after release, Patch My PC support may ask you to republish an app or update in this case The code-signing certificate has been updated. How to Republish Apps or Updates Once you determine what product(s) meet the criteria described above for requiring a republish operation you canright-click the product, vendor, or all products level and choose the\u2018Republish update(s) for these product(s) during next sync schedule\u2018 You may be prompted to verify if you want Patch My PC to Recreate Intune assignments for the products selected for republish. If you selectYes, you will be prompted to verify if you want tosupersede the currently published updatesfor this product when the new updates are republished. The popup also includes some details on how you can optionally expire those previously published updates. Note:If you select \u201cNo\u201d in the above prompt you willcontinue to receive warningsfrom the Publisher stating that the update could not be revised. To stop these warnings in this scenario you will want to decline the update which is failing to revise using themodify published updates wizard. The republishing of the selected updates will occur during the next publishing service sync. You can trigger this sync to happen right away by clicking theRun Publishing Service Syncin theSync Scheduletab. If you review thePatchMyPC.log,you should see the updates being republished. Republished updates will have the date appended to the update title here\u2019s an example:Google Chrome 84.0.4147.105 (x64) \u2013 (Republished on 2020-09-22 at 11:52) Optionally you can use theWSUS Optionsin theUpdatestab of the Publisher todisable the appending of the republish tag. See below for an example of the option. With the checkbox checked republished updateswill not have the republished tag, but would still supersede old updates if requested. Once the republishing has completed, the updates will show up in SCCM after the next software update point sync has occurred. You can force a sync to happen by clicking \u2018Synchronize Software Updates\u2018 in the Configuration Manager Console. You can monitor the SCCM software update point sync by reviewing thewsyncmgr.log. Once the sync is complete, you should see the newly republished update(s) in the console with the date appended as described above. If you choose tosupersedepreviously published updates for this product, you will see the previous update(s) as superseded as well as indicated by theiricon, and a \u2018Yes\u2019 in the superseded column. Note that the update has our appended republish date, and our previous update is now marked superseded. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-application-manager-utility/", "title": "Intune Application Manager, Win32 Apps, Export, Assignments", "raw_text": "Intune Application Manager Utility The Intune Application Manager Utility provides you with a live view of all Win32 apps currently in your Intune tenant. It can help you: Export a list of your Intune Win32 apps to .csv, so you can use ourPower BI templateto report on third party patching in Intune Manage live assignmentsfor all of your existing Win32 apps in Intune Multi-select and deleteIntune Win32 apps or their assignments Opening the Intune Application Manager Utility The utility can be found within the Publisher in either theIntune AppsorIntune Updatestab, on the right-hand side as a cloud icon with a magnifying glass: Below is an example screenshot of what the utility looks like in a tenant with some Win32 apps. This is alive view of all Win32 appscurrently in your tenant. From the above you can see the following details about your Intune Win32 apps: Name Description Installed Install Pending Not Applicable Classification Publisher Modified Date Assigned Purpose Right-clicking on the column headers enables you to add additional columns to this view: Export a list of your Intune Win32 apps to .csv Clicking theExportbutton at the bottom will prompt you to save this list of data to a .csv. This .csv file is used as a data source for ourPower BI templateto help you report on third party patch compliance in Intune. Manage assignments Selecting a single app in the list and clicking theManage assignmentsbutton at the bottom will produce a dialogue where you can manage the live assignments of your existing Win32 apps currently in Intune. The UI for managing the assignments here is a similar experience to using theright-click Manage assignmentsoption, however, this differs by being a live modification of assignments for existing app. Whereas the right-click option configures the Publisher what assignments to apply to newly created apps or updates. Delete assignments Selecting one or more apps in the list and choosing theDelete assignmentsbutton at the bottom deletes all of the assignments associated with all the select apps. This is a helpful function because doing such a task in the Intune console today involves more UI interaction, whereas here we can do that for multiple Win32 apps in fewer clicks. Delete applications Similar to theDelete assignmentsaction, selecting one or more apps in the list and choosing theDelete applicationsbutton at the bottom deletes all of the selected Win32 apps from your tenant. This is a helpful function because doing such a task in the Intune console today involves more UI interaction, whereas here we can do that for multiple Win32 apps in fewer clicks. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/unsigned-updates-fail-error-srvmsg_sms_isvupdates_syncagent_updatecontent_trust_fail_badsig/", "title": "System Center Configuration Manager, Third-Party Software Updates, Code-Signing Certificate", "raw_text": "Unsigned Updates Fail with Error SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL_BADSIG One of the new requirements when using theSystem Center Configuration Manager 1806+Third-Party Software Updates featureisevery update\u2019s installer file must be digitally signedwhen published as full-content within the SCCM console. If you right-click an update where theinstaller isn\u2019t signedand choose toPublish Third-Party Software Update Content, you will receive an error in the binary validation in theSMS_ISVUPDATES_SYNCAGENT.loglog file. Determine if You are Affected The following errors will be shown in theSMS_ISVUPDATES_SYNCAGENT.loglog file when an unsigned third-party update is published as full-content. SyncUpdate: File \u2018D:Microsoft Configuration ManagerISVTemphdrdeabp.51d7z1604-x64.msi\u2019 does not appear to be signed or there was an error retrieving the signing certificate. Signatures are required. Signature check on downloaded binary has failed, reason: 0. STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL_BADSIG). STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_FAIL). SinceSystem Center Updates Publisher (SCUP)does allow unsigned updates to be published, we expect Microsoft made the code-signing certificate requirement for SCCM due to the increased automated available in SCCM to addanother layer of validating binariesfor any third-party software updates being published from their product. List of Products Where Vendors don\u2019t Code-Sign the Binary Installer File We are maintaining a list of active products whose vendors who don\u2019t sign their installer binaries. 7-Zip Apache OpenOffice Apache Tomcat Archi FastStone Capture GanttProject ImgBurn Inkscape IZArc K-Lite \u201cBasic & Mega\u201d MapInfoPro MicroDicom MinuteTraq PaintDotNet PeaZip PKZip Programmer\u2019s Note ProjectLibre SeaMonkey ShareX Terminals RDP WinMerge Why don\u2019t vendor\u2019s code-sign their installers? Great question, code-signing does add anotherlayer of integrityto binaries and has been around for a long time. The vast majority of software vendors do code-sign their binaries, but we do see many open source projects such asNotepad++and7-Zipchoose not to code-sign due to cost and increased complexity and instead post file hashes. Unsigned Binary Workaround To published products whose binaries are unsigned, you need to use ourpublisheror SCUP as a workaround. Our publisher has avariety of benefitscompared to the SCCM in-console publishing. We also recommend contacting the vendor of the software whose installer is unsigned to ask them if it would be possible to sign their binaries in future versions. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/personal-lab-subscription/", "title": "Personal Lab Subscription Configuration Manager Intune", "raw_text": "Personal Lab Subscription We offer a Personal Lab subscription for those that want to use ourenterprise Patch My PC Publisherin their personal Configuration Manager or Intune lab environment. Overview of the Personal Lab Subscription A personal lab subscription is intended forConfigMgr/Intune enthusiasts in a personal lab. The personal lab will only work for environments with fewer than 25 devices and is subject to approval. You arenot permitted to use a personal lab subscription in a commercial or production environment.The personal lab is subject toadditional requirementsdefined in our terms of service. Note:If yourcompany has purchasedPatch My PC and uses it in a lab in your corporate environment, you can generally use your production subscription for this use. Please see the following FAQ:Can I Use the Same Catalog Subscription in Multiple Environments. Requirements and Limitations Themaximum count of 25 devicesis evaluated by the Patch My PC Publisher at the beginning of each sync. It checks your device count in WSUS, ConfigMgr, and Intune. It is acceptable to have up to 25 devices on each platform. Thefunctionality to publish third-party applications or updates will be disabledif you exceed the 25 device count in any of the respective platforms. How is the device count determined in WSUS? Total device count. Exceeding the device count in WSUS will cause the Updates tab to stop functioning, and products from this tab will no longer publish to WSUS. If this is the only platform you have to exceed in the device count, other tabs and platforms will continue to function and publish. How is the device count determined in Configuration Manager? All Desktop and Servers Clients device collection. How is the device count determined in Intune? Windows devices that checked in in the last 7 days Purchase a Personal Lab Subscription To purchase the Personal Lab Subscription, submit a quote request here:Personal Lab Quote Request. Note:If yourcompany has purchasedPatch My PC and uses it in a lab in your corporate environment, you can generally use your production subscription for this use. Please see the following FAQ:Can I Use the Same Catalog Subscription in Multiple Environments. Installation for Personal Lab Subscription For guidance on how to install the Publisher in your environment, please refer to ourdocumentation. Note:Technical support is included in our personal lab subscriptions, but we don\u2019t offer ourfree setup callsforpersonal lab subscriptions. What Happens if the Device Count is Exceeded Exceeding the device count inone platform will not cause other tabs to stop working or publishing to the other platforms. For example, exceeding the device count in WSUS still enables you to publish with the ConfigMgr Apps, Intune Apps, and Intune Updates tabs as long as the device count isn\u2019t exceeded in the other areas. If you exceed the number of allowed devices in any platform, you will receive an error similar to the below inPatchMyPC.log: You will beunable to publish new applications or updatesif the device count is exceeded. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-sign-package-error-was-2/", "title": "Failed to sign package,WSUS error,code signing certificate", "raw_text": "Failed to sign package; error was: 2148081670 Failed to sign package; error was: 2148081670 In this article, we will be reviewing an error that can occur when trying to publish third-party software updates toWSUS. Determine if You are Affected If you are affected by this error, you will see the following error(s) in thePatchMyPC.logorSoftwareDistribution.log. An error occurred while publishing with timestamping, and timestamping is enforced: Failed to sign package; error was: 2148081670 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2148081670 PublishPackage(): Operation Failed with Error: Failed to sign package; error was: 2148081670 This error can occur if thecode signing certificateused for WSUShas been revokedby the Certificate Authority (CA). You can check if your certificate has been revoked by following these steps using the Patch My PC Publisher: ClickShow Certificatein theGeneraltab ClickValidate Trust Chain\u2026 Note:We have also had reports of this specific error from customers even when the certificate was not revoked. Therefore,all circumstances as to why WSUS uses this error code are not yet known. Solution If the certificate has been revoked by your CA,you may be able to unrevoke it. For example, if the certificate was issued by an Active Directory Certificate Services (ADCS) CA and the \u201cCertificate Hold\u201d reason code was used to revoke, then it is possible to unrevoke the certificate. If your certificate is not revoked and you still have the original .pfx for your current code signing certificate, you may want to first try re-importing that instead of issuing a new certificate. However, if re-importing the original code signing certificate does not solve the issue, then you will need toimport a new code signing certificate. You will need to do the following in order: Import your new code signing certificate Deploy your new code signing certificate to your devices Re-sign all of your existing third-party updates in WSUS Download all third-party updates into a new Deployment Package 1. Import your new code signing certificate For guidance to import a code signing certificate into the Patch My PC Publisher, seeWhat is the WSUS Signing Certificate and How to Create It. 2. Deploy your new code signing certificate to your devices For guidance to deploy your new code signing certificate, seeHow to Deploy the WSUS Signing Certificate for Third-Party Software Updates. 3. Re-sign all of your existing third-party updates in WSUS Using theModify Published Updates Wizard, select all of your existing third-party software updates in WSUS and choose the option toRe-Sign Update. 4. Download all third-party updates into a new Deployment Package At this point, after re-signing all of your third-party updates, all of the .cab files in the WSUS directory should have a digital signature. They will be signed with your new code signing certificate. You can verify this by browsing to your WSUSContent or UpdateServicesPackages folder and looking at the digital signature for any of your .cab files containing a third-party update. Now, you mustdelete any previously downloaded third-party software updates in any existing Deployment Packages. After you have done this, you need todownload all of your third-party software updatesinto anew Deployment Package in Configuration Manager. Updates need to be downloaded again because the .cab files in your current Deployment Package(s) are signed with your old code signing certificate. They need to be re-downloaded since their digital signatures have changed, and you need your clients to trust all of your third-party updates. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-remove-already-published-third/", "title": "Third-party updates removal, WSUS modification, update decline", "raw_text": "How to Remove Already Published Third-Party Software Updates In some cases, you may want to remove third-party updates that have already been published to WSUS from Patch My PC. To perform this task, you will need to use themodify published updates wizardin thePublisher. Unchecking a Product doesn\u2019t Remove Previously Published Updates If you uncheck a product in theUpdatestab, it will cause no future updates to be published for that specific product, but it willnot cause existing updatesthat have been already published to be removed. Note:If you want to remove already published updates for the product, you will need todecline the existing updates. Show and Decline Only Updates for Not Enabled Products TheAll Enabled Statusdropdown allows you to selectNot Enabledto show any updates published from thePatch My PC\u2019s catalogthat are not currently enabled in theUpdatestab. Note: TheNot Enableddropdown option can be a great option todeclineordeleteold updates for products not currently enabled. Decline the Third-Party Updates Based on Filters To remove existing updates already published, you will need todeclinethe updates. Within the Publisher, go to the \u201cUpdates\u201d tab, click \u201cOptions\u201c, then click \u201cRun Wizard\u201d in theModify Published Updatessection. Select the updates you would like to remove from WSUS/SCCM and click the \u201cDecline Selected Updates\u201c. After the updates are declined in the Publisher, you can manuallysync your software update pointin SCCM for the changes to occur immediately. After the software update point sync is complete, you should see thedeclined updates show as expiredin SCCM and will no longer be deployed. In the example below, you can see the declined 7-Zip updates show expired. Note:Expired updates will be automatically purged from the Configuration Manager after7 days. Removing/Filtering Specific Updates from Automatic Deployment Rules In some scenarios, you may simply want to removespecific updatesfrom an automatic deployment rule. You can use thetitle filterto exclude the specific update title from the ADR search criteria. Here\u2019s an example of an ADR that will deployall Patch My PC updateswith no filters: Here\u2019s how you can add atitle filterif you wanted to excludeany 7-Zip updatefrom your ADR.Title: -7-Zip A full list of update title names for all product can be found atExcluding Specific Products from ADRs in Microsoft SCCM with Patch My PC Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/duplicate-category-sup-tab/", "title": "Duplicate Patch, Configuration, Management", "raw_text": "Duplicate Patch My PC Category Listed in Software Update Point Products Tab Recently, we have seen an increase in customers having an issue whereduplicate Patch My PC categorieswill appear in the software update point products tab. Determine if You are Affected The most common scenario that leads to us checking for duplicate Patch My PC categories is customers opening a support case mentioningnewly published updates aren\u2019t appearingin theAll Software Updatesnode in Configuration Manager. If you are affected by this issue, you should seemultiple Patch My PC categorieslisted in the Software Update Point properties. In the ConfigMgr console, navigate toAdministration>Site Configuration>Sites>Configure Site Components>Software Update Point. In theProductstab, check if there are multiple Patch My PC categories as shown below: Root Cause of Duplicate Product Categories The duplicate categories are caused by a change in WSUS on Server 2019, where it usesSHA2 instead of SHA1 to compute a unique category hash for a vendor category. Before Server 2019, WSUS would use SHA1 to compute a unique hash for a vendor category in the database. Unfortunately, this causes aduplicate categoryfor any updates published after a Server 2019 in-place upgrade. If you connect theSUSDBwith SQL Server Management Studio and run: execspGetTopLevelCategories You can see theduplicate categoriescreated Important:The duplicate category is not specific to Patch My PC updates. This WSUS bugaffects any published third-party category. For example, in the example below, you can see a duplicate Dell category when Dell drivers were published after the OS upgrade Resolution for Duplicate Patch My PC Categories The primary issue that causes customer problems is thenew company category in the Software Update Point Products tab has not been enabled. By not having it enabled, any newly published updates after the OS upgradedon\u2019t sync into ConfigMgr. The quickest and easiest fix is to simplyenable the second Patch My PC categoryin the Software Update Point Products tab Once the product is enabled and you completed asoftware update point syncin ConfigMgr, the new updates should appear in the All Software Updates as normal. Important:If you use an Automatic Deployment Rules that useVendororProductin the Software Update criteria, you will need to modify the search criteria. In theSoftware Updatetab of your automatic deployment rule, you will need to enable bothPatch My PC Vendors. Based on our experience, although it appears both Vendor categories may be enabled when clicking the Vendor that is not the case unless the ADR Vendor shows\u201cPatch My PC\u201d OR \u201cPatch My PC\u201din the search criteria. To enable both vendors, you canuncheckone of the Patch My PC vendors thenrecheckit again and the criteria should then listboth vendors. This change will allow your ADR to search updates published before the WSUS OS upgrade and after. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-set-subscriptions-wsus-server/", "title": "WSUS, Subscriptions, Software Update Points", "raw_text": "Failed to set Subscriptions on the WSUS Server. Error:(-2147467259)Unspecified error In this video KB article, we will be reviewing an issue that can happen when a third-party vendor has been removed from the WSUS products list, but the product is still enabled in the software update points products list. Determine if You are Affected In theWCM.log, on the site server, you will see an error message similar to thelog lines below: Category Product:e244170c-ed31-e94b-172a-fcc94c0541ea (%productname%) not found on WSUSSubscription contains categories unknown to WSUS.Failed to set Subscriptions on the WSUS Server. Error(-2147467259)Unspecified error In thewsyncmgr.log, on the site server, you will see an error message similar to the message below: Sync failed: WSUS server not configured. Please refer to WCM.log for configuration error details.. Source: CWSyncMgr::DoSync Why Error(-2147467259)Unspecified error Occurs Before reviewing the resolution, we want to make sure you understand why this error occurs in the first place. The error occurs in theWCM.log. The WCM componentrecords details about software update point configurations and connections to the WSUS server for subscribed update categories, classifications, and languagesbased on theMicrosoft Docs. If youview the log file, you will actually see more details on the issue The root cause is one of the products for third-party vendors was removed from WSUS, but it\u2019sstill enabled in the software update point. One common reason products may be removed from WSUS is whenSoftware update maintenanceruns and then the WSUS cleanup wizard is run. Unfortunately,ConfigMgr will not automatically un-check products that don\u2019t exist in WSUSfrom the software update point products. Resolution for Error(-2147467259)Unspecified error (Post Version) To fix this error, you will need to un-check all products that don\u2019t exist in WSUS from theProducttab in theSoftware Update Point Component Properties. Based on the error in our example log, we can see the vendorAdobe Systems, Inc.andNotepad++Team no longer exist in WSUS. In our example, we would un-check these products in our software update point. Once un-checked monitor theWCM.logto review if the error is resolved. Resolution for Error(-2147467259)Unspecified error (Post Version) Video resolution guide for this error. If the missing productdoesn\u2019t appear in the productsof the software update point, please see the following blog post:Case Study \u2013 ConfigMgr 2012: Moved the SUP role with a new WSUS server (new DB) and now the WCM fails to sync. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/system-cannot-find-the-path-specified-0x80070003/", "title": "Automatic Deployment Rule, Error, UNC Path", "raw_text": "DownloadUpdateContent() failed with hr=0x800070003 \u2013 The system cannot find the path specified Error 0x80070003 \u2013 Downloading Updates to a Deployment Package Using an Automatic Deployment Rule This article discusses a common issue seen when an Automatic Deployment Rule (ADR) is set up to download updates from a specific UNC path rather than to download updates using the internet. If your ADR is configured to download from a specific UNC path, you may see an error in yourSMS_CCM\\LogsPatchDownloader.logsimilar to the one seen below: ERROR: DownloadUpdateContent() failed with hr=0x80070003ORERROR: DownloadContentFiles() failed with hr=0x80070003 Looking up this error in CMTrace yields this explanation: The system cannot find the path specified. Resolution: Set ADR Download Location to Download Software Updates From the Internet This error occurs because the ADR was initially configured to \u201cdownload software updates from a location on my network\u201d that does not contain the update it attempted to download, hence the \u201cThe system cannot find the path specified\u201d error description. A common mistake here is that the UNC path specified in the download location is set to a location intended to download the updatesto, such as a deployment package, when it is asking where to download updatesfrom. You do not need to designate a specific UNC path to download Patch My PC third-party updates. When setting up an ADR, you will need to configure the deployment package to \u201cDownload software updates from the Internet\u201d instead of a UNC path. The ADR download will automatically use the WSUSContent website where the update was published when the option \u201cDownload software updates from the Internet\u201d is checked. Unfortunately, this is not a setting you can change in the properties of an ADR after it is created. You will need to create a new ADR to configure the download location, as seen in the picture above. Deleting the previously failing ADR and configuring the new one to download updates from the Internet should resolve this error. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/unable-find-assembly-adminui-wqlqueryengine/", "title": "ConfigMgr Assembly Error Resolution Patch My PC Publisher", "raw_text": "Unable to find the Assembly: AdminUI.WqlQueryEngine, Version=5.0.0.0, Culture=neutral The error message \u201cCould not load file or assembly \u2018AdminUI.WqlQueryEngine, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\u2019 or one of its dependencies.\u201d occurs when theConfiguration Manager console isn\u2019t installedon the device running thePatch My PC Publisher. We use the assembly files within the Configuration Manager console to connect to ConfigMgr to perform the following actions: Check the build number Trigger a software update point synchronization Create and manage ConfigMgr applications Determine if You are Affected There are a variety of different error messages that will occur depending on the action that occurred. Here\u2019s an example of errors you will see in thePatchMyPC.logfile. An error occurred while trying to trigger a SUP sync: Unable to find the Assembly: AdminUI.WqlQueryEngine, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 An error occurred while connecting to SCCM: Unable to find the Assembly: AdminUI.WqlQueryEngine, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 ] An error occurred while connecting to Sms provider as System: Unable to find the Assembly: AdminUI.WqlQueryEngine, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 ] How to Resolve this Error To resolve this error, you need toinstall the ConfigMgr consoleusing the steps documented hereInstall console \u2013 Configuration Manager | MicrosoftDocs. Important:After the ConfigMgr console is installed, you will need to perform the following steps to ensure theconsole assemblies are loaded within the Patch My PC Publisher. Once the console is installed,perform the following steps: Closethe Patch My PC Publisher UI Re-open the Publisher Navigate to theAbout taband clickRestart service These actions shouldresolve the issue Note:In rare cases, if the console assemblies still aren\u2019t detected, you may need to restart the computer for the assemblies to be detected. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-update-downloads-fail/", "title": "ConfigMgr, Update, Error, Authentication", "raw_text": "Third-Party Update Downloads Fail: Invalid certificate signature Error 0x800b0004 and 0x87D20417 Error0x800b0004,0x80073633,or13875generally occurs when attempting to download third-party software updates into a deployment package. When attempting to download an update into a deployment package in the SCCM console, you receive the error messageError: Invalid certificate signature Determine if You are Affected Whenever a software update is being downloaded, regardless of whether it\u2019s a Microsoft or third-party update, thecertificate used to sign the software update must always be trustedby the machine running theConfigMgr consoleor by thesite serverin the case it\u2019s an automatic deployment rule. If usingautomatic deployment, the error code will be a little different, as shown in the screenshot below: If theWSUS signing certificatehasn\u2019t properly been deployed to theTrusted RootandTrusted Publisherscertificate store on theconsole deviceor thesite server, the update validation check will fail, and the update will not be downloaded into the deployment package. Is the download is failing when manually downloading in the ConfigMgr console? If failing when using the ConfigMgr console, you will likely see the following errors in thePatchDownloader.log (For Console Downloads) Authentication of file C:\\UsersAppData\\Local\\TempCAB85AE.tmp failed, error 0x800b0004 ERROR: DownloadUpdateContent() failed with hr=0x80073633 Is the download is failing when using Automatic Deployment Rules (ADRs) in ConfigMgr? If failing to download when using ADRs, you should check thePatchDownloader.log (For ADR).You will likely see the following errors: Authentication of file C:\\UsersAppData\\Local\\TempCAB85AE.tmp failed, error 0x800b0004 ERROR: DownloadUpdateContent() failed with hr=0x80073633 If failing to download when using ADRs, theRuleEngine.logwill likely see the following error: Failed to download the update content with ID 16777699 from internet. Error = 13875 Are updates failing to install on a client with 0x800b0004? If updates are failing to install with error 0x800b0004, you will see the following error inWUAHandler.log: Failed to download updates to the WUAgent datastore. Error = 0x800b0004. If this error occursduring the update installation on a client(not the download to deployment package), it means theWSUS Signing Certificate isn\u2019t installedin theTrusted Publisherscertificate store on the client. If this isyour scenario, please see this articleThird-Party Updates Fail to Install with Error 0x800b0109 in SCCMinstead. 0x800b0004 = The subject is not trusted for the specified action.0x80073633 = Invalid certificate signature13875 = Invalid certificate signature Note:If using anADR, the actual error in the last error code in the console for the ADR may be a more generic error\u00c20X87D20417or0x80070194. Important:Thepatchdownloader.logis located in a different location, depending on whether youmanually download via the consoleor using anautomatic deployment rule. Resolution: Check if the WSUS Signing Certificate is Trusted The most common reason error0x800b0004or0x80073633occurs when downloading an update is that theWSUS signing certificatethat signed the update isn\u2019t installed in theTrusted Rootcertificate store. To check if the WSUS signing certificate is installed, perform thefollowing actions: 1. Downloadthe specific update CAB file failing to download using a web browser or copy directly from the WSUSContent folder. You can get the update download URL or folder/file path to the WSUSContent folder based on thePatchDownloader.log 2.Copythe .CAB file to the machine running theConfigMgr console if failing to download via consoleor to thesite server if using an ADR. Onpropertiesof the file, review theCertification Pathtab, and review if there are any trust errors. If the certificate shows anytrust errors, you will need todeploy this certificate to all machinesormanually installit toTrusted RootandTrusted Publisherson the affected machine if for testing only. Video Resolution Guide to Invalid certificate signature Error 0x800b0004 Please review our video guide below to explains how to resolve this download issue. Additional Information If you are using the SCCM console during the failure, you will also see the following error inSmsAdminUI.log: Failed to download content id 16939262. Error: Invalid certificate signature Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-uninstall-win32/", "title": "Win32 App, Available Uninstall, Patch My PC, Intune", "raw_text": "Intune Win32 app \u201cAllow Available Uninstall\u201d In this KB we will cover the expected behavior of the \u201cAvailable Uninstall\u201d feature for Win32 apps published by Patch My PC. You can configure this feature within the Patch My PC Publisher before publishing an Intune app, or manually from the Intune Admin Centre after publishing an app. We will explore both options in this guide. What is \u201cAvailable Uninstall\u201d When creating or configuring a Win32 app, there is a setting to provide the uninstall option for the app for users in the Company Portal. When this setting is enabled, set to Yes, the Primary user of the device should see the option to uninstall the app. The Uninstall option will only appear if the app has already been evaluated as installed, using the detection method set on the Win32 app. Configure \u201cAvailable Uninstall\u201d in the Patch My PC Publisher You can enable the \u201cAvailable Uninstall\u201d option either at the Global level, where the setting will be applied to all Intune Apps or at the vendor/product level. Option 1: Globally Set the Available Uninstall option 1. From theIntune Appstab, click theOptionsbutton2. Check theEnable \u2018Allow available uninstall\u2019check box and clickOK Option 2: Set the Available Uninstall option at the vendor/product level 1. From theIntune Appstab, right click a vendor or product and selectOverride Win32 application options 2. Check theEnable \u2018Allow available uninstall\u2019check box and clickOK Note:When the Patch My PC Publisher replaces an application in Intune, the new application will inherit the \u201cAllow available uninstall\u201d value if it had previously been set, even if the setting to enable \u201cAllow available uninstall\u201d in the Patch My PC Publisher has since been toggled off at either the global or product level. Configure \u201cAvailable Uninstall\u201d in the Intune Admin Centre If the application has already been published, you can toggle the available uninstall option from the Intune Admin Centre. 1. Navigate tohttp://intune.microsoft.com2. Navigate to Apps > Windows and select a Win32 app to edit3. SelectProperties 4. Scroll down to theProgramsection and clickEdit 5. ToggleAllow available uninstalltoYes 6. ClickReview and SaveandSave Company Portal Expected Behavior When the user clicks on the \u201cUninstall\u201d button, they are presented with a confirmation dialogue. Clicking \u201cUninstall\u201d again will invoke a policy sync using the Company Portal Intune Management Extension Bridge. The app will be removed and the user will be presented with the following option to \u201cReinstall\u201d the app. This screen will also indicate if the uninstall was successful. Note:The \u2018Uninstall\u2019 button may not be visible, even if the \u2018Allow available uninstall\u2019 parameter has been configured if the device has never evaluated detection for the application currently deployed as \u2018Available\u2019. This can occur if an earlier version of the application deployed by Patch My PC was used to initially install the application and the device has subsequently installed an update. Applications and Updates from Patch My PC have different App Ids. If the uninstall option is expected for an application visible in the Company Portal but it is not available, simply click \u2018Install\u2019. This will invoke detection to run and if the application is detected as installed, the \u2018Install\u2019 button will change to \u2018Uninstall\u2019. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sccm-update-download-error-0x80070191/", "title": "SCCM, WSUS, Error, Authentication", "raw_text": "SCCM Update Download Error: The Thread is not in Background Processing Mode (0x80070191) We have been seeing some instances where third-party software updates will fail to download into a deployment package whenWSUS is configured to use a UNC share for the WSUS Content folder. Determine if You are Affected When attempting to download a third-party update from the Configuration Manager console, you receive the following message in the consoleError: The thread is not in background processing mode. If you open the PatchDownloader.log in the%temp%folder, you can also find the following errors. HttpSendRequest failed HTTP_STATUS_FORBIDDEN or HTTP_STATUS_DENIED ERROR: DownloadContentFiles() failed with hr=0x80070191 This error happens because theuser identityconfigured in the WSUS AdministratorContentvirtual directory can\u2019t authenticate to aremote UNC sharespecified for theWSUSContent folder. Troubleshooting Step 1: Verify the Content Virtual Directory is Correct Validate theContent virtual directoryin theWSUS Administrationwebsite is correct. There is a bug in the WSUS setup process that can remove the leadingwhen using aUNC pathfor the WSUSContent folder. To check thePhysical Pathfor the Content virtual directory:Right-click Content>Manage Virtual Directory>Advanced Settings\u2026 Here\u2019s an example of the WSUS bug where the leadingare removed from the virtual directoryPhysical Path. Because the directory is invalid in the Content virtual directory updates will fail to download with error0x80070194or0X87D20417. If you are affected by this scenario, simply update the path to include the leadingas shown below and clickOK Troubleshooting Step 2: Is WSUSContent a UNC Share with the Default IUSR Authentication If steps 1 and 2 are correct, we often see customers where aUNC pathis being used. Still, the authentication identity hasn\u2019t been changed to use theApplication pool identityfor theContent virtual directory. Perform the following actions to review and resolve this issue if applicable: ClicktheContent virtual directory> Double ClickAuthenticationin theIIS Group Right-ClicktheAnonymous Authenticationand ClickEdit Here you can review theAnonymous user identityused for authenticating to the WSUSContent directory. By default, the authentication is set to use the specific user:IUSR. IUSR is a local user-specific to the WSUS server and will not have access to a authenticate to anyremote UNC share. In theEdit Anonymous Authentication Credentialsdialog for theAnonymous Authenticationensure it is set to use theApplication pool identity Resolution for DownloadContentFiles() failed with hr=0x80070191 (Video Guide) The video guide below goes into more detail about why the downloads fail with error0x80070191and the possible resolutions. Please start at20:18and watch to24:30for the resolution. Resources IIS LoginMethod\u2013https://docs.microsoft.com/en-us/iis/configuration/system.applicationhost/sites/site/application/virtualdirectory#configuration IIS 401.3 Error Code\u2013https://support.microsoft.com/en-us/help/943891/the-http-status-code-in-iis-7-0-iis-7-5-and-iis-8-0 Managing WSUS from the Command Line\u2013https://docs.microsoft.com/de-de/security-updates/windowsupdateservices/18127395 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-disable-timestamping-patch-my/", "title": "WSUS timestamping, disable, publishing, updates", "raw_text": "How to Disable Timestamping for Patch My PC Update Publishing By default, we will alwaysTimestampthird-party update content when publishing third-party updates to WSUS. Timestamping can be helpful because even after the WSUS Signing Certificate\u2019s expiration date has occurred, clients will stilltrust any previously published updatesthat were signed with that certificate if it was timestamped. For example, the following WSUS Signing Certificate has an expiration date ofMay 20, 2023. If timestamping is enabled, clients will trust an be able to install updates even after the expiration date. We usually recommend leaving timestamping enabled, but if you need to disable the timestamp feature, you can create the following DWORD value: HKEY_LOCAL_MACHINE\\Software\\Patch My PC Publishing Service:DisableTimestamping = 1 After creating the registry value, you will need torestart the PatchMyPCService One reason why you may want to disable time stamping is to test if updates may be failing to publish due totimestamping firewall rulesorproxy not configured at the system-level. Error Codes When Access to the Timestamping Server is Blocked or System-Level Proxy not Configured If a proxy is in use, we recommend reviewing our articleUpdate Publishing Fails When Proxy is in Use, and Timestamping is Enabled. By default, we usetimestamp.digicert.comfor timestamping. Here is a list of errors that may occur due to issues accessing the timestamping server. An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954402 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954429 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954407 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2148086027 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/troubleshooting-clients-unknown-update-state/", "title": "software update Configuration Manager issues", "raw_text": "Troubleshooting Clients with Unknown Update State in Configuration Manager (SCCM) We have seen an increase of cases whereupdate statesmay show as Unknown for a large number of devices. Customers facing this issue will generally see third-party updates not applying when the updates areapplicable to the devices. AnUnknownupdate state means the device(s) haven\u2019t successfullyscanned against the WSUS serveror haven\u2019t been able toreport the scan results to the Configuration Manager site. There are a variety of possible causes that could cause scan issues. Please see the Microsoft docTroubleshoot software update scan failures in Configuration Manager \u2013 Compliance results unknown. Determine if You are Affected If you are affected by scan issues, you will likely see a high percentage of devices showing anUnknown statein the ConfigMgr console\u2019sAll Software Updatesnode. Although this issueisn\u2019t specific to Patch My PC, we will review some troubleshooting methods below as best-effort support. Note:Depending on your Windows Update for Business (WUfB) policies, it\u2019s possible Microsoft updates can still apply from WUfB even if results show unknown in the ConfigMgr console. Third-party updates will never be applied if the update is in anUnknown state. Please seeUsing ConfigMgr With Windows 10 WUfB Deferral Policiesfor more details about WUfB policies. Troubleshooting Step 1: Troubleshoot software update scan failures in Configuration Manager Microsoft has a detailed knowledge base articleTroubleshoot software update scan failures in ConfigurationManager. We recommend starting your troubleshooting using this KB article. This article covers the following possible issues for software update scans: Scan failures due to missing or corrupted components Scan failures due to proxy-related issues Scan failures related to HTTP time-out or authentication Determine the port settings used by WSUS and the software update point Determine the WSUS port settings in IIS 7.0 and later versions Verify and configure ports for the software update point Scan fails with error 0x80072f0c Group Policy overrides the correct WSUS configuration information Clients can\u2019t find the WSUS server location Compliance results unknown The following article describes log files the processes totroubleshoot client software update scanning. Troubleshooting Step 2: Review the Troubleshooting 1 \u2013 Scan errors Report In most cases, the Microsoft troubleshooting guide isstep 1will help you resolve the issue. We will also share some common issues andtroubleshooting methodswe have found helpful. The following reportSoftware Updates \u2013 E Troubleshooting>Troubleshooting 1 \u2013 Scan errorscan be run if you have thereporting services point installedin your ConfigMgr site. In this report, you can review if there are a large number of devices reporting scan errors. Troubleshooting Step 3: Can the Client Find the WSUS/SUP Server? Another common reason that can cause clients to show unknown is beingunable to locate a WSUS serverto scan against. Please see the Microsoft articleWSUS server locationto understand how clients receive the WSUS server to scan against. If the software update point isn\u2019t associated with a boundary group the clients are in, it will cause the clients to not scan against the WSUS server causingUnknown statesfor updates. For more details, please see the articleConfigure boundary groups for Configuration Manager. FromMicrosoft Docs:Clients useboundary groups to find a new software update point. To control which servers a client can find, add individual software update points to different boundary groups. If you add all existing software update points to the default site boundary group, the client selects a software update point from the pool of available servers. This behavior is similar to earlier versions of Configuration Manager current branch. For controlled selection and fallback behavior, add individual software update points to different boundary groups. If you install a new site,software update points aren\u2019t added to the default site boundary group. Assign software update points to a boundary groupso that clients can find and use them. Troubleshooting Step 4: Group Policy Conflict Causes Error 0x87d00692 One of the most common reasons we see for scan failures is aGPO conflict overwriting the WSUS serverConfigMgr is trying to set locally. If affect, In thescanagent.log, you will likely see the error: CScanJob::Execute- Failed at AddUpdateSource, Error = 0x87d00692 If you receive the error above, please review our KB articleUpdate Scan Error: Job error (0x87d00692) received for assignment ({ID}) action Troubleshooting Step 5: IIS Application Pool Running and Optimized WSUS ultimately relies onMicrosoft IISon the backend, even when integrated with Configuration Manager. If the IIS website or application pool are not working properly then client devices may have scan errors, or report an unknown scan status.Within IIS on the server running WSUS we can see the below server has both theWSUS Administrationand theWsusPoolin a stopped state.When this does happen, clients may exhibit various errors in theWUAHander.log, two of which are below. OnSearchComplete \u2013 Failed to end search job. Error = 0x80244022 OnSearchComplete \u2013 Failed to end search job. Error = 0x80240438 To begin with, the two should be started again. You can simply highlight the WSUS Administration website, or the WsusPool and selectStartfrom the Actions pane on the right hand side of IIS. Commonly theWSUSPool Application Pool will crash dueto a lack of resources, or the app pool needing some advanced configuration changes. Microsoft has some docsherewhich can help give a good baseline for your IIS configuration. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-use-patch-my-pc-in-a-disconnected-environment/", "title": "Patch My PC, WSUS, Offline Environment", "raw_text": "How to Use Patch My PC in a Disconnected Environment without Internet We often get asked if Patch My PC supports publishing third-party updates to WSUS/SCCM in atotally offline environment with no internet access. Offline environments are a supported scenario, and luckily the process is similar to how you would export and import normalMicrosoft updates in a disconnected WSUS environment. Example Environment Setup In our example, we have the following WSUS servers: DEMO1= This WSUS server is independent on the offline environment and used to sync regular Microsoft updates DEMO2= A fully offline WSUS server used for client scanning in the disconnected environment. This server has no internet access. Note from Microsoft Docs:When the software update point at the top-level site isdisconnected from the Internet, you must use theexportandimportfunctions of theWSUSUtiltool to synchronize software updates metadata and content. You can choose an existing WSUS server not in your Configuration Manager hierarchy as the synchronization source. Step 1: Publish Updates from Internet-Connected WSUS Server Similar to how Microsoft updates need to be synced from astandalone internet-connected WSUS server, you will need to publish third-party updates to aninternet-connected WSUS server first. In this example, we haveinstalled and configuredthe Publisher software on DEMO1. We have published 7-Zip and Google Chrome to the WSUS on DEMO1. We also confirmed the updates have been published to WSUS using theModify Published Updateswizard from theAdvancedtab. Once updates are published to the online WSUS server, you can proceed to theexportstep. Step 2: Export the WSUS Catalog from the Online-WSUS Server After publishing updates to the online-WSUS server, you need toexportthe WSUS catalog that includes the metadata for those published updates. The exported file will then beimportedinto the WSUS server in the offline environment. Toperform the export update metadatafrom WSUS perform the following: Open acommand promptasadministrator In the command prompt window, change the directory to the WSUS tools directory. Generally, this will be:cd \u201cC:\\Program Files\\Update Services\\Tools\u201d Once there, run theWSUSUtil.exeexport command to export the catalog.wsusutil.exe exportpackagename logfileIn our example, we ran:WsusUtil.exe export \u201cC:\\WSUS-Export-2020-09-02.xml.gz\u201d \u201cC:\\WSUS-Export-2020-09-02.log\u201d wsusutil.exe exportpackagename logfile In our example, we ran:WsusUtil.exe export \u201cC:\\WSUS-Export-2020-09-02.xml.gz\u201d \u201cC:\\WSUS-Export-2020-09-02.log\u201d Step 3: Import the Exported File on the Offline WSUS Server Copy the.xml.gzfrom the online WSUS server to the offline WSUS server. On the offline WSUS server, perform the following steps to import the file: Open acommand promptasadministrator In the command prompt window, change the directory to the WSUS tools directory. Generally, this will be:cd \u201cC:\\Program Files\\Update Services\\Tools\u201d Once there, run theWSUSUtil.exeimportcommand to export the catalog.In our example, we ran:WsusUtil.exe import \u201cC:\\WSUS-Export-2020-09-02.xml.gz\u201d \u201cC:\\WSUS-Import-2020-09-02.log\u201d In our example, we ran:WsusUtil.exe import \u201cC:\\WSUS-Export-2020-09-02.xml.gz\u201d \u201cC:\\WSUS-Import-2020-09-02.log\u201d Optionally, after the import, you can run the modify published updates wizard on the offline WSUS server to verify the published third-party updates from the online-WSUS where imported: Step 4: Copy the WSUSContent and UpdateServicesPackages to the Offline WSUS Server Once the WSUS metadata has been exported and imported, the last step is to ensure the WSUS content folders arecopied to the offline environment. In our scenario, a local network connection exists betweenDEMO1andDEMO2, so we usedrobocopyto copy new content in the DEMO1 WSUS folder to DEMO2. The command in our example was:robocopy \u201cJ:\\WSUS\u201d \u201c\\\\demo2\\j$\\WSUS\u201d /E Important:If you do not copy the WSUSContent folder to the offline environment, third-party updates will be unable to download on clients or into a ConfigMgr deployment package. This is because the third-party updates are signed using yourWSUS signing certificateon the online-WSUS server. Search terms: air gap, air-gapped Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-updates-fail-download/", "title": "ConfigMgr, Third-party updates, Download Delta Update", "raw_text": "Third-Party Updates Fail to Download in ConfigMgr 1910 if Download Delta Update Enabled \u2013 0x80d02002 Microsoft has docs that discuss this scenarioherein the \u2018Important\u2019 note box, specifically the last bullet point. We were able to reproduce this issue and wanted to explain what\u2019s happening and a workaround. Step 1: Check if Download Delta Content Client Setting is Enabled For our scenario, we could only reproduce the third-party software update download issue when the client setting \u201cAllow clients to download delta content when available\u201d within \u201cSoftware Updates\u201d is enabled. A quick way to check if this client policy may be enabled on a device facing the download issue is to right-click the device in theDevicesnode >Client Settings>Result Client Settings. In the Result Client Settings, check if the policy is Yes. Step 2: Reproduction of the Scenario In our scenario, we had an available software update group deployment whereGoogle Chrome 81.0.4044.113 (x64)UpdateID:ff665b30-ccef-4806-9f81-7b5a762063d5was targeted to a device. Since this was an available deployment, we started the update installation using software center, but a required deployment would have the same download errors. Once the download is triggered, we will see the following data inDataTransferService.log CDTSJob::HandleErrors: DTS Job \u2018{857B9A7B-0908-44AE-BB80-96F30EF11E96}\u2019 BITS Job \u2018{0B57534F-36B3-4BA9-A07E-850F1B5C0CE4}\u2019 under user \u2018S-1-5-18\u2019 OldErrorCount 0 NewErrorCount 1 ErrorCode 0x80072EE7 Failed to set proxy to bits job for url \u2018http://sccm:80/Content/EB/2ABF1D5BCD7564FD2DF0E8DC6CFB628E6DEA4FEB.cab\u2019. Error 0x87d00215 All proxy types and no proxy have been tried but failed. Loop the types again for the 1 time The first interesting thing we notice is the client attempts to download the content from the internal WSUS server, but this actually isn\u2019t our issue and is a known scenario please see ourUserVoice requestto improve this behavior. The download against the internal WSUS will usually timeout after 3 attempts and fall back to your CMG-based distribution point. The log that will help us see the issues in this scenario isDeltaDownload.log. In this log, we can see the following lines: Failed to send HTTP Response. Error=800704cd We will see this happen for each updateevery 3 minutesfor about30 minutesbefore the download will fail. Once the download times out, we will see the following error inWUAHandler.log. Unexpected HRESULT for downloading complete: 0x80d02002 Step 3: Root Cause and Workaround In build 1910, the setting todownload delta content filesis enabled by default. Delta update content is not applicable for third-party updates, and it seems to cause the download to fail completely. We were able to resolve this download issue by disabling the client settingsAllow clients to download delta content when available. Once the client received the policy and applied this change, it was able to download the third-party software update. You may still see the device attempt to download the content from the internal WSUSContent folder three times (3 minutes) before it falls back to your CMG distribution point for each third-party update. You review and vote on our UserVoice hereThird-Party Updates Should Not Attempt 3 Downloads from Internet (WUMU)to help improve this scenario. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/job-error-0x87d00692-received-assignment/", "title": "ConfigMgr Error Group Policy", "raw_text": "Update Scan Error: Job error (0x87d00692) received for assignment ({ID}) action In this article, we are going to review a common error we see with our customers that can cause updates to evaluate and show anunknown scan stateresulting in third-party and Microsoft updates, not deploying to affected client devices. Symptoms of Error 0x87d00692 If you are experiencing this issue, you will see the following error in theWUAHandler.log: Group policy settings were overwritten by a higher authority (Domain Controller) to: Server http://server.example.local:8530 and Policy ENABLEDFailed to Add Update Source for WUAgent of type (2) and id ({891B2E1B-4873-4092-B1FD-7EAADE75A3D3}). Error = 0x87d00692. In thescanagent.log, you will likely see the error: CScanJob::Execute- Failed at AddUpdateSource, Error = 0x87d00692 In theUpdatesDeployment.log, you may see the error: Job error (0x87d00692) received for assignment ({8b5e0d02-d742-4fdc-b06e-d1e55d8c05da}) actionUpdates will not be made available What is Error 0x87d00692 Anyway? If you perform an error lookup usingControl+Lin CMTace.exe, you will see the error description for0x87d00692= \u201cGroup policy conflict\u201c. Group policy conflict means aGPO has been configuredto set the WSUS server to a different server than the ConfigMgr software update point. A GPO will take precedence over the local GPO policy the ConfigMgr client is trying to set. To determine the GPO setting the WSUS server OpenMMC.exe,File>Add/Remove snap-in\u2026 > Add Resultant Set of Policy ClickGenerate RSoP Data\u2026 You can leave thedefault optionswhen clicking through the Generate RSoP data wizard. Once complete, navigate toComputer Configuration>Administrative Templates>Windows Components>Windows Update > Specify intranet Microsoft update service location How to Fix Error 0x87d00692 Remove or stop targetting the group policy that is setting the policySpecify intranet Microsoft update service location. Once the GPO is not applied to a client, the ConfigMgr client will set the correct software update point dynamically based on boundary groups and other site configurations. Please see theMicrosoft Doc describing this policy when using Configuration Manager When the software update point is created for a site, clients receive a machine policy that provides the software update point server name andconfigures the Specify intranet Microsoft update service location local policy on the computer. The WUA retrieves the server name that is specified in the Set the intranet update service for detecting updates setting, and then it connects to this server when it scans for software updates compliance. When a domain policy is created for the Specify intranet Microsoft update service location setting,it overrides the local policy, and the WUA might connect to a server other than the software update point. If this happens, the client might scan for software update compliance based on different products, classifications, and languages. Therefore, youshould not configure the Active Directory policyfor client computers. Note:Depending on other Windows Update GPO\u2019s and the timing of policies being removed and applied, clients mayscan against Windows Update directlyonce the GPO is disabled and before the new WSUS server policy is configured locally by the Configuration Manager client. Once the GPO is no longer applied to devices, you can optionally trigger aSoftware Update Deployment Evaluation Cycle. This cycle will trigger the client to attempt to set the local policy for the WSUS server to the Configuration Manager software update point. Note:You may want to limit the number of devices you perform this action on at once to avoid large WSUS scanning traffic. In the WUAHandler.log, you should see the WUA Manager server can now be set by the ConfigMgr client, and the GPO conflict error will go away. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-publishing-alerts-work-patch/", "title": "Patch Publisher Email Alerts SMTP Settings", "raw_text": "How Publishing Alerts Work in Patch My PC\u2019s Publisher An important factor of third-party patching isstaying informedas new updates publish in real-time. Our alerts feature allows you to be notified via the following methods: Email Microsoft Teams webhook notification Slack webhook notification This article will cover how theSMTP SettingsandWebhook Settingswork within ourPublisher. How do Email Alerts Work in the SMTP Settings? IMPORTANT: Patch My PC Publisher, at this time, cannot support Modern authentication and relies on SMTP authentication for sending email reports. Please refer tothisarticle for more information on how to re-enable SMTP authentication for 1 specific mailbox, which will allow Patch My PC Publisher to authenticate and send emails through your Exchange Online environment. TheSimple Mail Transfer Protocol (SMTP)has been around since 1982 and is a common method for sending emails. OurPublisherallows you to configure SMTP settings to send email alerts forpublishing operations. The first step is to configure the required options for your SMTP server. Note:TheRecipientsandCC Recipientsvalue(s) must be a valid email address. You can specify multiple email-addresses and seperate the addresses with a semi-colon. e.g.[email protected];[email protected]. Once the settings are complete, you can click theTest buttonto see if the recipient received the test email. If you have any issues sending emails, it\u2019s likely anSMTP configuration error, and you can review our articleTroubleshooting SMTP Email Report Sending When Using Patch My PC. Once the SMTP settings are saved, the Publisher will automatically send an email at the end of each synchronization whenany updates or applicationshave been published. The email will include the following details for all Published products: Update/ApplicationTitle(Links to release notes) Timeof Publishing Sizeof binary UpdateClassification UpdateSeverity Level CVE\u2019s(Links to CVE-ID onhttps://cve.mitre.org/) In the example below, you can see an email alert where bothupdates and applicationswere published toWSUS & ConfigMgr. In the example below, you can see an email alert where bothUpdates and Applicationswere published toIntune For products published toIntune, The email will include the following additional information Intune Tenant friendly name Intune assignments set during Publishing. How do Alerts Work in Microsoft Teams and Slack? Another option for Alerts is to use aMicrosoft Teams Webhookor aSlack Webhook. The Teams or Slack webhook will allow the Publisher tosend a message into a Teams or Slack channeleither as each update or application is publishedin real-timeor a single message at the end of the synchronization. Note:Microsoft announced the end of support for traditional Office 365 Connectors. You can read more about this announcment and how it affects Patch My PC alerts athttps://patchmypc.com/migrating-from-office-365-connectors-to-the-workflows-app Customers are encouraged to migrate existing webhooks of theMSTeams\u201cMessage System\u201d type to theMSTeamsWorkflow\u201cMessage System\u201d type beforeDecember 2024.Migration of existing webhooks is covered below in the sectionHow to Update Existing Microsoft Teams Webhooks to Support Microsoft Teams Workflows. Note:TheMSTeamsWorkflow \u201cMessage System\u201d type is supported inPatch My PC Publisher version 2.1.27.0or higher. How to Create a Microsoft Teams Webhook URL Before you can send Microsoft Teams alerts, you need to create a Microsoft Teams Workflow to obtain a valid webhook URL. IMPORTANT The account being used to create the Teams Workflow must be a member of theTeam > Channelwhere you want the Patch My PC notifications to appear. The notification will include the name of the person who created the Teams Workflow. You cannot omit the name from the notification. This is by design from Microsoft. Please follow the steps below tocreate an incoming webhook URL: Open Microsoft Teams and navigate to the Channel where you want to receive Webhook Notifications. Click the More Options button\u2026and selectWorkflows. SelectPost to a channel when a webhook request is received. Allow a moment for the template to load, it can take a minute or two. ClickNext. Allow a moment for the details tab to load to verify which Team and Channel the webhook URL will be created for and clickAdd workflow. Click thecopy iconto copy the webhook URL to your clipboard and clickDone. In the Patch My PC Publisher, navigate to theAlertstab and in Webhook Settings clickAdd. Add aLabeland paste the Workflows URL obtained in Step 7 into theWebhook URLbox. Configure additional settings for the alert too. ClickOkto save the webhook and clickTestto ensure the newly configured webhook is received to the Microsoft Teams channel. Consideration for Private Channels In Microsoft Teams, bots, including those created via Power Automate (Flow), can interact with channels to provide automated responses, notifications, and other functions. However, posting messages as a Flow bot to a private channel presents a challenge because of permissions restrictions that exist within the Teams platform. A private channel in Teams is a more restricted environment compared to a standard channel. Only members who are specifically added to the private channel can access it and interact within it. To ensure the workflow can post to a private channel, you need to edit thePost Asvalue for the Flow. 1. Navigate tohttps://make.powerautonmate.com 2. Find the Workflow(s) used for Teams notifications in the Private Channel and clickEdit. 3. Select the step in the flow chart namedPost card in a chat or channel. 4. Modify thePost Asvalue and change it fromBottoUser. 5. ClickSave. How to update existing Microsoft Teams webhooks to support Microsoft Teams Workflows Microsoft announced that Office 365 connectors are being deprecated. You can read the full post athttps://devblogs.microsoft.com/microsoft365dev/retirement-of-office-365-connectors-within-microsoft-teams/ To prepare for this change, Patch My PC now supports the Microsoft Teams Workflows app which is Microsoft\u2019s recommended alternative to using Office 365 connectors to generate webhook URLs to receive notifications in Microsoft Teams. Workflows only support the \u201cAdaptive Message Card\u201d format. Legacy webhooks created in the Patch My PC Publisher use the \u201cMessage Card\u201d format. Note:Patch My PC Publisher version 2.1.27.0or higher is required to update legacy webhooks to support Microsoft Teams Workflows. Which webhooks should I update? Any webhook configured with theMSTeams\u201cMessage System\u201d(2)in the Publisher should be updated to theMSTeamsWorkflow\u201cMessage System\u201d(1)type. To update an existing webhook to the new format:- Follow the steps outlined inHow to Create a Microsoft Teams Webhook URLto generate a new webhook URL for a Microsoft Teams Workflow. Highlight the webhook and clickEdit. Change theWebhook ProviderfromMicrosoft Teams (Legacy Webhook)toMicrosoft Teams Workflow. Replace the existingWebhook URLwith the one obtained by completing Step 1 above. ClickOk IMPORTANT:The table formatting in the adaptive card for Teams may appear misaligned or incorrect unless thePost Asparameter in the flow action is set toFlow Bot. How to Create a Slack Webhook URL Before you can send Slack alerts, you need tocreate an incoming webhook: Please follow the steps below tocreate an incoming webhook URL: On the following web pagehttps://api.slack.com/messaging/webhooks, selectCreate your Slack app(note: you will need to be logged into your Slack account and, depending on your settings, you may need to be a Workspace Owner of the account) SelectCreate an App > From Scratch.Enter an app name, choose your workspace, and then selectCreate App SetActivate Incoming WebhookstoOn SelectAdd New Webhook to Workspace Choose the channel you want to post to and then selectAllow Copy the Webhook URL andPastethe URL into the Webhook URL in the Publisher and click theTest button In the Patch My PC Publisher under theAlertstab, selectAddin theWebhook Settingssection In the Notification Webhook Configuration window, enter a Label for your webhook, setWebhook ProvidertoSlackandPastethe URL into theWebhook URLfield. ClickOKwhen done Click theTestbutton You should see thetest messagesent in the Slack channel you selected Custom Options for Teams and Slack Webhooks You can configure the webhook notifications for Teams or Slack in theNotification Webhook Configurationwindow. To view the Notification Webhook Configuration selectAddorEditunderWebhook Settings. When the option \u201cSend alerts as each product is published rather than waiting until the end of the synchronization.\u201d is enabled, the Publisher will send a messagein real-timeright after each update or application is published. When this option is enabled, the message will include more detailed information about each update, including: Update/ApplicationTitle(Links to release notes) Timeof Publishing Sizeof binary UpdateClassification UpdateSeverity Level CVE\u2019s(Links to CVE-ID onhttps://cve.mitre.org/) Below is an example of the individual notification in Teams. When the option \u201cSend alerts as each product is published rather than waiting until the end of the synchronization.\u201d isdisabled, the Publisher will only send a summary of updates and applications published at theend of the synchronization. This option willonly include the nameof the update or application and link to the release notes. Below is an example of the Teams summary notification. You can choose thenotification level in the Notification Webhook Configuration window. The levels include receivingAll,Error, orSuccess. This option can be helpful if you want a specific channel to only receive alerts if an update or application fails to publish. In theWebhook Scopesection you can scope the product type you want for the alerts. You can also scope out alerts by specific products with theProduct Selectionsection. Note:When theSummary optionis enabled, notifications can be truncated if they are too long. This is due to Teams and Slack specifications. Since we can\u2019t send long notifications to Teams or Slack, you will need to enableSMTP Settingsto receive a full email report. If email reports are not enabled, you will need to fall back to the log file for more information on any error messages. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-policy-limit-considerations/", "title": "Policy Size Limit Intune Applications Update", "raw_text": "Intune Policy Size Limit Considerations In this article, we will discuss the existing limits on Intune Policy as it relates to Win32 application assignments. With these limits in mind, we can better plan the deployment of Intune Applications and Updates. Identify If You Are Hitting Policy Size Limit Reducing Policy Size Identify If You are Hitting Policy Size Limit For most of our customers, the policy size limit will not be an issue. The policy for the Win32 applications in Intune includes the PowerShell Detection and Requirement scripts for the application.The more applications you have assigned to any given device, the larger that policy will be. The most immediate affect of exceeding the policy limit isthe client will stop processing application policies from Intune. To quickly identify if you are running into policy size limits you can check the two logs below. %ProgramData%\\Microsoft\\IntuneManagementExtension\\Logs\\IntuneManagementExtension.log %ProgramData%\\Microsoft\\IntuneManagementExtension\\Logs\\IntuneManagementExtension.lo_ Within these logs, you can look for a line that starts with the below snippet. Failed to get the app policy from service, exception is System.ArgumentException: Error during serialization or deserialization using the JSON JavaScriptSerializer. The length of the string exceeds the value set on the maxJsonLength property\u2026 It is likely a large Base64 encoded JSON payload will be shown as well, such as below. Note:If you are hitting the policy limit the client will not be able to process application assignments. Reducing Policy Size There are a few options to consider when you need to reduce the total policy size your clients receive from Intune. Applications vs. Updates The largest part of any given Win32 application\u2019s policy is the scripts associated with it. For the Win32 Applications, this will be theDetection Script. For the Updates that the Publisher creates there will be aDetection Scriptand aRequirement Script. Because the Updates have two scripts they will inherently consume more space in the policy payload. Code Signing Within the Publisher the option to \u2018Digitally sign the detection method script\u2026\u2019 is provided as shown below. When a script is digitally signed it willadd approximately 10kb to the total script size. This does not seem like a lot, but for Intune Policy this is a very significant amount of overhead. Keeping in mind thatIntune Updates will have policy containing two scriptswhen these are signed the policy per-app increases by approximately 20kb. Note:In our testing, a device was able to have80-90 Intune Updates assignedwithout hitting the policy limit while having code signing enabled. With code signing disabled a device could haveover 300 applications assigned as Intune Updateswithout hitting the policy size limit. Number of Assignments With code signing, and the type of Win32 Application in mind the final consideration is the number of assignments.The larger the number of assignments to any given device the larger the policy will be for that device when it requests it from Intune. The business will need to determine their security requirements around code signing, and what applications they desire to update. The Publisher does have anIntune Scan Toolthat can assist in identifying products that exist on your Intune managed devices, but it does have limitations based on what is available via Microsoft Graph such as only MSI based applications being inventoried. Alongside identifying what software your devices have, you can leverage tools likeMicrosoft Defender Advanced Threat Protectionto identify known vulnerabilities and CVEs on your devices. This can provide a good pointer to applications which should be updated. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/updates-fail-download-adr-error/", "title": "Configuration Manager updates errors, Proxy issues, ADR failures", "raw_text": "Updates Fail to Download in ADR with Error HttpSendRequest failed 0x800701f6 or 0x800701f7 or 0x80070193 In this KB article, we will be reviewing a scenario where third-party software updates may fail to download to a Configuration Manager deployment package when using and automatic deployment rules (ADR). What Causes Error HttpSendRequest failed 502 / 0x800701f6 or 503 / 0x800701f7or 403 / 0x80070193? First, we will dig into the conditions where this issue is most likely to occur. Here are the conditions that may cause this issue to occur: 1. Aproxy is configuredon thesoftware update point site system: 2. The software update point site system is set to use the proxy forautomatic deployment rules content downloads: 3. Theproxy server being useddoesn\u2019t have access to download content from theinternal WSUS server. The third-party software updates are downloaded from theinternal WSUSserver. You can see download information in the following logs for ADRs (RuleEngline.logandPatchDownload.log). In thePatchDownloader.logyou can see the proxy details as well, This will cause an issue when the proxy doesn\u2019t have access to theinternal WSUS server. This is common for proxies that areinternet-basedor even internal proxies thatdon\u2019t allow access or route to internal servers. When the proxy can\u2019t resolve the internal WSUS server, you will often receive an HTTP response error such as: HttpSendRequest failed 502ERROR: DownloadUpdateContent() failed with hr=0x800701f6 OR: HttpSendRequest failed 503ERROR: DownloadUpdateContent() failed with hr=0x800701f7 OR: HttpSendRequest failed 403ERROR: DownloadUpdateContent() failed with hr=0x80070193 Note:The actual error code can vary depending on the proxy configuration. Improvements in Configuration Manager 2002 for Proxies and ADRs This proxy issue was becoming a very common issue with our customers and causing a lot of support cases. We submitted a Configuration Manager UserVoice request:Add Option to Bypass Proxy for Local Address for ADR Content Downloads, and the product group for Configuration Manager made some improvements in build 2002. If the update is published using the WSUS servershostname only and not the FQDN, thePatchDownloadercomponent used for ADR downloads will bypass the proxy. If the download URL for the third-party update is using theFQDN of the internal WSUS server, the proxy will still be used and the downloads will fail if the proxy server can\u2019t access that internal WSUS server URL. After working with the product group, the FQDN is generally used whenWSUS is configured to use SSL. Workaround for Proxy Issue when Using HTTPS WSUS If the improvements in Configuration Manager 2002 don\u2019t resolve your issue due toWSUS using the FQDN, you have another workaround to allow the content to be automatically downloaded. The resolution is to configure the ADR to download the content from theWSUSContent UNC sharerather thanusing the WSUS content URL. Unfortunately, you canonly configure the download location for an ADR is during the initial creation. You are unable to change the download location in the properties of a previously created ADR within the Configuration Manager console. By default, yourWSUSContentfolder should be shared automatically. The WSUSContent folder is the same folder the WSUS website uses for third-party update content downloads. When this setting is enabled, it will allow the ADR to completelybypass the proxyand search the UNC share directly without any HTTP request or proxies. This should resolve the issue if it\u2019s related to a proxy, not allowing traffic to the internal WSUS server. If you have an existing ADR that was configured with the options \u201cDownload software update from the Internet\u201d it is possible the update that existing ADR using a PowerShell cmdlet. Here\u2019s an example of the command you can copy and paste. You will need to update the-nameand-locationparameter to match your environment. Set-CMAutoDeploymentRule -name \"Patch My PC Software Updates\" -location \"demo1WsusContent\" -DownloadFromInternet $false Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/logging-options/", "title": "Logging Options, Troubleshooting, Collection, Patching", "raw_text": "Patch My PC Publisher Logging Options The Logging Options section of the publisher is where you can access helpful logs to view for more detailed information. Collect Logs The Collect Logs button allows you to quickly collect the relevant server-side logs that we need to do further troubleshooting. To collect the logs: Click on theCollect Logsbutton in the Publisher Pick a Folder where you want to save the logs to a ZIP file will be created in that location containing the relevant server-side logs needed for troubleshooting. You can then send that ZIP file using ourtechnical support form. Open PatchMyPC.log Select this button to open thePatchMyPC.logfile. This log is helpful for viewing detailed information relevant to the Patch My PC publisher. If you have CMTrace installed, and it is set to be your default log viewer, the log will open in CMTrace. Otherwise, it will open in Notepad. You can also access the log in the PatchMyPC Install Directory. Open wsyncmgr.log If you are using the publisher with ConfigMgr and your Software Update Point is on your Primary Site Server, you can access thewsyncmgr.logby selecting the option on the General tab. This is helpful to view the status of a Software Update Point synchronization for any new third-party updates. Note:If your Software Update Point is remote from your Primary Site or if you are using the Publisher for an Intune only environment, you will not see theOpen wsyncmgr.logbutton under theLogging Optionssection. Logging Level In theLogging Levelsection you can choose betweenInformationandDebuglogging for the PatchMyPC.log file. By default, Information logging will be selected. EnablingDebug loggingcan be helpful when troubleshooting unique issues with publishing. Logs to Retain:This is the number of the PatchMyPC.log files that will be retained. The maximum number you can set here is 10. Max Size in MB:This is the maximum size for the PatchMyPC.log. When the max size is reached a new PatchMyPC.log will be created. The maximum number you can set here is 10. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/minimum-permissions-required-publisher-scan/", "title": "Minimum Permissions Required, SCCM Database, SQL Server", "raw_text": "Minimum Permissions Required for Publisher to Scan SCCM Database For the Publisher to use theScan SCCM for Management Applicationsfeature, you will need to ensure the user or SYSTEM has rights to the SCCM SQL database. This article describes theminimum permissionsrequired to scan the SCCM database for installed applications from the Patch My PC Publisher. If you have the appropriate SQL permissions to the SCCM database, you should see scan results that look similar to below: Topicscovered in this article: Unable to Connect to the SCCM Database? SQL Permissions Required to Run SCCM Application Scans? Manually Add Permissions Using SQL Management Studio Unable to Connect to the SCCM Database? In the event, you receive the error \u201cUnable to connect to the SCCM database.\u201d you will need to review the information below. Here\u2019s the error you will receive if you don\u2019t have the appropriate permissions. In the PatchMyPC.log, you will also see the following information. Failed to connect to the WSUS database: Login failed for user \u2018CONTOSOuser\u2019. SQL Permissions Required to Run SCCM Application Scans? When we run the SCCM Application scan, it\u2019s a direct SQL Query and does not go through the SMSProvider. The SQL query allows for better performance but may require to you give account(s) permissions to the SCCM database using SQL Server Management Studio. If the query fails, you will need to perform the following steps to add the user or computer account in SQL Server. The first option is some SQL code that you can edit, and run as a SQL query, and the second option is the manual steps to add the user, and permissions. First Option \u2014 Replace CM_PR1 with the database name for your Configuration Manager environmentUSEGO \u2014 Replace CONTOSOServerName$ with the appropriate value for your environmentDECLARE @UserName nvarchar(128) = \u2018CONTOSOServerName$\u2019 DECLARE @QuotedUserToGrant nvarchar(128) = QUOTENAME(@UserName); IF NOT EXISTS(SELECT principal_id FROM sys.server_principals WHERE name = @UserName) BEGINDECLARE @LoginSQL as varchar(500);SET @LoginSQL = \u2018CREATE LOGIN \u2018+ @QuotedUserToGrant + \u2018 FROM WINDOWS\u2019;EXEC (@LoginSQL);END IF NOT EXISTS(SELECT principal_id FROM sys.database_principals WHERE name = @UserName) BEGINDECLARE @UserSQL as varchar(500);SET @UserSQL = \u2018CREATE USER \u2018 + @QuotedUserToGrant + \u2018 FOR LOGIN \u2018 + @QuotedUserToGrant;EXEC (@UserSQL);END DECLARE @PermissionsSQL as varchar(500);SET @PermissionsSQL = \u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrant +\u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrant +\u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrant +\u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrant +\u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrant +\u2018GRANT SELECT ON . TO \u2018 + @QuotedUserToGrantEXEC (@PermissionsSQL); Manually Add Permissions Using SQL Management Studio From SQL Server Management Studio, clickNew Login\u2026 Add the account you need to grant permissions to in SQL Server. In the event, you need to add a computer account such as a remote WSUS server enter it as $. Note:when you run the Query in the UI directly, the scan is performed under thecurrent user context. In the event you enable automated product scanning highlighted below, the query is executed underSYSTEM contextusingWSUS server\u2019s computer account. You can leave thepublicaccess only under theServer Rolestab and click OK. Under theUser Mappingtab, you need to check the SCCM database and enable thepublicdatabase role membership. Next, you need to grant the account you addedSelectpermissions on the the following SQL views within the Configuration Manager database: v_Add_Remove_Programs V_GS_ADD_REMOVE_PROGRAMS v_GS_ADD_REMOVE_PROGRAMS_64 v_GS_INSTALLED_SOFTWARE Right click on each view and clickPropertiesand grantSelectpermissions. If collection filtering is used, permissions will also need to be enabled on the following views as well: v_FullCollectionMembership v_Collection Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/firefox-esr-not-in-catalog/", "title": "Firefox ESR, Mozilla, Application Catalog, Updates", "raw_text": "Why is the newest version of Firefox ESR not available in the Application Catalog? Symptoms When looking in the Patch My PC Application Catalog, why do I see an older version of Firefox/Thunderbird ESR listed compared to what is available according to theRelease Noteson the Mozilla website? Cause This issue occurs because Mozilla keeps two versions of the Extended Support Release (ESR) version of Firefox/Thunderbird live for three-point releases whenever they issue a major ESR release: An older stable version. A newer version that is potentially unstable but can be rapidly stabilized by Mozilla as issues are resolved. Resolution As Mozilla officially supports both versions, they provide the same vulnerability patches to both versions until they reach their end of life. However, adding newer ESR versions of Firefox/Thunderbird every time Mozilla releases them would significantly increase the number of Firefox/Thunderbird updates in our catalog and potentially introduce complicated applicability considerations. We could add the newer unstable ESR versions as separate products, but these would only be valid during this 3-month transition period. Therefore, at Patch My PC, we have decided only to publish the stable ESR versions of Firefox/Thunderbird, as we assume customers choosing the ESR release are doing so for its stability benefits. Note:For Firefox 115, Mozilla has extended the support ONLY for Windows 7 and 8.1. However, Patch My PC has decided to move up to ESR 128 early October 2024. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/error-process-not-background-processing/", "title": "SCCM, WSUS, SSL, Download", "raw_text": "Error: The process is not in background processing mode. ERROR: DownloadContentFiles() failed with hr=0x80070193 When attempting to download third-party software updates into an SCCM deployment package, you receive the following error message in the console:Failed to download content id . Error: The process is not in background processing mode. If you review thePatchDownloader.log file for ADR\u2019sorPatchDownloader.log when downloading using the console, you will see errors similar to the errors listed below: HttpSendRequest failed HTTP_STATUS_FORBIDDEN or HTTP_STATUS_DENIED ERROR: DownloadContentFiles() failed with hr=0x80070193 Why Does ERROR: DownloadContentFiles() failed with hr=0x80070193? This error occurs when the WSUSContent virtual directory is configured to require SSL. In Internet Information Services (IIS) Manager, click theWSUS Administration website, click theContentvirtual directly, then clickSSL Settingsin the right pane. If Require SSL is checked,uncheckthat option and choose toapplythe changes The WSUSContent virtual directly in IIS should not be configured to Require SSLeven if your WSUS server is configured in SSL. Please see the following Microsoft documentation for more details:How to Configure the WSUS Web Site to Use SSL If this was your issue, third-party updates should now successfully download to an SCCM deployment package. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-catalog-error-12045-0x80072f0d/", "title": "SCCM, Third-party, Update, Catalog", "raw_text": "Adding Third-Party Software Update Catalog Fails with Error 12045 / 0x80072f0d in SCCM We have seen an increase of customers receiving failures when attempting to subscribe to our third-party update catalog in the third-party software updates catalog node of the Configuration Manager console. In this scenario, the console will return an error that says something similar toUnable to create the subscription. The console failed to download from because of error code 12045. For more information, see SmsAdminUI logfile. When you click the option toSubscribe to Catalogin the Configuration Manager, the console will attempt to download the catalog file from the URL you entered in the catalog URL. To better understand the error 12045, we need to review the patchdownloader.log within the %temp% folder of the user running the Configuration Manager console. If you review thepatchdownloader.log, and you see errors similar to that shown below: HttpSendRequest failed 12045, can still rety for 3 timesFileHash value is NULL. Hash verification for this file will not be performed.ERROR: DownloadContentFiles() failed with hr=0x80072f0d In this scenario, theerror code 12045is actually a generic code from patchdownloader.log. The actual information that will provide value for troubleshooting is the logline:ERROR: DownloadContentFiles() failed with hr=0x80072f0d In the CMTrace.exe tool, you can click Control + L to perform an error code lookup. Error code 0x80072f0d translates to Winhttp error:The certificate authority is invalid or incorrect On the server running Configuration Manager Console or the Patch My PC Publisher tool, open upInternet Explorerand navigate tohttps://patchmypc.com/. In the address bar, check the certificate lock to see if the SSL certificate is trusted. Click thelock iconthen clickView certificate Click the Certificate Path and validate the certificate for patchmypc.com is trusted. The Winhttp error0x80072f0d,generally means the root certificate that issued the SSL certificate for the website the HTTP download connection is being made to is not trusted. Forpatchmypc.com, we use a common public certificate authorityDigiCert. If this certificate isn\u2019t trusted, you will need to import all the issuing certificates into theTrusted Rootcertificate store on the computer, Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/missing-cab-update/", "title": "Associating cab files, WSUS, ConfigMgr, Error codes", "raw_text": "Associating a missing cab file to an Update In this article we outline how to associate a missing cab file from the WSUS Content folder with an Update in WSUS/ConfigMgr. Often an ADR will display the error code 0x87D20417 after evaluation and missing content is often the cause. Alternatively, manually trying to download missing update content in ConfigMgr might present the error \u201cError: Failed to download content id xxxxxx. Error: The cloud file provider exited unexpectedly\u201d. It might be a single update that is missing content that will cause the rule engine to throw this error. Identifying the update and declining or re-publishing it is the way to resolve the error. This article will help you identify which update your should decline or re-publish. Note:Additional troubleshooting help for error code 0X87D20417 and 0X80070194 can be found in the following KBAutomatic Deployment Rule Error 0X87D20417 or 0x80070194 \u2013 Patch My PC Determine if you are affected When you attempt to download update content in ConfigMgr, you may encounter the following error. Scenario 1: Using an Automatic Deployment Rule (ADR) The ADR will display the error code 0X87D20417 \u201cAuto Deployment Rule download failed\u201d. Additionally, RuleEngine.log will display the following error. Failed to download the update content with ID xxxxxxxx from internet. Error = 404Failed to download ContentID xxxxxxxx for UpdateID xxxxxxxx. Error code = 404Failed to download any updateFailed to download update contents.Failed to run the DownloadAction for the AutoDeployment.STATMSG: ID=8706 SEV=E LEV=M SOURCE=\u201dSMS Server\u201d COMP=\u201dSMS_RULE_ENGINE\u201d SYS=CM.constoso.LOCAL SITE=CM1 PID=3520 TID=8116 GMTDATE=Mon Oct 14 08:21:46.082 2024 ISTR0=\u201dSMS Rule Engine\u201d ISTR1=\u201dFailed to download one or more content files\u201d ISTR2=\u201d\u201d ISTR3=\u201d\u201d ISTR4=\u201d\u201d ISTR5=\u201d\u201d ISTR6=\u201d\u201d ISTR7=\u201d\u201d ISTR8=\u201d\u201d ISTR9=\u201d\u201d NUMATTRS=0 LE=0X0 Additionally, PatchDownloader.log will display the following. HttpSendRequest failed HTTP_STATUS_NOT_FOUNDERROR: DownloadUpdateContent() failed with hr=0x80070194 Scenario 2: Manually downloading the Software update The download software updates wizard will display the following message \u201cError: Failed to download content id xxxxxx. Error: The cloud file provider exited unexpectedly.\u201d Additionally, PatchDownloader.log will display the following. HttpSendRequest failed HTTP_STATUS_NOT_FOUNDERROR: DownloadUpdateContent() failed with hr=0x80070194 Identify a missing update file name PatchDownloader.log reveals the name of the content that was not found. Look for a line containg \u201cContentsource =\u201djust before the log line where the download fails. In the example above, the missing cab file is called316611FD021A120AE9FC6A3534A56DF7656F61F5.cab We can verify if the content is missing by browsing to the URL for the content and getting the same 404 status message. Manually match the missing content to an Update PatchDownloader.log reveals the name of the content that was not found. Look for a line containg \u201cDownload destination =\u201djust before the log line where the download fails. In the example above, theDownload destination = cm2.lab2.localPackagesPMPC_Updatescdbaf35-3ffd-4e3a-a8d9-c14ebea7173b.132b7c379-3210-4b61-abe4-cdcfb04284ff_1.cab ConfigMgr attempts to download the update content into a sub folder in the package root directory. The sub folder name is also the Update ID. In the example above, the Update ID is:- cm2.lab2.localPackagesPMPC_Updates0cdbaf35-3ffd-4e3a-a8d9-c14ebea7173b.132b7c379-3210-4b61-abe4-cdcfb04284ff_1.cab Note: Revision information is suffixed to the folder name and this can be ignored. The Update ID from the example above is:- 0cdbaf35-3ffd-4e3a-a8d9-c14ebea7173b Note:You should identify all the missing .cab files referenced in PatchDownloader.log and record the ContentSource URL. We will use the URL(s) and .cab name(s) in the following steps. Use SQL Server Management Studio to match the missing content to an update Once you have gathered a list of the missing cab file(s) in the previous step, you can run a query in SQL Server Management Studio (SSMS) to match the content to an update in the WSUS database. 1. Open SSMS 2. Select \u201cNew Query\u201d 3. Enter the following query:- \u2014 Create a temporary table to store the CAB file names as stringsCREATE TABLE #TempCabFiles (FileDigestString NVARCHAR(100)); \u2014 Insert CAB file namesINSERT INTO #TempCabFiles (FileDigestString)VALUES(\u2018316611FD021A120AE9FC6A3534A56DF7656F61F5.cab\u2018),(\u2018F2186E510EA4BD76B93FFBBD686D50D9769F3351.cab\u2018); \u2014 Create another temporary table to store the binary representationCREATE TABLE #TempCabFilesBinary (FileDigest VARBINARY(20)); \u2014 Insert values into the binary table, dynamically removing .cab andconverting to varbinaryINSERT INTO #TempCabFilesBinary (FileDigest)SELECT CONVERT(VARBINARY(20), REPLACE(FileDigestString, \u2018.cab\u2019, \u201d), 2)FROM #TempCabFiles; \u2014 Use the SUSDB database (assuming this is where your data is stored)USE SUSDB; \u2014 Query to match the CAB files and display binary values as hex stringsSELECT pu.DefaultTitle,u.UpdateID,f.FileDigest,sys.fn_varbintohexstr(f.FileDigest) AS FileDigestHex,f.FileNameFROM tbFile fINNER JOIN tbFileForRevision fr ON f.FileDigest = fr.FileDigestINNER JOIN tbRevision r ON fr.RevisionID = r.RevisionIDINNER JOIN tbUpdate u ON r.LocalUpdateID = u.LocalUpdateIDINNER JOIN PUBLIC_VIEWS.vUpdate pu ON pu.UpdateId = u.UpdateIDWHERE f.FileDigest IN (SELECT FileDigest FROM #TempCabFilesBinary); \u2014 Drop the temporary tablesDROP TABLE #TempCabFiles;DROP TABLE #TempCabFilesBinary; If querying a single .cab file, the single list item should have a semi-colon appended, indicating the end of the list of values. e.g.(\u2018F2186E510EA4BD76B93FFBBD686D50D9769F3351.cab\u2018); If querying multiple .cab files, each list item should be seperate by a comma and the last list item should have a semi-colon appended, indicating the end of the list of values. e.g.(\u2018316611FD021A120AE9FC6A3534A56DF7656F61F5.cab\u2018),(\u2018F2186E510EA4BD76B93FFBBD686D50D9769F3351.cab\u2018); The Results pane will indicate which updates were associated with the missing cab file(s). Use ConfigMgr to match the missing content to an Update Once you have gathered a list of missing cab file(s) in the previous step, you can run the following ConfigMgr SDK cmdlet to match the missing content to an update. 1. From the ConfigMgr console, choose toConnect via Windows PowerShell 2. Define a PowerShell list containg the URL(s) of the missing content referenced in PatchDownloader.log. e.g. $sourceURLs = @(\u2018http://sus01.lab2.local:8530/Content/F5/316611FD021A120AE9FC6A3534A56DF7656F61F5.cab\u2019, \u2018http://sus01.lab2.local:8530/Content/51/F2186E510EA4BD76B93FFBBD686D50D9769F3351.cab\u2019) Run the following snippet (This is a single line PowerShell command). $updateIds = Get-CMSoftwareUpdate -fast | Where-Object { $_.LocalizedCategoryInstanceNames -match \u201cSCUP Updates\u201d } | Select-Object -ExpandProperty CI_ID; $CMPSSuppressFastNotUsedCheck = $true; $updateIds | ForEach-Object { $fullUpdate = Get-CMSoftwareUpdate -Id $_; $sdmPackageXml = $fullUpdate.SDMPackageXML; $updateId = $fullUpdate.CI_UniqueID; $sourceUrl = $sdmPackageXml.DesiredConfigurationDigest.SoftwareUpdate.ConfigurationMetadata.Provider.Operation.Content.FileContent.SourceURL; if ($sourceURLs -contains $sourceUrl) { $fullUpdate | Select-Object LocalizedDisplayName, @{Name=\u2019UpdateId\u2019;Expression={$updateId}}, @{Name=\u2019SourceURL\u2019;Expression={$sourceUrl}} | Format-List } }; $CMPSSuppressFastNotUsedCheck = $false The output will list the Update(s) and Update Id(s) for the missing content. Find the Update and Decline or Re-Publish Now that you have identified the update(s) with missing content, you can find them in the ConfigMgr console by searching for the Unique Update ID. If this is the latest version of the update available in the Patch My PC catalog, you can simplyre-publish the updateto restore the missing content in the WSUS Content folder. If this is an older version of an update or you no longer need it because it is the reason your ADR is failing, you should decline it from WSUS via the Patch My PC Publisher using the following steps. 1. Open the Publisher. 2. From the \u201cUpdates\u201d tab, click \u201cOptions\u201d. 3. Click \u201cRun Wizard\u201d. 4. Search for and select the update(s) with missing content and clickDecline. 5. Perform a Software update Polint Sync for the update to be marked as expired in ConfigMgr. 6. Re-run the failed ADR(s). Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/local-content-repository-licensed-applications/", "title": "Local Content Repository, Licensed Applications, Manual Download", "raw_text": "Local Content Repository for Licensed Applications that Require Manual Download Thelocal content repositoryis used for licensed products in catalogue where there is no public download available due to apaywall loginand also when the vendor uses a compressed file for its installer. This article handles how we handle products that require you tomanually download. Note:the local content repository is for publishing products in our catalog. To see products available in our catalogue, seeSupported Products. To publish products not available in our catalog, seeCustom Apps. Products that Require Manual Download to the Local Content Repository The following products currently require a manual download of the installer files due to apaywall portal, filedownload format,or forEULAreasons: Important:If Oracle JRE or JDK is enabled, you need to download the binaries from theJava SE Downloadspage instead of the Oracle portal. If you download from the Oracle licensing portal, the hash of the binary will be different from our catalog. How the Local Content Repository Works when Using Patch My PC\u2019s Publisher When you enable a product that requires a manual download, you will receive the following message when you clickApply. This message will let you know you need to configure the folder in theAdvanced tabthat our publishing service will use to search for installers that are required for enabled products where the download can\u2019t be performed directly online. The folder you define in theLocal Content Pathwill be the location the publishing service searches through when attempting to publish third-party updates. You will need to download the EXE or MSI installer for products that require manual downloads. In the example above, we defined a UNC path of \u201csccm\\sourcesSoftware UpdatesThird-Party-Updates-Local-Repository\u201c. In this folder, the Java installer files forJava 8 Update 211have been downloaded as shown below.Note:if you use a UNC path, the computer account of the server running the publishing service will needread and modify permissions. We highly recommend enabling email notifications from theAlertstab. If we areunable to locate the installer fileduring a publishing attempt, you will receive an email listing the specific updates that need to be manually downloaded as well as the expected file name. These emails are especially helpful because they will let you know when action is required on your part to download installers when new updates are available for licensed products. How the Local Content Repository Works when Using SCCM In-Console Publishing If you are using SCCM 1806+in-console publishingorSystem Center Updates Publisher (SCUP), you cannot define a custom folder for the local content repository. Instead, you need to use the path specified in the catalog metadata. The path used in the catalog metadata for any licensed updates is:LocalHostPatchMyPCRepository To set this path, create a shared folder on the top-level WSUS/SUP server shared as \u201cPatchMyPCRepository\u201c. Once created, simply download any update installers that require manual downloads from the vendors pay portal. In the example below, we downloaded Java 8 Update 211 and Java SE Development Kit 8 Update 211 into the local content repository folder. You can use the right-click option toShow package infoto gather details such as file name, and version which can be helpful in getting the proper content to place in the local content repository. Note:If multiple products have the same file name, e.g. TeamViewer_Full.msi is the file name for TeamViewer MSI x64 & x32, place each installer in a separate subfolder within your Local Content Repository and the Publisher will find the correct file during the sync. How the Local Content Repository Works (Video Guide) Please review the step-by-step video guide for information on how to publish products that require manual download. Compressed Installers Some vendors publish their installers in the compressed file format. Download the compressed installer and extract the EXE or MSI into the Local Content Repository. The folder you define in theLocal Content Pathwill be the location the publishing service searches through when attempting to publish the app or update. Additional Options Available with Local Content Files There are two additional options in the local content repository menu Delete the update file in the local repository after publishing When this option is checked, whenever a product is published using a content file located in the local content repository folder, the file will beautomatically deleted after publishing. Check the local content repository for content files before attempting to download content files from the internet. When this option is checked, all content files that would typically be downloaded from the internet will first check if the file exists in the local content repository. If the file exists in the local content repository, it will use thelocal filerather thandownloading it from the internet. This option may be helpful is the server is unable to download the content for certain products directly from the internet. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/underlying-connection-was-closed-could/", "title": "Error, Trust, Certificate, Download", "raw_text": "The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. The download error \u201cCould not establish trust relationship for the SSL/TLS secure channel\u201dis generally related to your machine not trusting the website\u2019s rootCertificate Authority. We are generally pretty limited in the amount of support we can provide for issues related toweb filters,firewalls,proxies,certificate trust, or othernetwork-related errors. However, our resolution below will generally help diagnose and resolve this specific error. Determine if you are affected If affected, you will see an error similar to below in one of the following log filesPatchMyPC.logorSMS_ISVUPDATES_SYNCAGENT.log,dependent on the publishing method you are using. WebClient report an error during download: The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel.An error occurred while downloading the file: The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. This error is usually because theRoot Certificate authorityissuing theSSL certificateisnot trustedon your device. Possible cause 1: Validate the website\u2019s TLS/SSL certificate is trusted A common reason you may receive the errorCould not establish trust relationship for the SSL/TLS secure channelis because the SSL certificate isn\u2019t trusted. On the machine receiving the error, browse to the URL from the log file for the download failing with this error using Internet Explorer running as NT AUTHORITY\\SYSTEM. Important: The Patch My PC Publisher uses the same .NET Framework classes as Internet Explorer to download content from the Internet. The default identity of the service is also NT AUTHORITY\\SYSTEM. It may be possible you have different Internet access control policies applied between users and computers in your environment. Performing this test in a different browser or as another identity may produce different results. A common reason you may receive the errorCould not establish trust relationship for the SSL/TLS secure channelis because theSSL certificate isn\u2019t trusted. If the SSL certificate is not trusted, you will need toinstall the SSL certificate\u2019sroot certificate. For more details about this process for many common published certificate authorities, please review this articleSSL Certificate Not Trusted Error. Possible cause 2: The request was aborted: Could not create SSL/TLS secure channel. The issue could also be related to the following: Firewall or proxy TLS/SSL cipher availability (limited by hardening policies or Operating System availability) To troubleshoot the above items, please see the following article:The request was aborted: Could not create SSL/TLS secure channel. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-signing-certificate-deployment-ci/", "title": "WSUS Certificate Deployment, Configuration Item", "raw_text": "WSUS Signing Certificate Deployment within Configuration Manager Deploying the WSUS Code Signing Certificate Within Configuration Manager Using a CI In this article, we will cover how aWSUS signing certificate,or other code-signing certificates can be deployed to your Configuration Manager clients by using aConfiguration Item. A code-signing certificate is a core component in Third-Party Patching. The certificates private key is used to sign the CAB files that will be published to WSUS, and ultimately installed on clients. The client musttrustthis certificate and thecertificate chain. There are use cases where deploying this certificate can be useful via Configuration Item as opposed to something likeGPO, or the built-in Client Settings. One that comes to mind is wanting the monitoring that a Configuration Item provides. Below is a step by step showing how a Configuration Item can be created usingthe script attached here. Additionally, there are steps to help gather the required information. Article Outline: Gathering Info Step 1: Create a New Configuration Item Step 2: Create the Associated Compliance Rule Step 3: Associate the CI with a Configuration Baseline Step 4: Deploy the Configuration Baseline Gathering Info The script itself will need to be edited with your specific Thumbprint and Base64 encoded certificate string. The function contained within the script discusses how to gather these values, but I\u2019ll also note them below. Also, if you are comfortable with Configuration Items within Configuration Manager, you can simply grab the script, adjust for your environment, and deploy away! Certificate Thumbprint:Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate.This can also be copied out of the Patch My PC Publisher, as shown below. Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate. This can also be copied out of the Patch My PC Publisher, as shown below. Base64 Encoded Certificate String:This can be acquired a handful of ways, but a simple way is to get a copy of the certificate as a file and run a PowerShell command similar to the belowSet-Clipboard -Value ([System.Convert]::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Set-Clipboard -Value ([System.Convert]::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Step 1: Create a New Configuration Item This process will require creating a new Configuration Item, which can be accessed in the context menu as shown below, or within the ribbon when in the node shown. The CI will return a Boolean value, either$trueor$falsebased on the presence of the specified certificate thumbprint. See below, for example, Discovery, and Remediation implementation. Note Data Type is set to Boolean, and the script is modified between Detection and Remediation. A$Remediatevariable is changed based on the purpose of the script. The$CodeSigningCertificateThumbprintand$EncodedCertStringvariables will also need to be populated and should be the same in both scripts. The below screenshots simply show placeholder text. Step 2: Create the Associate Compliance Rule When creating the Configuration Item, you will also configure a Compliance Rule. The compliance rule is the logic that dictates if the remediation script should run, or if the Configuration Item should return compliant or not. Note that we check the box for\u201cRun the specified remediation script when this setting is noncompliant.\u201dThis option is needed to ensure we can perform remediation. Step 3: Associate the CI with a Configuration Baseline With the CI created, we need to create a Configuration Baseline, which can be accessed in the context menu as shown below, or within the ribbon when in the node shown. Alternatively, you could add this CI to an existing baseline you have in place. See the below wizard for an example of the wizard for creating a Configuration Baseline where we are adding our previously created Configuration Item. Step 4: Deploy the Configuration Baseline Finally! The entire point of this article. What you select within this wizard is ultimately up to you. If you want theactionto happen, you, at a minimum, need the check the\u201cRemediate noncompliant rules when supported\u201dcheckbox. Whether you allow this outside maintenance windows, and on what schedule, targeting which devices etc. are all decisions that will be specific to your organization. Assuming all steps were followed, and the values for the base64 string and thumbprint are valid, you should be able to perform aMachine Policy Evaluation Cycleon a client that is targeted with the deployment, and check the Configurations tab as shown below. Once the Configuration Baseline has evaluated as compliant, the certificate should show in theTrusted Root Certificate Authoritiescertificate store and theTrusted Publisherscertificate store and with no \u2018content\u2019 needed! We can store the certificate as a string, very cool! Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/when-how-republish-patch-my/", "title": "Patch My PC WSUS Updates Republishing Configuration", "raw_text": "When and How to Republish Patch My PC Third-Party Updates In this article, the topic of republishing updates in Patch My PC will be explained in detail. What is Republishing WSUS Updates Republishing an update means the selected update(s) will bepublished to WSUS with a new update ID.This effectively creates an entirely new update. It will appear as a separate item in the WSUS, and in Configuration Manager. More importantly,the update will have a new content path and content hash. As shown below, a republished update will have the name appended with \u2018(Republished on )\u2019. Within the Publisher, we offer an option when republishing an update to supersede \u2018previously published update(s) for these product(s)\u2019, which will be discussed later in this article. ConfigMgr Apps Republishing a ConfigMgr App means that the selected application(s) will have its content recreated and its revision incremented while retaining its package ID. Why Would an Application or Update Need Republishing There are four scenarios that would require an update to be republished. Those scenarios, and the reason the republish is needed, are below. Published updates\u2019 content wasremoved from WSUSContentIf the update\u2019s content is no longer in WSUSContent, then Configuration Manager will fail to download the software update into a Deployment Package with a404 (not found)error. If the update\u2019s content is no longer in WSUSContent, then Configuration Manager will fail to download the software update into a Deployment Package with a404 (not found)error. Aright-click optionis used thatadds content to an updateAdd custom pre/post update installation scriptsAdd MST transformation fileBranding/logo changed forManage conflicting processes\u2026 Add custom pre/post update installation scripts Add MST transformation file Branding/logo changed forManage conflicting processes\u2026 TheWSUS code signing certificate has been updatedRepublishing updates would code sign them with your updated certificate Republishing updates would code sign them with your updated certificate Aright-click optionis selected that wouldadd PatchMyPC-ScriptRunner.exe to the updateAuto close application processes before installationSkip installation when the application is in useDelete desktop shortcut(s) created by this applicationDisable self-updaterManage installation loggingModify command line Auto close application processes before installation Skip installation when the application is in use Delete desktop shortcut(s) created by this application Disable self-updater Manage installation logging Modify command line Note:In scenario 4 above, a republish is only needed for thefirst selected right click optionfrom the list. For example, you right click an update and none of the 6 options listed under scenario 4 are checked.After you check one of them, a republish will be necessary so that the PatchMyPc-ScriptRunner.exe can be added to the update content.Any additional options from the list can then be checkedwithouta republish. This is because additional options are simply a command line update that is an update revision.No additional binary changes are needed once PatchMyPC-ScriptRunner.exe ispresentfor the scenario 4 options right-click options. You can check to see if an update hasScriptRunner.exepresent by looking in the update CAB file in the WSUS content folder. Publisher Notifications Regarding Republishing The Publisher will create log entries and alerts if it detects that updates require republishing. Aloglinewill appear in the PatchMyPc.log file such as the below. Apple iTunes 12.10.8.5 (x64) previously published without custom actions, republish update to receive newly added custom actions. See https://patchmypc.com/faq-scup-catalog#republishing-updates for details on republishing updates. Additionally,if the Teams Alerts are configuredyou will receive a message similar to below. Similarly, if theSMTP based alertsare configured, theemail report will include a noticesuch as below. Receiving any of these alerts, or log entries would indicate that the specified update should be republished. The process for republishing can be found below. How to Republish Updates Once you determine what product(s) meet the criteria described above for requiring a republish operation you canright-click the product, vendor, or all products level and choose the\u2018Republish update(s) for these product(s) during next sync schedule\u2018 You will be prompted to verify that you do want tomark these update(s) for republishing. The popup also includes scenarios for republishing. If you selectYes, you will be prompted to verify if you want tosupersede the currently published updatesfor this product when the new updates are republished. The popup also includes some details on how you can optionally expire those previously published updates. Note:If you select \u201cNo\u201d in the above prompt you willcontinue to receive warningsfrom the Publisher stating that the update could not be revised. To stop these warnings in this scenario you will want to decline the update which is failing to revise using themodify published updates wizard. The republishing of the selected updates will occur during the next publishing service sync. You can trigger this sync to happen right away by clicking theRun Publishing Service Syncin theSync Scheduletab. If you review thePatchMyPC.log,you should see the updates being republished. Republished updates will have the date appended to the update title here\u2019s an example:Google Chrome 84.0.4147.105 (x64) \u2013 (Republished on 2020-09-22 at 11:52) Optionally you can use theWSUS Optionsin theUpdatestab of the Publisher todisable the appending of the republish tag. See below for an example of the option. With the checkbox checked republished updateswill not have the republished tag, but would still supersede old updates if requested. Once the republishing has completed, the updates will show up in SCCM after the next software update point sync has occurred. You can force a sync to happen by clicking \u2018Synchronize Software Updates\u2018 in the Configuration Manager Console. You can monitor the SCCM software update point sync by reviewing thewsyncmgr.log. Once the sync is complete, you should see the newly republished update(s) in the console with the date appended as described above. If you choose tosupersedepreviously published updates for this product, you will see the previous update(s) as superseded as well as indicated by theiricon, and a \u2018Yes\u2019 in the superseded column. Note that the update has our appended republish date, and our previous update is now marked superseded. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-updates-fail-to-install-with-error-0x800b0109-in-sccm/", "title": "Third-party updates, SCCM, Error codes", "raw_text": "Third-Party Updates Fail to Install with Error 0x800b0109 / 0x8024b303 in SCCM When attempting to install third-party software updates, you receive error code0x800b0109or0x8024b303. Determine if You are Affected This error generally will occur when attempting toinstall third-party software updates. You may see the following error in software center based on thedeployment visibility. InWUAHandler.log, you will see the following error in the log. Failed to download updates to the WUAgent datastore. Error = 0x800b0109Failed to download updates to the WUAgent datastore. Error = 0x8024b303 If the certificate exists inTrusted Root, but notTrusted Publisherson the client, you may see the following error instead. Failed to download updates to the WUAgent datastore. Error = 0x800b0004. 0x800b0109 = A certificate chainprocessed,but terminated in a root certificate which is not trusted by the trust provider.0x800b0004 = The subject is not trusted for the specified action. This error occurs when a client is attempting to install an update signed by aWSUS signing certificatethat the client doesn\u2019t trustor theallow third-party updates policy isn\u2019t enabled. Step 1: Check if the WSUS Signing Certificate is Deployed to the Client Device The most common reason error0x800b0109or0x8024b303occurs is that the specificWSUS signing certificateisn\u2019tproperly deployedto the client device. The signing certificate needs to be in theTrusted RootandTrusted Publisherscertificate store. It\u2019s important to review the certificate used to sign thespecific update failingas we often see the failing update was signed using a previous certificate that may not be deployed to clients. To find the certificate used for the update perform the following actions: 1.Get theUpdateIDfor the update failing. TheUpdateIDcan be found in the line before the error message in theWUAHandler.log. 2. Downloadthe update CAB file using the Configuration Manager console. Navigate toAll Software Updates>Search UpdateID>PropertiesofUpdate>Content Informationtab >Ctrl + Cto copy theSource Path>Pasteto Notepad and remove non-URL text 3.Downloadorcopythe .CAB file to the client receiving error0x800b0109 / 0x8024b303. Onpropertiesof the file, review theCertification Pathtab, and review if there are any trust errors. If the certificate shows anytrust errors, you will need todeploy this certificate to all client devices. 4.If the certificate appears to betrustedandvalid, you should next validate the certificate exist in both theTrusted RootandTrusted Publisherscertificate store on the client. 4.1Take note of thethumbprintof the WSUS signing certificate from theDetailstab of the .CAB file as shown instep 3. Opencertlm.mscon the client receiving the error and check if the certificate exists in bothTrusted RootandTrusted Publisherscertificate stores by checking thesubject nameandthumbprint. 4.2If the certificate appears is installed in bothTrusted RootandTrusted Publishers, and you still receive0x800b0109 / 0x8024b303, you also need to validate the settingAllow signed updates for an intranet Microsoft update service locationis enabled and deployed. Important:We often see cases where theWSUS signing certificate is updated, andonlythenewest WSUS signing certificateis deployed to the client. If there where any updates signed using a previous certificate, that certificate also needs to be deployed to client devices, orupdates published before the new certificate was createdwill fail with error0x800b0109. Step 2: Check policy: Allow signed updates for an intranet Microsoft update service location If the certificate appears to be installed inTrusted RootandTrusted Publisherson the client, and you still receive error0x800b0109or0x8024b303, it\u2019s likely due to the policyAllow signed updates for an intranet Microsoft update service locationnot being enabled. To check if the policy is enabled perform the following actions: 1.Open regedit.exe, and navigate to:HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:AcceptTrustedPublisherCerts=1 | (REG_DWORD). If enabled, you will see the RegValueAcceptTrustedPublisherCertsset to1as aREG_DWORD 2.If the value isn\u2019t set,updates will fail to installwith error0x800b0109. You can use aConfiguration Manager client settingorgroup policyto deploy this policy to devices. Important:Please ensure that the \u2018Type\u2018of the RegValue is \u2018REG_DWORD\u2018 andNOT\u2018REG_QWORD\u2018 Step 3: Check if 0x800b0109 is a Scan Error, not an Update Install Error We periodically have customers mistakenly think that error0x800b0109is happening when installing third-party updates, but it\u2019s actually occurring when trying toscan against the WSUS server. If WUAHandler.log contains the error below containing the wordsOnSearchCompleteorScan failed,then your issue is actually related to the client not trusting the SSL certificate used by the WSUS server. OnSearchComplete \u2013 Failed to end search job. Error = 0x80244010.Scan failed with error = 0x80244010. To resolve the error in this scenario, you will need to install theRoot Certificate Authorityfor the CA that issue the SSL certificate to the WSUS server on the client. One option to do this is usingGroup Policy. Video Resolution Guide for Error 0x800b0109 To resolve error code0x800b0109 / 0x8024b303,you need to distribute the WSUS signing certificate to theTrusted RootandTrusted Publisherscertificate stores on your client devices. We also have a detailed step-by-step video guide below that covers deploying the WSUS signing certificate using SCCM 1806+ or using group policy toresolve error 0x800b0109 on your clients. If you prefer a non-video format, you can use the following guides to distribute the WSUS signing certificate: Third-party software updates feature in SCCM 1806+ \u2013 (Microsoft Docs) Deploy the certificate using group policy \u2013 (PDF Guide). Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/migrating-from-publisher-to-cloud/", "title": "Cloud Migration Guide, Publisher to Cloud, Manual App Migrations, Intune Integration", "raw_text": "How to migrate from the Publisher to Cloud \u2013 Patch My PC If you\u2019re a Patch My PC customer currently using the On-Prem Patch My PC Publisher Console to integrate and automate the publishing of Win32 apps to Intune, but want to transition to our new SaaS Cloud Portal, this guide is here to help. Important Notes Before You Begin No automated migration:Currently, there is no automated migration process available to transition from the On-Prem Publisher to the Cloud Portal. We will build one once we achieve Full-Feature parity. If you are interested in this option, please upvotethis ideaon our UserVoice and we\u2019ll notify you when it\u2019s available. Feature Parity in Progress:While we\u2019re working to achieve full feature parity between the On-Prem Publisher and the Cloud Portal, there may be differences in functionality. You can track our progress onthis page. Manual App migration:You will need to manually migrate your apps and updates to the Cloud Portal. Please follow the steps outlined below to ensure a smooth transition. Steps to Migrate Your Apps and Updates to the Cloud Portal 1. Review Cloud Portal DocumentationBegin by familiarizing yourself with thedocumentation for our Cloud Portal. Understanding its capabilities and workflows will make the migration process easier. 2. Sign Up on portal.patchmypc.comPlease skip this step if you have already signed up on our Cloud portal. Followthis guideto sign up to our Cloud portal.Once you\u2019ve signed up, followthis guideto integrate our Cloud portal with your Intune tenant. 3. Take Note of Right-Click CustomizationsIdentify and document the customizations applied to apps published through the On-Prem Publisherright-click options. Note:Ensure that the customization options you use are available in the Cloud Portal before continuing. 4. Uncheck the Software in the On-Prem Publisher ConsoleIn the On-Prem Publisher Console, uncheck the software you wish to migrate. 5. Delete the Win32 App in IntuneRemove the Win32 app that was previously published by the On-Prem Publisher from Intune. 6. Reconfigure and Deploy from the Cloud PortalUsing the Cloud Portal, reconfigure the app as a new deployment (app, update, or both) and deploy it to your environment. FAQ Can I Migrate Only Some Apps While Testing the Process? Absolutely! We encourage you to start small. You can migrate a few apps initially to familiarize yourself with the Cloud Portal. While you\u2019re testing, the On-Prem Publisher will continue to publish new versions of any apps you leave selected, while the Cloud Portal will manage only the ones you\u2019ve migrated. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-application-creation-options/", "title": "Intune Application Creation Options, Win32 Applications, Digital Signatures, Azure AD", "raw_text": "Intune Application Creation Options Explained In this article, we will cover all of the Intune Application Creation Options that are available from the publisher. These are options that apply specifically to the creation of Win32 applications for your Intune tenant. Below is a screenshot of this section as of the writing of this article. This article does not go over configuring Authority, Application ID, and Application Secret. For documentation on configuring these items please refer to our setup documentation for Intunehere. Digitally sign the detection method script and enforce signature checking on the application in Intune When this option is checked, it will enforce signature checking for the detection method script. This option will be reflected in the application\u2019s properties in your Intune tenant under Detection Rules. If this option is enabled, you will need to browse for a code-signing certificate from your local computer\u2019s personal store to sign the Powershell detection method scripts for all created applications. If you also use our product for MEMCM (SCCM), you can use your WSUS code signing certificate that you previously created also to sign the detection method script for Intune apps, as long you are running the service from the same server. Alternatively, you can generate a code signing certificate to sign the detection method script (How to generate a code signing certificate and sign PowerShell .ps1 script \u2013 Patch My PC). The certificate will still need to be deployed to your Intune-managed clients for the script to be trusted. Copy the assignments from previously created applications when an updated application is created The Publisher can immediately add assignments for the apps to Azure AD groups upon creation. This option can be executed through a right-click action at a global, vendor, or individual level. Right-clicking a product, vendor, or All Products will give you the option to Manage Assignments. From this window, you can add an assignment for an app or apps as Available, Required, or as an Uninstall. When a new version of an app is created, and the box to copy assignments in the Intune Options window is checked, the Publisher will automatically transfer these assignments to the newly created application. The assignments will not be transferred if you enable this option after the fact, while the newer version already exists in Intune. Update Enrollment Status Page associations with new application when an updated application is created This option will ensure that the list of selected Win32 applications for an IntuneEnrollment Status Pageis kept up to date as new versions of applications are published. These Enrollment Status Pages are commonly used during Autopilot. With this checkbox checked the Publisher will ensure the latest version of the published application are associated with your ESP. The ESP associations will not be removed from older versions of Patch My PC-made Intune Win32 packages if you enable this option after the fact, while the newer version already exists in Intune. Delete the assignments from previously created applications when an updated application is created This option corresponds with \u2018Copy Assignments\u2026\u2018feature from above. When the Publisher creates a new version of an application or update, the old version will still exist in the Intune tenant (unless specified to be deleted ie.1or2). This Win32 application will still have the same assignments that were set before the new version was created. If thecopy assignments optionis set you will end up having two different versions of the same Win32 application assigned to your Intune clients. To avoid this, you would want to enable this option to delete the assignments of the old application, so that only the latest version of the application is assigned to your clients. The assignments will not be deleted if you enable this option after the fact, while the newer version already exists in Intune. Update application dependencies from previously created applications when an updated application is created This option will support maintaining your application dependencies in Intune. When this option is enabled, if you have any Win32 apps from Patch My PC in the application dependencies you create, it will ensure that they are kept up to date as new versions are published. Note:When this option is enabled, the notification below will display. Previously, if you had a dependency change the applications would not go away. With this option enabled, there is a possibility that applications can be deleted. Copy the requirements from previously created applications or updates when an updated application is created When enabled, this option ensures that any customer-definedWin32 requirementsare retained as new versions of a product are updated. For example, the customer might add a custom requirement PowerShell script or registry value check. This will be copied forward as long as the checkbox is checked. Note:If this feature is not enabled, then customer-defined requirements will not be retained. When a new version of a product is published, the additional requirements will not exist on the newly published Win32 application. The Publisher will never delete a requirement; they are simply not copied forward.\u00c2 Delete any previously created applications when an updated application is created As explained in Option 2 and 4, when the Publisher runs a sync and finds a new version is released for an application, it will create the new version of the application. Without selecting this option, the old version of the application will still exist in the Intune tenant. If this option is enabled, however, the Publisher will delete the old version of the application when the new version is created. Select this option if you only want to have the latest version of an application that exists in your Intune tenant. Note:Beginning in version 2.0.1 we support the ability to retain a limited number of previous versions for both updates and applications. Setting the value will allow you to preserve the specified number of previous versions. This provides you with the benefit of having access to older versions of applications in your environment, as well as the latest, ready to deploy if you need to roll back your devices to a last known good version. It also keeps your environment tidy by maintaining a set number of applications. Delete any previously created updates when a new update is published As explained above, when the Publisher runs a sync and finds a new version is released for an application it will create the new version of the application as an Intune Update. Without selecting this option, the old version of the Intune Update will still exist in the Intune tenant. If this option is enabled, however, the Publisher will delete the old version of the Intune Update when the new version is created. Select this option if you only want to have the latest version of an Intune Update that exists in your Intune tenant. Enable \u2018Allow available uninstall\u2019 When creating or configuring a Win32 app, there is a setting to provide the uninstall option for the app for users in the Company Portal. All Win32 apps published will inherit this flag if the option is set at this global level. For more information about this feature, and how to configure it at the vendor/product level, please see the following KB:- Intune Win32 app Allow Available Uninstall Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/forticlient-vpn-installer/", "title": "Fortinet, Forticlient, VPN, Installer", "raw_text": "Forticlient VPN Online Installer Update 27/11/2023: Fortinet have removed the free download link for v7.0.x. This version now requires a support contract with Fortinet to access.More info FortiClient VPN MSI Latest FortiClient VPN EXE 7.0.x, 7.2.x, 7.4.x & Latest FortiClient VPN 7.0.x, 7.2.x & 7.4.x MSI FortiClient VPN MSI Latest In this article, we will detail how to get the MSI required for theFortiClient VPN Latest (MSI-x64)product in our catalog. Currently, this product uses an \u201conline installer\u201c. These type of installers are generally\u201cstub\u201d installers, where theydownload the real software installer from the Internet prior to starting the installation. Today,we cannot directly support online installersin our catalogue as theyaren\u2019t reliableandinvalidate our security measures. Therefore the steps in this article are necessary to support this product. These steps cover the process of downloading the online installer, extracting the MSI and placing the MSI in thePatch My PC Publisher Local Content Repository. Download the Installer The Forticlient VPNrequires a manual download.Browse toDownload Forticlient VPN, find the product and download it. The product we are looking for specifically, is highlighted below: Extract the Installer and Grab the MSI Once you have the online installer downloaded, you will have to extract it. Running theFortiClientVPNOnlineInstaller exewill present you with a popup showing the download progress: Once the download is finished, the installer will launch. Leave this open in the background for now. With the installer open, navigate to%ProgramData%\\ApplicationsCache Copy the MSI file you see here and place it in yourLocal Content Repositoryset in the Patch My PC Publisher Advanced tab: FortiClient VPN EXE v7.0.X, v7.2.X, 7.4.X & Latest In this section, we will detail how to get the EXE required for theForticlient VPN 7.2.x & Latest (EXE-x64)product in our catalog. The download for FortiClient VPN EXE 7.2.x EXE requires a support contract with Fortinet. Provided you have one, you can login here to access the download. Ensure you select the product titledFortiClient Once download, Copy the file into yourLocal Content Repositoryset in the Patch My PC Publisher Advanced tab FortiClient VPN MSI v7.0.x, 7.2.x, 7.4.x In this section, we will detail how to get the EXE required for theFortiClient VPN 7.0.x (EXE-64)product in our catalog. The download for FortiClient VPN EXE 7.0.x requires a support contract with Fortinet. Provided you have one, you can login here to access the download. Ensure you select the product titledFortiClient To acquire the MSI Download the latest EXE installer (Pictured below) Launch the EXE installer Browse to %ProgramData%\\ApplicationsCache Copy the FortiClientVPN.MSI to yourlocal content repository, set in the Patch My PC Publisher Advanced tab.Note: The MSI file name has changed from Forticlient.msi to ForticlientVPN.msi Note:This process will need to be carried outfor each new version of the Forticlient VPN Online Installer. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-api-reference/", "title": "Patch My PC, API Reference, Permissions, Intune", "raw_text": "Patch My PC Publisher Intune API Reference This knowledge base article provides an overview of the various features of Patch My PC and their interactions with external APIs, including Microsoft Graph API and Patch My PC\u00c3\u00a2\u00c2\u0080\u00c2\u0099s own API. The article details specific actions taken by each feature, associated endpoints, and required permissions. Note 1:Some URLs in this article might differ depending on your geographical location, for example Azure Storage endpoints. For a full list of endpoints required for Patch My PC Publisher, please refer tohttps://patchmypc.com/list-of-domains-used-for-downloads-in-patch-my-pc-update-catalog Note 2:A spreadsheet containg the references in this KB can be found athttps://patchmypc.com/app/uploads/2025/06/Publisher-Graph-Endpoints-and-API-Permissions-for-Intune.xlsx API Permision Reference Reason(s): List and Manage ApplicationsThis permission allows Patch My PC to query and list Win32 applications in your Intune tenant, manage applications, and perform actions such as creating or deleting assignments. Add or Update ApplicationsRequired for adding new Win32 applications, updating them with new content versions, or deleting them when they fall outside of the retention chain specified by the publisher. Batch OperationsEnables performing batch requests such as deleting multiple Win32 applications in bulk or assigning multiple applications at once. Upload Application ContentNecessary to obtain a storage URI from Intune for uploading content for new or updated applications. Assignment ManagementUsed when adding or removing application assignments or managing the group assignments related to applications. Reason(s): Retrieve Assignment FiltersThis permission allows Patch My PC to read assignment filters from Intune, which are used to target specific devices or users when deploying or updating applications. Reason(s): Request and Download ReportsThis permission allows Patch My PC to request reports for discovered applications (AppInvRawData) and poll the service to check if the report is ready. Display Discovered AppsIt enables Patch My PC to download and display generated reports that contain details of managed devices in your Intune environment. Enumerate Groups for AssignmentsNecessary for querying the Intune device inventory and retrieving device data to support application assignment and other management operations. Reason(s): Role Scope Tag ManagementThis permission is needed to retrieve and manage role scope tags, ensuring that administrative roles and permissions are applied consistently across application assignments, device configurations, and user roles. It helps restrict certain actions based on role-based access control (RBAC) policies. Reason(s): ESP Profile ManagementRequired for Patch My PC to update and manage Enrollment Status Page (ESP) profiles, ensuring that newly added Win32 applications are correctly flagged as blocking apps during device provisioning. Reason(s): Populate Groups for AssignmentsThis permission allows Patch My PC to read Entra ID group information when creating or managing application assignments. It fetches group data for assignment targeting and filtering, ensuring that only authorized users or devices receive the intended applications. API Reference Product: Publisher Tab: General Feature: Licence validation Button/Option: Validate Endpoint(s):https://patchmypc.comhttps://api.patchmypc.com https://patchmypc.com https://api.patchmypc.com Method: CONNECT Graph API Permission: None Product: Publisher Tab: General Feature: Licence validation Button/Option: Validate Endpoint(s):https://api.patchmypc.com https://api.patchmypc.com Method: CONNECT Graph API Permission: None Product: Publisher Tab: Intune Apps Feature: Options Button/Option: Test Endpoint(s):https://login.microsoftonline.com/<>.onmicrosoft.com/oauth2/v2.0/token https://login.microsoftonline.com/<>.onmicrosoft.com/oauth2/v2.0/token Method: POST Graph API Permission: None Product: Publisher Tab: Intune Apps/Updates Feature: Scan for supported products Button/Option: Query Endpoint(s):https://login.microsoftonline.com/common/discovery/instance https://login.microsoftonline.com/common/discovery/instance Method: GET Graph API Permission: None Product: Publisher Tab: Intune Apps/Updates Feature: Scan for supported products Button/Option: Query Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/reports/exportJobs https://graph.microsoft.com/beta/deviceManagement/reports/exportJobs Method: POST Graph API Permission: DeviceManagementManagedDevices.Read.All Product: Publisher Tab: Intune Apps/Updates Feature: Scan for supported products Button/Option: Query Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/reports/exportJobs https://graph.microsoft.com/beta/deviceManagement/reports/exportJobs Method: GET Graph API Permission: DeviceManagementManagedDevices.Read.All Product: Publisher Tab: Intune Apps/Updates Feature: Scan for supported products Button/Option: Query Endpoint(s):https://amsub0502repexpstorage.blob.core.windows.net/ https://amsub0502repexpstorage.blob.core.windows.net/ Method: GET Graph API Permission: DeviceManagementManagedDevices.Read.All Product: Publisher Tab: Intune Apps/Updates Feature: Intune application manager Button/Option: Query Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ Method: GET Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Intune Apps/Updates Feature: Intune application manager Button/Option: Query Endpoint(s):https://amsub0502repexpstorage.blob.core.windows.net/ https://amsub0502repexpstorage.blob.core.windows.net/ Method: GET Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Intune Apps/Updates Feature: Intune application manager Button/Option: Delete Assignment Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ Method: DELETE Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Intune Apps/Updates Feature: Intune application manager Button/Option: Delete Application Endpoint(s):https://graph.microsoft.com/beta/$batch https://graph.microsoft.com/beta/$batch Method: POST Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Intune Apps/Updates Feature: Assignments Button/Option: Add assignment Endpoint(s):https://graph.microsoft.com/beta/groups/ https://graph.microsoft.com/beta/groups/ Method: GET Graph API Permission: GroupMember.Read.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://patchmypc.com https://patchmypc.com Method: CONNECT Graph API Permission: None Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://api.patchmypc.com https://api.patchmypc.com Method: CONNECT Graph API Permission: None Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://login.microsoftonline.com/common/discovery/instance https://login.microsoftonline.com/common/discovery/instance Method: GET Graph API Permission: None Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://login.microsoftonline.com/<>.onmicrosoft.com/oauth2/v2.0/token https://login.microsoftonline.com/<>.onmicrosoft.com/oauth2/v2.0/token Method: POST Graph API Permission: None Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/managedDevices? https://graph.microsoft.com/beta/deviceManagement/managedDevices? Method: GET Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps https://graph.microsoft.com/beta/deviceAppManagement/mobileApps Method: POST Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://mmcswdb01.blob.core.windows.net:443 https://mmcswdb01.blob.core.windows.net:443 Method: CONNECT Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ Method: POST Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ Method: PATCH Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ https://graph.microsoft.com/beta/deviceAppManagement/mobileApps/ Method: DELETE Graph API Permission: DeviceManagementApps.ReadWrite.All Product: Publisher Tab: Sync Schedule Feature: Sync Button/Option: Run Publishing Service Sync Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/deviceEnrollmentConfigurations/ https://graph.microsoft.com/beta/deviceManagement/deviceEnrollmentConfigurations/ Method: POST Graph API Permission: DeviceManagementServiceConfig.ReadWrite.All Product: Publisher Tab: Cloud Feature: Test Connection Button/Option: Test Connection Endpoint(s):https://us.portal.patchmypc.com:443 https://us.portal.patchmypc.com:443 Method: CONNECT Graph API Permission: None Product: Publisher Tab: Intune Apps/Updates Feature: Refresh the list of products Button/Option: Refresh the list of products Endpoint(s):https://us.portal.patchmypc.com:443 https://us.portal.patchmypc.com:443 Method: CONNECT Graph API Permission: None Product: Publisher Tab: Intune Apps/Updates Feature: Manage ESP Profiles Button/Option: Manage ESP Profiles Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/deviceEnrollmentConfigurations/ https://graph.microsoft.com/beta/deviceManagement/deviceEnrollmentConfigurations/ Method: GET Graph API Permission: DeviceManagementServiceConfig.ReadWrite.All Product: Publisher Tab: Intune Apps/Updates Feature: Assignments Button/Option: Add assignment Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/assignmentFilters/ https://graph.microsoft.com/beta/deviceManagement/assignmentFilters/ Method: GET Graph API Permission: DeviceManagementConfiguration.Read.All Product: Publisher Tab: Intune Apps/Updates Feature: Product customization Button/Option: Manage Role scope tags Endpoint(s):https://graph.microsoft.com/beta/deviceManagement/roleScopeTags/ https://graph.microsoft.com/beta/deviceManagement/roleScopeTags/ Method: GET Graph API Permission: DeviceManagementRBAC.Read.All Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/update-publishing-fails-error-srvmsg_sms_isvupdates_syncagent_updatecontent_trust_fail/", "title": "Certificate Trust Issue, Configuration Manager, Third-Party Updates", "raw_text": "Publishing Fails with Error SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL In this article, we\u2019re going to be reviewing an error that can occur when using the built-inthird-party software update catalogs featurewithin Configuration Manager. This error is related to updates failing to publish with full content due to a certificate trust issue in Configuration Manager. If you are experiencing this issue, you will see the following errors in theSMS_ISVUPDATES_SYNCAGENT.loglog file. SyncUpdate: Certificate \u2018%CERTIFICATE-THUMBPRINT%\u2019 is BLOCKED.SyncUpdate: ff1bb935-7ecd-482f-988e-ba7fafe0eacf \u2013 Signature check on downloaded binary has failed.STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL).STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_FAIL). How Certificate Trust Works for Third-Party Update Catalogs When yousubscribe to a third-party software update catalogin the Configuration Manager console, you will be required to accept the primary certificate used to sign the catalog file. During the catalog export, we will also includecode-signing certificates from the installer filesfor updates within our catalog. For example, in the extracted catalog in the screenshot below, you can see a certificate used tocode-sign Dropbox\u2019s installer. During a catalog sync in theSMS_ISVUPDATES_SYNCAGENT.log, you can review thecertificates being importedinto Configuration Manager from a third-party update catalog. Why The STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL). Error? Before any third-party update can be published to WSUS, the SMS_ISVUPDATES_SYNCAGENT component will alwaysperform a certificate check on the downloaded update file. When an update file is downloaded, and the code-signing certificateisn\u2019t trustedwithin Configuration Manager, you will receive the error: STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_TRUST_FAIL). Within the Configuration Manager Console, you can navigate toAdministration>Security>Certificates You can then right-click the certificate of the blocked certificate and clickUnblock. Once unblocked, you should be able to go back to the update and choosePublish Third-Party Software Update Content,and it should publish successfully. Why was the Certificate Blocked in Configuration Manager There are two primary reasons a certificate may be blocked. Youunsubscribedfrom the catalog that imported the Third-party Software Update Content certificate The certificate wasblockedfrom the console We forgot to include the certificate in our catalog If you believe it\u2019s the last point, you canopen a support case, and attach yourSMS_ISVUPDATES_SYNCAGENT.logfile. The log file will allow our team to review if the certificate used for a vendor\u2019s installer may not be included in our catalog export process. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/standalone-wsus-mode/", "title": "Standalone WSUS Configuration, Third Party Updates, Microsoft, Deployments", "raw_text": "Configuring Standalone WSUS Mode Description This article will show you how the Patch My PC Publisher can be set up to publish updates in astandalone WSUSenvironment. A full guide on how to configure WSUS standalone can be found here:WSUS Standalone \u2013 Getting Started (patchmypc.com). Configuring Standalone WSUS Mode You can publish third-party updates tostandalone WSUSwithout SCCM. To allow updates to appeardirectly in WSUS, follow the instructions in this article. Standalone WSUS mode isonly required when you are not using Configuration Managerfor software updates and areonly using WSUS. When enabled, published third-party updates will appear directly in the WSUS console. Enable Standalone WSUS Mode To enable standalone WSUS mode, go to theUpdatestab and selectOptions. In theWSUS optionswindow check the boxMake updates appear in the WSUS console. This option isn\u2019t needed if using Configuration Manager. If your WSUS database is using aWindows Internal Database(WID), thedatabase connection options will be read-only. When using aSQL Server for the WSUS database, you will need to choose either to connect to the database using theSYSTEM accountor define a user name and password usingSQL authentication. Verify Third-Party Updates Appear in the WSUS Console Any updates published after this setting was enabled should appear directly in the WSUS console. You can now deploy the third-party updates just like a Microsoft updatedirectly from the WSUS console. If updates were publishedbefore this setting was enabled, they wouldnot appear in the WSUS console automatically. For updates published before WSUS Standalone mode was enabled, use theModify Published Updates Wizardto make those updates appear in the WSUS console. SQL permissions required to publish update information to the database When the Patch My PC Publishing Sync runs, if the SUSDB is remote from the WSUS Standalone server, you would have to grant specific permissions to the computer account where PMPC is installed for it to be able to update information. The script below can be used to grant those permissions. Make sure to replace the computer account values with the ones appropriate to your environment. The code can be edited, and run as a SQL query to grant the permissions. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-share-large-files-patch/", "title": "Large file sharing, support cases, SharePoint upload", "raw_text": "How to Share Large Files with Patch My PC for Support Cases There may be some cases when working with our support team where you may need to sharelarge fileswith us for troubleshooting. A fewexamplesare: Package sourcefiles for ConfigMgr applications Installerbinaries Multiplelarge log filesthat are larger than 20 MB that can\u2019t be sent via email Step 1: Prepare the Files that will be Uploaded The first step is topreparethe files you are sending. We recommend compressing the files into asingle .zip archive filebefore uploading. We also recommendrenaming the .zip filewith a descriptive name, including your company name. Here\u2019s an example: Step 2: Upload the ZIP-File to Sharepoint Next, you will need toupload the .zip filecreated in step 1 to our Sharepoint website. Navigate to:https://patchmypc.com/sharein a web browser. ChooseSelect files In thefile browse dialog, select the file(s) you need to upload for support. Next, you need to enter yourfirstandlastname. Optionally, you can also select the+ Add more fileslink it applicable to include more files. Once filled out, clickUpload. Once theupload is completed, the support engineer working on your case will be notified. Upload Application Source Files for Troubleshooting There may be some cases where our support team may requestapplication source filesfor an SCCM application created by Patch My PC. To upload application source files, ZIP the primary folder referenced in the deployment typeContenttab. You can then upload the files using theprevious step. Security Details for File Storage If you are interested in the security around the file upload and storage, please review thefollowing resources. File Security in Microsoft SharePoint and OneDrive for Business SharePoint and OneDrive: security you can trust, control you can count on Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-create-temp-file-gettempfilename/", "title": "Failed Download SCCM Temp File Error", "raw_text": "Failed to create temp file with GetTempFileName() at temp location . error 80 Error80, or0x80070050, generally occurs when attempting to download software updates (whether third party updates or Microsoft updates) into a deployment package. When attempting to download an update into a deployment package in the SCCM console, you receive the error message:Failed to download content id Error: The file exists. Determine if You Are Affected Whenever a software update is being downloaded, regardless of whether it\u2019s a Microsoft or third-party update, you receive the following error using the Download Software Updates wizard in the console: Looking inPatchDownloader.logfile we can see an error code which resolves to The file exists (0x80070050or80): Failed to create temp file with GetTempFileName() at temp location C:\\Usersusername\\AppData\\Local\\Temp, error 80ERROR: DownloadUpdateContent() failed with hr=0x80070050 If using Automatic Deployment Rules (ADR), the error code will be different and unfortunately a little more generic (0X87D20417): Looking at theruleengine.loglog file for ADRs, we can find a more useful error code which resolves to the file exists (80): Failed to download the update content with ID from internet. Error = 80Failed to download ContentID for UpdateID . Error code = 80 Root Cause Temporary files are createdby ConfigMgr in the%temp% directorywhile it downloads software updates. Depending on whether you\u2019re downloading software updates manually via the Download Software Updates Wizard or automatically with ADRs, %temp% could be located in one of two places. If downloading software updates manually via right click > Download, %temp% will resolve to youruser profile\u2019s temp directory\u2013 typically this is inAppData. If downloading software updates automatically via ADR, this will be in the system\u2019s context and will generally beC:\\Windows\\Temp. Note:The system environment variabletempcan be changed. To verify your system\u2019s temp directory, execute the below PowerShell snippet: The issue stems from there beingtoo many temporary filesin thetemp directory. The naming convention of the.tmpfiles it tries to create isCAB.tmpwhere is a random hexadeciaml number. Since there can only be so many valid permutations in this naming convention, when a new temporary file is attempted, it willfailwithexit code 80\u201cThe file exists\u201d if it tries to create the temporary file with thesame name with one that already exists. Generally, applications like SCCM dispose of temporary files after they\u2019re done with them. Howeversecurity software (antivirus)orNTFS permissionscaninterfere with the file creation and deletionof these temporary files when the application processes them. Your content goes here. Edit or remove this text inline or in the module Content settings. You can also style every aspect of this content in the module Design settings and even apply custom CSS to this text in the module Advanced settings. Workaround: Manually delete all .tmp files As a temporary workaround to enable you to download the software updates now, you can manually delete all .tmp files in the %temp% directory. Note that this is not a practical solution as the issue will invaraibly return because something is stopping Windows / applications from cleaning up temporary files. If downloading software updates mmanually via right click > Download, %temp% will resolve to youruser profile\u2019s temp directory\u2013 typically this is inAppData. If downloading software updates automatically via ADR, this will be in the system\u2019s context and will generally beC:\\Windows\\Temp. Note:The system environment variabletempcan be changed. To verify your system\u2019s temp directory, execute the below PowerShell snippet: Solution: Create antivirus exceptions Create an exclusion policy in your security software to exclude .tmp files in your or your system\u2019s temp directory. The temp directory which you exclude depends on whether you experience the issue while downloading manually or via ADR. If downloading software updates mmanually via right click > Download, %temp% will resolve to youruser profile\u2019s temp directory\u2013 typically this is inAppData. If downloading software updates automatically via ADR, this will be in the system\u2019s context and will generally beC:\\Windows\\Temp. Note:The system environment variabletempcan be changed. To verify your system\u2019s temp directory, execute the below PowerShell snippet: Solution: Verify NTFS permissions Another possible solution could be that the security context trying to conduct the downloads does not have the NTFS permission to delete files. Therefore ensure your user or system object has theDeleteNTFS permission in the temp directory. If downloading software updates mmanually via right click > Download, %temp% will resolve to youruser profile\u2019s temp directory\u2013 typically this is inAppData. If downloading software updates automatically via ADR, this will be in the system\u2019s context and will generally beC:\\Windows\\Temp. Note:The system environment variabletempcan be changed. To verify your system\u2019s temp directory, execute the below PowerShell snippet: Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/personal-lab-subscription/personal-lab-quote", "title": "Patch My PC Subscription Cloud Lab", "raw_text": "Patch My PC Looking for a personal lab quote? Just fill out our Personal Lab quote request form \u2014 we\u2019ll usually get back to youwithin a few hours. The Personal Lab subscription is made forConfigMgr/Intune enthusiastsrunning asmall personal lab (under 25 devices).It\u2019s for non-commercial use only and can\u2019t be used in production environments. Approval is required, and there are a few extra requirements in ourterms of service. Our personal lab subscription will only work in environments with fewer than 25 devices. The subscription will beEnterprise Plusand cost $24.99/yr. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/powershell-rule-not-met/", "title": "PowerShell Script, Intune Updates, Deployment Issues", "raw_text": "PowerShell Script Requirement Rule is not met This article discusses the \u201cPowerShell script requirement rule is not met\u201d status you get when deploying Intune Updates through the Patch My PC Publisher. Introduction When you deployIntune Updatespublished by the Patch My PC Publishing Service for some devices the Intune deployment statistics might sayNot Applicable. The status details in such cases will statePowershell script requirement rule is not met. Additional information Each Intune Update published by Patch My PC contains in its Properties a requirement script. Intune runs this requirement script to determine if the update you targeted the device with applies or not.Therefore, before installing the update, Intune invokes the script, which returns: True, if an older version is installed on the device. False, if an older version isn\u2019t installed on the device. Note:Intune Updates will only work if the version already on the device matches the type of installer (like EXE or MSI) and the system architecture (like x64 or x86) of the update you\u2019re sending out. Recommendations If you want to update software on your devices, like Google Chrome, you can pick all the Google Chrome updates from theIntune Updatessection and deploy them. Then, Intune takes care of installing the necessary updates on the devices. We don\u2019t recommend selecting every software available in the Patch My PC Publisher or it\u2019s Cloud counterpart, however, as you might run into the Intune policy size limit issue documentedhere. Troubleshooting If you find that Intune Updates aren\u2019t being applied even though an older version is installed, you\u2019ll need to troubleshoot the issue. Here\u2019s what we need: The name of the update that is not installing (e.g. Update for Google Chrome, or Update for Notepad++) From the device on which the update is not applying, collectthese logs.Make sure to include the rolled-over logs as well. Additionally, runthis scriptto export a list of the software installed on the device.This step is very important, as this export will allow us to verify the applicability rules of the update. Once you\u2019ve collected the necessary files, pleaseopen a support case, if you haven\u2019t already. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/hardware-inventory-scan-sccm/", "title": "Configuration Manager, Hardware Inventory, Scan Cycle", "raw_text": "Understanding the Hardware Inventory Scan Cycle in Configuration Manager Over a year ago, we published anarticleon the PatchTuesday tech blog discussing the various Configuration Manager (or simply ConfigMgr) Client actions, including the one we\u2019ll discuss today \u2013 the Hardware Inventory scan cycle. The article detailed what each does, when it\u2019s useful to trigger a specific action, and the relevant logs to monitor on the client side. The article was written because the information was highly relevant to many people at the time. That article provided a general overview of all the available actions. In this article, we\u2019ll examine one of the most powerful actions: the Hardware Inventory Scan Cycle. We\u2019ll discuss the data it collects, how to configure its automatic execution, and the various methods to trigger it manually. What is the Hardware Inventory Scan Cycle? Before answering this question, we need to know what the hardware inventory is.Briefly put, it is a collection of detailed information about client devices in your environment. The scan cycle triggers the collection of data from your devices.By default, the hardware inventory data collection is disabled in Configuration Manager. You will have to enable it by following the stepsprovided by Microsoft. What does it do, and what data does it collect? The Hardware Inventory Scan Cycle collects a wide range of data about the hardware configuration of client devices, including: Processor details: Type, speed, and number of cores. Memory information: Total physical memory and available memory. Storage details: Disk drives, partitions, and available space. Network information: Network adapters, IP addresses, and MAC addresses. Peripheral devices: Monitors, keyboards, and mice. System details: BIOS version, manufacturer, and model. Last but not least,Installed software: A list of installed programs and updates. Note:Yes, the software inventory data is collected by the Hardware Inventory Cycle, not by Software Scan Cycle. Configuring Automatic Hardware Inventory Scan Cycle To configure the Hardware Inventory Scan Cycle to run automatically, follow these steps: Open the ConfigMgr consoleand navigate toAdministration > Client Settings. Edit theDefault Client Settingsor create a new, custom client settings policy. Right-click on your client settings, selectProperties, and go to theHardware Inventorysection. Enable hardware inventory and configure the schedule for the inventory scan cycle (e.g., every 7 days). Apply the settings and deploy the client settings policy to the desired collection.Note: It\u2019s not needed to deploy the client settings if you edit the Default Client Settings. This setup ensures the Hardware Inventory Scan Cycle runs automatically according to the specified schedule. Ways to manually invoke the Hardware Inventory Scan Cycle In some cases, you might need to trigger the Hardware Inventory Scan Cycle manually instead of waiting for the automated sync. Here are several methods to do so: 1. From the Client Side One method is by using the Control PanelConfiguration ManagerApplet: Open theControl Panelon the client device. Go toSystem and Security> Configuration Manager. In the Actions tab, select Hardware Inventory Cycle and click Run Now. The other method of manually invoking the scan cycle from a client is by using PowerShell: Open PowerShell as Administrator Run this command:Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000001}\u201d Invoke-WmiMethod -Namespace \u201crootCCM\u201d -Class SMS_Client -Name TriggerSchedule -ArgumentList \u201c{00000000-0000-0000-0000-000000000001}\u201d 2. Using PowerShell Remoting PowerShell remoting may or may not be enabled in your organization. Some orgs prefer to disable it, as they consider it a security risk.Truth be told, it can be a security risk if not properly configured. But that\u2019s not the scope of this article. Here is how to invoke the scan cycle on a remote computer within your network: Open PowerShell as Admin with an account that has PowerShell Remoting privileges. Run this code:Invoke-Command -ComputerName EnterComputerName -ScriptBlock {Invoke-WmiMethod -Namespace \u201crootccm\u201d -Class \u201csms_client\u201d -Name \u201cTriggerSchedule\u201d -ArgumentList \u201c{00000000-0000-0000-0000-000000000001}\u201d} Invoke-Command -ComputerName EnterComputerName -ScriptBlock {Invoke-WmiMethod -Namespace \u201crootccm\u201d -Class \u201csms_client\u201d -Name \u201cTriggerSchedule\u201d -ArgumentList \u201c{00000000-0000-0000-0000-000000000001}\u201d} 3. From the SCCM Console Open the ConfigMgr console and navigate toAssets and Compliance>Devices. Locate the device and right-click on it. In theClient Notificationsection, chooseCollectHardware Inventory. 4. Using Support Center Client Tools This is also a client-sided tool, but I wanted to allocate an additional section to it. This tool can be distributed to your devices with the MSI that resides in your \u201c%ConfigMgr Install Directory%toolsSupport Center\u201d. With the MSI installed, you will find an app namedConfiguration Manager Support Center Client Tools. This tool will give you more information about the Configuration Manager agent on the device, such as: Client information (assigned Management Point, Site Code, Client Version, etc), Policy details Content details, deployments, cache information, etc Troubleshooting Log viewer The most important, however, is theInventory. It can give you information on when the last hardware inventory was performed: If you\u2019re curious about the information stored in the WMI collected by the Hardware Inventory Scan Cycle, this tool can give you that insight as well: This option can be useful if you\u2019re setting additional classes to be collected by the hardware inventory, and you\u2019re curious to know if it\u2019s collected, it\u2019s one option to check. But back to the topic. If you wish to trigger a Hardware Inventory cycle, do this: Open Configuration Manager Support Center Client Tools Navigate to theInventorytab Click on theInvoke triggerdropdown SelectHardware inventory cycleif you want to run a Delta sync.OR SelectAdvancedand thenHardware inventory cycle (full resynchronization)to run a full sync. 5. Using Advanced Insights If you\u2019re unaware,Advanced Insightsis an innovative reporting and patch compliance solution for Configuration Manager offered by Patch My PC. Among the very useful information this tool offers (and I encourage you to check it out, as it might be something your org can benefit from), it allows you to trigger some client actions, including the cycle we are discussing today. To trigger the cycle, follow these steps: Access the Advanced Insights reporting website Navigate to Resources \u00e0 Devices \u00e0 Managed devices and locate your device using the Quick Search option. From theActionsdropdown, select theHardware Inventoryoption. Viewing the data using Resource Explorer Once the data is collected, you probably want to view it. Here\u2019s how: Open the ConfigMgr console and navigate toAssets and Compliance>Devices. Locate and select the desired device. Right-click on the device and chooseStart>Resource Explorer. In the Resource Explorer Window, you can browse the various categories to see the information collected from clients, such as Installed applications, Operating System, Network adapters, and more.This information can be used to create a dynamic collection, for example. Relevant logs to monitor on the client side If you want to monitor the evaluation of this action, it can be done using these logs located on the client side in the %WinDir%\\CCM\\Logs folder: InventoryAgent.log\u2013 Records activities of hardware inventory, software inventory, and heartbeat discovery actions on the client. InventoryProvider.log\u2013 More details about hardware inventory, software inventory, and heartbeat discovery actions on the client. If you trigger aDeltahardware inventory scan, this is how the InventoryAgent.log will look like: Note:Don\u2019t worry about the Warning messages. If a class the hardware inventory scan cycle is supposed to collect data for, but the class doesn\u2019t exist on the device and there is no data to collect, you\u2019ll see the warning. However, if you trigger a full hardware inventory sync using the Support Center Client Tools, this is how the log is going to look like: Every time a delta hardware inventory sync is performed, the minor version is incremented (e.g., from 6.1 to 6.2). When a full hardware inventory sync is performed, the major version is incremented, and the minor version resets (e.g., from 6.2 to 7.0). When the site server receives a new report from the client, the client is instructed to perform a delta or full inventory sync if the version does not match what the server expects. Conclusion In conclusion, the Hardware Inventory Scan Cycle in ConfigMgr plays an important part in keeping a current list of your organization\u2019s hardware. Knowing how to set it up and run it manually, as well as which logs to check, helps IT administrators manage and troubleshoot hardware inventory. The Resource Explorer makes it easy to view and analyze the collected data, leading to better asset management, compliance, and efficiency in the IT infrastructure. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/update-cab-files-deleted-from/", "title": "WSUS, SUSDB, Shared Servers, CAB Files", "raw_text": "Update CAB Files Deleted from WSUSContent when Using Shared SUSDB We\u2019ve recently seen an increase in customer cases where published third-party software update (.CAB files) are automatically deleted from theWSUSContent folder. For this scenario, it occurs when customers are using ashared SUSDBamongmultiple WSUS servers. Determine if You are Affected The first step to determine if this could be your issue is to check if you havemultiple WSUS servers(Software Update Points in ConfigMgr) using the sameSUSDB. The most accurate way to check if multiple servers are using the same SUSDB is toconnect to the SUSDB using SQL Server Management Studio. Once connected, run the followingSQL commands: UseSUSDBexecspGetFrontEndServers The result of this query should listall WSUS front end serversusing the sameSUSDB. If there aren\u2019t multiple servers listed in theServerNamecolumn, this blog post will not be related to your issue. If affected, you will see.CAB updates automatically be deletedright after the publishing is completed. In many cases, this will happen so fast you will not see the file appear unless you runProcmonto verify it was created. You will likely only see a new folder created in theWSUSContent directorythat is empty, and the third-party update will fail to download to a deployment package witherror 404. Why the Third-Party Update CAB Files are Auto-Deleting If this is your scenario, we\u2019ll dig into our findings after working with multiple customers having this same issue. The big thing to note when using a shared SUSDB with multiple WSUS servers is what WSUS server is acting as theNLBMasterFrontEndServer. From a third-party update perspective, theNLBMasterFrontEndServeris theWSUS server that performs hash validationafter a third-party software update is published to the WSUSContent folder. WSUS has a stored procedure (spUpdateServerHealthStatus) that will automatically change the WSUS server that holds theNLBMasterFrontEndServerrole if the currentNLBMasterFrontEndServerserver has beenunavailable for 5 minutes. This includes the server being offline, WSUS service stopped, or database connectivity issues. To determine what WSUS front end server currently holds theNLBMasterFrontEndServerrole, you can run the following query against theSUSDB. select*fromtbReference In the example below, we can see theNLBMasterFrontEndServeris set toSITESYSTEM.CONTOSO.LOCAL. The publishing of updates is being performed from the WSUS serverDEMO4.CONTOSO.LOCAL, because it is the top-level software update point within our Configuration Manager environment. The root cause for the actual .CAB files being deleted is because theNLBMasterFrontEndServerserver doesn\u2019t trust the WSUS signing certificate from the WSUS server that is performing the publishing of third-party updates. Within theWSUS log file(C:\\Program Files\\Update ServicesLogFilesSoftwareDistribution.log) on theNLBMasterFrontEndServer(SITESYSTEM.CONTOSO.LOCALin our scenario), you will actually be able to see the CAB files being deleted. CabUtilities.CheckCertificateSignature File cert verification failed for demo4j$WSUS\\WsusContent7E88A3263D0FBFB63F57D93A0322958B051B18B97E.cab with 2148204809ContentSyncAgent.WakeUpWorkerThreadProc Importing file 88A3263D0FBFB63F57D93A0322958B051B18B97E failed at file cert verificationContentSyncAgent.WakeUpWorkerThreadProc Invalid file deleted: demo4j$WSUS\\WsusContent7E88A3263D0FBFB63F57D93A0322958B051B18B97E.cab The error code2148204809mentioned in the log above translates toA certificate chain processed, but terminated in a root certificate which is not trusted by the trust provider. How to Resolve CAB File Auto-Deletion for Third-Party Updates The previous section gives insight into the root cause of the issue which is theNLBMasterFrontEndServerdoesn\u2019t trust theWSUS Signing Certificatefrom the WSUS server performing the publishing. The fix is toexport the WSUS Signing Certificatefrom the server performing the publishing and install it in theTrusted RootandTrusted Publisherscertificate store on theNLBMasterFrontEndServerWSUS server. If are using thePatch My PC Publisher, you canexportthe WSUS Signing Certificate from the general tab to a(.CER file). If you are not using the Publisher, you canexportthe WSUS Signing Certificate using the following steps: Opencertlm.mscon the WSUS server performing the publishing Click theWSUSstore Right-clicktheWSUS Signing Certificate>All Tasks>Export = In theExport Private Keydialog, be sure to choose the option \u201cNo, do not export the private key\u201c Copy the(.CER certificate file)from the WSUS server that it was exported from (DEMO4.CONTOSO.LOCAL in our case) to theNLBMasterFrontEndServer(SITESERVER.CONTOSO.LOCAL in our case). On theNLBMasterFrontEndServerWSUS server, open the(.CER certificate file). In theCertificate Pathtab, you will likely see the certificate shows an error similar to the one below: On the General tab of the certificate, clickInstall Certificate\u2026button In theCertificate Import WizardchooseLocal Machinefor theStore Location Click the radio buttonPlace all certificates in the following storeand browse toTrusted Root Certification Authorities Once installed toTrusted Root Certification Authorities,repeat the certificate installationsteps above, but choose the certificate storeTrusted Publishers Important:The WSUS Signing Certificate must be installed at both theTrusted Root Certification AuthoritiesandTrusted Publishers Once theWSUS Signing Certificateis installed on theNLBMasterFrontEndServerWSUS server, any future published updates should not be automatically deleted. For any third-party update (.CAB files) that have already been deleted, you will need to republish those products as new updates using the articleWhen and How to Republish Patch My PC Third-Party Updates Note:The WSUS Signing Certificate should be installed onall devices in your environment. You can review our guideHow to Deploy the WSUS Signing Certificate for Third-Party Software Updatesfor information on deploying the WSUS Signing Certificate site-wide. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/nomachine-enterprise-desktop-failed-install/", "title": "NoMachine Enterprise Desktop installation failure ConfigMgr Intune", "raw_text": "NoMachine Enterprise Desktop installation failed The installation of NoMachine Enterprise Desktop installation fails when an older version is installed. Determine if You are Affected The installation might fail when an update is attempted on a device with an older version of NoMachine using a ConfigMgr base application or an IntuneApp.If the older version of NoMachine is thefree versionand not theEnterpriseversion, then the install will fail.The installation will fail withExit Code 1. Also, if we investigate theAppEnforce.logfile, it will show us the same exit code: Finally, if theRight click customizationoption to enable additional, vendor verbose installation logs \u2013Manage installation logging\u2013 is enabled, the vendor log will show the exact cause of the failure: Resolution The resolution would be to make sure that theFree Versionof NoMachine is uninstalled before theEnterprise Versionis installed. We recommend one of these options: Supersede with uninstall:Deploy the update of theFree Versionto that device to make sure the latest version of the Free edition is installed.Create theConfigMgr app/IntuneAppfor the Free Version.Edit theEnterprise Editionof NoMachine and set it tosupersede with uninstalltheFree Version.When NoMachine Enterprise Edition will install, the Free Version app will run first to uninstall it, and once complete, the Enterprise Edition app will run the install. Deploy the update of theFree Versionto that device to make sure the latest version of the Free edition is installed. Create theConfigMgr app/IntuneAppfor the Free Version. Edit theEnterprise Editionof NoMachine and set it tosupersede with uninstalltheFree Version. When NoMachine Enterprise Edition will install, the Free Version app will run first to uninstall it, and once complete, the Enterprise Edition app will run the install. Use a custom script to uninstall the Free Version.Use the Right-Click customization option toManage custom pre/post scripts.Create your own script to uninstall the Free Version of NoMachine and use that as a customPreInstallScript forNoMachine Enterprise Desktop.TheUninstall-Software.ps1script we offer to the community can be used to uninstall a software based on it\u2019s DisplayName. Use the Right-Click customization option toManage custom pre/post scripts. Create your own script to uninstall the Free Version of NoMachine and use that as a customPreInstallScript forNoMachine Enterprise Desktop. TheUninstall-Software.ps1script we offer to the community can be used to uninstall a software based on it\u2019s DisplayName. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-download-content-id-id/", "title": "Access Denied Error, Sccm, Download Failure", "raw_text": "Failed to download content id. Error: Access is Denied. Error0X87D20417,0x80070005, or5, generally occurs when attempting to download software updates (whether third party updates or Microsoft updates) into a deployment package. When attempting to download an update into a deployment package in the SCCM console, you receive the error message:Failed to download content id Error: Access is denied. Determine if You are Affected Whenever a software update is being downloaded, regardless of whether it\u2019s a Microsoft or third-party update, you receive the following error using the Download Software Updates wizard in the console: Looking in thePatchDownloader.logfile we can also see an error code which resolves to access denied (0x80070005): Download destination = hostnameSourcesSoftware UpdatesPatch My PC Updates2f57c5d1-aab5-46a3-bbed-fdfec4101f23.18364431e-00b7-4f9b-8551-de6aa3dbbcec_1.cabDownload destination = hostnameSourcesSoftware UpdatesPatch My PC Updates2f57c5d1-aab5-46a3-bbed-fdfec4101f23.18364431e-00b7-4f9b-8551-de6aa3dbbcec_1.cabContentsource = http://hostname:8530/Content/48/AE431DC3B6D7F1FC4AC7C80FC6D0570F4B166C48.cabFailed to create directory hostnameSourcesSoftware UpdatesPatch My PC Updates2f57c5d1-aab5-46a3-bbed-fdfec4101f23.18364431e-00b7-4f9b-8551-de6aa3dbbcec_1.cab, error 5CreateLinkToExistingFile() failed for ContentID 16777459. hRes = 0x80070005Downloading content for ContentID = 16777459, FileName = 8364431e-00b7-4f9b-8551-de6aa3dbbcec_1.cabProxy is enabled for download, using registry settings or defaultsFailed to create directory hostnameSourcesSoftware UpdatesPatch My PC Updates2f57c5d1-aab5-46a3-bbed-fdfec4101f23.1, error 5ERROR: DownloadUpdateContent() failed with hr=0x80070005 If using Automatic Deployment Rules (ADR), the error code will be different and unfortunately a little more generic (0X87D20417): Looking at theruleengine.loglog file for ADRs, we can find a more useful error code which also resolves to access denied (5): Failed to download the update content with ID 16777460 from internet. Error = 5Failed to download ContentID 16777460 for UpdateID 16777951. Error code = 5Failed to download any updateFailed to download update contents. Root cause Depending on whether you\u2019re using the SCCM console to download the updates, or using ADR, it\u2019s going to by either the user running the SCCM console or the SYSTEM account of the site server missing SMB/NTFS permissions on the Deployment Package\u2019s source path. The solution is toreview the SMB and NTFS permissionsof the source path used for the Deployment Package. If you\u2019re seeing this error while using ADRs,verify the SYSTEM account of the site server has the necessary read/write permissions. If you\u2019re seeing this error while using the SCCM console,verify the user running the console has the necessary read/write permissions. Solution: Verify SMB and NTFS Permissions on Deployment Package Source Path First you need to find out what the source path is for your Deployment Package. Right click the Deployment Packageyou, or your ADR, is trying to download to and chooseProperties: Go to the directory in File Explorer andverify the user or computer object has at least Modify permissionin theSecuritytab of the folder\u2019s Properties: Note:It\u2019s not necessary to directly add the user or computer object here. It is possible to use Active Directory groups to contain users or computer objects. If the NTFS permissions look fine, next you will need to verify SMB permissions on the shared folder itself. For example, in the above screenshots the Deployment Package source path isdemo3SourcesSoftware UpdatesPatch My PC Updates. We need to verify the SMB permission on theSourcesshared folder. The instructions to verify SMB permissions will vary between platforms, i.e. it\u2019s possible to create a shared folder from Synology or NetApp systems. The below detail is specific to a shared folder hosted on a Windows operating systeml. Open up theComputer Managementmmc snap in (protip: right click on the start menu and chooseComputer Management), expandShared Foldersand selectShares: Right click on the shared folder in the centre pane and chooseProperties. In this case I will right click onSources. Go to theShare Permissionstab andverify the user or computer object has at least Change permission. As you can see from the above, only theEveryoneobject is in the Access Control List (ACL) with only theReadpermission. This will need changing to allow the user or computer object access to the shared folder with theChangepermission. Whether you remove theEveryoneobject and use specific identity objects is your discretion. In any case, you would need to make sure the needed user or computer object is granted Change or Modify permissions, for both the SMB and NTFS permissions respectively. Note:It\u2019s not necessary to directly add the user or computer object here. It is possible to use Active Directory groups to contain users or computer objects. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/smtp-authentication-exchange/", "title": "SMTP Authentication Exchange Online", "raw_text": "Patch My PC SMTP Authentication for Exchange Online Purpose of this article Patch My PC\u2019s Publisher, at this time, cannot support Modern authentication and relies online SMTP authentication for sending its email reports. In this article we will look at how to reenable SMTP authentication for 1 specific mailbox, which will allow Patch My PC\u2019s Publisher to authenticate and send emails through your Exchange Online environment. History it is generally a bad practice to have an open/anonymous/unauthenticated relay for messaging on the internet, as a messaging server that is either intentionally or unintentionally configured in such a way to allow messages from any source to be routed through the relay completely transparently. This type of configuration is very sought after and can be used maliciously if discovered. Exchange Online does not allow this type of relay by default, and configuring one is somewhat obfuscated. We will not discuss how to configure that here today. Where such a relay is not configured, systems must authenticate against a standard relay to be permitted to send emails, which is the preferred approach. However, Exchange Online, by default (as of a recent change \u2013 2023), does not allow basic authentication or the use of SMTP authentication. The default now is Modern authentication (Oauth 2.0 token-based authenticate), which uses tokens and provide enhanced security features such as multi-factor authentication (MFA). Disabling basic authentication helps protect against attacks like credential stuffing, brute force, and phishing, which helps improve the overall security of Exchange Online environments. That said, this type of relay is still a common requirement for many organizations with internal web, app, or database servers, monitoring applications, or MFPs that can generate emails but cannot always send them without using such a relay. Additionally, many of these applications, servers, and MFPs cannot perform the actions required to use Modern authentication, especially if something like MFA is configured. Lastly, in newer tenants, all of this is topped off by Authenticated SMTP being blocked, even if you turn it on for 1 mailbox, if Security Defaults are enabled in your Entra ID Tenant. Note: Basic Auth is now deprecated in Exchange Online \u2013https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/deprecation-of-basic-authentication-exchange-online/https://techcommunity.microsoft.com/t5/exchange-team-blog/improving-security-together/ba-p/805892 Determine if you are affected. When providing an email address and password for email authentication in the Publishers alerts tab, if that mailbox does not SMTP authentication enabled, you will see the following error message. An error occurred while sending the test mail: The SMTP server requires a secure connection, or the client was not authenticated. The server response was: 5.7.57 Client not authenticated to send mail. Error: 535 5.7.139Authentication unsuccessful,SmtpClientAuthentication is disabled for the Mailbox.Visit https://aka.ms/smtp_auth_disabled for more information. HResult: -2146233088. If Authenticated SMTP is already enabled, but your Entra ID Tenant has Security Defaults enabled, Publisher will still be unable to authenticate and show this error instead. An error occurred while sending the test mail: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.7.57 Client not authenticated to send mail. Error: 535 5.7.139 Authentication unsuccessful, user is locked by your organization\u2019s security defaults policy. Contact your administrator. HResult: -2146233088. Please see kb: https://patchmypc.com/troubleshooting-smtp-email-sending Resolution To allow Publisher to send email reports through Exchange Online, you will need to configure an account to be allowed to authenticate using SMTP authentication and disable Security Defaults if enabled, following the steps outlined below Ensure your account is licenced to be a mailbox In the example below I am using Exchange Online (Plan 2), but there are alternative licences available. Enable SMTP authentication on your licenced mailbox Navigate to the Microsoft 365 admin center and select Active Users \u2013Active users \u2013 Microsoft 365 admin center, Then select the mailbox you wish to configure, click on Mail, followed by Manage email apps. Check the box forAuthenticated SMTPand click Save changes. Disable Security Defaults in Entra ID Note:This may not be applicable if your tenant was created before October 2019 and you have not configured any policy around this, or you may already have it disabled for other reasons. Tenants created after October 2019 have Security Defaults enabled by default,Raising the Baseline Security for all Organizations in the World \u2013 Microsoft Community Hub Navigate to your Entra ID Tenant overview, select Properties, Manage security defaults, Switch to disabled, click Save Note: You can read more about security defaults and the impact this change may have here:https://learn.microsoft.com/en-us/entra/fundamentals/security-defaults Security defaults \u2013 Microsoft Entra admin center 1000 years later (When these changes propogate)\u2026 Wait a while (It took about an hour for me) for it to take effect, and then retry the test email in Publisher. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-deprecation-what-it-means/", "title": "Windows Server Update Services, Deprecation, Microsoft, Patch My PC", "raw_text": "WSUS Deprecation: What It Means for Patch My PC Customers On the 20th Septemeber 2024,Microsoft announcedthe deprecation ofWindows Server Update Services (WSUS), encouraging their customers to explore more modern update management solutions. Despite this announcement,Patch My PC customers are unaffected. WSUS will continue to be supported in its current state, and no action is required by our customers. This article explains the deprecation in more detail and reassures customers about its non-impact on their environments. Microsoft Announcement Microsoft announced the deprecation ofWindows Server Update Services (WSUS).Deprecation, in this context, means that Microsoft are no longer adding new features or accepting requests for them. However, existing functionality will remain, and updates will continue to be published through the WSUS channel. It has been confirmed that WSUS will still be available onWindows Server 2025and beyond. Importantly, there are also no current plans to remove the WSUS feature from existing supported Windows Server versions. You can read the announcement athttps://techcommunity.microsoft.com/t5/windows-it-pro-blog/windows-server-update-services-wsus-deprecation/ba-p/4250436 Patch My PC Resonse At Patch My PC, we understand that this notice from Microsoft may raise concerns with our customers. In short, the WSUS deprecation announcement will haveno immediate effecton our customers existing patching processes. No Action RequiredYou can continue using WSUS as part of your existing update management workflows. Our service will continue to support WSUS, allowing you to receive updates and patches as usual. Long-Term SupportWSUS will remain available in its current form, with no end-of-life date announced yet. Patch My PC will monitor closely any further announcements from Microsoft that may affect compatibility and long-term support for our customers who are leveraging WSUS. Future PlanningWhile WSUS is being deprecated, we do have a plan to ensure any future updates to Microsoft\u2019s strategy will not negatively impact our customers. For customers usingConfiguration Manager, WSUS remains a critical component for updates. Microsoft has confirmed that WSUS deprecation will not impact existing capabilities or ConfigMgr\u2019s integration. In the unlikely scenario where WSUS is discontinued,Patch My PChas prepared for alternative approaches to ensure updates for third-party applications will continue seamlessly. Summary Microsoft\u2019s WSUS deprecation is a significant industry development, but not unexpected given it has had very few feature enhancments in the last 10 years. Our customers can continue to rely on Patch My PC for their update management needs without making any immediate changes to their processes. For customers using co-management in Configuration Manager or considering moving toMicrosoft Intunefor client operating system updates,Patch My PCcan help you navigate this transition to understand the impact on third-party patching. We can also assist in migrating the third-party applications and updates workload to Intune. We remain committed to providing you with seamless patching solutions and will handle any future transitions in a way that ensures uninterrupted service. If you have any questions or would like more information, pleasecontact our support team. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/list-domains-firewall-allowlist-when/", "title": "whitelist, firewall, exceptions, filter", "raw_text": "List of Domains for Firewall Allowlist when Using Patch My PC When updates are published usingfull contentfrom our catalog, the Publisher will need to download content filesfrom patchmypc.comandother vendor\u2019s websites. You need to allow traffic to the domains for products that you choose to publish with full content. The Publisher downloads content for updates and applications directly from the vendor\u2019s website. In the case any vendorresides in a region that is geo-blocked, the Publisher cannot download the binaries for the corresponding vendor. Ifuser-agent filtersare in place, you need to allow \u201cPatch My PC Publishing Service*\u201d for the publishing service\u2019s user agent. Review Download Failures from Firewall Rules for Previous Synchronizations In addition to the full list of domains provided below, we also store thelast download response code and domain for currently enabled products. This can be helpful when reviewing download failures for currently enabled products. The download history can be found on a CSV file in:%InstallDir%\\PatchMyPC-DownloadHistory.csv Here\u2019s an example of the data included in thePatchMyPC-DownloadHistory.csv file. You can use thedomain column to create firewall exceptionsbased on the products enabled and failing to download. List of Domains Always Required Note: The list of potential Digicert domains can be found here (Only CertCentral Global CRLs are required):DigiCert Certificate Status IP Addresses List of Domains/IP Ranges for Intune If you are publishing to Intune, as well as the above domains, you will also need the necessary domains, ports, and protocols for Microsoft Azure too. Allow the following Azure portal URLs on your firewall or proxy serverhttps://docs.microsoft.com/en-us/azure/azure-portal/azure-portal-safelist-urls?tabs=public-cloud Azure IP Ranges and Service Tags \u2013 Public Cloud *https://www.microsoft.com/en-us/download/details.aspx?id=56519 *If you are a US government cloud customer, use this link for Azure IP Ranges and Service Tags insteadhttps://www.microsoft.com/en-us/download/details.aspx?id=57063 List of Domains for Update Content (Based on Products Enabled for Published) You can also download a .CSV file with the list of possible domains, ports, and protocols that would need to be whitelisted. Download CSV file for Firewall Allowlist Keywords:whitelist, firewall, exceptions, filter, filters, allowlist Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/troubleshooting-smtp-email-sending-when/", "title": "SMTP, Email Sending, Troubleshooting, Configuration", "raw_text": "Troubleshooting SMTP Email Sending When Using Patch My PC This article covers steps you can take to troubleshoot emails failing to send within our publishing service. Ourautomated email reportscan be helpful to keep you informed when third-party products are publishing. These emails contain a lot of useful details like release notes, update classification, severity levels, and CVE IDs, as shown below: If you can\u2019t send emails, the problem is almost always related to theSMTP server configuration. Here are common issues we see that we recommend checking: IncorrectSMTP Server details SMTPportandprotocol Verify allusernamesandpasswords Firewallsettings Step 1: Check Your Ports One of the most common issues we see is the ports defined aren\u2019t correct for the customer\u2019s SMTP server. By default, our service is configured to usePort 587andUse TLS. These are the default settings for many public email providers like Office 365, Outlook.com, and Gmail. If you are using aninternal SMTP server, it may be different such as the defaultPort 25,or it may not be configured forTLS. Step 2: Is Authentication Required? Another common issue is that your SMTP server may require authentication, but you didn\u2019t set theloginandpasswordfor aSpecified User. Step 3: Does Sending Work in the UI But Not During An Automated Sync? In some cases, you may be able to send a test email manually in our UI by clickingTest, but emails to send during a synchronization with errors in the PatchMyPC.log Generally, this is because your SMTP server allowsdomain accountsto send emails, but doesn\u2019t allow anonymous users to send. Since our settings tool UI is running under your local user context, it will enable the email to send. However, our service runssynchronizationsunder thelocal SYSTEM accountas a service that may not be allowed to send emails through your SMTP server. In this scenario, try to configure anauthentication accountby selectingSpecified Userand setting theLoginandPasswordfor that user: Step 4: Try Using A Common Provider? If sending is failing using an internal SMTP server, you can attempt to use a public email service. Click the drop-down menu and select your provider, if supported, we will pre-fill server, port, and TLS settings. You will need a valid email and password and ensure the outgoing ports aren\u2019t blocked. Step 5: Ask Your Email Team To Verify Settings and SMTP Logs If you have a dedicated team for email, we recommend having them review all the configurations within our tool. We Hope This Helped Resolve Your Issue Hopefully, this guide helped resolve your issue. Generally, we are going to be very limited in the support we can provide for SMTP emails as the sending is all performed on the SMTP server. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/site-database-collection-options-application/", "title": "Configuration Manager Database Server, Site Database, Device Collection, Scanning", "raw_text": "Site Database and Collection Options for Application Scanning This article will describe how to quickly find the correctConfiguration Manager database server nameanddatabase name. Set the Configuration Manager Database Server and Database Name To find the database server and database name, navigate toAdministration>Monitoring>System Status>Site Statusin your configuration manager console. Here you will find the Site database server site system that contains the details required. Are You Using a Custom SQL Server Instance for the Site Database? Although less common, if you are using a custom SQL instance, use%Server%%Instancename%in the Server Name input box. Limit Scanning to a Specific Collection By default, the device collection is not set. When empty, the scan for support products is performed againstAll Systems. Optionally, you can choose a device collection by clicking the browse icon. When a device collection is enabled, the results for detected applications will befiltered to devices in the specified collection. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/registry-publisher-config/", "title": "Registry Values, Publisher Settings, PowerShell Scripts", "raw_text": "Advanced Configurations Using Registry Values for Publisher In this article, we will describe someadvanced settingsyou can make using registry values for ourPublisher. There are some scenarios where we need to change a default behavior to address specific customer issues/needs. These advanced settings are not available via the Publisher user-interface and canonly be set via RegValues. Enable the Delete Update Button in the Modify Updates Wizard The delete update button is not enabled by default because it can cause hash issues if an update is deleted while that product is still enabled, causing the same UpdateID to be republished. If you have a scenario to delete updates, such as cleaning upvendors from WSUSyou can enable the button using the value below. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v EnableDeleteUpdates /t REG_DWORD /d 1 /f Save Detection Method PowerShell Scripts to Custom Folder Based onUserVoice feedback, you can now save all PowerShell detection method scripts to a secondary folder location. By default, all detection method scripts are also saved to \u201cDetection Method Scripts\u201d REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v DetectionMethodScriptsAddtionalSavePath /t REG_SZ /d \u201cserverexamplefolder\u201d /f Change SCCM Query to Use v_GS_INSTALLED_SOFTWARE SQL View By default, we use the v_Add_Remove_Programs SQL view to query the supported products in our SCCM scan feature. For extremely large environments, SQL queries against this view can be slower since it\u2019s not indexed. You can change the view to use the v_GS_INSTALLED_SOFTWARE for better performance since it is indexed. Note: this view will contain slightly different results since it\u2019sbased on asset intelligence. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v UseGSINSTALLEDSOFTWARE /t REG_DWORD /d 1 /f Change the SQL Timeout Period By default, the SQL timeout period for each product query is 90 seconds. This can be changed using the REG ADD command below where 300 is the number of seconds for the timeout. Valid timeout ranges are from 1 \u2013 600. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v SQLTimeoutinSeconds /t REG_DWORD /d \u201c300\u201d /f Increase the HTTP Download Timeout By default, theHTTP download timeoutperiod is 15 minutes. This can be changed using the REG ADD command below where 1800 is the number of seconds for the timeout (30 minutes). Valid timeout ranges are from 10 \u2013 3600 (10 seconds to 60 minutes). REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v DownloadTimeout /t REG_DWORD /d 1800 /f Change the Timeout for Intune Reports By default, the timeout when waiting for an Intune report to finish is five minutes. This can be changed using the REG ADD command below, where 10 is the number of minutes for the timeout. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v IntuneReportsRequestTimeout /t REG_DWORD /d 10 /f Note:This registry setting was made available in version 2.1.36.32 of the Publisher. Change Catalog XML Parsing to Use Sequential Method By default, we use a parallel method to parse our catalogs\u2019 XML. In some rare cases, you may receive an error in thePatchMyPC.logsaying: Error while parsing XML node of the catalog: Index was outside the bounds of the array If this occurs, add the registry value below to change it to use a sequential method, and restart the PatchMyPCService. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v UseSequentialMethod /t REG_SZ /d \u201c1\u201d /f Force legacy method to sign PowerShell scripts By default, we will attempt to use native .NET code in order to code sign PowerShell scripts that are generated by the Publisher. For example, detect scripts, requirement scripts, and recommended pre/post scripts. Additionally we fall back to using PowerShell to sign these scripts if the .NET signing fails. If .NET code signing is failing, or you do not wish to use it you can use the below REG ADD command and then restart the PatchMyPCService. The result is all code signing will be done using the Set-AuthenticodeSignature cmdlet. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v UseLegacyMethodToSignScript /t REG_DWORD /d \u201c1\u201d /f Note:This registry setting was made available in version 2.0.5.1 of the Publisher. Change the max number of threads to use for uploading content to Azure By default, the Publisher will use10 threads when uploading chunks to azure for Intune publishing. If the internet connection is unable to remain stable while the upload is occurring then the number of threads can be reduced. An example is below for setting the number of threads to 1.The number of threads can range from 1-10with 10 being the default. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v AzureUploaderMaxThreadCount /t REG_DWORD /d \u201c1\u201d /f Note:This registry setting was made available in version 2.1.9.11 of the Publisher. Change the chunk size to use for uploading content to Azure By default, the Publisher will use a12MB chunk size when uploading chunks to Azure for Intune publishing. You may want to adjust this if the Publisher is failing to uploaded files to Intune. The maximum value is 12582912, or about 12MB, and the minimum value is 2097152, or about 2MB. An example is below for setting the chunk size to 10485760, or about 10MB. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v AzureUploaderChunkSize /t REG_DWORD /d \u201c10485760\u201d /f Note:This registry setting was made available in version 2.1.21.12 of the Publisher. Use the embedded browser for creating the cloud connection By default, the Publisher will use the \u2018System Default\u2019 browser when prompting for credentials when creating a cloud connection. If this does not allow for a connection to be created it is possible to switch to the \u2018Embedded\u2019 browser. REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v MsalUseEmbeddedWebView /t REG_DWORD /d \u201c1\u201d /f Note:This registry setting was made available in version 2.1.21.2 of the Publisher. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-use-process-monitor-help/", "title": "Process Monitor, Windows, Antivirus, Troubleshooting", "raw_text": "How to use Process Monitor to help diagnose publishing issues In the following article we will show you how to use Process Monitor (procmon) from Sysinternals to collect file system, registry and process events to assist a Patch My PC support engineer with diagnosing publishing issues in both WSUS and ConfigMgr. Overview Sometimes we require more details to help diagnose publishing issues in your environment.Process Monitor, from Sysinternals, commonly referred to asProcmon, is an advanced monitoring tool for Windows that captures real-time file system, registry and process activity. We often see antivirus engines locking files during publishing and a procmon trace is useful to help flag to security teams the correct antivirus configurations and exclusions to put into place. A procmon trace is also very useful at revealing competing antivirus products installed on the same server which will exasperate file locks. We often encounter this when customers perform in-place upgrades on servers from Server 2012 > higher. Windows Defender must be explicitly disabled or set to passive mode after an in-place upgrade if you are using a third-party antivirus solution. See the following advice from Microsoft for more informationMicrosoft Defender Antivirus on Windows Server | Microsoft Learn Note:Please see the following KB for the recommended antivirus exclusions when publishing apps and updates to ConfigMgr, WSUS and IntunePatch My PC \u2013 Recommended antivirus exclusions Download Procmon from Sysinternals Procmon can either be downloaded as a zip file (1) or as an executable (2) from the Sysinternals website. Typically, we recommend downloading the zip file and extracting the contents to disk so they can be used for continuous troubleshooting when working with our engineers on a support case. Downloadthe zip file from thie websitehttps://learn.microsoft.com/en-us/sysinternals/downloads/procmonor directly from this linkhttps://download.sysinternals.com/files/ProcessMonitor.zip.Once downloaded, extract the contents to a folder. The extracted zip file will reveal the following files which we will use for troubleshooting. Run a procmon trace to diagnose publishing issues Unless otherwise instructed, a procmon trace is run from the same computer where the Patch My PC Publishing Service is installed. 1. Runprocmon.exe(1) on the same computer where the Patch My PC Publisher Serviceis installed (2) 2. Agree to the Sysinternals licence terms 3. Procmon will start collecting events straight away. To avoid unnecessarily \u00e2\u0080\u008blarge capture files, stop the capture until you are ready to reproduce the issue. Stop the trace by clicking theCaptureicon on the toolbar. 4. Clear the current trace by clicking theClearicon on the taskbar. 5. Re-produce the publishing issue by selecting the appropriate products in the Publisher and from theSync Schedule(1) tab clickRun Publishing Service Sync(2). 6. Immediately, in procmon click theCaptureicon on the toolbar to begin capturing the publishing events that occur during the sync. 7. Once publishing has completed, click theCaptureicon on the toolbar again (see above) to finish the capture. You can verify the sync has completed by reviewing the following log file and observing the*** Reportlog line. This log line indicates the sync has completed and will report any success and failures. %PatchMyPCInstallDirectory%\\PatchMyPC.log 8. Save the capture by clickingSavefrom theFilemenu. 9. Unless instructed to filter captured events, ensure the following options are selected:- Events to save =All events Format =Native Process Monitor Format (PML) Path =Make a note of the path where the .pml file will be saved By default, the .pml file will save into the same folder that procmon.exe was launched from and will be namedLogFile.PML. 10. Finally, the .pml file will compress very well. Please compress the file before sending it to Patch My PC support. Send the capture (pml) file to Patch My PC support IMPORTANT:As well as sharing the capture with us, we also require the relevant log files to help us match failed publishing events with the captured events. Your support engineer will ask for the relevant log files, as listed in the KBCollecting Log Files to Send to Support for SCCM and Intune \u2013 Patch My PC. Even after compressing the .pml file, it is normally too large to send via email. Please upload the captured eventsandrequested log files, in .zip format. We recommend renaming the zip file so its descriptive and can easily identified by your support engineer. For example:- ProcmonCapture-for-PatchMyPC-from-ContosoLtd.zip Upload the file(s) to support viahttps://patchmypc.com/share Note:The following KB has more details on how to share files with support:Share Large Files with Patch My PC for Support Case Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/acrobat-mst-transform/", "title": "Adobe Acrobat Reader Customization, MST Transform, Patch My PC, ConfigMgr", "raw_text": "Add an MST Transform to the Adobe Acrobat Reader Base Install You can customize the Adobe Acrobat Reader using a customMST transformfile via Patch My PC using ourcustom command line feature. The Adobe Acrobat Reader Base Installation uses the executable (.EXE) installer by default, not an MSI. However, it is still possible touse a custom MST to customize the Reader installation. Follow the instructions below to add a custom MST to the Patch My PC Base installation for Adobe Acrobat Reader. Note:Patch My PC uses the latest Adobe Acrobat Reader EXE based installer for Base installations. Because of this, the Adobe Acrobat Reader version installed via the base installation feature may not match the latest MSP patch provided by Adobe. Adding the MST file Generate your MST transform fileusing the Acrobat Customization Wizard or similar MSI modification software. Place the generated MST in a centralized location that the Patch My PC Publisher has access to. Open the Patch My PC Publisher and navigate toConfigMgr Apps->All Products->Adobe Systems, Inc.->Adobe Acrobat Reader DC Right-click the application to modify and choose toAdd custom pre/post update installation scripts. ClickBrowse\u2026 next to theAdditional Fileslist box and select your customMST file, ClickOK. Right-click the application to modify once more and chooseModify Command Line Enter the following in the Additional Argument field and clickOK:TRANSFORMS= ClickApplyandrun a Syncto update the Application in ConfigMgr. After the sync completes, the MST customizations should apply tofuture installationsof the Adobe Reader base application. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-bundle-cisco-anyconnect-modules/", "title": "Cisco AnyConnect modules, Patch My PC, Script installation", "raw_text": "How to bundle Cisco AnyConnect modules to install in a specific order The Cisco AnyConnect Secure Mobility Client module needs to be updated first on an endpoint before you can update any of the other modules. If you try and update any of the modules, before first updating the Secure Client, you will get an error similar to the below: This article will demonstrate how you can control the order of install for the Cisco AnyConnect modules, and also bundle in thepreferences.xmlandconfiguration.xml. It is not necessary to follow this process in order to patch the AnyConnect modules. However, it will optimise the order of operations during the patching flow by ensuring all the modules are installed within one patch, and in the correct order. We will leverage the custom right click actionAdd custom pre/post scriptson the Cisco AnyConnect Secure Mobility Client product to install the other modules as part of a post install script, i.e. to install the other modules after the Secure Mobility Client has installed. The steps covered in this article can be used in all tabs in Publisher: Updates, ConfigMgr Apps, Intune Apps and Intune Updates. Note:The Cisco AnyConnect modules are part of our catalogue using thelocal content repository. Note:Make sure you select the product you want to bundle within the Patch My PC Publisher. If you want to deploy version 4.x \u2013 select theCisco Anyconnectproducts If you want to deploy version 5.x \u2013 select theCisco Secure Clientproducts. Step 1: Download modules Download all the latest Cisco AnyConnect modules andstore only the Secure Mobility Clientinstaller in yourlocal content repository: Step 2: Enable the product and configure post script Within the Patch My PC Publisher, ensure youonly have the Cisco AnyConnect Secure Mobility Client enabled. Right click on the product and chooseAdd custom pre/post scripts. Download and savePatchMyPC-Install-CiscoAnyConnectModules.ps1. This is the post-script which will call the other module installers. At the subsequent dialogue, clickBrowsebeside Post Script and choose thePatchMyPC-Install-CiscoAnyConnectModules.ps1script file. This script will install all of the other module installer files after theSecure Mobility Clienthas installed. ClickBrowsebesideAdditonal Filesand choose all of the other Cisco AnyConnect Modules you need,excluding the Secure Mobility Client(typically namedanyconnect-win-x.x.x-core-vpn-predeploy-k9.msi). Doing this will include the other module installers within the same the content payload as the Secure Mobility Client package. Also include theconfiguration.xml or preferences.xmlasAdditional Filesif you would like them automatically copied to the newConfigFiles folder for the Network Access Manager module after installation. ClickOK. Step 3: Synchronize to publish Now the product is configured you are ready to publish. Navigate to the Sync Schedule tab and clickRun Publishing Service Sync. Once publishing is complete,you will see only one update or application for the Cisco AnyConnect Security Mobility Client. This will include all installers for the other modules, which will be installed on the device after the Security Mobility Client has been installed. Moving forward and dealing with new updates When a new version of the modules has been released by Cisco, the process is: Repeat Step 1of downloading all of the needed modules from Cisco\u2019s website and storing the Secure Mobility Client installer in your local content repository. Right click on theCisco AnyConnect Secure Mobility Clientproduct in the Publisher, chooseManage custom pre/post scriptsandremove all of the existing additional files,andreplace them with the newly downloaded module installers. It is not necessary to redownload thePatchMyPC-Install-CiscoAnyConnectModules.ps1script and re-add that back in to the Publisher. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/introducing-proactive-customer-care/", "title": "Proactive Customer Care Automation Software Updates Security", "raw_text": "Introducing Proactive Customer Care Today, we\u2019re excited to announce our newproactive customer care program. Below we will cover what this actually means and why we think this program will benefit our customers. What is Proactive Customer Care? Our proactive customer care program is a way to help ensure ourPublishing softwareis running smoothly and successfully publishingthird-party updatesandapplicationsto Windows Server Updates Services (WSUS), Configuration Manager, orMicrosoft Intune. If we receiveinsightsthat key operations failed, such as publishing a third-party update to WSUS, we want to notify you and ensure things are running smoothly again as soon as possible. Why We Think It\u2019s Important From an engineering perspective, our biggest goal is for you to set our software up once, and thenit just works. Generally, this works great since everything is fully automated after setup, and day-to-day work is performed using yourexisting workflowsin the Configuration Manager console orIntune portal. If you enabled theSMTP email featureorMicrosoft Teams notificationsin our Publisher, as shown below, we would already notify you about anyhealth issues. Here\u2019s an exampleemail alertyou would receive if yourWSUSContent is misconfigured. Our goal with proactive customer care is to send alerts containing key information abouterrors in your environment,even if youdidn\u2019t enable emails using SMTP settingsdirectly in our software. We don\u2019t want customers to realize there are issues when they notice a new0-day vulnerabilityisn\u2019t showing up in their environment. Proactive Alerts for Optimizing Performance Starting in July 2021, we will also send alerts for settings that could allow you to optimize various configurations to avoid future problems. For example, in Configuration Manager 1806, there are new settings forsoftware update maintenancethat aren\u2019t enabled by default. If these settings aren\u2019t enabled, you could receive a proactive email to let you know this could help improve performance and reliability. How Does Proactive Customer Care Work? By partnering with our customer base of over 2,000, we have seentrendsandrecurring issuesthat lead to a list ofknowledge base articlesto solve known issues quickly. Last month, we included a newtelemetry optionto let us know if you receive any error messages during important publishing operations for updates and applications. If we detect aknown issuethrougherror insights, we will send you a direct email containing the information about how to resolve the issue. Here\u2019s an example of what a proactive email would look like: Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/upgrading-outdated-microsoft-teams-webhook/", "title": "Microsoft Teams Webhook, Upgrade, Security Update", "raw_text": "Upgrading an Outdated Microsoft Teams Webhook When running an outdated Microsoft Teams webhook, you will receive the alertImportant: Your connector is running on old configuration. Navigate to connector configuration window to update to new configuration. This article will review how to identify an outdated webhook, and if necessary, upgrade your Microsoft Teams webbook connection. In mid-January of 2021, Microsoft performed an upgrade to provide increased security on incoming webhook URLs. This change was communicated via the messaging center in your Tenant. See the below link. Admin Center Message center: Microsoft Teams connector apps webhook URL security improvement Determine if You are Affected You recently might have seen the following message in Microsoft Teams if you have the Patch My PC or other configured webhooks. Warning Message:Important: Your connector is running on old configuration. Navigate to connector configuration window to update to new configuration. How to Resolve Warning \u201cYour connector is running on old configuration.\u201c If you see this message, you can validate the root cause as an out-of-date connector by browsing thechannel\u2019s connectors. Once you have opened theconnectors panefor the channel, you will review your webhooks and other related connectors. Select \u201cConfigured\u201d from the left-hand side. Then scroll through all your configured connectors until you find the \u201cIncoming Webhook\u201d section. In this section, select \u201cconfigured\u201d to open all of the resources that use the webhook. If the connections denote \u201cattention required\u201c, you will need to rebuild the webhook to cause the URL to update. You will need to find thewebhookin use for thePatch My PC service from this list. Once you find it selectmanageto view the configurable options for the webhook. Once updated, you will notice thewebhook URLwill change the old prefix ofoutlook.office.comto{yourdomain}.webhook.office.com Note:In the event, theUpdate URLbutton does not properly regenerate a new URL, then we recommend using the remove option to delete the webhook andcreating a new webhook from scratch. Valid the Webhook was Updated and Can be Used To validate the updated webhook works, you can use theTestbutton in the Publisher\u2019sAlerts tab. You should see atest notificationin the channel, and the message shouldn\u2019t give the warning that the connector is running an old configuration. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/1password-install-it-team/", "title": "1Password installation issue resolution", "raw_text": "1Password \u2013 Your IT team will need to install 1Password for you. During the installation of 1Password, despite it being done silently, the user receives this message and the installation doesn\u2019t complete: Your IT team will need to install 1Password for you. Contact them for more information. The cause of this issue This issue appears when the installation of 1Password is attempted using the user-based installer (EXE) while a previous version is already installed which was installed using the system-wide installer (MSI). If you navigate to%localAppData%\\Local\\1Password\\logs\\setupand open thewindows_starter_rCURRENT.logfile, the following warning will be displayed: Resolution Ensure you are deploying the system-wide version of 1Password. Another solution would be to deploy the software as anupdate, as it will only apply if an older version of the corresponding installer is present on the device. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/custom-apps-support-pmpc/", "title": "Custom Apps, Patch My PC, Support Statement, Publisher", "raw_text": "Patch My PC Custom Apps \u2013 Public Support Statement Patch My PC Custom Apps is a feature that allows Patch My PC customers to upload their own applications to be made available inthe Patch My PC Publisher.This feature will be available in the Publisher for the following tabs:- ConfigMgr Apps Intune Apps Intune Updates\u200b Our engineers will be able to help with the initial configuration of the Custom Apps feature, ensure the upload of Custom Apps are successful, andthe app(s) appear for publishing in the Patch My Publisher.\u200b Additionally, our support team will be able to help ensure:-\u200b Application uploads are successful to the Custom Apps portal\u200b Connections to the Patch My PC Publisher are healthy\u200b Uploaded applications appear within the Patch My PC Publisher for publishing\u200b Login and User invite anomalies with the Custom Apps portal are addressed\u200b Other errors relating to Custom Apps that appear in PatchMyPC.log or the Custom Apps UI are resolved\u200b Our support team will offer \u201cbest-effort\u201d support for:-\u200b Custom Apps that fail to install on devices\u200b Custom Apps that fail to be detected on devices after installation\u200b Our support team are unable to:-\u200b Guarantee that every application can be packaged via the Custom Apps feature\u200b Build custom apps for our customers\u200b Write custom scripts to support the installation of Custom Apps To submit a support case concerning Patch My PC Custom Apps,Open a Support Case, and choose \u201cCustom Apps\u201d as the product. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-install-additional-notepad-display/", "title": "Notepad++, Installation, PowerShell, PatchMyPC", "raw_text": "How to install additional Notepad++ display languages with Patch My PC If you want to deploy Notepad++ in your organization on your managed devices,and would like to also install additional Display Languages during the unattended installation, follow this guide. At the time of writing this article, the Notepad++ installer does not support any parameters that will allow you to install additional languages. 1. Download the Notepad++ installer and run the installation manually. 2. Click through the wizard until you get to theComponentssection. 3. Select the languages you would like to deploy: In today\u2019s example, we chose English (included by default), German, and French. 4. Proceed with the installation. 5. Once you installed the app, go to the installation directory. In my case, I installed the 64-bit version, so I went to: \u201cC:\\Program FilesNotepad++localization\u201c. 6. Copy these files to your desktop, they will be used later. 7. Save the script lines below as a .ps1 file. Note: LEGAL DISCLAIMER The PowerShell script provided is shared with the community as-isThe author and co-author(s) make no warranties or guarantees regarding its functionality, reliability, or suitability for any specific purposePlease note that the script may need to be modified or adapted to fit your specific environment or requirementsIt is recommended to thoroughly test the script in a non-production environment before using it in a live or critical systemThe author and co-author(s) cannot be held responsible for any damages, losses, or adverse effects that may arise from the use of this scriptYou assume all risks and responsibilities associated with its usage 8. Edit row in the script and give the name of the XLS files you have on your Desktop. 9. Copy the ps1 script as well as the XML files on the server hosting the PMPC Publisher Console and save them in a location they won\u2019t be accidentally deleted. 10. Open the PMPC Publisher Console, right-click on Notepad++ (64-bit), and choose the \u201cAdd custom pre/post scripts\u201d right-click option. 11. Specify the ps1 file as a post-install script, as well as your files, as shown in the screenshot: 12. Run a sync to publish Notepad++ (64-bit). Make sure to test before a global rollout. Note:If the latest version of Notepad++ is already published through the Patch My PC Publisher, you will have to republish it with the updated configuration Note:By following this guid, you will only install the DisplayLanguages. Users then be able to choose the Display (Localization) language from the Notepad++ app \u2013> Settings menu \u2013> Preferences. This specific setting is specific to each user profile and can be set by creating/modifying this XML: %appdata%\\Notepad++\\nativelangs.xml. More infohere. Given ConfigMgr / Intune runs the installation as the SYSTEM account, if you aim to modify the file with a script, you will have to create one that takes into account all user profiles. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/optimizing-azure-sentinel-log-ingestion/", "title": "Azure Sentinel, Optimization, Excessive Events, Transformation", "raw_text": "Optimizing Azure Sentinel Log Ingestion for Intune Customers using the Defender XDR Connector Azure Sentinel is a powerful security information and event management (SIEM) platform, but as organizations scale, large amounts of data can quickly lead to high operational costs. For Intune customers using the Defender XDR Connector with Azure Sentinel, a common cause of excessive event ingestion is Win32 App Detection and Requirement scripts. These scripts are evaluated every 24 hours on each device for required apps. This frequent evaluation can lead to a significant increase in event volume, especially when targeting large numbers of devices with several hundred Intune Win32 app update policies. Determine if You are Affected TheDeviceProcessEventsand/or theDeviceFileEventstable can become noisy due to script executions by Intune Management Extension (IME). Specifically, events related to the execution of detection and requirement scripts. Win32 app detection and requirement scripts are all handled by the IME processAgentExecutor.exewhich, in turn, invokes powershell.exe. You may see excessive events when you run the following query agains theDeviceProcessEventstable. A useful KQL query to understand the extent of these invocations and recorded entries against the DeviceProcessEvents table can be found below. Note:This example data does not reflect the issue outlined in this KB. Workaround Azure Sentinel provides the ability to apply data transformations directly in the Log Analytics Workspace to customize data ingestion and processing. The following steps outline how to apply transformations to specific tables to exclude events related to the Intune Agent Executor. IMPORTANT Applying transformations to tables to exclude certain events may haveserious security implications. While transformations can help reduce noise and lower the cost of Azure Sentinel, they alsopermanently exclude data before it is ingested. Once excluded, the events areirrecoverable, which means they cannot be used forfuture analysis,threat hunting, orincident investigation. Ensure you carefully evaluate the impact of any exclusions, and consult with your security team before applying transformations. 1. Log in to the Azure Portal. 2. In the search bar at the top of the portal, typeLog Analytics workspacesand select it from the results. 3. From the list of workspaces, locate the Log Analytics Workspace associated with your Azure Sentinel instance. 4. From the left-hand menu, under Settings, click onTables. 5. Use the search bar to find theDeviceProcessEventstable. 6. Click on the ellipsis (\u2026) and selectCreate transformation. 7. SelectCreate a new data collection rule. 8. Select the desiredSubscriptionandResource Groupto create the data collection rule in. Enter aNamefor the rule and clickDone. 9. ClickNext. 10. ClickTransformation Editorand enter the following KQL query in the window. Ensure the queryRuns(copying and pasting from WordPress can result in incorrect ASCII chars being pasted) and then clickApply. 11. ClickNextand on the summary review screen, clickCreate. Note:You can find data collection rules used on table transformations by navigating toAgents > Data Collection Rulesfrom the Log Analytics workspace. NOTEWhile transformations themselves don\u2019t incur direct costs, some scenarios can result in additional charges, as per:-https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/data-collection-transformations#cost-for-transformations Fortunately, if Azure Sentinel is enabled for the Log Analytics workspace,there\u2019s no filtering ingestion charge regardless of how much data the transformation filters. Additional Event Savings If you are seeking additional savings, it might also be worth understanding if you can apply transformations to other tables. Specifically, montiroing whenthe IME creates detection scripts on disk might not be of value but it can result in large event data when targetting hundres or thousands of required apps to devices. DeviceFileEvents |where FolderPath !startswith \u201cC:\\Program Files (x86)\\Microsoft intune management extension\\content\\detectionscripts\u201d Summary Applying transformations to tables can effectively reduce costs by filtering out unnecessary events, such as those generated by the Intune Management Extension (IME), which can be excessively chatty when evaluating scripts for required Win32 apps. These transformations permanently exclude the filtered events before ingestion, making them unavailable for future analysis or investigation. To avoid unintentionally filtering out critical security data, it is essential to thoroughly test and understand the transformation\u2019s impact before applying it. Always consult with your security team to ensure that the exclusion does not adversely affect security monitoring or compromise your business compliance requirements. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-update-considerations-cloud/", "title": "Cloud Management Gateway, SCCM, Third-Party Updates", "raw_text": "Third-Party Update Considerations with Cloud Management Gateway (CMG) in SCCM In this video guide, Cody Mathis and Justin Chalfant from Patch My PC will review common issues that can arise with third-party patch management through Cloud Management Gateway in Microsoft Configuration Manager (SCCM). We will review common issues that can arise with third-party updates such as content not distributed to CMG, CMG authentication to the SUP site system, certificates, content lookups, policy, and more. Helpful Resources Integrate with Windows Update for Business \u2013https://docs.microsoft.com/en-us/configmgr/sum/deploy-use/integrate-windows-update-for-business-windows-10 Set up cloud management gateway for Configuration Manager \u2013https://docs.microsoft.com/en-us/configmgr/core/clients/manage/cmg/setup-cloud-management-gateway Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sonos-s2-controller-installer/", "title": "Sonos Controller, MSI Extract, Silent Install, Patch My PC", "raw_text": "Sonos S1/S2 Controller Installer In this article, we will detail how to get the MSI required for the Sonos S1/S2 Controller Latest (MSI-x64) product in our catalog. Sonos S1/S2 Controller provides a compressed install file which is in an EXE format and does not have a silent install option. It is essentially a self-extracting archive that contains an MSI file within it. Currently, we do not directly support these types of installers since the initial extraction phase typically involves interactive steps or temporary directories that are dynamically created and destroyed, making it difficult to automate reliably. The following steps outlined in this article are essential to enable support for Sonos installs. These next steps cover the process of downloading the online installer, extracting the MSI and placing the MSI in thePatch My PC Publisher Local Content Repository. Download the Installer The Sonos S1/S2 Controller requires a manual download. Browse to Download the Sonos Controller you require. The download should start immediately. S1 Controller Link https://www.sonos.com/redir/controller_software_pc S2 Controller Link https://www.sonos.com/redir/controller_software_pc2 Extract the Installer to obtrain the MSI Once you have the online installer downloaded, you will have to extract it. This can be done manually or silently from a command prompt. Navigate to the downloaded exe file. You can either extract the MSI manually or silently using the command line. Manually\u2013 Extract the MSI by double-clicking the downloaded exe. The installer will launch. Leave this open in the background for now. With the installer open, navigate to:- S1 Controller Temporary DirectoryC:\\Users\\<UserName>\\AppData\\Local\\Downloaded Installations{90ADEE83-346E-45D3-8960-54792369FB54}S2 Controller Temporary DirectoryC:\\Users\\<UserName>\\AppData\\Local\\Downloaded Installations\\{AF00AB56-E4FE-4122-8688-4C47ADB9BF85} You will see the MSI file. (The MST is not needed) Silently\u2013 For a silent extract, open a command prompt, navigate to the download, and run the following command: Navigate to: \u201cC:\\Windows\\Temp\u201d to obtain the MSI file. Copy the MSI to the Local Content Repository Copy the MSI file and place it in yourLocal Content Repositoryconfigured in the Patch My PC Publisher on the Advanced tab. Note:This process will need to be carried outfor each new version of the Sonos S1/S2 Controller Installer. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/verifying-wsus-server-settings/", "title": "WSUS Server, Registry Settings, Configuration, Update Files", "raw_text": "Verifying WSUS Server settings This topic covers typical WSUS Server settings as recommended by Microsoft. This section covers the following issues which affect update file synchronization and download: Registry Settings Configuration Settings IIS Settings Permissions Note:These settings are configured during WSUS setup by default. They are listed here as a reference, to use as checkpoints when troubleshooting. When troubleshooting, you can verify that these settings are in place. Registry Settings Following are registry settings configured during setup on the WSUS server. These settings do not store server configuration information. All configuration information is stored in the WSUS database (SUSDB.mdf). All of the following Registry entries are within theHKLM\\SOFTWARE\\Microsoft\\Update Services\\Server\\SetupRegistry key: ContentDir\u2013 the location under which update binaries and end user license agreement files are stored. If the user chose to install WMSDE during setup, this location also contains the database storage files and log files; for example, C:\\WSUS. Note the following:WsusContentcontains the update filesMSSQL$WSUScontains the database files (if WMSDE) WsusContentcontains the update files MSSQL$WSUScontains the database files (if WMSDE) TargetDir\u2013 the product installation location; for example, C:\\Program Files\\Update Services WmsdeInstalled\u2013 this entry specifies whether or not WMSDE was used in the original installation; for example, 1=yes, 0=no. Note: This key does not get modified if your later migrate the WMSDE database to a full SQL Server database. SqlServerName\u2013 The main registry key used under regular server operation. This is used to bootstrap the server components with the database server where the rest of data and server configuration is used. Ex: %computername%WSUS for WMSDE. Use this key to quickly figure out which SQL server the WSUS server is using (especially in the remote SQL case). SqlDatabaseName\u2013 the name of the database. For WSUS 2.0, this is always SUSDB. SqlAuthenticationMode\u2013 the authentication mode WSUS uses to talk to the database server. For WSUS 2.0, this is always WindowsAuthentication. Configuration settings All of the following server configuration settings are stored inside the WSUS database (SUSDB.mdf). IIS Settings The following virtual directories (vroots) are created in IIS (in the Default Web Site by default) for client to server synchronization, server to server synchronization, reporting, and client self-update. Permissions The following lists permissions necessary for specific folders on the WSUS server disk and registry permissions. Disk The following permissions are configured during WSUS setup, and are important for BITS downloads to work: The root folder on the drive where theWSUSContentfolder resides (for example,<%windir%>\\WSUS\\WsusContent) must haveReadpermissions for either theUsersaccount or theNT Authority\\Network Serviceaccount (on Windows 2003). If this permission is not set, BITS downloads will fail. Note: this is the permission that WSUS setup does not configure, so make sure the permissions are set as described here The WSUS content directory, usually<%windir%>\\WSUS\\WsusContentmust haveFull Controlpermission granted to theNT Authority\\Network Serviceaccount. This permission is set by WSUS server setup when it creates the directory, but it is possible that your security software might reset this. permission. Not having this permission set will also cause BITS downloads to fail. TheNT Authority\\Network Serviceaccount (on Windows 2003) must haveFull Controlpermissions to the following folders for the WSUS console to display the pages correctly:<%windir%>\\Microsoft .NET\\Framework\\v1.1.4322\\Temporary ASP.NET Files<%windir%>\\Temp <%windir%>\\Microsoft .NET\\Framework\\v1.1.4322\\Temporary ASP.NET Files <%windir%>\\Temp Registry The following permissions are set for the Registry during WSUS setup. TheUsersgroup must have Read access to theHKLM\\SOFTWARE\\Microsoft\\Update Services\\ServerRegistry key. The following accounts must have Full Control permissions to theHKLM\\SOFTWARE\\Microsoft\\Update Services\\Server\\SetupRegistry key:ASP.NETNetwork Service(for Windows Server 2003)WSUS Administrators ASP.NET Network Service(for Windows Server 2003) WSUS Administrators Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/scup-catalog-download-could-not-create-secure-ssl-tls-channel/", "title": "SCUP, TLS, Error, Resolution", "raw_text": "SCUP Catalog Download \u2013 The request was aborted: Could not create SSL/TLS secure channel -2146233079 In this article, we will look at the cause and resolution for error-2146233079when trying to import our catalog intoSystem Center Update Publisher. Topicscovered in this article: Issue: SCUP Uses TLS1.0, Not TLS1.1/TLS1.2 by Default Resolution 1: Configure .NET to \u2018Use Strong Crypto\u2019 (Preferred) Resolution 2: Switch the Catalog to HTTP:// (Alternative) Issue: SCUP Uses TLS1.0, Not TLS1.1/TLS1.2 by Default Currently, the System Center Update Publisher tool has native support for TLS1.0. It is a .NET Application which targets .NET Framework v4.5. Any connections which require a newer version of TLS, such as to the PatchMyPC.com website, will not connect successfully. The PatchMyPC.com website currently allows TLS1.1 and TLS1.2 connections. This specific error will appear in the UpdatesPublisher.log file for SCUP as shown below. Download file: \u2018https://patchmypc.com/scupcatalog/apis/subscriber_download.php?id=12345678901234567890\u2019 failed.==================== Exception Detail Start =======================Exception type: WebExceptionException HRESULT: -2146233079Exception Message: The request was aborted: Could not create SSL/TLS secure channel.Exception source UpdatesPublisher.BaseServicesException TargetSite Void MoveNext()EStack: at Microsoft.UpdatesPublisher.BaseServices.WebClientWrapper.d__17.MoveNext()\u2014 End of stack trace from previous location where exception was thrown \u2014at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)at Microsoft.UpdatesPublisher.BaseServices.FileDownloader.d__11.MoveNext()===================== Exception Detail End ======================== Resolution 1: Configure .NET to \u2018Use Strong Crypto\u2019 (Preferred) Perform the registry edits which are detailed in theMicrosoft docsregarding TLS support for applications targeting older versions of .NET Framework Specifically, SCUP is a 64-bit application which targets .NET Framework v4.5. For this scenario, the below registry edits are needed on the server which has SCUP installedHKEY_LOCAL_MACHINE\\Software\\Microsoft.NET\\Framework\\v4.0.30319\u201cSystemDefaultTlsVersions\u201d=dword:00000001\u201cSchUseStrongCrypto\u201d=dword:00000001 HKEY_LOCAL_MACHINE\\Software\\Microsoft.NET\\Framework\\v4.0.30319\u201cSystemDefaultTlsVersions\u201d=dword:00000001\u201cSchUseStrongCrypto\u201d=dword:00000001 \u201cSystemDefaultTlsVersions\u201d=dword:00000001 \u201cSchUseStrongCrypto\u201d=dword:00000001 A couple of lines of PowerShell can be used to set these values in the registry as well. The code is below. Set-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319 -Name SystemDefaultTlsVersions -Value 1 -Type DWordSet-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319 -Name SchUseStrongCrypto -Value 1 -Type DWord Resolution 2: Switch the Catalog to HTTP:// (Alternative) Change your SCUP Catalog URL toHTTP://\u2026 instead ofHTTPS://\u2026If you request the catalog over HTTP, you are no longer using TLS of any form, and the catalog will download successfully. If you request the catalog over HTTP, you are no longer using TLS of any form, and the catalog will download successfully. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/patch-my-pc-recommended-antivirus/", "title": "Patch My PC, Antivirus Exclusions, Configuration Manager, WSUS", "raw_text": "Patch My PC \u2013 Recommended antivirus exclusions This article outlines Microsoft\u2019s recommended antivirus exclusions forConfiguration Manager,WSUS, andIntune. It documents folders pertinent to content distribution, particularly those within Patch My PC\u2019s scope of third-party updates. We\u2019ve included links to relevant Microsoft documentation for a deeper dive into the topic. Patch My PC Publisher If you are using theon-premises Patch My PC Publisherfor third-party patching, kindly ensure the following antivirus exclusion: PostponedBinariesThis folder is used to store package sources which are temporarily held due to theDelay the in-place application upgrade by x daysfeature This folder is used to store package sources which are temporarily held due to theDelay the in-place application upgrade by x daysfeature Note:The folder is specified in the registry keyHKEY_LOCAL_MACHINE\\SOFTWARE\\Patch My PC Publishing Service:Path Configuration Manager / WSUS Server-side Microsoft recommends quite a few antivirus exclusions when it comes to Configuration Manager (server-side). ThePatch My PC Publisherinteracts with the following folders: SCCMContentLib*The location the content for the ConfigMgr apps will be published The location the content for the ConfigMgr apps will be published WSUSContent*The location the content for the WSUS updates will be published The location the content for the WSUS updates will be published Note:The folder is specified in the registry keyHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Update Services\\Server\\Setup:ContentDir More info on the server-side exclusions Microsoft recommends forConfigMgrcan be foundhereand WSUS can be foundhere. Client-Side When it comes to clients, these folders should be excluded from antivirus scans: C:\\Windows\\ccmcache\\*The SCCM cache folder stores temporary software packages for application execution The SCCM cache folder stores temporary software packages for application execution C:\\Windows\\Setup\\Scripts*The location for custom scripts during Windows installation process The location for custom scripts during Windows installation process More info on the client-side exclusions Microsoft recommends for ConfigMgr can be foundhere. Intune For Win32 apps, Microsoft suggests excluding these folders from antivirus actions on the client side: On x64 client machines: C:\\Program Files (x86)\\Microsoft IntuneManagement Extension\\Content\\*The location content is staged in and detection scripts are executed from.C:\\Windows\\IMECache\\*The location installers are executed from. C:\\Program Files (x86)\\Microsoft IntuneManagement Extension\\Content\\*The location content is staged in and detection scripts are executed from. The location content is staged in and detection scripts are executed from. C:\\Windows\\IMECache\\*The location installers are executed from. The location installers are executed from. On x86 client machines: C:\\Program Files\\Microsoft Intune Management\\Content\\*The location content is staged in and detection scripts are executed from. The location content is staged in and detection scripts are executed from. C:\\Windows\\IMECache\\*The location installers are executed from. The location installers are executed from. For more information on the AV exclusions, seethis Microsoft Docs page. Honorable mentions This section highlights folders identified by Patch My PC engineers that contain files related to Patch My PC-published applications and updates. If these folders are blocked by antivirus or security software, that may cause issues. Since there is no Microsoft documentation that explicitly mentions that these directories need to be whitelisted, please proceed with caution if you need to whitelist them. ConfigMgr / WSUS server-side WSUS_ContentDir\\UpdateServicesPackages\\*The location 3rd party update content is staged before the cab is copied to the WSUSContent folder The location 3rd party update content is staged before the cab is copied to the WSUSContent folder %ProgramFiles%\\Update Services\\LogFiles\\WSUSTemp\\*The location of the staging area for signing cab files for 3rd party content The location of the staging area for signing cab files for 3rd party content ConfigMgr / WSUS client-side C:\\Windows\\CCM\\SystemTemp\\*This folder stores PowerShell detection scripts used in ConfigMgr Apps packaged by the Patch My PC Publisher.The ConfigMgr agent runs these PowerShell scripts from this location.Additionally, unrelated to Patch My PC, PowerShell scripts associated with Configuration Items or Baselines are also executed from this directory. This folder stores PowerShell detection scripts used in ConfigMgr Apps packaged by the Patch My PC Publisher. The ConfigMgr agent runs these PowerShell scripts from this location.Additionally, unrelated to Patch My PC, PowerShell scripts associated with Configuration Items or Baselines are also executed from this directory. %windir%\\SoftwareDistribution\\Datastore\\*The location for metadata for Windows Server Update Services clients The location for metadata for Windows Server Update Services clients %windir%\\SoftwareDistribution\\Download\\*The location for update content delivered via Windows Server Update Services The location for update content delivered via Windows Server Update Services Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/pmpc-app-detection-troubleshooting/", "title": "Patch My PC Application, Troubleshooting Scripts, ConfigMgr", "raw_text": "Troubleshooting Patch My PC Application Detection Troubleshooting Patch My PC Application Detection In this article, we will detail how to troubleshoot the scripts that are generated by the Patch My PC Publisher. These scripts are created for the purposes of application detection (both Intune, and ConfigMgr applications) as well as Intune update requirement scripts. Topicscovered in this article: Local Copy of PowerShell Scripts Troubleshooting ConfigMgr Scripts Topic3 Topic4 Topic5 Topic6 Local Copy of PowerShell Scripts When the Publisher processes software, it retains a copy of the PowerShell scripts that are generated. These copies can be found in the installation directory of the Publisher in subfolders as shown below. The names of the scripts will match the application name, version, and architecture making it easy to identify which one is needed for troubleshooting. For example if you install the Publisher in the default location on the C: drive you would find scripts in the folders described below. Root FolderC:\\Program Files\\Patch My PCPatch My PC Publisher Service Detection Method ScriptsScripts generated for detecting Configuration Manager applications Scripts generated for detecting Configuration Manager applications Detection Method Scripts for IntuneScripts generated for detecting Intune Win32 applications Scripts generated for detecting Intune Win32 applications Detection Method Scripts for Intune UpdatesScripts generated for both detection, and requirements for Intune Win32 updates Scripts generated for both detection, and requirements for Intune Win32 updates If troubleshooting a particular application installation, the respective script can be copied from these directories. Troubleshooting ConfigMgr Scripts To troubleshoot the scripts for Configuration Manager applications, we will want tograb a copy of the generated scriptfor the respective applications. For this example, we will run through the detection of \u2018Zoom Meetings 5.4.58740.1105\u2018 Troubleshooting steps: Get a Copy of Detection Script Validate Code Signing Certificate Trust If ApplicableCheck Client Settings Execution Policy Check Client Settings Execution Policy Run Script On Client Run Script On Client In Verbose Mode Evaluate Patch My PC Log File Evaluate Configuration Manager Log Files Collect Uninstall Registry Hives for Support Get a Copy of Detection Script Reference thebeginning of this articleto find the location of your Configuration Manager application detection scripts. I have located the generated script on my machine that runs the Patch My PC Publisher for Zoom Meetings. The example path is below. \u201cC:\\Program Files\\Patch My PCPatch My PC Publishing ServiceDetection Method ScriptsZoom Meetings 5.4.58740.1105.ps1\u201d This file can be copied to the client device we intend to do troubleshooting on. Validate Code Signing Certificate Trust If Applicable In this case, thescript is signedbased on myoptions in the Publisher. If the scripts are being signed, then you\u2019ll need to verify the trust relationship. If they arenot signed, you\u2019ll still want toverify the execution policy configured in your Client Settings. This code signing happens with the configuredWSUS Signing Certificate. With the script beingsigned, we will want to validate that theclients trust the code signing certificateandcheck the code signing configurationwithin the Configuration Manager Client Settings. An example of validating the client trusting the certificate is below used to sign the script is below. This is a copy of the signed script generated by the publisher. It should be copied directly from the directories described above to ensure the code signing is still valid.Do not copy-paste the script from the Detection Method in Configuration Manageras this may add or remove characters, invalidating the code signing. We can additionally validate this is thesame certificate in use by the Publisher. Certificate trust relies on the code signing certificate being in the \u2018Trusted Publishers\u2018 certificate store, and also having a validcertificate chainfor trust. There are two scenarios for certificate chain trust with a code-signing certificate. If the code signing certificate isself-signedthe trust will rely on thecode-signing certificate being in the Trusted Root Certificate Authoritiescertificate store. If this is apki-basedcode-signing certificate, or from apublic certificate authoritythen the certificate should already be trusted in your environment, as thecertificate chain would be trusted already, and you would only need to ensure the code-signing certificate is in the \u2018Trusted Publishers\u2018 certificate store unless you find it is not trusted for some reason. In either case, you should find the certificate in the respective stores similar to the below screenshot. With the certificate in the correct stores, the certificate should be trusted and valid. Check Client Settings Execution Policy Once we understand whether our detection scripts are being signed, and if we trust the signing certificate on our client, we can determine oureffective execution policyfor our client we are troubleshooting. I have found the client in theConfiguration Manager Console, right-clicked it, and selected \u2018Resultant Client Settings\u2018 Navigate to:Computer Agent > PowerShell execution policyandtake note of the value. We will use this when weexecute our script on a client for testing. Run Script On Client When a Configuration Manager application detection method runs we do have some visibility into what happens. TheAppDiscovery.logand theAppIntentEval.logcan be used to evaluate exit codes and the resolved intent of application discovery. But, because we have a copy of the detection script it is good to do some testing byrunning the script manually. A detection script can run inboththeuser contextand thesystem contextdepending on how the installation was started. For the Patch My PC script, testing in user context is sufficient. In the below screenshot we have copied our script,Zoom Meetings 5.4.58740.1105.ps1, to the desktop of the client we are testing on. A PowerShell window is opened. It does not need to be elevatedunless you need to elevate to set the execution policy. Note that we use theSet-ExecutionPolicycmdlet in order to match the policy we previously found in theResultant Client Settings. In my case, I am setting it toRemoteSignedand also specify a \u2018Scope\u2019 ofProcessto ensure this is a temporary setting change. With this in place, I have executed the script & \u2018.Zoom Meetings 5.4.58740.1105.ps1\u2019 The expected output of this script is \u2018Detected\u2018 and that is not what we are seeing on this client. This explains why this device would not detect this application from a Configuration Manager deployment. Run Script On Client In Verbose Mode The Configuration Manager detection script has a-verboseparameter that will make it much more informational. This includes bothclient output being verbose, as well as the log file having additional entries. & \u2018.Zoom Meetings 5.4.58740.1105.ps1\u2019 -verbose Note: The -verbose option was added in Version 2.0 of the script. You can open the script and check the release notes, or $ScriptVersion variable to see the version. Configuration Manager detection scripts can also be recreated using theRecreate Detection Script right-click option. The version is also noted in the log file generated by the script. Evaluate Patch My PC Log File The log file for Configuration Manager application detection is calledPatchMyPC-SoftwareDetectionScript.logand it can be located in one oftwo locationsdepending on the context the script was run under. Script ran as user(When testing script, or if the user clicks \u2018Install\u2019 in Software Center)Temp directory of the user that ran the scriptVariable%temp%(cmd/File Explorer) or$env:temp(PowerShell) Temp directory of the user that ran the script Variable%temp%(cmd/File Explorer) or$env:temp(PowerShell) Script run as system(Script runs as part of required application deployment, or you run as system deliberately for testing)This is typicallyC:\\Windows\\CCM\\Logsbut the script does use the below registry value to get the exact value for the log path.HKEY_LOCAL_MACHINE\\Software\\MicrosoftCCMLogging@Global > LogDirectory This is typicallyC:\\Windows\\CCM\\Logsbut the script does use the below registry value to get the exact value for the log path. HKEY_LOCAL_MACHINE\\Software\\MicrosoftCCMLogging@Global > LogDirectory Below is a sample log file from a verbose run of the detection script. We can see that both theSoftware, andSoftwareWOW6432Nodewere searched in this case, and no match was found forZoomwithversion 5.4.58740.1105. With no matches found, we can either manually navigate the registry hives, and try to identify why the software is not found, or we can run the script provided below to collect a CSV file which can be easier to navigate. Collect Uninstall Registry Hives for Support If you are unable to determine the cause of the issue, or if requested by Patch My PC support,this scriptcan be used to generate a CSV file containing all the uninstall registry hives. Below you will find an example of using the script. For the below example,the scripthas been copied to a file Export-PMPCUninstallRegistryHives.ps1 in the C:\\temp directory. The file is thendot-sourcedto load the function so it can be run. You may need to set your execution policy. The script will generate aPMPC-Uninstall-Hive-Export.csvin the same directory the script is by default. In the below screenshot I have simply imported the CSV to show some sample data. You wouldPMPC-Uninstall-Hive-Export.csvPMPC-Uninstall-Hive-Export.csv. In the case of our missing Zoom install, I can either open the CSV in Excel or something similar, or I can search the CSV with PowerShell as shown below. And we do see that Zoom was found, BUT it isunder the HKEY_CURRENT_USER registry hive. This is a common issue for software that supports user based installs. Special Text Formatting and Common Text Common log files and intro indetermine if you are affected If affected, you will see the following error in the ENTERLOGFILESURLs file. List ofcommon server log fileswith links: PatchMyPC.logSMS_ISVUPDATES_SYNCAGENT.logSoftwareDistribution.log List of commonclient log fileswith links: WUAHandler.logWindowsUpdate.logPatchMyPC-ScriptRunner.log (For ConfigMgr Apps/Updates)PatchMyPC-ScriptRunner.log (For Intune Apps/Updates)PatchMyPC-SoftwareDetectionScript.logPatchMyPC-SoftwareUpdateDetectionScript.log CommonKB references modify published updates wizardWSUS signing certificatedeploy the WSUS signing certificate to clients Here\u2019sError Text: Example CMTace Error MessageExample CMTrace Warning Messagesample-powershell command line Note:Here is an example call out section for something super duper cool Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sccm-app-options/", "title": "Application Creation Options, ConfigMgr Applications, Distribution Points", "raw_text": "Application Creation Options Explained for Configuration Manager In this article, we will cover all of theConfigMgr Application Creation Optionsthat are available within the publisher. These are options that apply specifically to the applications created in Configuration Manager. Below is a screenshot of this section as of the writing of this article. Allow applications to be installed from the Install Application task sequence action When this option is checked every application created by the Publisher will have the equivalent checkbox displayed below checked in Configuration Manager. If you intend to use the applications as part of any Task Sequences, you will want to check this option. Allow clients to use distribution points from the site\u2019s default boundary group When this option is checked every application deployment type created by the Publisher will have the equivalent checkbox displayed below checked in Configuration Manager. Whether you select this option is a company-specific decision based on your network layout and bandwidth considerations. Seethis Microsoft docs linkfor more information around the content options for applications. Code-sign the PowerShell detection method script using the WSUS Signing Certificate. When this option is checked every application created by the Publisher will have a code-signed PowerShell detection script. Because there is already a code-signing certificate in place for Third Party Patching, and all clients trust it, we are able to leverage this to sign the detection scripts generated by the Publisher. Generally, code-signing is used to ensure the integrity of the script being run. For more information regarding code-signing seethis linkandthis linkwhich discusses the how and why in further detail. When you do sign the detection scripts, you\u2019ll see a large block of text at the end of the script as shown below. Do not include the version in the application name, so the application name doesn\u2019t change after updates. When this option is checked newly created applications will no longer have the version number as part of the application name. There are some use cases that benefit from this, such as MDT UDI, UI++, or anything that is keying specifically off the application name. Below you can see the result of having this boxunchecked.The name of the application will be different every time a new one is published, reflecting the current version. And the below shows the result of having this boxchecked, which removes the versioning. This results in a consistent name between application versions. If you wish to control this on a per-application basis you can referencethis article.It will show some of the additional options regarding application naming that are available within the right-click context menu. Note:TheLATESTversion of the application will not have the version appended to the name. However, if you are retaining any older version of the app, their version will be re-appended to the name. Move applications to the following folder in the applications node of the console. When this option is checked every application created by the Publisher will be moved to the specified folder in the Applications node in the console. In the screenshot below we can see the \u2018ApplicationsPatch My PC\u2019 folder is in use. This can be useful to keep applications that are being automatically created, and/or updated in one location. When a New Application Update is Available: The options here are detailed in the followingKB Article. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/removal-think-cell-from-patch/", "title": "think-cell, update, methodology, removal", "raw_text": "Removal of think-cell from the Patch My PC Catalog Patch My PC will be removing the think-cell product from its catalog on March 17, 2025. Patch My PC engineers have worked closely with think-cell, and it has been determined by both parties that Patch My PC\u2019s update methodology does not work well with think-cell products due to several factors including: Updates from think-cell are pushed in waves to all think-cell customers Many think-cell customers receive a custom installation MSI that will not match the MSI provided by Patch My PC After receiving numerous support cases, Patch My PC engineers met with think-cell and concluded that the best course of action is to remove this product from the Patch My PC Catalog at this time. Think-cell recommends utilizing their auto-updater to manage think-cell updates. Additionally, think-cell offers the following resources to help manage updates for the think-cell product using their auto-updater: Deployment Guide for IT admins:https://www.think-cell.com/resources/manual/deploymentguide https://www.think-cell.com/resources/manual/deploymentguide Information on Automatic updates:https://www.think-cell.com/resources/manual/deploymentguide#subsect_updates https://www.think-cell.com/resources/manual/deploymentguide#subsect_updates Alternatively, customers that would still like to deploy and manage their think-cell updates via Patch My PC can utilize our Custom Apps feature to deploy the latest versions of think-cell as the latest version becomes available to their account. Resources for Patch My PC Custom Apps can be found here:https://docs.patchmypc.com/installation-guides/patch-my-pc-cloud/custom-apps https://docs.patchmypc.com/installation-guides/patch-my-pc-cloud/custom-apps Think-cell also offers the following resources when manually deploying updates to their product: Control think-cell updates manually:https://www.think-cell.com/resources/manual/deploymentguide#subsect_manualupdates https://www.think-cell.com/resources/manual/deploymentguide#subsect_manualupdates Does think-cell work with Microsoft 365 (Office 365) and Office 2016/2019 Click-to-Run:https://www.think-cell.com/en/resources/kb/0165 https://www.think-cell.com/en/resources/kb/0165 If you have any additional questions on deploying think-cell updates, please reach out to think-cell at their support email[email protected] Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-record-browser-network-activity/", "title": "browser network activity HAR file troubleshooting", "raw_text": "How to record browser network activity as a .HAR file Recording browser network activity as aHTTP Archiveor.HARfile is a quick and effective way to help troubleshoot issues with Patch My PC Cloud features. The .HAR file logs all network requests made between your browser and the Patch My PC portal, capturing critical information like load times, errors, and API responses. In this article, we\u2019ll show you step-by-step how to generate a .HAR file so you can share it with support for assisted problem resolution. Record a .HAR file We will use Microsoft Edge for the following example:- 1. Open the Microsoft Edge browser. 2. PressF12orCtrl + Shift + Ion your keyboard or open the browser menu and navigate toMore tools > Developer tools 3. In the Developer Tools window, select theNetworktab at the top. This tab shows all the network activity between your browser and the website. 4. Check the box toPreserve log. 5. Reproduce the actions in the browser that are causing the issue to record the network activity for support. Note:Click the circular record button( )at the top left of theNetworktab (1) to start recording if you do not see any network activity (2). Continue to perform the actions that are causing issues (e.g. click a button, fill out a field, or load a specific part of the page). This will capture those interactions in the network log. 6. Once you\u2019ve reproduced the issue, click the circular record button again( )to stop capturing network activity. 7. Either click the download icon \u2b07\ufe0f to save the .HAR file (1) or right-click anywhere in the network activity log and selectSave all as HAR with content(2). 8. Choose a location on your computer to save the .HAR file and give it a recognizable name (e.g. \u201csupport.har\u201d). 9. If the file is large, it might be prudent to compress it before sending it to support. Video walk through Share a .HAR file with support Please share the resultant file with your customer engineer by either replying to your support case or uploading the file using the instructions documented atShare Large Files with Patch My PC for Support Case Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-error-message-1-not/", "title": "WSUS Error, Win32 Application, Certificate, Signing", "raw_text": "WSUS Error Message %1 is not a valid Win32 Application | failed to sign package; error was: 2147942593 In this article, we\u2019re going to cover an issue that we periodically see related toWSUSand theWSUS Signing Certificate. This issue generally occurs when attempting toimport/createa new WSUS signing certificate, and it may cause theWSUS signing certificate to not be properly detectedeven when it exists in the WSUS store incertlm.msc. Errors Related to %1 is not a valid Win32 application If you are affected by this issue, you will likely see the following errors in thepatchmypc.log. Export WSUS Certificate to C:\\Users\\%username%\\AppData\\Local\\Temp\\PMP-nia3xn2d5wszzsvn.tmpAn error occurred while extracting the certificate from WSUS: C:\\Users\\%username%\\AppData\\Local\\TempPMP-nia3xn2d5wszzsvn.tmp : %1 is not a valid Win32 applicationFailed to extract the certificate from WSUS If an update is being published, you will likely see an error An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147942593 Depending on the build of the Publisher, you may also receive the error \u201cNo certificate found in the WSUS certificate store on this server.\u201c Resolution to %1 is not a valid Win32 application The error%1 is not a valid Win32 applicationgenerally occurs due to a rogue file named \u201cC:\\Program\u201d that exists on the WSUS server. This file seems to cause issues related to the WSUS certificate being properly detected and imported. We\u2019ve seen the rogue file often is a log file forccmsetup.exeor some other application log file that wasn\u2019t properly saved. In some versions of Windows, you may even receive a warning on login about issues that can occur when \u201cC:\\Program\u201d file exists. The fix is to rename the \u201cC:\\Program\u201d to \u201cC:\\Program1\u201d or you can delete the file if you determine it\u2019s not needed. After renaming or deleting the file, you can restart the \u201cWSUS Service\u201d and the \u201cWSUS Certficate Server\u201d fromservices.msc Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/enable-wsus-client-trace-logging/", "title": "WSUS logging, Windows Update Agent, Registry settings", "raw_text": "Enable WSUS Client Trace Logging In this article, we will discuss how to enable trace logging for the Windows Update Agent on a Windows device. This can also be considered debug, or verbose logging. With this enabled the WindowsUpdate.log file, and the corresponding event logs will contain more information which is helpful for troubleshooting. Note:Modifying REGISTRY settings incorrectly can cause serious problems that may prevent your computer from booting properly. Patch My PC cannot guarantee that any problems resulting from the configuring of REGISTRY settings can be solved. Modifications of these settings are at your own risk. Enable trace logging manually First, a registry key must be created at the locationHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Trace. The WindowsUpdate key should already exist, but the Trace key will need to be created. Once this is created twoREG_DWORDvalues must be made as noted below, and also shown in the picture above. Flags = 7 Level = 4 Lastly, the Windows Update service must be restarted. This can be done in many ways. The services MMC method is shown below by simply right-clicking theWindows Updateservice and selecting restart. Enable trace logging with a PowerShell snippet A script is available on GitHubhereto perform the registry edits and restart the service for both enabling and disabling the trace logging. An example of running the script is shown below. Theexecution policymay need to be adjusted depending on the configuration of the device the script is being run on. . \u201cC:\\temp\\Set-WSUSTraceLogging.ps1\u201d -TraceLogging Enabled Note:Once you have enabled or disabled trace logging you can collect the logs using the Get-WindowsUpdateLog PowerShell cmdlet, or review the event logs. More information regarding the Windows Update logs can be found within the Microsoft documentation foundhere. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/managing-enrollment-status-pages-microsoft/", "title": "Enrollment Status Pages, Patch My PC, Intune Win32, Azure App Registration", "raw_text": "Managing Enrollment Status Pages in Microsoft Intune In this article, we will discuss how Patch My PC can manage the Intune Win32 applications which are associated withEnrollment Status Pages. Note:This feature will require your Azure App Registration to haveDeviceManagementServiceConfig.ReadWrite.Allpermissions set. Why Use Enrollment Status Pages An Enrollment Status Page (ESP) allows you to configure a list of applications thatmust be installed before the ESP completes. This is particularly useful if you happen to be using theIntune Updates featureof the Patch My PC Publisher. Generally, Intune Updates are assigned toall devicesor alarge number of devicesasrequired. With this large scope of a required assignment, you would see the Intune Updates be evaluated during Autopilot or Device Enrollment. To prevent these updates from unnecessarily evaluating, you canspecify a list of applications in your ESP. Below is a sample of what an ESP might look like in the Intune portal. These are found within Intune under Home > Devices > Windows > Enrollment Status Page. Note:You shouldn\u2019t associate Intune Updates from the Patch My PC Publisher with an Enrollment Status Page. The updates have a \u2018Requirement\u2019 script that checks if an old version of the application is installed. This is almost never going to apply during Autopilot or Device Enrollment. Update ESP When New Application Version Published Within theIntune Options, there is an option to \u2018Update Enrollment Status Page associations with new application when an updated application is created.\u2019 This option can be seen below. This option will ensure that the list of selected Win32 applications for an IntuneEnrollment Status Pageiskept up to date as new versions of applications are published. These Enrollment Status Pages are commonly used during Autopilot. With this checkbox checked the Publisher will ensure the latest version of the published application is associated with your ESP during a synchronization. Right-Click Option to Assign ESP The \u2018Manage ESP Profiles\u2019 right-click option allows you to manage theEnrollment Status Page profileswhich any Win32 application can be associated with (Intune Apps). The ESPs are pulled from Microsoft Intune for your configured tenant. Note that the profile must have \u2018Show app and profile configuration progress\u2018 set to \u2018Yes\u2018 in order to appear in the list for selection. An example list is shown below. Any Win32 applicationcreated by the publisherwill beadded to the ESPs which are selectedfor the respective application. Note:ESP associations will beaddedto existing applications during the next publisher sync, but theywill not be removedfor existing applications. Whenever anewapplication is created the Publisher will ensure thecurrently specified Enrollment Status Page associations are in place. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/proxy-url-uri-error/", "title": "Proxy Bug Fix Publisher", "raw_text": "An error occurred while converting the provided Proxy URL to a URI In this article, we will discuss a bug introduced inversion 1.8.6.0of the Patch My PC Publisher. In version 1.8.6.0, changes were made toparse the provided proxy URLin the Publisher. Below you will find how to identify if the bug affects you, and resolve it. Determine if you are affected If you havea proxy configured in the publisherand upgraded to version 1.8.6.0 then the below error will be in yourPatchMyPC.logfile. An error occurred while converting the provided Proxy URL to a URI for use by the Web Client. Invalid URI: The format of the URI could not be determined Check if you are onbuild 1.8.6.0and aproxy is enabled: If you open the Publisher UI, you willlikely see error(s)similar to the error shown below: Note:This proxy is used by the publisher for all download operations, including downloading Publisher updates. Resolving the Issue (Option 1 \u2013 Recommended) Manually update the publisher to a build that isversion 1.8.7.0 or above. This bug has been fixed in all newer versions of the publisher. You can run the MSI installer on the machine which runs the publisher. All settings will be retained during the in-place upgrade. Once the upgrade is complete, attempt to validate theLicense URLin the Publisher to confirm the fix. Resolving the Issue (Option 2) Within the Publisher on the affected 1.8.6 build, navigate to the \u2018Advanced Tab\u2018 and update the Proxy URL field by addinghttp://to the beginning of your URL as shown below. Once you have changed this you can clickApply, then close and reopen the publisher. Once this is complete the error messages will be resolved. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/export-publisher-product-list/", "title": "Publisher Export List", "raw_text": "Export Publisher Product List In this article, we will cover the feature with the Publisher that allows you to export the current list of enabled products and their right-click configurations. How to use it This option is found within the Advanced tab of the Publisher. You will need to scroll down in order to find the Product Export section. The section can be seen below. Once you have found the section exporting the list is as simple as: Check the boxes of the types of products you would like to export Press the \u2018Export\u2019 button. Select the location for the export CSV file. Notes With this feature, there are some things to take note of. You can only check a box to export a product type if the below conditions are met. If the conditions are not met the checkbox will be grayed out, such as the \u2018Export Intune Updates\u2019 checkbox above.The product type is enabled (checkbox at the top of each tab)There is at least one product of the type selected The product type is enabled (checkbox at the top of each tab) There is at least one product of the type selected Some complex properties, such as those listed below, are exported as JSON strings in the CSV.Intune assignmentsCustom display info such as name, description, localized name, etc.Manage Conflicting Process options Intune assignments Custom display info such as name, description, localized name, etc. Manage Conflicting Process options Some properties have a \u2018default value\u2019 and so they may be populated but not in use.For example, the Intune apps and updates may show a value for the max run time that is in use by ConfigMgr. For example, the Intune apps and updates may show a value for the max run time that is in use by ConfigMgr. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/permissions-required-sccm-base-installation/", "title": "SCCM Permissions, Base Installation, Configuration Manager", "raw_text": "Permissions Required in SCCM for Base Installation Packages from Patch My PC Note:As a first step, ensure that the Configuration Manager console is installed on the remote Software Update Point as well. It is amandatory requirement. When enabling thebase installation featureas shown below in ourPublisher, it\u2019s important to understand what permissions are required in SCCM. Automatically Create the Configuration manager Security Role for the Patch My PC Publisher In build 1.8.6 or newer, the Publisher canautomatically createthe Security role with the minimum permissions for you. After the security role is created, you will need toassign the computer accountof the server running the publisher,or the provided alternative accountto the security role. Note:If you already have a role with the same \u2018Patch My PC Publisher\u2019 name then you will be prompted to overwrite the existing role. This will keep existing Security Role associations and simply update the permissions. Manually Create the Configuration manager Security Role for the Patch My PC Publisher When we create installation packages and distribute then we will need the following permissions in SCCM. Application:Read, Modify, Delete, Set Security Scope, Create, Move Object, Modify Folder Distribution Point:Read, Copy to Distribution Point Distribution Point Group:Read, Copy to Distribution Point Group Folder Class:Read, Modify, Create Security Scopes:Read Site:Read Software Updates:Read, Modify We will need to be able to create, modify, delete, and distribution packages within SCCM. By default, we attempt these actionsusing the computer account of the server the publishing service is running. You can download our pre-created security role named \u201cPatch My PC \u2013 Base Installations\u201c. Once imported, you will then need to add the computer account as a newAdministrative Userand assign this new security role. Be sure to select\u201cAll instances of the objects that are related to the assigned security roles\u201dto prevent potential issues with scoping. If you prefer, you can configure animpersonation account to use rather than the computer accountof the server in the base install options. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-to-resolve-download-errors-during-patchmypc-scup-catalog-download-exception-message-the-request-was-aborted-could-not-create-ssl-tls-secure-channel-2146233079/", "title": "PatchMyPC, SCUP, TLS", "raw_text": "How to Resolve Download Errors During PatchMyPC SCUP Catalog Download \u2013 Exception Message: The request was aborted: Could not create SSL/TLS secure channel -2146233079 In this article, we will look at the cause and resolution for error-2146233079when trying to import our catalog intoSystem Center Update Publisher. Issue: SCUP Uses TLS1.0, Not TLS1.1/TLS1.2 by Default Currently, the System Center Update Publisher tool has native support for TLS1.0. It is a .NET Application which targets .NET Framework v4.5. Any connections which require a newer version of TLS, such as to the PatchMyPC.com website, will not connect successfully. The PatchMyPC.com website currently allows TLS1.1 and TLS1.2 connections. This specific error will appear in the UpdatesPublisher.log file for SCUP as shown below. Download file: \u2018https://patchmypc.com/scupcatalog/apis/subscriber_download.php?id=12345678901234567890\u2019 failed.==================== Exception Detail Start =======================Exception type: WebExceptionException HRESULT: -2146233079Exception Message: The request was aborted: Could not create SSL/TLS secure channel.Exception source UpdatesPublisher.BaseServicesException TargetSite Void MoveNext()EStack: at Microsoft.UpdatesPublisher.BaseServices.WebClientWrapper.d__17.MoveNext()\u2014 End of stack trace from previous location where exception was thrown \u2014at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)at Microsoft.UpdatesPublisher.BaseServices.FileDownloader.d__11.MoveNext()===================== Exception Detail End ======================== Resolution 1: Configure .NET to \u2018Use Strong Crypto\u2019 (Preferred) Perform the registry edits which are detailed in theMicrosoft docsregarding TLS support for applications targeting older versions of .NET Framework Specifically, SCUP is a 64-bit application which targets .NET Framework v4.5. For this scenario, the below registry edits are needed on the server which has SCUP installedHKEY_LOCAL_MACHINE\\Software\\Microsoft.NET\\Framework\\v4.0.30319\u201cSystemDefaultTlsVersions\u201d=dword:00000001\u201cSchUseStrongCrypto\u201d=dword:00000001 HKEY_LOCAL_MACHINE\\Software\\Microsoft.NET\\Framework\\v4.0.30319\u201cSystemDefaultTlsVersions\u201d=dword:00000001\u201cSchUseStrongCrypto\u201d=dword:00000001 \u201cSystemDefaultTlsVersions\u201d=dword:00000001 \u201cSchUseStrongCrypto\u201d=dword:00000001 A couple of lines of PowerShell can be used to set these values in the registry as well. The code is below. Set-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319 -Name SystemDefaultTlsVersions -Value 1 -Type DWordSet-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319 -Name SchUseStrongCrypto -Value 1 -Type DWord Resolution 2: Switch the Catalog to HTTP:// (Alternative) Change your SCUP Catalog URL toHTTP://\u2026 instead ofHTTPS://\u2026If you request the catalog over HTTP, you are no longer using TLS of any form, and the catalog will download successfully. If you request the catalog over HTTP, you are no longer using TLS of any form, and the catalog will download successfully. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/prevent-required-intune-app-from/", "title": "Prevent App Updates, Required Assignments, Patch My PC, Intune", "raw_text": "Prevent a required Intune app from installing if any version of the app is already installed In some situations, such as during Autopilot deployments, you may need to mark a Patch My PCIntune appasrequiredto ensure it installs during the Enrollment Status Page (ESP) phase, when blocking apps are enforced. However, after the app is installed, you might want to prevent that required targeting from pushing newer versions of the app to the device. Instead, you can use Patch My PCIntune updatesto manage future updates using update rings. This approach lets you control the update cadence, avoiding the immediate updates that would otherwise happen due to the original required targeting. In this article, we\u2019ll guide you through configuring an extra requirement on Patch My PCIntune appsto prevent immediate app updates after the initial installation has occured. Scenario 1 Install a required app during Autopilot but prevent the same, required, assignment from updating the app when a new version is published by Patch My PC. In deployment scenarios like Autopilot, it\u2019s common to designate apps asrequiredto ensure they install during the ESP phase. This ensures that critical applications are in place before the device is handed over to the user. However, a challenge typically arises after the initial installation \u2013 the samerequiredassignment that ensured the app was deployed can also triggerimmediateupdates when a newer version of the app becomes available. This behavior can be problematic for organizations that want to control when app updates are applied, especially when users need stability and consistency on their devices. Why does this occur? The issue arises because Patch My PC creates the initial version of the app usingIntune apps, and admins will assign it asrequiredtoAll Devices(for example) for deployment. This ensure\u2019s the app gets installed during Autopilot when using the ESP blocking apps feature. When a new version of the app is released by the vendor, Patch My PC automatically creates and publishes the updated version while retaining the same assignments as the initial release. This means that the new version is immediately targeted to the same devices with a required assignment, resulting in the app being pushed as soon as it\u2019s available. Why is this a problem? This breaks any expected ringed update approach when customers have deployed Patch My PCIntune updates, where organizations typically want to stagger updates through phased deployments, ensuring stability and controlled testing before the app reaches all users. This behavior can lead to the new version being deployed too quickly, bypassing the gradual rollout process many customers expect. Scenario 2 Install a required app for a specific set of users or devices but prevent the same, required, assignment from updating the app when a new version is published. In many deployment scenarios, admins may choose to assign an app as required for specific users or devices to ensure it is deployed automatically. This approach ensures that critical applications are installed for a targeted group, ensuring those users or devices have the necessary apps to perform their job function. However, a challenge often arises after the initial installation \u2013 the same required assignment that ensured the app was deployed to the intended group can also trigger an immediate update when a newer version of the app is released by the vendor. This behavior can be problematic for organizations looking to maintain control over when app updates are applied. The issue occurs because Patch My PC creates the initial version of the app usingIntune apps, and admins often assign it as required for specific users or devices. This guarantees the app is installed across the specified group. When a new version of the app is released by the vendor, Patch My PC automatically generates and publishes the updated version while retaining the same assignments that were set for the initial release. As a result, the new version is immediately targeted to those same users or devices, leading to an immediate update. This disrupts any desired phased update strategy, particularly when Patch My PCIntune updatesare in place. Organizations typically want to roll out updates gradually, ensuring that testing is performed and stability is maintained before the app reaches all users or devices. However, this behavior can result in updates being deployed too quickly, bypassing the carefully planned rollout process. Customers expecting to manage updates using rings or controlled phases may find their users or devices receiving updates sooner than anticipated, potentially introducing instability or unforeseen issues within their environments. Solution Step 1: Download and edit the Get-NotInstalledRequirement.ps1 script The provided script will be used as a requirement check for a Win32 app in Intune, designed to evaluate if specific software is already installed on a device. The script performs the following:- Checks for Installed ApplicationsThe script looks for installed applications by searching the Windows registry for specific software titles listed in the$appNameListarray. In the provided example in the script, it searches for \u2018Cisco Secure Client\u2019 and \u2018Cisco AnyConnect\u2019 by their \u201cApps & Features\u201d DisplayName. Registry SearchIt examines the registry paths related to both 32-bit (Wow6432Node) and 64-bit installations, depending on the device architecture, to check for installed applications. It scans the registry hives (HKLM and HKCU) for the software names. Custom MatchingThe script performs a pattern match (using -like) to find software that matches the names in$appNameList. If a match is found, the script does not return any output, which means the requirement is not met, preventing the Win32 app from installing. Determines ApplicabilityIf the specified software is found, the script outputsApplicable. This indicates that the software is not installed, satisfying the requirement for the Win32 app to be installed on the device. 1. Download the script fromhttps://github.com/PatchMyPCTeam/Community-Scripts/blob/main/Install/NotInstalledRequirement/Get-NotInstalledRequirement.ps1 2. Open the script in VSCode, Notepad or another text editor of your choice. 3. Replace the contents of the array list$appNameListonline 36with theApps & Features / Installed Appsname of the app you want to check for. Note:The script will search for the exact match based on what you enter in $appNameList. You can add asterisk characters (*) if you want to use wildcards. For example:$appNameList = @(\u20187-Zip*2*\u2019)will match a DisplayName of7-Zip 24.07 (x64) Important:Using an overly generic name may cause the app to be falsely detected as installed. In the following example, we replace the default entries in the$appNameListarray with\u2018Google Chrome\u2019as this is the DisplayName that is shown inApps & Features / Installed Appswhen this app is installed. 4. Save the script. Step 2: Select your Publishing Method The app must be publishedbeforewe can add the requirement script in the Intune Admin Center. Patch My PC Publisher In the following example, we will use Google Chrome:- 1. Open the Patch My PC Publisher. 2. Navigate to the Intune apps tab and clickoptions(the options button might look different than depicted in the image below depending on your licence level). 2. Ensure the check box is selected forCopy the requirements from previously created applications or updates when an updated application is created 3. Ensure your desired variant ofGoogle Chromeis selected with the intent to Publish by verifying the check box is ticked on the Intune apps tab. 4. After the next schedule sync cycle, or a manual sync, or as a result from being published previously, find your selected variant of Google Chrome in the Intune Admin Center. 5. Proceed toStep 3. Patch My PC Cloud In the following example, we will use Google Chrome:- 1. In a browser, navigate tohttps://portal.patchmypc.com. 2. By reviewing theDeploymentstab, ensure the app is already deployed. If it is not,follow the instructions hereto deploy an Intune app from Patch My PC Cloud. 3. Proceed toStep 3. Step 3: Add the requirement script to the app in the Intune Admin Center To address the issue where new versions of required Patch My PC apps continue to install immediately on targeted Entra ID groups after the initial deployment, arequirement scriptcan be implemented. This solution leverages the ability to add custom requirements to Win32 apps in Intune, ensuring that if the app is already installed, a newer version of the Intune app will not install, regardless of a required assignment. By using a requirement, the script checks ifanyversion of the app is already present on the device, and if so, it marks the Win32 app asnot applicable. This prevents the immediate install behavior triggered by the required assignment. In the following example, we will continue to use Google Chrome:- 1. Select the app in the Intune Admin Centre. In our example, we are usingGoogle Chrome. 2. SelectPropertiesand clickEditin the app requirements section. 3. ClickAdd. 4. Select the Requirement typeScript. 5. Select the edited script you saved inStep 1and apply the following settings:- Script file:Get-NotInstalledRequirement.ps1 Run script as 32-bit process on 64-bit clients:No Run this script using the logged on crednetials:No(Unless you are deploying an app that installs in the User context, then set this toYes). Enforce script signature check:No Select output data type:String Operator:Equals Value:Applicable 6. ClickOK. 7. ClickReview & Savetwice and clickSave. 8. The Win32 app should indicate that it now has the requirement script configured. Step 4: Verify a newer version of a required Intune app will not install if an older version of the application is already installed In the following example,Google Chrome 114.0.5735.199is already installed on the device. We can simulate a required deployment of a newer version of the Intune app. We deployedGoogle Chrome 130.0.6723.59, as an Intune app. In the Company Portal we can verify the newer version of the Intune app did not install, it is marked asRequirements not met. The AppWorkload.log also indicates the applicability result: ScriptRequirementRuleNotMet =1008(0x000003F0). The AppActionProcessor.log also indicates the Intune app is not applicable. Summary By utilizing the script in this article as a requirement for Patch My PC Intune apps, the installation of newer versions of the app can be blocked if an older version of the app is already installed on a device. The script checks the system for the app and, if found, marks the app as \u201cnot applicable,\u201d ensuring the required assignment does not trigger an immediate, unplanned, update of the app. Crucially, this approach does not interfere with Intune updates managed by Patch My PC. Once the app is installed, Patch My PC Intune updates will continue to work as expected, allowing you to control when updates are deployed. This gives you the flexibility to maintain controlled rollouts, like during Autopilot, while ensuring an expected cadence of update roll-out across your organisation. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/createdirectory-failed-error-when-publishing/", "title": "CreateDirectory failed, wsus errors, publishing updates, permissions issues", "raw_text": "CreateDirectory failed Error when Publishing Third-Party Updates In this video guide, we will cover an error you may encounter when trying to publish third-party software updates to WSUS. This exception happens when the WSUSUpdateServicesPackagesfolder orWSUSContentfolder doesn\u2019t exist, isn\u2019t shared correctly, not set correctly in the SUSDB, or has incorrect permissions. Determine if You Are affected by Error: CreateDirectory failed Depending on the method you are using to publish updates to WSUS, you will see one of the following errors in thePatchMyPC.log,SMS_ISVUPDATES_SYNCAGENT.log,SCUP.log, orUpdatesPublisher.log An error occurred while publishing an update to WSUS: createdirectory failed SyncUpdate: Exception Message: CreateDirectory failed Exception Message: CreateDirectory failed Step 1: Check if the WSUS Content Shared Directories Exist IfStep 1 looks okay, perform the following check:OpentheComputer Managementsnap-in by opening arun dialogand typingcompmgmt.msc If theWsusContentorUpdateServicesPackagesdon\u2019t exist you can either manually create them with the appropriate permissions or an easier option may be tomove the WSUS content foldersto a new folder to reset all settings. We expect to see thatboth folders exist, and thepaths match those found above in the share dialog. Step 2: Validate the Permissions on the WsusContent and UpdateServicesPackages Shares After validating the shares exist, confirmboththeWsusContentandUpdateServicesPackageshaveAllowpermissions under theShare Permissionstab for the following local (i.e. non-domain) users and groups: NETWORK SERVICE WSUS Administrators Administrators. ForNTFS permissionson theSecuritytab, you will need to ensure theFull controlpermission is applied for the following local (i.e. non-domain) users and groups: SYSTEM NETWORK SERVICE WSUS Administrators Administrators Note:If your WSUS server is configured to use a shared folder for its content, there are more considerations to make for delegating folder permissions: If the WSUS content shared folder is remote from the WSUS server, ensure theAD computer account of the WSUS serveris in the SMBShare Permissionand NTFSSecuritytabs withAllow /Full Controlpermissions. If the WSUS content shared folder is on the same host as the WSUS server itself, ensure the local identity objectSYSTEMis in the SMBShare Permissionand NTFSSecuritytabs withAllow / Full Controlpermissions. You can verify if your WSUS is configured to use a shared folder for its content by reviewing step 3 below. If it\u2019s a shared folder, it will use theUNC notation, e.g.servershare. Step 3: Validate the WSUS Content Folder in the Registry Matches the SUSDB Ifsteps 1 and 2 are correct, you should check the values in theregistrymatch the values in thedatabase (SUSDB). To check the WSUSContentDirin theRegistrycheck: HKLM\\SOFTWARE\\Microsoft\\Update Services\\Server\\Setup:ContentDir To check thevaluein theSUSDBrun the following query in SQL Management Studio against the SUSDB: SelectLocalContentCacheLocationfromtbConfigurationB Ensure the pathsresolve to the same root folderas shown below: If these values don\u2019t match and one is incorrect, you should review the following KB instead specific to this scenario:Failed to sign package; error was: 2147942403 Step 4: If you have HTTPS configured, validate that the SSL Cert contains the correct DNS entries If you have HTTPS configured in your environment, you need to ensure that the correct DNS names (both alias and FQDN) were added when the SSL Certificate was issued.Follow these steps to verify if the correct names were added: 1. Go toIIS, selectWSUS Administrationand clickonBindings 2. Selectthehttpsbinding and chooseEdit. 3. Next to yourSSL Certificate, press theVi ewbutton. 4. Go on theDetailstab, and scroll down until you find theSubject Alternative Name. If you click on it, you should find 2 DNS entries, one for the Alias and one for the FQDN. If the wrong names were added when the certificate was issued, you would have to request the certificate again, and this time add the correct DNS names.You can followthis video guidewe posted on our youtube channel for instructions. Once the new SSL certificate is requested and added, you would have to use the wsusutil.exe command to configuressl again. This is also referenced in the video guide linked above. Step 5: If you have HTTPS configured and you are using a DNS alias If WSUS has HTTPS configured and: the hostname of the server is not in the certificate\u2019s SAN, and there is a DNS record pointing to the WSUS server but it\u2019s not the same address as the server\u2019s AD hostname or FQDN Then you will need to either: Revert the aliasing and issue a new certificate to the server\u2019s AD hostname and FQDN, or\u2026 Configure a Service Principal so the alias can do kerberos authentication on behalf of the server Read more about understanding if this is your scenario and details of the solutions here:Using DNS aliases with WSUS and third-party patching Resolution for the Issues in Step 1 or Step 2 (Video Format) The video guide goes into more detail about why the updates fail to publish to WSUS with the error \u201cCreateDirectory failed\u201d and the possible resolutions. If this resolution doesn\u2019t work for you, please use our technical support form herehttps://patchmypc.com/technical-support Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/user-cancelled-installation/", "title": "win32 apps, installation error, patch my pc", "raw_text": "The user cancelled the app installation (0x80070642) When deploying win32 apps from Intune, in some cases they fail to install. This is an unwanted scenario for any sysadmin. However, the installation failure will need to be investigated. The root of the installation error can vary based on multiple factors, such as dependencies, conflicting processes and many others. This article will focus on applies to apps published through the Patch My PC Publisher or its younger brother, the SaaS platform. In some cases, the installation error will be \u201cThe user cancelled the installation\u201d with the corresponding error hexadecimal code 0x80070642, also known as \u20181602\u2019 in decimal error code. Determine if you are affected Log path for SCCM:%WinDir%\\CCM\\Logs\\PatchMyPC-ScriptRunner.logLog path for Intune:%ProgramData%\\PatchMyPCIntuneLogs\\PatchMyPC-ScriptRunner.log InthePatchMyPC-ScriptRunner.logyou will see this:- User in session 2 has exited with command: Ignore.ScriptRunner8/11/2024 8:06:26 AM1 (0x0001)User has blocked the update installation process(A conflicting process is still running).ScriptRunner8/11/2024 8:06:26 AM1 (0x0001)End of installation. Exit code is: 1602 ScriptRunner 8/11/2024 8:06:26 AM 1 (0x0001) In the Intune Admin Center, you will see this error message for the application install status: \u201cThe user cancelled the app installation(0x80070642)\u201d. Cause The error code0x80070642typically means that the app installation was cancelled / snoozed by the user from the pop-up generated by the Patch My PCManage Conflicting Processesfeature. Example scenario and repro steps Products that should be closed while an update is being applied can be found atKnown Issues and Considerations when Using Patch My PC \u2013 Patch My PC.We will be using the Notepad++ application in the following example, because we know this is an application that must be closed for it to successsfully install.Scenario:An update to this app was published from Patch My PC Publisher to Intune, and based on the assignment, it gets deployed to your client devices. However, out of the 300 targeted devices, 100 devices failed to install the update and returned error : The user cancelled the app installation (0x80070642), in the Intune Admin Center under \u201cDevice Install Status\u201d.Repro steps: Navigate to the \u201cIntune Updates\u201d tab in the Publisher. Select Notepad++ (x64). Right click the product and select \u201cManage Conflicting Process\u201d. Note:By default, if you see thexicon next to any app, it indicates that the app must be closed before an update can be installed. This implies that Managed Conflicting Process (MCP) feature needs to be configured for this product. The default behavior for these apps is set toSkip Installation when conflicting process are in use. With this option set and un-changed, the update will install successfully if the application is closed, but it will fail if the app remains open, and it will fail with exit code 1618.https://patchmypc.com/patchmypc-scriptrunner-known-exit-codes. Note:Applications that should be clsoed during an update behave differently when this default setting is enabled.For instance, with Notepad++, the \u201cAdd and Remove\u201d program entry in the Control Panel will be updated, but the Notepad++ binary on disk will not be updated. If you\u2019ve configured the customization to \u201cNotify the user to close the app\u201d and set a specific number for deferrals, the behavior will vary accordingly. If this customization is enabled, allowing users to defer the installation, then when a user selects the Snooze button, Intune will mark the update as \u201cThe user cancelled the app installation,\u201d leading to an error in the Intune portal. You can customize the behavior when the application is running. For instance, you can trigger a notification asking the user for permission to close the app so the update can proceed successfully. For more detailed guidance, please refer to our comprehensive Knowledge Base article atManage Conflicting Processes when Updating Third-Party Applications \u2013 Patch My PC. According to the settings above, the user can snooze the update up to 5 times. After the 5th time, there will be one more pop-up and that is when the coutdown will reach 0 and the app will be closed automatically and the update will be installed. Client side behavior In the following scenario, Notepad++ was running and when the update was initiated by the Intune Management Extension (IME), the user received a notification configured via the \u201cManage Conflicting Process\u201d to close the app. 1. IME processes the policy. 2. User selects \u201cSnooze Update\u201d. 3. IME reports installation failed 4. Error reported in the PatchMyPC-Scriptrunner.log. User in session 2 has exited with command: Ignore.ScriptRunner8/11/2024 8:06:26 AM1 (0x0001) User has blocked the update installation process (A conflicting process is still running).ScriptRunner8/11/2024 8:06:26 AM1 (0x0001) End of installation.Exit code is: 1602ScriptRunner8/11/2024 8:06:26 AM1 (0x0001) Summary The Manage Conflicting Processes (MCP) feature allows customers to customize the behavior for application updates when the application is running. For instance, a notification can prompt the user to confirm whether it\u2019s acceptable to close the app for a successful update. If you use the Manage Conflicting Process feature in Patch My PC, and users choose to defer an update, the exit code of the installation will always be reported back to the Intune service. Intune will consider a 0 exit code as success but Patch My PC cannot manipulate or control how the Intune service interprets other exit codes. Tip:If you do allow users to postpone the install, don\u2019t allow them to postpone indefinitely or the app may never get updated. Note:After making any changes to the MCP configuration, you must re-publish the app or update so the latest modifications are incorporated into the existing package in Intune. When and How to Republish Patch My PC Third-Party Updates \u2013 Patch My PC Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/file-signature-verification-failed/", "title": "Verification of file signature failed, WSUS error, publishing update, WSUS Signing Certificate", "raw_text": "Verification of file signature failed for file during update publishing This article covers a common error \u201cVerification of file signature failed for file:\u201d that can occur when publishing anew updateorrevisinga third-party software update inWSUS. Determine if You are Affected If you are affected by this error, you will see errors similar to the errors below in thePatchMyPC.log,SMS_ISVUPDATES_SYNCAGENT.log, orSoftwareDistribution.log. The actual log file you see the error in may vary depending on thePublishing methodyou are using. An error occurred while publishing an update to WSUS: Verification of file signature failed for file: ServerUpdateServicesPackagesUpdate-ID.cab PublishPackage(): Operation Failed with Error: Verification of file signature failed for file: ServerUpdateServicesPackagesUpdate-ID.cab SyncUpdate: Exception Message: Verification of file signature failed for file: ServerUpdateServicesPackagesUpdate-ID.cab Is the File Signature Failed Error Happening when Publishing New Updates? There are two common scenarios where this error could occur. The first is whenpublishing a new update to WSUS,and the second is whenrevising an already published update. If using thePatch My PC Publisher, you should see the following in thePatchMyPC.logbefore the signature validation error: If using thein-console third-party catalog feature in SCCM, you should see the following line in theSMS_ISVUPDATES_SYNCAGENT.logto confirm a new update fails to publish: If the error occurs when publishing a new update to WSUS, theWSUS Signing Certificateis notproperly installedin theTrusted RootorTrusted Publisherscertificate store on the WSUS Server. Next, you need to determine thethumbprintof theWSUS Signing Certificate. If using the Publisher, you can click theShow Certificatein theGeneraltab and take note ofthumbprint. If you are using the SCCM in-console publishing or any other method, you can opencertlm.mscand navigate to theWSUScertificate store. If you double click the certificate, you can review the thumbprint in theDetailstab. Once the WSUS Signing Certificate is identified, you need to ensure it\u2019s added to theTrusted RootandTrusted Publishercertificate store on the WSUS server. Opencertlm.mscand review theCertification Pathtab of the WSUS certificate. You may notice an error in this tab about thecertificate not being trusted. Next, you need to ensure the certificate exists on both theTrusted RootandTrusted Publisherscertificate store. In the WSUS certificate store,right-clickthe certificate and clickCopy. In theTrusted Publishersstore, right-click and clickPaste: Validate the certificate was copied to theTrusted Publishers store. If you receive a message, the certificate already exists you can clickYesto overwrite the existing certificate. Repeat the same process toPastethe WSUS Signing Certificate into theTrusted Rootcertificate store. The WSUS certificate should now be trusted on the WSUS server, and you can attempt topublish the update again. Note:Although manually copying the WSUS signing certificate to theTrusted RootandTrusted Publishersis a quick fix for the WSUS server, ideally, the WSUS signing certificate shouldautomatically be deployed to all machines,including the WSUS server. Is the File Signature Failed Error Happening when Revising Existing Updates? The error can also occur when an update already published to WSUS is attempting to berevised. In thePatchMyPC.log, you will see the following line before the error if it\u2019s being revised: If the.CABfile for the update referred to in the error exists. You will want to review the certificate used to sign it in thePropertiesof the file. You will need torepeat the steps in the previous sectionto ensure the certificate for the previously published update exist in theTrusted RootandTrusted Publisherscertificate store on the WSUS server. If the cab file doesn\u2019t exist in theUpdateServicesPackagesfolder, this means the file was likely removed during aWSUS cleanup task,or theWSUS contentfolder may have beenmovedwithout copying old updates. Whenever anupdate is revised(a command line change is one example when this may happen), the WSUS API needs access to the originally published CAB file in theUpdateServicesPackagesfolder. If this file doesn\u2019t exist, you will always receive the error: \u201cVerification of file signature failed for file:\u201c. If you are unable to restore the CAB file in theUpdateServicesPackagesfrom a backup, the only other workaround is torepublish the updates for the product as a new updateand supersede the current update that is unable to be revised during the republishing confirmation prompt. Video Guide Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/troubleshooting-incorrect-notifications-company-portal/", "title": "Company Portal App, Notification Issues, Microsoft Intune", "raw_text": "Troubleshooting Incorrect Notifications in the Company Portal App The Company Portal app communicates with Microsoft Intune using an IME (Intune Management Extension) bridge to manage app deployments and status reporting. When a user initiates actions like installing or uninstalling an app through the Company Portal, the app triggers calls to the Intune service to request app status updates based on both the User GUID and Device GUID. This setup enables the Company Portal to align the app\u2019s displayed status with Intune\u2019s reported state. Sometimes, the Company Portal doesn\u2019t always reflect the real-time state of the apps on the device accurately for the logged in user. Determine if You are Affected You will see that the Notifications displayed in the Company Portal app do not reflect the status of the apps in the Intune Admin Centre. In this example, we only see2app related issues being notified (the other errors shown are related to device compliance for other devices belonging to the user). But our expectation is there should be more. In your case, you might be expecting fewer, or no errors in the Company Portal at all. We can see there are8related app install issues for this device. Workaround The Company Portal periodically requests updated app status reports from the Intune service after each action (e.g. install, uninstall). It tracks the app status by requesting reports for the Intune enrolled device. However, the notifications shown in the Company Portal do not always match the actual state of applications on the device. This discrepancy is largley due to stale Win32 app reporting data cached in the user profile for the Company Portal. Deleting a specific JSON files in the user\u2019s profile proves an effective workaround to the problem. This action forces the Company Portal to re-query Intune for updated app status data the next time it is launched, resulting in a more accurate display of the app states. The JSON file is located here for each user profile on the device: Deletethe fileWin32LocalAppStatus.jsonandre-openthe Company Portal. The Company Portal should now show the correct notifications. In this example, it is displaying more errors \u2013 which is expected for this device. Note:Since the Company Portal tracking and reporting functions are proprietary to Microsoft Intune, the underlying processes remain outside direct control of Patch My PC. If this issue persists, consider logging a support case with Microsoft. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/updates-applications-stuck-preparing-download/", "title": "Preparing for download, Error 0x87D00669, Download issues, Content Distribution", "raw_text": "Updates or Applications Stuck at Preparing to download or fail with error 0x87D00669 or 0x87D00607 This guide covers common reasons clients fail to download updates with the errors \u201cPreparing to download\u201c, \u201c0x87D00669\u201c, or \u201c0x87D00607\u201d within Configuration Manager. Determine if You are Affected Forsoftware updates failing to download, you may see the below error in theUpdatesHandler.log: CDeploymentJob \u2014 Failed to download update (121de25b-8ca6-4e50-8a81-b6baf31d9e5d). Error = 0x87d00669 If your software updates are visible in the software center, you may see theStatus columnstuck atPreparing to download If thesoftware updatedownload times out, you will see the following error:The software change returned error code 0x87D00669(-2016410007). If it\u2019s anapplicationfailing to download, you may see the below warning in theCIDownloader.log: ECCIInfo::SetError \u2013 Setting CI level error to (0x87d00607). If the error is for anapplicationand not a software update, the error will be:The software change returned error code 0x87D00607(-2016410105). Troubleshooting Step 1: Validate the Content is Successfully Distributed We see a common issue for clients not to download content because the content isnot distributedor thecontent fails to distribute. Forsoftware updates failing to download, perform the following actions: Software Library>Software Updates>Deployment Packages> Select theDeployment Packagethe updates is downloaded to: Here is an example of a deployment package in afailed state.If a package failed to distribute, clients would be unable to download the content. If the package is in a failed state, you can use the following resource to resolve the issue:Troubleshoot Content Distribution issues \u2013 Configuration Manager | Microsoft Docs. Below is an example of adeployment package that is not distributedto any distribution points. This scenario will also cause clients to be unable to download updates until youdistribute the content. Forapplications failing to download, perform the following actions: Software Library>Application Management>Applications>Select the Applications>Summary tab Validate the application content is successfully distributed and not in afailed or undistributed state. If the content is successfully distributed and you still have issues, please continue the next troubleshooting step. Tip:There isno direct way within the Configuration Manager console to view the deployment package(s) a specific software update is a part of. You will need to right-click the deployment package and click view members to review if the update in question is part of the package. If you have many deployment packages and updates, you can run the followingSQL queryto see the packages every update is a part of. Troubleshooting Step 2: Check if Client is in Boundary Groups The next troubleshooting step if the content is distributed is to validate a machine failing to download the content iswithin aboundary group. Since ConfigMgr 2002, the easiest way to check if a client falls within a boundary group is to perform the following actions: Assets and Compliance>Overview>Devices Right-click on one of the columns and add theBoundary Group(s)column. The example below shows that DEMO1CLIENT iswithin a boundary group, but DEMO1 isnot within a boundary group. After validating a client falls within a boundary group, you will want to perform the following steps tovalidate there is a distribution point site system referencedwithin thatboundary group: Note:Theboundary group(s) columnwas added in Configuration Manager 2002. Both the Configuration Manager server and client need to be upgraded to 2002 for this feature to work. The client version for 2002 is5.00.8968.1008 Troubleshooting Step 3: Validate Content is Distributed to Correct Distribution Point(s) If you are still having issues after the previous 2 steps, you should confirm the content is actually distributed to aspecific distribution pointin a boundary group from step 2. Perform the following steps to check the specific distribution points a software update deployment package is successfully distributed to: Monitoring\u00c3\u0083\u00c2\u0082 >Distribution Status>Content Status > Select the deployment package Right-click on one of the columns and add theBoundary Group(s)column. Under theSuccesstab, ensure the content has been successfully distributed to aspecific distribution pointreferenced in the boundary groupfrom the previous step. Important:If the content isn\u2019t distributed to areferenced distribution pointof aclient\u2019s boundary group, you can right-click the item and choose toDistribute Content. Optional Additional Resources for Advanced Scenarios You can run the following SQL query to determine what deployment packages software updates are available. \u2014 Run this query against your ConfigMgr database to seeall software updatesand the deployment package they are part of. If you want to limit the software updates toonly Patch My PC third-party updates, you can run the following query instead. \u2014 Run this query against your ConfigMgr database to seeonly Patch My PC third-party software updatesand the deployment package they are part of. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/publisher-error-certificate-not-suitable/", "title": "Publisher Error, Code Signing, Certificate", "raw_text": "Publisher Error: Certificate is not Suitable for Code Signing In certain situations, the Publisher may throw an error during the publishing of Apps or Updates when signing a PowerShell script fails. Patch My PC Publisher version 2.0.2.0 introduced this error, before the 2.0.2.0 release, a failure to sign PowerShell scripts would still result in a successfully published application, however the script included with the application (pre/post script or detection method script) would not be code signed. Determine if You are Affected This error will occur when the Publisher attempts to code sign a PowerShell script, but the Code Signing certificate used was created incorrectly. When this issue occurs you may see one of the following errors in the PatchMyPC.log: An error occurred while signing the PowerShell detection script, but there is no error message to display. CertManagerAn error occurred while copying Pre/Post Script: Error creating detection method PowerShell script because code-signing is enabled, but there is no code-signing certificate available. Please review the following article for a resolution https://patchmypc.com/ui-doc-no-signing-certificate-for-intune [[System.Exception]] An error occurred while signing the file: Cannot sign code. The specified certificate is not suitable for code signing. [[System.Management.Automation.PSArgumentException]]. Please see kb:https://patchmypc.com/ui-doc-certificate-not-suitable-for-code-signingAn error occurred while copying Pre/Post Script: while signing the file: Cannot sign code. The specified certificate is not suitable for code signing. [[PatchMyPC_Certificate.AuthenticodeSignatureException]] To confirm if you are affected by this issue, the following steps may be performed On the system with the Patch My PC Publisher installed, run certlm.msc Navigate to the WSUS -> Certificates store Double-Click the Code Signing Certificate Navigate to the \u201cDetails\u201d tab Under the \u201cDetails\u201d tab, the following Properties should exist:Enhanced Key Usage \u2013 Code SigningKey Usage \u2013 Digital Signature Enhanced Key Usage \u2013 Code Signing Key Usage \u2013 Digital Signature Click \u201cEdit Properties\u2026\u201d ensure that Code Signing is listed and enabled under the list of \u201cCertificate purposes\u201d If any of the properties listed above do not exist or contain the values listed, the certificate cannot be used to sign PowerShell scripts Solution: Recreate Code Signing Certificate The full solution for this error is to recreate the Code Signing Certificate that is used for signing updates, and republish updates using the new code signing certificate. See the following KB articles for information on creating a new Code Signing Certificate and republishing updates: What is the WSUS Signing Certificate and How to Create It When and How to Republish Patch My PC Third-Party Updates Workaround: Disable Code-Signing in the Publisher and disable any Patch My PC provided Pre/Post Scripts If recreating the Code Signing Certificate is not possible, the following steps will work around the issue until a new Code Signing Certificate can be created. Open the Patch My PC Publisher Navigate to ConfigMgr Apps tab Click Options\u2026 Deselect the option to \u201cCode-sign the PowerShell detection method script using the WSUS Signing Certificate\u201d and click \u201cOK\u201d Click Apply to apply the changes The Publisher also attempts to code sign any Patch My PC provided scripts by default (custom pre/post scripts are not resigned), any application utilizing a Patch My PC provided script will need to be disabled and optionally converted to a custom pre/post script in order for publishing to complete successfully. The following process can be used on each of the effected apps to perform this conversion. Open the Patch My PC Publisher Navigate to an application with a Patch My PC defined script (Oracle Java is a popular example) Right click on the Product and select \u201cPatch My PC defined pre/post scripts\u201d Select the Option to \u201cDisable the Patch My PC recommended pre/post-update script for this product.\u201d Click on View Script, this will open the provided script in a web browser Save the script as a \u201c.ps1\u201d file in a location that the Publisher has read access, close the web browser Click OK in the \u201cPatch My PC Defined Script(s)\u201d window Right click the Product in the Publisher again Select \u201cAdd Custom Pre/Post Scripts\u201d Select \u201cBrowse\u2026\u201d next to the appropraite pre/post script option Navigate and select the script that was just saved Click OK, Click Apply The Update or Application should successfully publish on the next Publisher Sync Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sup-sync-generic-error/", "title": "Configuration Manager, Security Role, Software Updates, Synchronization", "raw_text": "An error occurred while triggering a SUP synchronization: Generic failure [-1] In thePatchMyPC.log, you may see the following error when the option to trigger a software update point sync is enabled. An error occurred while triggering a SUP synchronization: Generic failure [-1]Failed to triggered a SUP..sync OR An error occurred while trying to trigger a SUP sync: Access is denied. This error will occur when thecomputer accountof the server running the publisher doesn\u2019t have the necessary permissions to sync the software update point. Import the Patch My PC \u2013 Base Installation Security Role The easiest fix for this issue is todownload our Security Role XML filefor Configuration Manager. This security role will contain permissions required tocreate applicationsas well as permissions to sync the software update point. This security template was updated onMay 7, 2020to include theReadandModifypermissions on theSoftware Updatesclass. Import the filePatch My PC \u2013 Base Installations.xmlfrom the extracted ZIP file in your console underAdministration>Security>Security Roles Validate the security role hasReadandModifyforSoftware Updates. Automatically Create the Configuration manager Security Role for the Patch My PC Publisher In build 1.8.6 or newer, the Publisher canautomatically createthe Security role with the minimum permissions for you. After the security role is created, you will need toassign the computer accountof the server running the publisher to it. Assign the Computer the Security Role Add the computer account of the server running the publisher in theAdministration>Security>Administrative Usersnode on the Configuration Manager console. After the computer account is added, ensure you assign the security role for Patch My PC. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/digest-verification-failed/", "title": "Digest Verification Failure, Software Updates, PatchMyPC", "raw_text": "Digest Verification Failed on Content for Software Update The errorDigest verification failed on content for software updateis pretty common, In this article, we will review why file digest verification failures happen and how they are resolved. Determine if You are Affected by this Error If usingPatch My PC\u2019s Publisher, you will see an error similar to the one shown below in thePatchMyPC.log: The hash of file downloaded is different than the file hash in our catalog. Hash errors happen when vendors release updates that aren\u2019t available in our catalog yet. This error should be resolved in the next catalog update. Additional details: Downloaded Hash Catalog Hash If you are using theSCCM 1806+third-party updatesfeature directly in the SCCM console, you will see the following errors in theSMS_ISVUPDATES_SYNCAGENT.logwhich is located on the top-level software update point in the site system logs folder. STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_HASH_FAIL). STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_FAIL). If you are using Microsoft\u2019s legacy method for publishing updates throughSystem Center Updates Publisher,you will see an error similar to the error below in theUpdatesPublishing.logorSCUP.loglocated in your users%temp%directory. \u2014 Digest verification failed on content for software update \u2018Google Chrome 72.0.3626.119 (x64) (UpdateId:\u2019626b77a4-61e5-4e84-9870-3aa68abafd0e\u2019 Vendor:\u2019Patch My PC\u2019 Product:\u2019SCUP Updates\u2019)\u2019. Why Does the Digest Verification Fail When Publishing Updates? Whenever a third-party update is being published with full-content, the update needs to passsecurity validation checks. The first check is that thebinary downloaded from the vendor\u2019s websitemustmatch the binary file digest when we created it. When vendors use thesame download URLfor a product such as Google Chrome:https://dl.google.com/chrome/install/GoogleChromeStandaloneEnterprise64.msi, hash validations can fail if you arepublishing an older version of the updateor if thevendor just released a new updatethat isn\u2019t in our catalog yet. Resolving Digest Verification Failures To fix the digest validation error, you will need toimportorsyncthe latest Patch My PC Update Catalog so you can publishthe latest software updatethat will match the hash of the vendor\u2019s latest update binary. You will need toperform a sync of the catalog manually. In the Third-Party Software Update Catalog node in your SCCM console, right-click the Patch My PC Catalog and chooseSync now. By default, SCCM will onlyautomatically sync a third-party software update catalog every 7 days. You can review the catalog sync progress in theSMS_ISVUPDATES_SYNCAGENT.log. located on the top-level software update point in the site system logs folder. Once the catalog publishing sync is complete, you canperform a sync of your software update pointto have any newly released third-party updates show up in the \u201cAll Software Updates\u201d node of the SCCM console. Once the sync is complete, you should seenew updatesfor the product, and theprevious updates that were failing should become superseded. The latest version of the update should be able to publish the update content successfully. You will need to import the latest catalog manually from the console: Once the newest catalog is imported, you should seethe latest update(s)for the product that was previously failing to publish. Choose to publish the latest software updates(s). Our publisher always downloads thelatest catalogbefore any publishing operations. If you receive a hash error while using our publisher, it means the vendor recentlyreleased an update that isn\u2019t yet available in our catalog. You will just need to wait for future catalog syncs for the issue to be automatically resolved. You Can Switch to Our Publisher to Reduce Hash Errors When usingSystem Center Updates Publisheror theSCCM 1806+ Third Party Updates feature, you will be more likely to run across hash errors, because there is a delay between when the catalog syncronizes and when you choose to manually publish the content. For example, the SCCM 1806+ catalog feature canonly perform an automatic catalog sync every 7 days, and this is not currently configurable. If SCCM syncronized our third-party update catalog on March 2, 2019, and on that date, Google Chrome 72.0.3626.119 (x64) was the latest version it would be published automatically to SCCM. If we then released Google Chrome 72.0.3626.121 (x64) on March 3, 2019, and you hadn\u2019t previously published the content for Google Chrome 72.0.3626.119 (x64) before it was updated on Googles web server you would receive a hash error. Since SCCM only syncs the catalog every 7 days, you would continue to have hash failures when trying to publish the update content until the next automatic sync occurs on March 9, 2019, or you perform a manual catalog sync in the SCCM console. If you were to switch to ourpublishing service, you would have complete control over how often our catalog syncronizes. The scheduling options will allow you to sync the catalog more frequently to ensure you have the most recent catalog metadata. Our publishing service will always download the most recent catalog before downloading any third-party update content. By downloading the newest metadata, it will ensure we are pulling the most recent updates with the current file digest before performing content publishing. There are other benefits to switching to our publishing service including full automation. You can get more details about the benefits of our publishing service below. ? What\u2019s the Difference our Publishing Service and SCCM 1806+ In-Console Publishing? What if You Receive the Hash Error when Using the Latest Catalog? If you receive the hash digest error afterverifying you have imported the latest catalogandpublishing the latest update, it\u2019s because the vendor just posted a new software update that hasn\u2019t been made available in our catalog yet. You can let us know you are getting a hash error when publishing the latest available update by using ourtechnical support contact form. Generally, we release updates the same day a vendor makes releases the update so it will just automatically resolve itself when we update the catalog. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/1password-install-error/", "title": "1Password, Installation, Error, Blocking", "raw_text": "1Password was unable to complete installation and will roll back any changes. The installation of 1Password fails, and when running manually, the error message \u201c1password was unable to complete installation and will roll back any change\u201d appears. Determine if You are Affected If the installation of 1Password fails, locate the installer in the cache ordownloadthe installer from the vendor\u2019s website and attempt the installation manually.This error should appear: Potential Resolution This error is generally caused due to 1Password being blocked from updating/installing by another program. Make sure you don\u2019t have any pending restarts or any pending browser updates to be installed.The easiest fix is to restart the device, then retry the installation. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-rollback-uninstall-third-party-update-in-intune/", "title": "Intune, Third Party Updates, Rollback", "raw_text": "How to Rollback or Uninstall Third-Party Updates in Intune This article describes how torollback/uninstall a third-party update in Intune. We get asked:how do I rollback a third-party update if there are issues in my environment?This guide will describe your options and some limitations that exist. How to Rollback a Third-Party Update to a Previous Version in Intune To rollback a third-party software update, you can useWin32 app supersedencein Intune torevert an application to a previous version.At the time of writing this article, this supersedence feature for Intune is in public preview. In the example below, we will show how torevert Google Chrome 96.0.4664.45 (x64)toGoogle Chrome 88.0.4324.146 (x64). To perform a rollback, you will need to have an application you want to rollback to as well as the version you want to revert from (the update that was installed). Note:Previous application versions may not be available from Patch My PC if you do not have the retain options enabled in theIntune Optionswindow. Note:If you have any required assignments for the application you want to uninstall, you will want to remove the assignments so that the rolled back version is not re-installed. To revert to an older version, go to thepropertiesof the application you want to revert to and perform the following actions: Click theEditnext to theSupersedence (preview)option > clickAdd> Select thelatest applicationyou want to uninstall > SelectYesunderUninstall previous version> ClickReview + Save> ClickSave. You can now deploy the application you want to revert to with arequired assignment. The required assignment will automatically uninstall the latest update before the rollback to the previous version. It may take some time for the policy to hit your devices and for the full rollback to complete. In our example we added a required assignment in Intune to ourAll Usersgroup. On our client machine, after the policy hits, we can take a look at ourPatchMyPC-ScriptRunner.logand see when it uninstalled the application that will be superseded. If you set the options toShow all toast notificationsfor your assignment, you should also see a notification similar to the one below. In my case, it took about an hour for policy to hit on the client machine. We can view thePatchMyPC-ScriptRunner.logto view when that installed. The installation can also be confirmed in theDownload & Updatessection inCompany Portal. Note:After the superseded role is applied, you will need to either delete the supersedence relationship from the app you reverted to or delete the app completely from Intune. Since we cannot update the dependencies or supersedence relationships for the Win32 apps, we won\u2019t be able to delete the application when an updated version is available. Perform an Uninstall of a Third-Party Application in Intune If you want to remove a third-partyapplication entirely, you can use anUninstall Assignmentto a user group you are targeting. Almost all Win32 apps created by Patch My PC will have theuninstall command. In the example below, we will demonstrate how touninstall Notepad++ 8.1.9.1 (x64)with theIntune Application Managerin our Publisher. To uninstall the application, open the Intune Application Manager in the Publisher > double-click on the application you want to uninstall. Remove any previous assignments for that app and then add anUninstall assignmentto the user group you want to target > SelectOK. This will update the assignment for the Win32 app in Intune and depending on the deadline you set, it will perform the uninstall. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/authority-uri-format/", "title": "Intune Authority Uri Format", "raw_text": "\u2018authority\u2019 should be in uri format The error\u2018authority\u2019 should be in uri formatcan occur when you configured an invalid authority URL. Determine if You are Affected If affected, you will see the following error in thePatchMyPC.logfile. \u2018authority\u2019 should be in Uri format Parameter name: authority Resolve Error: authority\u2019 should be in Uri format This error happens when the URL in theIntune tenant settingsis invalid. We often see customers removed thehttps://login.windows.net/prefix, as shown below: If you do not know your Intune tenant domain, navigate to thetenant status pagein your Intune tenant, and look at the property forTenant name. Now, it is time to go to thePatch My PC Publisherand input theAuthority,Application ID, andApplication Secretinto theIntune Optionswindow of the Publisher. It\u2019s important you leave thehttps://login.windows.net/prefix and only change the part Replace with theTenant nameyou found in your Intune tenant\u2019stenant status page. Paste theApplication IDandApplication Secretthat was saved from earlier. Click Test to validate that thePublishercan connect to your Intune tenant if you get a dialog box that says \u201cSuccessfully connected to Intune\u201d, congratulations! You can now begin to publish applications to your Intune tenant. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/deploying-additional-language-packs-firefox/", "title": "Custom language packs, Firefox, Publisher", "raw_text": "Deploying Additional Language Packs to Firefox This article will demonstrate how you can leverage ourPublisher\u2019sability toAdd custom pre/post scriptsto allow you to add additional language packs to Firefox and configure it to use the appropriate language pack based on the system locale. Step 1: Download script and language packs Download the post installation script from out GitHub repo here:Add-FirefoxLanguagePacks. Download all the language packs you require fromMozilla\u2019s website. They can be found here:https://releases.mozilla.org/pub/firefox/releases//win64/xpi/ Note:You can download and include any and all language packs using this process, you are not limited solely to 1 language pack, The post installation script will detect the system\u2019s locale and use the appropriate language pack. Note:Language packs are Firefox version specific and will need updated every time there is a new version of Firefox available. The full version list can be found here:Firefox version list. For example, to see all language packs for version 93.0, the URL is:https://releases.mozilla.org/pub/firefox/releases/93.0/win64/xpi/ Step 2: Add script and language packs to custom pre/post scripts Once you have the script saved and the language packs downloaded, right click on any version of Firefox in out Publisher and selectAdd custom pre/post scripts. Add the script to thePost Scriptfield and add any language packs you downloaded previously in theAdditional filessection. Step 3: Synchronize to publish Once you have completed Step 2 you will need to run a sync, or wait for your next sync schedule , to allow our Publisher to either update existing Firefox packages with the post script and additional files or publish fresh if Firefox was not previously published. Note \u2013 Configuration Manager:Previously published FirefoxApplicationswill have their content updated on next sync to include the post script and zip file. Previously published Firefoxupdateswill needrepublishedto have the post script and zip file included. Note \u2013 Intune:Previously published FirefoxApplicationsandUpdateswill need deleted and republished Additional information This process follows documentation provided by Mozilla, more information on that process can be foundhere If you encounter any issues with this either raise an issue on Github or email me at[email protected] Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-not-installed/", "title": "Windows Server Update Services, Patch My PC, WSUS RSAT tools, PowerShell", "raw_text": "Windows Server Update Services not installed This article discusses the \u201cWindows Server Update Services is not installed\u201d error message you get when installing the Patch My PC Publisher. Introduction When you install the Patch My PC Publisher on a Windows 10 / 11 / Windows Server, you get the error message \u201cWindows Server Update Services is not installed\u201d. Even for the Intune-only integration, the Patch My PC Publisher can only be installed if the WSUS RSAT tools are installed. These tools are needed to be installed to parse the Patch My PC catalog XML. You can find more details on necessary requirements onthis page. How to fix it If you are installing the Patch My PC Publisher on aWindows OS, you\u2019ll need to install theWSUS RSAT toolsto fix this issue. Note:You can only install the WSUS RSAT tools on Pro or Enterprise Operating Systems. If you plan on installing the Publisher on aWindows Server OS,you\u2019ll need to install theUpdateServices-API. Note:It\u2019s not mandatory to install the full WSUS role, the API is sufficient. How to fix the issue on Windows 10 and Windows 11 OS To install the WSUS RSAT tool on a Windows Desktop machine, please follow these steps: Open an elevated PowerShell window. Enter this command: Add-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0 You can verify if this capability installed successfully by running the following PowerShell command. Get-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0 You should get a result similar to this: How to fix the issue on a Windows Server OS If you plan hosting the Patch My PC Publisher on a Windows Server, please follow these steps to install the UpdateServices API: Open an elevated PowerShell window. Enter this command: Install-WindowsFeature UpdateServices-API You can verify if this feature installed successfully by running the following PowerShell command: Get-WindowsFeature UpdateServices-API You should get a result similar to this: Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/teamviewer-hash-workaround/", "title": "TeamViewer Hash Mismatch Workaround TeamViewer Update Fix Patch My PC", "raw_text": "TeamViewer Hash Mismatch Workaround A short summary of the issue including keywords. Explanation of TeamViewer Hash Issue In August 2022, TeamViewer began adding unique data to their EXE-based downloads. Due to this change, Patch My PC cannot publish updates to the TeamViewer EXE-based applications, as the unique data added to each download changes the hash of each download file. Patch My PC relies on the hash of the downloaded file to match what is found in Patch My PC\u2019s catalog. This article will cover how to work around this issue by modifying a manually downloaded TeamViewer EXE to ensure that the hash of the downloaded file matches the one found in Patch My PC\u2019s catalog. Workaround for TeamViewer Hash Issue Download the TeamViewer installation file to be publishedThe link to the download can be found in the Patch My PC Publisher by right-clicking on the appropriate Product and selecting \u201cShow Package Info..\u201dPatch My PC Publisher \u2013 Show Package Info The link to the download can be found in the Patch My PC Publisher by right-clicking on the appropriate Product and selecting \u201cShow Package Info..\u201dPatch My PC Publisher \u2013 Show Package Info Move the downloaded file to the \u201cLocal Content Repository\u201d pathIf the \u201cLocal Content Repository\u201d path is not defined, it may be set in the Patch My PC Publisher under the \u201cAdvanced\u201d tabPatch My PC Publisher \u2013 Local Content Folder If the \u201cLocal Content Repository\u201d path is not defined, it may be set in the Patch My PC Publisher under the \u201cAdvanced\u201d tabPatch My PC Publisher \u2013 Local Content Folder Download the script from here: Run the downloaded script on the device where the Patch My PC Publisher is installedThe script will modify the TeamViewer files in the Local Content Repository in-place The script will modify the TeamViewer files in the Local Content Repository in-place In the Publisher, ensure that the checkbox to \u201cCheck the local content repository for content files before attempting to download content files from the internet.\u201d under the \u201cAdvanced\u201d tab is enabledPatch My PC Publisher \u2013 Check for Local Content On the \u201cSync Schedule\u201d tab, click \u201cRun Publishing Service Sync\u201d to sync the modified installersPatch My PC Publisher \u2013 Run Publishing Service Sync Note:The script provided by Patch My PC is digitally signed, and the installer files modified by the script should still have valid signatures even after this process is complete. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/pmpc-prioritization-criteria/", "title": "Prioritization Process, New Features, Customer Value, UserVoice", "raw_text": "What Criteria Does Patch My PC Use to Prioritize New Applications and Features? One of our most common questions is thecriteria usedwhenadding new products to our catalog or building new features. In this article, I want toreview the processmyself (Justin Chalfant, Founder) and our engineering team use when evaluatingpending feature and application requestson ourUserVoice. The Basics: We Don\u2019t Know What We Don\u2019t Know The first step in the process is to ensure we know whatnew applicationyou would like to see added to oursupported productsor whatfeaturewould provide you value. Our goal isnot to have the largest update catalog in the industryfor promotional purposes. Instead, our goal is to have alist of supported products that provides our customers with the most value. If you have anew applicationorfeature request, the first step is to submit a new feature request on ourUserVoice (https://ideas.patchmypc.com/). If you don\u2019t submit it here, it\u2019s unlikely your idea will ever be implemented into our product. Before submitting a new request, you cansearchfor theapplicationorfeatureyou would like to see added. If you see anexisting feature matching your request, you shouldup-voteit rather than submitting a new idea. After subscribing to an existing idea, you will receive anemail notificationwhen there are any status updates. How Does Patch My PC Prioritize New Application Requests? There are multiple factors we take into account when working through thesubmitted application requests. One of the biggest factors we start with when working through our queue is how manyunique customershavesubscribedto a specific application request. The number ofunique subscribersdoes not necessarily mean the largest number of votes. For example, an idea with10 voteswith subscribers from8 different companieswould likely be prioritized over an idea with25 votesbut onlysubscribers from 3 different companies. This is why the most important step is to submit your application request if it\u2019s not already in ourUserVoice. Once we determine there is a product that wouldbenefit multiple customers, the next factors thatimpact priority are: Howcomplexis the installer? Does the installer have apublic download? Is the installerdigitally signed? Is the installer downloaded inEXE,MSI, orMSPformat? Does the installer supportsilent installations? Can the installerreboot behaviour be controlled or suppressed? Does the installer supportSYSTEM-level installations? Are there anycustom-actionsorscriptsthat need to be run? We have these requirements because each new product added requires alarge amount of up-front timeand even more time tomaintain all future updates. Our goal is to add around50 new products per month. In ourPublic Roadmap,you can see the recent applications that shipped. Shipped application requests will use the \u201cNew Products\u201d dark blue tag. How Does Patch My PC Prioritize New Feature Requests for the Publisher? The prioritization ofnew feature requestsfor ourPublisheris very different from prioritizingnew application requests. The reason for this is simple. For applications, we know the following: The upfront engineering time will be about8+ hours. Maintaining an application that updates often can be well over40+ engineering hours per year. Many requests for features or improvements to our Publisher can be implementedquicklyand is only aone-time effort, unlike new applications. Since the engineering time can often vary, our criteria for adding features areless based on the number of unique customersand more based on the value we think the request could provide. For example, when filtering byshipped feature request for the publisher,you will see many features shipped with only 1 vote: Oftentimes, these lower voted for ideas that areeasier to implementfrom an engineering perspective may ship in afew weeks. However, there are oftencomplexfeature requests that may take many subscribers before it\u2019s implemented. For example, the feature request to add support forMicrosoft Intunetook about1-year to implementbecause it was difficult and took amassive amount of engineering time. What Does Each Status Mean in the UserVoice Portal? Each idea submitted will have astatusassociated with it. The status will help you know at what point in the process the idea is in. Below is an overview of how we define status: Submitted is thedefault statusassigned to every new idea. This means it\u2019s been submitted, but there hasn\u2019t been any action taken on the request from Patch My PC. We use this state to acknowledge this is apopular requestor a request tosee the value. We want toconsider any request marked noted for a future updatein our product, but there hasn\u2019t been any engineering work yet. We use this status when there is a morecomplicated requestthat we would like to consider adding in the future. We needmore detailsfrom the person who submitted the request in the comments section to understand the request better. Planned means weintend to implement this feature in the future, but we haven\u2019t actively started coding it yet. In the planned status, we also will not generally have an ETA yet. Started means our engineering team isactively codingthe feature. The feature is available in private preview to specific customers and undergoing internal testing. The feature is available in the latest preview build, which can be enabled in theAbouttab of the Publisher. The feature isavailable in the latest production buildof our Publisher or catalog. We willnot be implementingthe feature request. The request can\u2019t be added due tocompatibility issues. Takeaway: Please Submit Your Feedback on UserVoice If you didn\u2019t get this take away from the points above already :), please submit any new application or feature request athttps://ideas.patchmypc.com/. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/digest-mismatch-due-download-url/", "title": "Digest Mismatch Download Firewall Block", "raw_text": "Digest Mismatch Due To Download URL Being Filtered by Firewall or Web Filter If you received an error message in thePatchMyPC.logsimilar to the one shown below when publishing a third-party update this article should help. Digest of the downloaded update doesn\u2019t match the digest from the catalog: Hash from catalog doesn\u2019t match downloaded update hash ofThis error appears to be a known error. Please see our KB article https://patchmypc.com/digest-mismatch-download-filtered for the resolution. Why the Hash Check? Whenever we download an update file from a vendor\u2019s website to publish to WSUS/SCCM, we validate thehash of the current binary downloadedmatches theoriginal hash within the catalog metadata. This check ensures thatif a binary is compromised or changedon the vendors websites, we will not publish the software update. We have a deep dive into oursecurity validation process here. Review Download Failures from Firewall Rules for Previous Synchronizations We store thelast download response code and domain for currently enabled products. This can be helpful when reviewing download failures for currently enabled products. The download history can be found on a CSV file in:%InstallDir%\\PatchMyPC-DownloadHistory.csv Here\u2019s an example of the data included in thePatchMyPC-DownloadHistory.csv file. You can use thedomain column to create firewall exceptionsbased on the products enabled and failing to download. Resolution to this Specific Hash Check Failure If you received the error message above that links our to this article, that means thehash check failed, andthe downloaded file size was less than 100 kb. When the downloaded file isless than 100 kbin size, this almost always correlates to aweb filterorfirewall blocking the downloadfrom the server that is running our publishing service. Step 1\u2013Open the PatchMyPC.logfrom thepublishing service. Step 2 \u2013Copy the download URL from the PatchMyPC.logfor any updatesreceiving this hash error. Step 3 \u2013 Paste the download URL into a web browseron the same server running the publishing service and check if you receive anerror that a web filter is blocking the download. Step 4 \u2013You will need to get exceptions created for any downloads receiving this hash error for \u201cdigest mismatch download filtered\u201c. A full list of possible domains used for products in our catalog can be found athttps://patchmypc.com/list-of-domains-used-for-downloads-in-patch-my-pc-update-catalog Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/moving-supersedence-software-update-model/", "title": "Supersedence, Software Update Model, Configuration Manager, Third-Party", "raw_text": "Moving to Supersedence Software Update Model StartingDecember 28, 2018, we are moving to asupersedence modelfor software updates in our third-party software update catalog. Before this change, we would mark previous versions of software updates as expired. Why are We Making this Change? With theThird-Party Software Update Catalogs feature inConfiguration Manager 1806+, all third-party updates in a catalog are published. When we expired previous updates in our catalog, those previous versions were immediately marked expired when a new update is released. When an update is marked as expired, it can\u2019t be deployed in Configuration Manager. The immediate expiring of updates could cause issues where customers don\u2019t have enough time to fully deploy updates through all testing cycles for products where new updates are released frequently. What\u2019s the Supersedence Model Look Like? By moving to a supersedence model,you will have complete control over how long you want to keep previous versions availablefor deployment that have been superseded. You can control whether you want superseded updates to be immediately expired or delay expiring superseded updates for a certain number of months using theSupersedence Rulesoption on your software update point. In the example below, configuration manager won\u2019t expire superseded updates until they have been superseded for 1 month. In today\u2019s catalog update in our lab, we can see the previous versions of applications are superseded and not expired. This change will allow the superseded application updates to continue being deployed for an additional month in our configuration. If you are not expiring superseded immediately and using automatic deployment rules, you will want to ensure that youexclude superseded updatesin your criteria to ensure your ADR\u2019s only deploy the latest updates. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-win32-application-failed-install/", "title": "Intune, PowerShell, Certificate, Deployment", "raw_text": "Intune Win32 Application Failed to install: Powershell script is failed to execute Intune applications created by Patch My PC may give the errorFailed to installin some scenarios if the code-signing certificate used to sign the PowerShell detection method script isn\u2019t trusted on the client device. Determine if You are Affected If affected, you will see the errorFailed to installin Company Portal if the application assignment is available. In some cases, the application may actually be installed successfully, as shown below. If you review theIntune Management Extentionlog fileAgentExecutor.log, you will see errors similar to below: Powershell script is failed to executewrite output done. output = , error = File C:\\Program Files (x86)\\Microsoft Intune Management ExtensionContentDetectionScripts.ps1 cannot be loaded. A certificate chain processed, but terminated in a root certificate which is not trusted by the trust provider. + CategoryInfo : SecurityError: (:) , ParentContainsErrorRecordException + FullyQualifiedErrorId : UnauthorizedAccess This error results from having the optionDigitally sign the detection method script and enforce signature checking on the application in Intuneenabled andnot deployingthe certificate to theTrusted RootandTrusted Publisherscertificate store on the client. Resolution: Deploy the Code-Signing Certificate to Client Devices You have two options to deploy the code signing certificate with Intune: Using aprofile with custom settings in Intuneand an OMA-URI to apply a setting from the RootCATrustedCertificates CSP. Using aPowerScript in Intune, which itself will be unsigned and contain the code signing certificate used to install it on target machines. To read more about option 1, using a profile with custom settings in Intune, see this Microsoft TechCommunity article by Jason Sandys:Adding a Certificate to Trusted Publishers using Intune. For options 2, using a PowerShell script deployed in Intune, contiune reading. Below is a step by step showing how an Intune Script can be created usingthe script attached here. Additionally, there are steps to help gather the required information. Gathering Info Step 1: Create a New Script Step 2: Assign the Script Gathering Info The script itself will need to be edited with your specific Thumbprint and Base64 encoded certificate string. The function contained within the script discusses how to gather these values, but I\u2019ll also note them below. Also, if you are comfortable with Configuration Items within Configuration Manager, you can simply grab the script, adjust for your environment, and deploy away! Certificate Thumbprint:Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate.This can also be copied out of the Patch My PC Publisher, as shown below. Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate. This can also be copied out of the Patch My PC Publisher, as shown below. Base64 Encoded Certificate String:This can be acquired a handful of ways, but a simple way is to get a copy of the certificate as a file and run a PowerShell command similar to the belowSet-Clipboard -Value (::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Set-Clipboard -Value (::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Step 1: Create a New Script Make a local copy ofthe script attached hereand ensure you edit the script based on the information you gathered above. We will later upload this .ps1 file to Intune. Navigate toIntuneand locate theScriptsnode underDevices. Within this node, you can createAdda newWindows 10script. Basic information can be input for the Name and Description. We now will make sure our local copy of thescripthas beenedited for our environment. Ensure$Remediate = $true Set$CodeSigningCertificateThumbprintto your thumbprint gathered earlier. Set$EncodedCertStringto the Base64 string representation of your code signing certificate gathered earlier. Save the script! With our script updated and saved we can: Upload it to Intune Ensure we set\u2018Run script in 64 bit PowerShell Host\u2019 Note:It is important that youdo not \u2018Enforce script signature check\u2019on this script. We are deploying this script to ensure we can enforce signature checking on other scripts. Step 2: Assign the Script With all the above steps complete we can assign our script! The target of the assignment is up to you, but in our case, we will target all devices. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/right-click-options-available-updates/manage-dynamic-assignments", "title": "Dynamic Assignments, Automatic Deployment Rules, Intune Updates, Enterprise Plus", "raw_text": "Manage Dynamic Assignments In this article, we will cover theManage Dynamic Assignmentsfeature that allows you to publish application updates to Intune that will dynamically assign to security groups based on pre-defined search criteria. We will discuss how the feature works and recommend some key best practices using it. This feature requires the Enterprise Plus subscription. What are \u201cDynamic Assignments\u201d Prior to this feature, the Patch My PC Publisher was able to create assignments via the right click optionManage assignments. This enabled customers to define Available, Required, and Uninstall assignments which would always be applied to newly published Intune Apps and Intune Updates. These could be referred to as \u201cstatic assignments\u201d. While this provided customers with granular control and consistency, other customers wanted the ability to still automatically create assignments but only apply some groups if theupdate contained a CVE, or wasclassified as a security update, or contained aspecific keyword in its titleetc. This is the premise ofDynamic Assignments. With Dynamic Assignments, the Patch My PC Publisher will evaluate every new update against a pre-configured set of rules (or \u201csearch criteria\u201d) to determine if an update should be assigned to a specific security group. In this way, Dynamic Assignments can also be thought of asAutomatic Deployment Rules(ADRs)\u2026 but for Intune! Evaluation Criteria Below is a list of the available search criteria you can use to dynamically search and create assignments with usingDynamic Assignments: Has CVEThis is a Boolean property. Click the value to switch betweentrue / false This is a Boolean property. Click the value to switch betweentrue / false SeverityMulti-select list of the below valuesCriticalImportantModerateLow Multi-select list of the below valuesCriticalImportantModerateLow Critical Important Moderate Low TitlePlain text or Regular expression strings can be used to aggressively filter the evaluation.Exclusions can be achieved by adding a \u201c-\u201d to the beginning of the string. Plain text or Regular expression strings can be used to aggressively filter the evaluation. Exclusions can be achieved by adding a \u201c-\u201d to the beginning of the string. Update classificationMulti-Select list of the below valuesUpdatesCritical UpdatesSecurity Updates Multi-Select list of the below valuesUpdatesCritical UpdatesSecurity Updates Updates Critical Updates Security Updates Note:To understand how Patch My PC classifies an update, please see this article:Aligning to Microsoft Standards for Update Classifications For example, you could create an evaluation criteria that only assigns updates with a CVE ID associated with them, of \u201cCritical\u201d severity, and classified as \u201cCritical updates\u201d and \u201cSecurity updates\u201d: Search criteria options which allow multiple values (Severity, Title, Update Classification),multiple values will be joined with an \u201cOR\u201d operator. However, all search criteria options will be joined by an\u201cAND\u201doperator. For example, looking at the above screenshot, the criteria forUpdate Classificationwill search for updates with the classificationCritical UpdatesORSecurity Updates. Therefore, theHas CVE,Severity,andUpdate Classificationwill all be joined together with anANDoperator. In English, the above rule will search for updates which contain a CVE ID, and severity of \u201cCritical\u201d, and has Update Classification of \u201cCritical Updates\u201d or \u201cSecurity Updates\u201d. The following illustration of the same rule above may also help with understanding: Note:Dynamics Assignments will apply assignments to newly published updates in the same sync. In other words, it will not apply assignments to updates which already exist in Intune. How to Configure Dynamic Assignments In this section we will detail how to leverage the Dynamic Assignments feature. To configure and manage Dynamic Assignments, in theIntune Updatestab, right click on theAll Productsnode and selectManage dynamic assignments: Opening the feature will bring you to a list of existing evaluation rules. To create a new rule, selectAdd. We will now build a dynamic assignment rule. Below is an example of a rule that will select only application updates that have: CVEs attached Severity classification of \u201cCritical\u201d Update classification of \u201cCritical Updates\u201d OR \u201cSecurity Updates\u201d To validate what application updates will pass evaluation, we can pressPreview(bottom left) to run the evaluation rule against the catalog. In the example below, the evaluation rule has returned only the products that meet the dynamic assignment rule from above. Once you are happy that with your new evaluation search criteria, you can associate Intune assignments with the rule by selecting theManagebutton. This will bring up the standardManage Assignmentswindow used for existing \u201cstatic\u201d assignments. Here you can define either \u201cRequired\u201d or \u201cUninstall\u201d assignments, with the normal options to add Azure Active Directory groups and all the other assignment options, too, including notification options, installation deadline availability and deadline, and restart grace period. These will be the assignments associated with theDynamic Assignmentrule. Once assignments are added, we can verify that the assignments have been applied by checking theAssignmentslist on the previous window. Once we are happy with our new rule, clickingOKwill return us to the list of dynamic assignment rules, which should display our newly created rule. Note:In the screenshot above, we can verify that the rule has assignments attached to it \u2013 this means the rule is \u201cActive\u201d and will perform evaluations when the publishing service runs next. Notes: With this feature, there are some important things to take into consideration: Unlike Configuration Manager, where a product can be deployed to the same collection more than once, with Intune, an application can only assign to a security group once. What this means is that if you have an existingstatic assignmentset to assign an application to \u201cGroup A\u201d and you also set a dynamic assignment rule to assign to \u201cGroup A\u201d based on certain criteria, a conflict will occur. In the case of a conflict,Dynamic Assignments will always supersede static assignments. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/manage-conflicting-processes-when-updating/", "title": "Manage, Conflicting, Updating, Applications", "raw_text": "Manage Conflicting Processes when Updating Third-Party Applications When updating third-party applications, there may be cases where you need toclose an applicationthat is currently open by an end-user. This guide will explain the option \u201cNotify the user to close the application\u201d within thecustom right-click optionManage conflicting processes. Video Walkthrough of Notify the user to close the application feature If you prefer to watch a video guide of how this feature works, please check out the video below. Configuration Options for Notify the user to close the application There are a variety of options available for this feature. Below you can find detailed explanations of each option. Notify Timeout ConfigurationThis option controls how long the user notification will remain open on the screen.Time out after\u2026 \u2013 maximum value depends on the platform. See below for details.While the user notification is displayed, the update or application install is considered to be running.The run time here would contribute to the max run time of your applications and updates, and consume time during a maintenance window, for example.Platform Specific Maximums: Max runtimes account for a 15-minute buffer to allow the application to install after a notification has timed out or closed. (Note: There are newer features in ConfigMgr to default this to a higher value that Patch My PC will investigate)Updates Max: 5 minutesThird-party updates in ConfigMgr can have a few default values for Maximum Runtime depending on your version of ConfigMgr. We default to assuming the maximum runtime of third-party updates will be 15 minutes. Because of this, we have the maximum set to 5 minutes, allowing 10 minutes for the update to run before it would exceed the update maximum run time. See the \u2018use maximum run time\u2019 info below for a workaround to this.ConfigMgr App Max: 705 minutesThis is the maximum configurable run time for a ConfigMgr application minus a 15-minute buffer.Intune (Applications and Updates) Max: 1425 minutesIntune has a non-configurable run time of 1440 minutes (1 day) for Win32 applications. The notification max is this 1440 minutes minus a 15-minute buffer.Option to use \u2018maximum run time\u2019 from the respective update or app.ConfigMgr Update Max: Will use configured update \u2018max run time\u2019 as configured in ConfigMgr for the update.Note: Update max run time must be edited before the update is deployed for a client to recognize the change.If either the maximum run time in ConfigMgr, or the Notify Timeout Configuration, is under 15 minutes, the timeout notification will default to 5 minutes. This is because a 15-minute buffer is applied. For example, a 60-minute max run time will have a 45-minute UI timeout.ConfigMgr App Max: Will use the configured deployment time \u2018max run time.\u2019Intune App/Update Max: Will use the maximum run time of an Intune Win32 app (60 minutes minus the 15-minute buffer).Once the timeout is reached, the options defined in the \u2018Defer Policy\u2019 section described below will either increment or start the day deferral count, depending on your settings. This option controls how long the user notification will remain open on the screen. Time out after\u2026 \u2013 maximum value depends on the platform. See below for details.While the user notification is displayed, the update or application install is considered to be running.The run time here would contribute to the max run time of your applications and updates, and consume time during a maintenance window, for example.Platform Specific Maximums: Max runtimes account for a 15-minute buffer to allow the application to install after a notification has timed out or closed. (Note: There are newer features in ConfigMgr to default this to a higher value that Patch My PC will investigate)Updates Max: 5 minutesThird-party updates in ConfigMgr can have a few default values for Maximum Runtime depending on your version of ConfigMgr. We default to assuming the maximum runtime of third-party updates will be 15 minutes. Because of this, we have the maximum set to 5 minutes, allowing 10 minutes for the update to run before it would exceed the update maximum run time. See the \u2018use maximum run time\u2019 info below for a workaround to this.ConfigMgr App Max: 705 minutesThis is the maximum configurable run time for a ConfigMgr application minus a 15-minute buffer.Intune (Applications and Updates) Max: 1425 minutesIntune has a non-configurable run time of 1440 minutes (1 day) for Win32 applications. The notification max is this 1440 minutes minus a 15-minute buffer. While the user notification is displayed, the update or application install is considered to be running.The run time here would contribute to the max run time of your applications and updates, and consume time during a maintenance window, for example. Platform Specific Maximums: Max runtimes account for a 15-minute buffer to allow the application to install after a notification has timed out or closed. (Note: There are newer features in ConfigMgr to default this to a higher value that Patch My PC will investigate)Updates Max: 5 minutesThird-party updates in ConfigMgr can have a few default values for Maximum Runtime depending on your version of ConfigMgr. We default to assuming the maximum runtime of third-party updates will be 15 minutes. Because of this, we have the maximum set to 5 minutes, allowing 10 minutes for the update to run before it would exceed the update maximum run time. See the \u2018use maximum run time\u2019 info below for a workaround to this.ConfigMgr App Max: 705 minutesThis is the maximum configurable run time for a ConfigMgr application minus a 15-minute buffer.Intune (Applications and Updates) Max: 1425 minutesIntune has a non-configurable run time of 1440 minutes (1 day) for Win32 applications. The notification max is this 1440 minutes minus a 15-minute buffer. Updates Max: 5 minutesThird-party updates in ConfigMgr can have a few default values for Maximum Runtime depending on your version of ConfigMgr. We default to assuming the maximum runtime of third-party updates will be 15 minutes. Because of this, we have the maximum set to 5 minutes, allowing 10 minutes for the update to run before it would exceed the update maximum run time. See the \u2018use maximum run time\u2019 info below for a workaround to this. Third-party updates in ConfigMgr can have a few default values for Maximum Runtime depending on your version of ConfigMgr. We default to assuming the maximum runtime of third-party updates will be 15 minutes. Because of this, we have the maximum set to 5 minutes, allowing 10 minutes for the update to run before it would exceed the update maximum run time. See the \u2018use maximum run time\u2019 info below for a workaround to this. ConfigMgr App Max: 705 minutesThis is the maximum configurable run time for a ConfigMgr application minus a 15-minute buffer. This is the maximum configurable run time for a ConfigMgr application minus a 15-minute buffer. Intune (Applications and Updates) Max: 1425 minutesIntune has a non-configurable run time of 1440 minutes (1 day) for Win32 applications. The notification max is this 1440 minutes minus a 15-minute buffer. Intune has a non-configurable run time of 1440 minutes (1 day) for Win32 applications. The notification max is this 1440 minutes minus a 15-minute buffer. Option to use \u2018maximum run time\u2019 from the respective update or app.ConfigMgr Update Max: Will use configured update \u2018max run time\u2019 as configured in ConfigMgr for the update.Note: Update max run time must be edited before the update is deployed for a client to recognize the change.If either the maximum run time in ConfigMgr, or the Notify Timeout Configuration, is under 15 minutes, the timeout notification will default to 5 minutes. This is because a 15-minute buffer is applied. For example, a 60-minute max run time will have a 45-minute UI timeout.ConfigMgr App Max: Will use the configured deployment time \u2018max run time.\u2019Intune App/Update Max: Will use the maximum run time of an Intune Win32 app (60 minutes minus the 15-minute buffer). ConfigMgr Update Max: Will use configured update \u2018max run time\u2019 as configured in ConfigMgr for the update.Note: Update max run time must be edited before the update is deployed for a client to recognize the change.If either the maximum run time in ConfigMgr, or the Notify Timeout Configuration, is under 15 minutes, the timeout notification will default to 5 minutes. This is because a 15-minute buffer is applied. For example, a 60-minute max run time will have a 45-minute UI timeout. Note: Update max run time must be edited before the update is deployed for a client to recognize the change. If either the maximum run time in ConfigMgr, or the Notify Timeout Configuration, is under 15 minutes, the timeout notification will default to 5 minutes. This is because a 15-minute buffer is applied. For example, a 60-minute max run time will have a 45-minute UI timeout. ConfigMgr App Max: Will use the configured deployment time \u2018max run time.\u2019 Intune App/Update Max: Will use the maximum run time of an Intune Win32 app (60 minutes minus the 15-minute buffer). Once the timeout is reached, the options defined in the \u2018Defer Policy\u2019 section described below will either increment or start the day deferral count, depending on your settings. Notification behavior if the application is running and focus assist is enabledThis option will configure whether the notification should appear whenfocus assistis enabled on the machine and whether it should impact deferral counts.Discard the notificationAlways show the notificationShow the notification if the deferral policy is reached This option will configure whether the notification should appear whenfocus assistis enabled on the machine and whether it should impact deferral counts.Discard the notificationAlways show the notificationShow the notification if the deferral policy is reached Discard the notification Always show the notification Show the notification if the deferral policy is reached Allow the user to defer the installationNote that when a user selects to defer, the application will \u2018fail\u2019 to install.This option will control whether the user can defer the installation to a later time. The following options are available when this setting is enabled:Indefinitely: The user can defer the update indefinitely.Keep in mind this may result in updates never being installed.Up to 5 Times: The user can defer up to the specified number of times.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 100.First notification displayed + 5 days:The user can delay the software installation up to the specified number of days after the first notification was displayed, or the first notification would have been displayed based on focus assist settings described above.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 15. Note that when a user selects to defer, the application will \u2018fail\u2019 to install. This option will control whether the user can defer the installation to a later time. The following options are available when this setting is enabled:Indefinitely: The user can defer the update indefinitely.Keep in mind this may result in updates never being installed.Up to 5 Times: The user can defer up to the specified number of times.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 100.First notification displayed + 5 days:The user can delay the software installation up to the specified number of days after the first notification was displayed, or the first notification would have been displayed based on focus assist settings described above.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 15. Indefinitely: The user can defer the update indefinitely.Keep in mind this may result in updates never being installed. Keep in mind this may result in updates never being installed. Up to 5 Times: The user can defer up to the specified number of times.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 100. The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications. This has a minimum value of 1 and a maximum value of 100. First notification displayed + 5 days:The user can delay the software installation up to the specified number of days after the first notification was displayed, or the first notification would have been displayed based on focus assist settings described above.The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications.This has a minimum value of 1 and a maximum value of 15. The installation will try again during the next application or update evaluation cycle, which will depend on the platform that is being used, ConfigMgr Software Updates, ConfigMgr Apps, or Intune Win32 applications. This has a minimum value of 1 and a maximum value of 15. If the timeout expired and no action is taken\u2026There are two options for when the user does not provide any response to a conflicting process notification within the timeout period. The below event will happen if the notification is left to expire without any user interaction.Defer the installation on behalf of the user (Default):The notification will timeout and be closed and count towards deferral, whether that is a count-based deferral or a time-based deferral.Note:With this option enabled, thesoftware will force close when the deferral count is met, such as having the count set to 5, and the user missing 5 notifications. The application would close and update after the 5 notification timeout.Close the application and perform the update:The notification will timeout, the application will be force-closed, and the update for the application will begin to install.Note: With this option enabled, thesoftware will force closeif someone is not present to dismiss the notification, such as being at the lock screen or otherwise not present. There are two options for when the user does not provide any response to a conflicting process notification within the timeout period. The below event will happen if the notification is left to expire without any user interaction.Defer the installation on behalf of the user (Default):The notification will timeout and be closed and count towards deferral, whether that is a count-based deferral or a time-based deferral.Note:With this option enabled, thesoftware will force close when the deferral count is met, such as having the count set to 5, and the user missing 5 notifications. The application would close and update after the 5 notification timeout.Close the application and perform the update:The notification will timeout, the application will be force-closed, and the update for the application will begin to install.Note: With this option enabled, thesoftware will force closeif someone is not present to dismiss the notification, such as being at the lock screen or otherwise not present. Defer the installation on behalf of the user (Default):The notification will timeout and be closed and count towards deferral, whether that is a count-based deferral or a time-based deferral.Note:With this option enabled, thesoftware will force close when the deferral count is met, such as having the count set to 5, and the user missing 5 notifications. The application would close and update after the 5 notification timeout. The notification will timeout and be closed and count towards deferral, whether that is a count-based deferral or a time-based deferral. Note:With this option enabled, thesoftware will force close when the deferral count is met, such as having the count set to 5, and the user missing 5 notifications. The application would close and update after the 5 notification timeout. Close the application and perform the update:The notification will timeout, the application will be force-closed, and the update for the application will begin to install.Note: With this option enabled, thesoftware will force closeif someone is not present to dismiss the notification, such as being at the lock screen or otherwise not present. The notification will timeout, the application will be force-closed, and the update for the application will begin to install. Note: With this option enabled, thesoftware will force closeif someone is not present to dismiss the notification, such as being at the lock screen or otherwise not present. Proceed with the installation even if the application is still running after the countdown (Auto close application):This option will show a countdown matching your selected timeout setting and force close the application if the user does not choose to close and update before the timer is completed. This option will show a countdown matching your selected timeout setting and force close the application if the user does not choose to close and update before the timer is completed. Prevent the end-user from opening an application while the application is updatingIf the installation is running and a user attempts to start a known conflicting process, they will receive a message box letting them know the application\u2019s startup is blocked.This option can only be set at the product level. If an installer launches a conflicting process during installation, it can cause failures.Refer to the \u2018Update in progress\u2026\u2018 section for more detailed information. If the installation is running and a user attempts to start a known conflicting process, they will receive a message box letting them know the application\u2019s startup is blocked. This option can only be set at the product level. If an installer launches a conflicting process during installation, it can cause failures. Refer to the \u2018Update in progress\u2026\u2018 section for more detailed information. Note:If an update is snoozed, or if the notification times out the software will return a 1602 exit code. Manage Process List TheMange process listoption allows you to add and remove apps that need to close in order for the update to process (This applies only if you have Auto-close or Notify option enabled). The UI notification for Conflicting Processes now lists all processes which are conflicting in a dropdown. This is to make it more clear what software will be closed. Add Custom Branding for Notifications In theManage default settingsoptions, you can configure a customer banner image and company name. You can also preview how it will appear for an end-user by clickingPreview how it willappear. Custom Banner Images for Custom Usage We have various banner images available below. You can use these images to customize the experience of the popup or use your company banner. Download ourdefault JPG banner imagebelow. Download thelight-theme GIF imagebelow to show an application close and update completed. Download thedark-theme GIF imagebelow to show an application close and update completed. Customize Notification In theMange default settingsoption, you can customize the notification and add multiple languages under theLocalizationsection. You can add languages by selectingAdd/RemoveunderLocalizationand then fill in the fields for those unique languages and their requirements. The language that is then chosen is based on the language of the machine in question at the time of the UI prompt opening. Note:Keep in mind that youMUSTprovide content for each selected language in each possible intended state. This means cycling through the drop downs underSelected LanguageandIntent. Otherwise you won\u2019t be able to select theOKbutton. Note:You can add additional blank lines when modifying text in these boxes using When to enable: Notify the user to close the application This option can help third-party products whoseinstallers will fail if the application is currently runningin the background by an end-user. The option tonotify the user to close the applicationcan be less impactful than the option toauto close application process before installation. This option is only needed for products that have issues updating while in use. The majority of products can update while in use, but may just require a reboot to fully apply. Below is a list of products we are aware of that will generally fail to update while in use. Update in progress\u2026 When the option is set to \u2018Prevent the end-user from opening an application while the application is updating\u2018 we use theImage File Execution Optionsfeature to stop the application from opening. Example usage of this can be seen below. The user would expect to see a message box that says \u2018An update is currently being installed on your computer. Please, do not try to start\u2018 or in some cases\u2018The requested operation requires elevation\u2019depending on the version of PatchMyPC-Scriptrunner.exe. This message box would appear if the user attempts tolaunch the software while it is being updated. In some cases,these registry entries may be left behindif the Scriptrunner process is forcefully closed or otherwise closes unexpectedly. If this happens you may see the above messages even though no application installation or update is occurring. If this happens you candelete the registry key named after the process, such as the highlighted notepad++.exe registry key in the above image. Note:You will want to check both registry hives below depending on the architecture of the Operating System and the process which started ScriptRunner. HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution OptionsHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options The following PowerShell code can be used to find and delete all Patch My PC created process blocking registry entries: Get-Childitem \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\" -ea SilentlyContinue | Where {if($_.Property -contains \"Debugger\"){($_|Get-ItemProperty).Debugger -like \"*PreventStart*\"}} | Remove-Item -Force -Recurse;Get-ChildItem \"HKLM:\\SOFTWARE\\Microsoft\\WOW6432Node\\Windows NT\\CurrentVersion\\Image File Execution Options\" -ea SilentlyContinue | Where {if ($_.Property -contains \"Debugger\"){($_|Get-ItemProperty).Debugger -like \"*PreventStart*\"}} | Remove-Item -Force -Recurse; Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/request-was-aborted-could-not/", "title": "SSL/TLS error, Firewall blocking, Proxy issues, Network connectivity", "raw_text": "The request was aborted: Could not create SSL/TLS secure channel. The error \u201cThe request was aborted: Could not create SSL/TLS secure channel.\u201d can happen during any download HTTP request. This error generally will correspond tofirewalls, proxiesorDNS filteringblocking the connection or anSSL/TLS ciphermisconfiguration. Determine if You are Affected If affected, you will see an error similar to below in one of the following log filesPatchMyPC.logorSMS_ISVUPDATES_SYNCAGENT.log,dependent on the publishing method you are using. The request was aborted: Could not create SSL/TLS secure channel. Note: We are generally pretty limited in the amount of support we can provide for issues related toweb filters,firewalls,proxies,certificate trust, or othernetwork-related errors. However, our resolutions below will generally helpdiagnose and resolvethis specific error. Possible Cause 1: Firewall, DNS, or Proxy Blocking Network Connections The most common cause for this errors us network firewalls or security appliances blocking network connections. If using ourPublisher, thePatchMyPC.logwill show the specific download URL returning the SSL/TLS error. On the machine running with the error, copy the download URL from the log: On the same machine where the Publisher is installed returning the error, browse to the URL inInternet Explorer running as NT AUTHORITY\\SYSTEM. Check if Internet Explorer returns any errors or warnings from a firewall or security appliance. Important: The Patch My PC Publisher uses the same .NET Framework classes as Internet Explorer to download content from the Internet. The default identity of the service is also NT AUTHORITY\\SYSTEM. It may be possible you have different Internet access control policies applied between users and computers in your environment. Performing this test in a different browser or as another identity may produce different results. If blocked, you will need to work with your networking team to remove any restrictions. You can find the full list of domains, ports, and protocols used for Patch My PC Publisher and catalogue atList of Domains for Firewall Allowlist when Using Patch My PC. Possible Cause 2: Are You Using A Proxy and is It Configured Correctly? If a proxy is required for internet access within your environment, you will need to configure it in theAdvancedtab: After configuring the proxy, restart the servicePatchMyPCService(can also be done in theAbouttab), and close and re-open the Publisher UI. If proxy authnetication is required, enable theUse Authenticationcheckbox and enter credentials. Possible Cause 3: Is SSL Being Limited to Specific Cryptography Protocols and Cipher Suites? We have also seen issues related to customers that are onlyallowing specific SSL protocols and ciphers. Some customers configure this to apply security harden policies to the Operating System. In this scenario, we have observed the following errors when browsing out to the file download URL in internet explorer. OnServer 2019ornewer: OnServer 2016orolder: Important: The Patch My PC Publisher uses the same .NET Framework classes as Internet Explorer to download content from the Internet. The default identity of the service is also NT AUTHORITY\\SYSTEM. It may be possible you have different Internet access control policies applied between users and computers in your environment. Performing this test in a different browser or as another identity may produce different results. If you receive one of theerrors belowin thePatchMyPC.logand your error is similar to the Internet Explorer images above it may be related to onlyallowing specific SSL ciphers * WebClient report an error during download: The request was aborted: Could not create SSL/TLS secure channel. OR An error occurred WebClient reported an error during download. The handshake failed due to an unexpected packet format. On the server, check if the following registry value exists:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Cryptography\\Configuration\\SSL0010002:FunctionsorHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\0010002 If this value exists,only the SSL/TLS ciphersin theFunctions REG_MULTI_SZ valuewill work. If a domain is using a cipher other than ones listed, you will receive the errorThe request was aborted: Could not create SSL/TLS secure channel. Limiting theSSL/TLS ciphersis sometimes enabled as a hardening method for security. Limiting the ciphers is not enabled by default. To fix the download in the scenario, you need to eitheradd ciphersused for all downloads having issues in theFunctions REG_MULTI_SZ listorremove the Functions valueto set the SSL/TLS ciphers to not be limited. There is a third-party tool available fromQualys SSL Labswhere you can paste the download URLs having the issue and the tool will show you theSSL/TLS ciphersbeing used on the domain. For example, when we used the URL https://1.na.dl.wireshark.org/win32/Wireshark-win32-3.2.2.exe, we are able to see the specific SSL/TLS ciphers being used for that domain. These ciphers would need to be added to theFunctionsregistry value to resolve the issue if applicable. *A similar error,\u201cAn error occurred WebClient reported an error during download\u201d, can be observed in thePatchMyPC.logif the HTTP download timed out. It might also be prudent to increase the HTTP timeout value in the registry if the other workarounds in this KB are not effective. Click the following link for more detailshttps://patchmypc.com/advanced-configurations-available-using-the-registry-for-patch-my-pcs-publishing-service#topic5 Important: For any new ciphers to take effect after being added, the server will need to be restarted. Possible Cause 4: Windows Server 2012 Doesn\u2019t Support New TLS Cipher Suites Third-party software vendors restrict the SSL/TLS ciphers allowed to connect to their web servers to use more modern algorithms. As a result of this, older ciphers are being phased out. Older Windows Server Operating Systems may experience issues connecting to these web servers as they are limited to specific ciphers. More recently, we have seen the SSL/TLS ciphers available in Windows Server 2012 / 2012 R2 and Windows 8 / 8.1 are being rejected by vendors\u2019 webservers. See below links to Microsoft documentation listing SSL/TLS ciphers for each OS: TLS Cipher Suites in Windows Server 2012 R2 / Windows 8.1 TLS Cipher Suites in Windows Server 2012 / Windows 8 All Windows TLS cipher suites You can view a web server\u2019s current list of accepting TLS/SSL ciphers by using theQualys SSL Labs websitementioned at the end of the last section. To resolve this problem, consider the two options: Plan to upgrade the Operating System of where the Patch My PC Publisher is installed to a newer versions with the newer SSL/TLS ciphers Manually download the installer from a different browser or newer Operating System and save it into yourlocal content repository. Also enable the below highlighted option: We also have this documented on ourList of Known Issues and Considerationsarticle for products we aretracking with these download issues. At this time, we are aware of the following products that may fail to download on older server operating systems: Snagit and Camtasia Tableau Products Cisco Webex Docker Desktop Slack Known Issues For products that are currently known to fail to download, refer to ourKnown Issues and Considerations when Using Patch My PC. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/script-runner-exit-codes/", "title": "Customization, Installation, Exit Codes, ScriptRunner", "raw_text": "PatchMyPC-ScriptRunner \u2013 Known Exit Codes A short summary of the issue including keywords. Brief introduction This article will explain the exit codes managed by Patch My PC, using its custom installation wrapper called \u201cPatchMyPC-ScriptRunner.exe.\u201d \u201cPatchMyPC-ScriptRunner.exe\u201d is a tool used to install software selected through the PatchMyPC Publisher on client devices, typically managed by ConfigMgr/Intune agents. Besides installing software, it can also carry out various customizations based on your preferences. These customizations may include tasks like removing desktop shortcuts, disabling self-updaters, executing custom scripts, and more. The behavior of ScriptRunner can vary, particularly in cases of installation failure. In such instances, the failure exit code from the software installer will also be returned by ScriptRunner. However, there are predefined exit codes within ScriptRunner that may appear in specific scenarios. These are detailed below. PatchMyPC-ScriptRunner Exit Codes Exit code 0\u2013 means that the execution of your script / the installation of the software completed successfully. Exit code 3010\u2013 the software installed successfully, but asoft rebootis required to complete the installation Exit code 1602\u2013 this exit code is returned when the user is presented with the \u201cconflicting processes\u201d notification from theManage conflicting processesfeature and pressesSnooze installation.By default, this exit code is considered an \u201cinstallation failure\u201d by both Intune and ConfigMgr agents. Intune will retry the installation 24+ hours later. More information about this can be foundhere. ConfigMgr will retry the installation based onyourSoftware Updates Deployment Evaluation Cycleclient settings \u2013 for updatesyourApplication Deployment Evaluation Cycleclient settings \u2013 for applications. yourSoftware Updates Deployment Evaluation Cycleclient settings \u2013 for updates yourApplication Deployment Evaluation Cycleclient settings \u2013 for applications. Exit code 1618\u2013 this exit code is returned when theManage Conflicting Processesoption is set to \u201cSkip the installation\u201d or when the installation is skipped because focus assist is enabled. This exit code is marked in the return codes section for both Win32 apps in Intune and in the application deployment type for ConfigMgr.This means that: Intune will retry the installation 3 times every 5 minutes. If those attempts are deferred by the user too, it will retry 24+ hours later. For ConfigMgr, the installation will be retried 2 hours, for a total of 10 times. Note:This exit code will also be returned if the installation of a different software is already in progress. Exit code 32768\u2013 This exit code is returned when the recommended prescript fails. Some installers, such as the Oracle Java one, will not uninstall previous versions.To fix this, Patch My PC specified arecommended Pre-Install scriptthat will remove older versions before the latest one you deploy is installed. This script can be found in theright-click optionsof that particular software. By default, if this script fails to run successfully for any reason, the PatchMyPC-ScriptRunner will no longer proceed with the installation of the latest update and exit with code 32768. Exit code 32767\u2013 This exit code is returned if thecustom pre-script specified by the customerdoes not run successfullyandif the option \u201cDon\u2019t attempt software update if the pre script returns an exit code other than 0 or 3010.\u201d Honorable Mentions The exit codes documented above are specific to Patch My PC\u2019s \u201cPatchMyPC-ScriptRunner\u201d executable. If an MSI installation fails for reasons other than those listed, the ScriptRunner will pass the exit code from the MSI installer through. In such cases, you can refer to Microsoft\u2019sdocumentationfor msiexec.exe error messages. For failed EXE installations, you should consult the vendor\u2019s installer documentation page for information on the error code. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/what-wsus-signing-certificate-how/", "title": "code-signing certificate, WSUS Certificate, Third-party updates, Software signing", "raw_text": "What is the WSUS Signing Certificate and How to Create It In this article, we\u2019re going to break down what theWSUS Signing Certificateis with regard to third-party software updates, why you need one, and what you need to know when deciding what type ofcode-signing certificateis best for your organization. Why Do I Need a Code-Signing Certificate? In order to create third-party software updates in WSUS or ConfigMgr, they must be signed using acode-signing certificate. Furthermore, your devices must trust the same certificate used to sign updates for the Windows Update service to install them. Without a code-signing certificate, you cannot publish third-party software updates into WSUS or ConfigMgr. By default, updates in WSUS are from Microsoft and client Windows devices inherently trust updates published by Microsoft. By using your own code-signing certificate, you enable your devices to successfully install third-party updates by trusting them. If your devices do not trust the code-signing certificate used to sign the updates in WSUS, they will not successfully install. The Basics of the WSUS Signing Certificate At the most basic level, theWSUS Signing Certificateis simply acode-signing certificate. The purpose of the certificate is to code-sign any content files for third-party updates during the publishing operation from the WSUS API. Before any third-party software update is installed on a device, it will check to ensure the third-party update content wassigned using a certificate the device trusts. If you click the properties of aCAB filefor a published update in theWSUSContentfolder, you will be able to see the WSUS code-signing certificate that was used. If you open the CAB file, you will be able to see thebinaries from the original updatefrom the vendor. For example, we can see theGoogleChromeStandaloneEnterprise64.msiwithin the CAB file in the image below. In the event theCAB file was modified, it would no longer be trusted on a device that attempts to install the third-party update. The WSUS Signing Certificate can be viewed in the WSUS certificate store on the local machine usingcertlm.msc. Should You Choose a Self-Signed or PKI Based WSUS Certificate? We get this question a lot from our customers. Unfortunately, there is no one-size-fits-all answer to this because it depends. Each option has its pros and cons. We have discovered the most common option used by ourcustomersis self-signed. Here\u2019s a list of someProsandConsfor each option: Self-Signed WSUS Signing Certificate: ProsIt\u2019s freeto generate a self-signed code-signing certificateIt\u2019s simpleand doesn\u2019t require aPKIIt can becreated immediatelyConfiguration Manager canautomatically deploy the certificate to clients It\u2019s freeto generate a self-signed code-signing certificate It\u2019s simpleand doesn\u2019t require aPKI It can becreated immediately Configuration Manager canautomatically deploy the certificate to clients ConsSelf-signed certificatescan\u2019t be revokedusing a certificate revocation list if the private key is compromised. You would need to use a script via Configuration Manager or another method to remove the certificate from the Trusted Root certificate store if it was compromised. Self-signed certificatescan\u2019t be revokedusing a certificate revocation list if the private key is compromised. You would need to use a script via Configuration Manager or another method to remove the certificate from the Trusted Root certificate store if it was compromised. PKI Based WSUS Signing Certificate: ProsThe certificate can berevokedif compromisedYou can issue acode-signing certificate for WSUSfrom an internal PKI such asActive Directory Certificate Servicesfor freeConfiguration Manager canautomatically deploy the certificate to clients The certificate can berevokedif compromised You can issue acode-signing certificate for WSUSfrom an internal PKI such asActive Directory Certificate Servicesfor free Configuration Manager canautomatically deploy the certificate to clients ConsA code-signing certificate needs to be issued from aPKIThere will be a cost if you use apublic certificate authorityto issue the code-signing certificate A code-signing certificate needs to be issued from aPKI There will be a cost if you use apublic certificate authorityto issue the code-signing certificate Options for Creating a Self-Signed WSUS Signing Certificate If you decide to use a self-signed certificate, you havethree common waystogenerate the self-signed certificate. Patch My PC\u2019sPublisherAn easy option if you are using the Patch My PC PublisherThis option allows you to customize the expiration date, subject name, key length, and export the private keyYou can create a self-signed certificate or import a PKI based certificate An easy option if you are using the Patch My PC Publisher This option allows you to customize the expiration date, subject name, key length, and export the private key You can create a self-signed certificate or import a PKI based certificate Configuration Manager Console (Automatically manage the WSUS Signing Certificate)A good option if you are using the ConfigMgr third-party software update catalog feature directly in the ConfigMgr consoleIt only supports creating a self-signed certificate A good option if you are using the ConfigMgr third-party software update catalog feature directly in the ConfigMgr console It only supports creating a self-signed certificate System Center Updates Publisher (SCUP)If you are using legacy SCUP on our Basic subscription, this will be a good option.You can create a self-signed certificate or import a PKI based certificate If you are using legacy SCUP on our Basic subscription, this will be a good option. You can create a self-signed certificate or import a PKI based certificate Each tool uses the same WSUS API when generating the self-signed WSUS signing certificate. Creating the WSUS Signing Certificate Using Patch My PC\u2019s Publisher Afterinstalling our publisher, if there is no certificate detected, you can clickGenerate a Self-Signed Certificate. In theCertificate Optionsdialog, you have the ability to adjust thesubject name,validity, andkey length. Once the certificate is generated, you can click theShow Certificatebutton in our Publisher to view more details. You can also view the certificate in the WSUS store usingcertlm.msc. Import a PKI Based Certificate Using Patch My PC\u2019s Publisher If you decide to use aPKIbased code-signing certificate, you have the ability toimportthe exported code-signing certificate (PFX File). We will not cover the process ofobtaining a PKI based code-signing certificate in this guide,as that process can vary depending on the certificate authority you use. We do have a separate article that will covercreating a certificate template and requesting the certificate using Active Directory Certificate Services. Once you have the PFX file for the PKI based code-signing certificate, you can click the button toImport PFX Certificate. Please be aware that if you use a PKI based code-signing certificate, the PFX file can only be imported usingPatch My PC\u2019s PublisherorSystem Center Updates Publisher. You can\u2019t import a PFX certificate directly in the Configuration Manager console, although there is aUserVoice for this feature. Once the PKI certificate is imported, the option for configuration manager toAutomatically manage the WSUS Signing certificatewill still work and can be used to distribute that PKI based certificate to clients\u2019Trusted RootandTrusted Publisherscertificate stores automatically. Set Configuration Manager to Automatically Manage the WSUS Signing Certificate If you enabled the option toAutomatically manage the WSUS Signing Certificate in the Configuration Manager console, it will automatically generate a self-signed certificate in the eventone doesn\u2019t already exist. To enable this option, navigate toAdministration>Site Configuration>Sites>Right-click the site>Configure Site Components>Software Update Point Note that there are two options here. The difference is explained below. Configuration Manager manages the certificateIf the SUP is remote from the Site Server, please review theadditional requirements when the SUP is remote.If the WSUS code-signing certificate is not found or has expired, then Configuration Managerwill generate a new certificateand store it in the database.If there is an existing WSUS code-signing certificate associated with WSUS, then it will be grabbed and stored in the database.Configuration Manager will automatically distribute this certificate to clients that have the client settings for \u2018Enable third party software updates\u2019 set to \u2018Yes\u2019. If the SUP is remote from the Site Server, please review theadditional requirements when the SUP is remote. If the WSUS code-signing certificate is not found or has expired, then Configuration Managerwill generate a new certificateand store it in the database. If there is an existing WSUS code-signing certificate associated with WSUS, then it will be grabbed and stored in the database. Configuration Manager will automatically distribute this certificate to clients that have the client settings for \u2018Enable third party software updates\u2019 set to \u2018Yes\u2019. Manually manage the certificateIf the WSUS code-signing certificate is not found or has expired, then Configuration Managerwill take NO action. A certificate must already exist as you have set it to be manually managed.If there is an existing WSUS code-signing certificate associated with WSUS, then it will be grabbed and stored in the database.Configuration Manager will automatically distribute this certificate to clients that have the client settings for \u2018Enable third party software updates\u2019 set to \u2018Yes\u2019. If the WSUS code-signing certificate is not found or has expired, then Configuration Managerwill take NO action. A certificate must already exist as you have set it to be manually managed. If there is an existing WSUS code-signing certificate associated with WSUS, then it will be grabbed and stored in the database. Configuration Manager will automatically distribute this certificate to clients that have the client settings for \u2018Enable third party software updates\u2019 set to \u2018Yes\u2019. After enabling these options,trigger a software update point synchronizationfrom the Configuration Manager console. You can view thewsyncmgr.logon the site server. This log file will show the WSUS certificatebeing createdorimportedif one already existed. If the WSUS Signing Certificatealready existedbefore setting the \u2018Enable third-party software updates\u2019 option, it will automaticallyimport the existing certificate,and it will allow that certificate to be automatically deployed to client devices. This feature will be helpful if you want to use Patch My PC\u2019s Publisher to create the certificate and benefit from theadditional optionsorimport a PKI based certificate.Configuration Manager can still manage the certificate and automatically deploy it to devices rather than using a GPO. After the sync, the certificate details should appear in theSoftware Update Point Component Properties>Third Party Updatestab You will want to ensure the client settings toEnable third party software updatesis set toYes. This should be enabled on theDefault Client Settingsas well as anycustom client device settingstargeted to devices that will install third-party software updates. When this client setting is enabled, the device willautomaticallyinstall the WSUS Signing Certificate to theTrusted RootandTrusted Publishers.If thethird party updates tab is not configured on your Software Update Pointor theclient settings is set to No, you will need todeploy the WSUS Signing Certificate using group policy. If your software update point isremotefrom yourtop-level site serverand the software update point isnot configured for SSL, the option within Configuration Manager toAutomatically manage the WSUS Signing Certificatewill not work and you will receive an error in wsyncmgr.logRemote WSUS connection is not HTTPS. This prevents the software update point from getting the signing certificate for third-party updates. For more details about this scenario, please see the following Microsoft Doc:Additional requirements when the SUP is remote from the top-level site server. If your software update point is remote from your site server and the software update point is not in SSL, you canuse group policy to deploy the WSUS Signing Certificateinstead of the option in Configuration Manager toAutomatically manage the WSUS Signing Certificate. How to Deploy the WSUS Signing Certificate for Third-Party Software Updates Once you have theWSUS Signing Certificatecreated, it needs to be deployed to all your devices for the third-party software updates to be trusted. If you need more details on the options available for certificate deployment, please review this knowledge base articleHow to Deploy the WSUS Signing Certificate for Third-Party Software Updates Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/publish-error-too-many-locally-published-categories/", "title": "WSUS error Publishing Category Limit Locally Published", "raw_text": "Publishing operation failed, too many locally published categories. We periodically get reports about the errorPublishing operation failed, too many locally published categorieswhen publishing third-party updates. In this article, we will review the root cause and how to resolve the issue. This error generally happens for customers trying our service who were previously using another vendor. The error message for this scenario will look similar to the error below. An error occurred while publishing an update to WSUS: Publishing operation failed, too many locally published categories. A Little Background on this Error WSUS has a limitation on the number of unique third-party vendors/products that can be published. When troubleshooting with customers coming from another product, we have seen where some vendor catalogs cancause you to exceed the 100 category limit. Here\u2019s an example of all the custom third-party products that may be listed. Due to this100 category limitationand after talking to the Microsoft product group, this is why we decided to use asingle vendor and productin our catalog. Am I Affected? If you receive this error, it means you currently have100 or more categoriespublished to WSUS. The WSUS API checks the total number of categories before it allows an update to be published. Part of the check requires the API to call theGetLatestRevisionNumberForUpdatestored procedure in SQL. This stored procedure is looking in the tbRevision table to see if the category already exists. If it doesn\u2019t, it needs to calculate how many new categories the API call will make and if that total plus the existing category total is larger than 100, the API throws the error \u201cToo many locally published categories\u201d. Note that the stored procedure is checking thetbRevisiontable here. Check using SQL Server Management Studio You can run the following SQL query against SUSDB to understand the total number of categories in the same way the API performs the test. >> Download Category_Count.sql.txt << Note:Rename the extension from .txt to .sql to import the query in SQL Server Management Studio. Category_Count.sql As the API call is only limited by total number of categories, including revisions, for updates marked asisLocallyPublisher = 1, a simple workaround is to change this flag. Changing this flag for all updates in a category will mean the those third party updates will show in the WSUS console. Note:When updates are set to show in WSUS, and the isLocallyPublished flag changes to 0, the CategoryType also changes fromOthertoMicrosoftSource. Check Using PowerShell The following PowerShell snippet uses the built-in .NET Framework\u2019sSystem.Data.SqlClientnamespace to interact with SQL Server Script Example Resolution for Error: Too many locally published categories When you consider which approach you want to take below, Option 1, below, should be considered first, especially for customers who have used an Ivanti catalog in the past and are not comfortable removing updates/categories during a POC. You have 3 options: Option 1:Use the Modify Published Updates Wizard in the Publisher to show updates in the WSUS Console* Option 2:Use theModify Published Updates Wizard in the Publisherto delete updates in a category (Vendor / Product) Option 3:Using aPowershell Scriptto delete updates by Category * Recommended option for customers coming from Ivanti Option 1: Use the Modify Published Updates Wizard in the Publisher to show updates in the WSUS Console In Publisher, theModify Published Updates Wizardallows you to set third-party updates toShow in WSUS. Doing so will flip theisLocallyPublishedflag for an update. Flipping this flag for all updates in the same category will ensure the category, and the category revisions, do not count towards the limit of the API. It can be found under theUpdatestab >Options> selectRun WizardunderModify Published Updates. After running the SQL query shared above inResolution for Error: too many locally published categoriesyou should be able to understand which products to select to reduce the overal category count. In this example, we need to reduce theTotalCategoriescount down from 205 to under 100 In theModify Published Updates Wizard, filter by one of the vendors identified in your SQL query results, clickSelect Alland clickShow in WSUS. Re-run the SQL query again. Repeat this process until the query indicates you are below100categories. IMPORTANT:TheThird Party Category Countdisplayed in the bottom left of the window (shown above) does not account for revised categories or categories that have isLocallyPublished = 0 (This can happen if the third-party updates are set to be visible in the WSUS console). Always use the total category count from the SQL query to understand if you are under the 100 category limit imposed by the WSUS API. Option 2: Using Modify Published Updates Wizard to Remove Categories Our publishing serviceModify Published Updates Wizardallows you to delete published third-party updates. It can be found under theUpdatestab >Options> selectRun WizardunderModify Published Updates. In the example below, we selected two updates from the vendor7-Zipand chooseDelete. Note:To enable theDeletebutton, create a new DWORD registry value: Computer\\HKEY_LOCAL_MACHINE\\Software\\Patch My PC Publishing Service: EnableDeleteUpdates = 1 Once you have deleted the updates from WSUS, run theWSUS Cleanup Wizardfrom the Options node in WSUS. You should be able to leave the default checkboxes in theSelect items to Cleanwizard Once you complete the WSUS Server Cleanup Wizard,republish the updates. That\u2019s it!As long of you removed enough of the old vendors and products, you can publish new third-party updates to WSUS Option 3:Running aPowershellScript to Remove Categories Open an elevated PowerShell window. Copy and paste this PowerShell script from our GitHub repository You will want to navigate to our GitHub page and run this script:CustomerTroubleshooting/PowerShell/Remove-WSUSCategories.ps1 at Release \u00b7 PatchMyPCTeam/CustomerTroubleshooting \u00b7 GitHub This will open a UI showing all the categories you have published in WSUS. You can select multiple categories and delete. If you receive an error stating \u201cThe update content cannot be deleted as it is still referenced by other updates(s).\u201d Run the script again with-force. This will ensure it also removes revised categories, which is common with customers migrating from Ivanti. After running with -force, it should say \u201cThe update could not be found.\u201d This indicates we successfully removed the revised categories from WSUS, despite the update referenced under that category not being found.. As long of you removed enough of the old vendors and products, run another publisher sync and you should be able to successfully updates in WSUS. Note:Many customers encountering this error were usingIvanti, if this is your case, you may also be able to use their tool to delete all theirvendorandproductcategories if applicable usinghttps://help.ivanti.com/iv/help/en_US/PAT/24/Topics/Managing_Products.htm Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/troubleshooting-license-activation-issues/", "title": "Troubleshooting License Activation Issues, Proxy, Web Filters, Firewall", "raw_text": "Troubleshooting License Activation Issues (Invalid License ID.) This article details common reasons why thelicense validation may failwithin ourPublisher. If you\u2019re facing a license activation error similar to below, this will be the guide for you! Almost all license validationissues are related to proxy and web filters. Step 1: Validate You are Using the Correct License key The first step is to validate you are using thecorrect license key.When you receive yourfull-trialor customer license email, it will contain your 20 character license key. Here\u2019s an example of a license key email. Enter the license key you received in theLicense Informationsection of theGeneraltab and selectValidate. If the license validation is successful, it should look like the image below. Step 2: Are You Using A Proxy? If a proxy is required for internet access within your environment, you will need to configure it from theAdvanced tab\u2019sand apply the new settings. If a proxy is configured,restart the Publisherfor the changes to take effect. You will also need to confirm ifproxy authenticationis required. If so, theUse Authenticationmust be checked and a login configured. Step 3: Web Filters and Firewalls The most common issue with license activation is web filters such asfirewalls,DNS filtering, or othersecurity appliancesblocking the web request. For the license to be validated, please ensure the following traffic is allowed through any web filters, and review any blocked request to the domains listed below. Note:Dependingon firewall restrictions, you may need towhitelist other domainsfor third-party content downloads for vendors in our catalog. For a full list of domains, please seeList of Domains for Whitelisting when Using Patch My PC\u2019s Catalog You can download the Microsoft toolPortQryUIto perform a test to verify access to the domains listed above. Once downloaded, run portqueryui.exe. In the screenshot below we enteredpatchmypc.comfor the domain, and443for the port overTCP. The result should show listening if there are no firewalls blocking traffic. Step 4: Verify the patchmypc.com SSL Certificate is Trusted If trusted root certificate updates are disabled via windows update, the SSL certificate used for patchmypc.com may not be trusted. On the server running the publishing service, open up internet explorer and navigate tohttps://patchmypc.com/. In the address bar, check the certificate lock to see if it\u2019s trusted. Click thelock iconthen clickView certificate Click the Certificate Path and validate the certificate for patchmypc.com is trusted. If the certificate is not trusted,import the root certificates for DigiCertso the certificate is trusted. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/patch-my-pc-publisher-now/", "title": "Patch Management Event Log Windows", "raw_text": "Patch My PC Publisher Now Writes to the Windows Event Log We recently had a customer request our Publishing Service save certain events of publishing operations to the Windows event log. In the customer\u2019s scenario, they wanted to automate specific actions based on certain events. Using the Windows event log with specific event ID\u2019s would allow for an easier experience than parsing the PatchMyPC.log Below are the currentevent ID\u2019swe use for the actions listed below. List of Events Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-multitenancy-pmpc/", "title": "Multitenancy, Patching, Publisher, Intune", "raw_text": "Multitenancy for the Intune with the Patch My PC Publisher The Patch My PC Publisher has the ability tomanage third party patching for multiple Intune tenants. This is commonly referred to as \u2018multitenancy\u2018. This article will document all the features specific to a multi-tenant feature-enabled Patch My PC Publisher. By and large,the core functionality of the Publisher is the sameas detailed in all other documentation. However this article will document exceptions to that rule by highlighting areas that differ in the user interface, or functionality of the Publisher when it is enabled for multitenancy. Multi-tenant management features of the Publisher areavailable for Managed Services Providers using the MSP subscription. To find out more information about this subscription, please seeInformation for Managed Service Providers. Installation Mutli-tenant management features of the Publisher are available in the same installer of the Publisher for all customers. Therefore the installation instructions are the same as currently documented:Intune \u2013 Getting Started (patchmypc.com). A minor exception to the installation process is the Azure App registration. Instead of creating just on Azure App registration in one Azure Active Directory tenant, it is required to create an Azure App registration in each AAD tenant you intend to manage. In other words, if you want to manage 10 customers each with their own AAD tenant, in each tenant create an app registration and enter those in the Publisher as detailed below. Adding the First Tenant After installing the Patch My PC Publisher you can start adding more tenants in either of theIntune AppsorIntune Updatestabs. To configure the first tenant, either clickOptions\u2026or the+icon, and it will produce the typicalIntune Optionswindow. Enter your the tenant\u2019s Azure App registration details including a friendly name to identify the tenant, e.g. customer or tenant domain name. For more information on how to create the Azure App registrations, see our documentation:Azure App Registration \u2013 Getting Started (patchmypc.com). After entering the Azure App registration details for your first tenant, clickOK. This tenant will be currently in-focus for both theIntune AppsandIntune Updatestabs. Enable the checkbox forEnable creation of Win32 applications/updates in Microsoft Intunein both tabs. Products you select inIntune AppsorIntune Updateswill configured for this tenant. Click onOptions\u2026to change theIntune Optionsfor the currently selected tenant. Adding and Removing Additional Tenants To add an additional tenant, click on the+at the top right in either of theIntune AppsorIntune Updatestab. It will produce the typicalIntune Optionswindows where you can configure another tenant for publishing. To remove a tenant, change the currently selected tenant to the one you want to remove from the dropdown. Click on the red cross at the top right in either of theIntune AppsorIntune Updatestab. You will be prompted to confirm you want to delete the tenant. Importing Tenants If you currently manage multiple instances of the Patch My PC Publisher for Intune publishing and you wish to leverage the new multi-tenant functionality, you can import your settings from the other instances into your new multi-tenant installation of the Publisher! Gather the latest Settings.xml from the install directory for each install of the Publisher you support today, and copy them to the host running the multi-tenant featured-enabled Publisher. In either of theIntune AppsorIntune Updatestabs, click the import button and select each (or all) Settings.xml files you want to import. After selecting the Setting.xml file(s) and importing, you will receive a dialogue confirming the successful import. These are the supported configurations carried over when you import settings from another instance of the Publisher: Product selections and theirright click optionsin theIntune AppsandIntune Updatestabs Tenant information (friendly name, authority and AAD application ID) Intune Win32 Application Options As noted in the confirmation dialogue,some previously configured settings may need to be updated. For each tenant you will need to re-configure the following: AAD application secret (If configured) Ensure the code signing certificate is still available for the Intune OptionDigitally sign the detection method script and enforce signature checking on the application in Intune. (If configured) Restore content used forpre or post, installation or uninstallion scripts, and additional files or folders. If you import a tenant that uses these and the content is no longer available in the same path, this will be logged in PatchMyPC.log. It is recommended you either restore the content using the same same path, or restore the content and update the right click option to use a new path. After importing other tenant settings from Settings.xml file(s), all the Publisher settings (inc all tenants) are stored in the single Settings.xml in the install directory of the Publisher. Backup and Restore Publisher Settings The process of backing up the Publisher, and restoring it, is still the same process for multi-tenant feature-enabled Publishers. You can more about that process here:Backup and Restore Publisher Settings \u2013 Patch My PC Manage Conflicting Processes The feature forManage conflicting processesis still availalbe for multi-tenant feature-enabled Publishers, however its UI and configuration options change. This is to allow you set tenant specific settings, such as: Set a unique company logo per tenant Configure the \u2018Organization Name\u2019 per tenant Configure different localization text per tenant You can still configure global settings via theManage default settings, however this enables you to configure the above settings differently per tenant. Alerts At this time, webhook or mail notification settings configured in the Alerts tab is \u2018system-wide\u2019. In other words, the Alerts notifications are used for all tenants. The email notfication will provide a breakdown of publishing results on a per-tenant basis with a unique table for each tenant configured in the Patch My PC Publisher. Notes Intune Application Manager Utilityconnects to the currently selected tenant. Scan Intune for Supported Productstool connects to the currently selected tenant. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/java-new-categorization/", "title": "Patch My PC Java Releases Categorization Methodology Update", "raw_text": "New Categorization Methodology for Patch My PC Java Releases In July 2021, Patch My PC added a new flavor of OpenJDK \u2013 Zulu JDK. With this new addition we are trying a new methodology for the JRE/JDK releases. If this new methodology proves to be successful, Patch My PC plans to utilize the same methodology for all other available versions of Java in the catalog. This post will explain the changes we plan to make to the Java installers and why. Currently (for Oracle Java), we create a new product in the catalog for every major Java release (11, 14, 15, etc.), andonlyallow our updates to update existing versions of java that are of the same major release. We believe this is counter to the intentions of these latest releases of Java and are proposing the following (using Zulu OpenJDK as our testbed). In the catalog, we now have the following Products: Zulu JDK LatestIf this product is selected and deployed, the latest Zulu JDK version available will be deployed, this product will upgradeallversions of Zulu OpenJDK on applicable devices to the latest available. If this product is selected and deployed, the latest Zulu JDK version available will be deployed, this product will upgradeallversions of Zulu OpenJDK on applicable devices to the latest available. Zulu JDK 8This product if selected and deployed will only upgrade existing Zulu JDK 8 installations to the latest version of Zulu JDK 8 This product if selected and deployed will only upgrade existing Zulu JDK 8 installations to the latest version of Zulu JDK 8 Zulu JDK 11This product if selected and deployed will only upgrade existing Zulu JDK 11 installations to the latest version of Zulu JDK 11 This product if selected and deployed will only upgrade existing Zulu JDK 11 installations to the latest version of Zulu JDK 11 Switching to this method will allow our customers to choose if they want to patch OpenJDK to the latest available or stay on a supported LTS release. As new LTS releases come out, Patch My PC will add them as new products and provide update definitions until that LTS release hits end-of-life. One major drawback to this new method is that deployments for this new methodology is that if both \u201cZulu JDK Latest\u201dandany of the Zulu JDK LTS releases are selected as a product in Patch My PC, there is the chance of 2 updates being applicable on a single device (say if Zulu JDK Latest and Zulu JDK 8 are both selected and deployed to a device with an old version of Zulu JDK 8, that device will get both updates as applicable and the version that the device will end up with is Zulu JDK Latest). The benefits of this new method are: Customers will not need to update their product selections as often Customers will be able to update to the latest version of Java without an application deployment (Zulu JDK Latest will update any version to the latest, so app deployments to update between major versions are unnecessary) Patch My PC will not need to create a new product for every new release of Java every 6 months (Adding a new product node to the catalog is more time consuming than adding a new update for the same product) Customers will have a clear choice between staying on LTS versions or following the latest Java release. Following a successful test period of Zulu JDK using this methodology, Patch My PC plans to use this same methodology on the next major Java update (planned for September 2021), for all supported Java products in our catalog. If you have any comments on this change, please leave a comment on this idea on the Patch My PC ideas portal:https://ideas.patchmypc.com/ideas/PATCHMYPC-I-1497 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/smsprovider-connection-source-folder-options/", "title": "SMS Provider, Configuration Manager, Permissions", "raw_text": "SMSProvider Connection and Source Folder Options In this article, we are going to review the options related to theSMSProviderand theapplication source folder. It\u2019s important to ensure these settings are configured and have theproper permissionsfor our service to work correctly. Configure the SMS Provider Connection TheSMSProvideris how all actions take place within the Configuration Manager Console or anyAPI\u2019savailable for Configuration Manager. First, you will need to define the SMSProvider server name in ourSMS Provider Connection Optionsdialog. Within your Configuration Manager console, navigate toMonitoring>System Status>Component Status> Search forSMS_PROVIDERS This search should return the SMSProver server(s) within your configuration manager environment. Important:We recommend that you review our articlePermissions Required in SCCM for Base Installationsto ensure you have the proper permissions configured to allow the service to create applications. By default, the connection to the SMSProvider it performed usingSYSTEM-contextof the server running the publisher.Optionally, you can switch connection to the SMSProvider to use a domain service account: Application Source Folder The Source Folder (UNC) is theroot folderwhere you want all application content to be stored for applications created by the publisher. The folder structure is \\\\%Folder%\\Applications\\%Vendor%\\%Product%\\%UniqueID% Important:All connections to the network share areperformed using the computer accountof the server. Thecomputer accountwill need at a minimum modify permissions at both theshareandNTFS-level. For more information on permissions required, please see our KB articleAccess to the Path Is Denied \u2013 Configuring Content Source Permissions Source Folder Validation Alerts If there is an issue while performing validation an alert will be sent via Teams or SMTP email if they are set up. Below is a sample of each alert. Teams Alert Email Alert Once you go into the ConfigMgr app options in the Publisher you can check which issue below applies and work to resolve the conflict. When configuring the ConfigMgr source you may receive a warning message regarding a misconfigured source such as the below. In this case, the folder \u2018\\\\demo1\\Sources\\Software Updates\\Patch My PC Updates\u2019 was selected as the source folder. This selection conflicts with an existing Deployment Package as shown below which contains our software update source files. Note:This warning is in place to prevent the use of a Deployment Package source as an application source. This is becauseConfigMgr regularly \u2018cleans\u2019 these source folders and will remove all content that is not a software update associated with the Deployment Package. This would include removing the application source files placed here by the Publisher. To resolve this issue please select a UNC path that is not in use by any Deployment Package. UNC When configuring the ConfigMgr source you may receive a warning message regarding a misconfigured source such as the below. In this case, a non-UNC path, such as \u2018D:\\Application\\Sources\u2018 was selected as the source folder. This is an invalid ConfigMgr setting and will cause validation errors within ConfigMgr. To resolve this issue please select a UNC path of a network share such as\u2018\\\\sccm\\Application\\Sources\u2018 instead. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/microsoft-software-license-terms-have/", "title": "Microsoft Configuration Manager, WSUS, End User Licensing Agreement", "raw_text": "The Microsoft Software License Terms have not been completely downloaded and cannot be accepted Microsoft Configuration Manager can throw the error in the title when the Software Update Point tries to synchronise new updates from WSUS and the update it is trying to supersede no longer has its End User Licensing Agreement (EULA) available on disk. EULAs are stored in the WsusContent directory as .txt files for software updates which come with any. For example, the Windows Malicious Software Removal Tool for some older versions of Windows come with EULA .txt files saved in WsusContent. Before you can deploy any updates which come with a EULA, the agreement must first be accepted. An example of this can be seen below in Configuration Manager: It is also possible to automatically accept all EULAs without any manual acceptance when using Automatic Deployment Rules (ADR): Determine if you are affected If affected, you will see the below log line inwsyncmgr.log: Failed to sync update 8b1ca2c2-e002-4dc6-a5d6-0168006fb369. Error: The Microsoft Software License Terms have not been completely downloaded and~~cannot be accepted. Source: Microsoft.UpdateServices.Internal.BaseApi.LicenseAgreement.GetById The GUID would be the WSUS update ID of the new update failing to synchronise into Configuration Manager. You may also see theerror code 0x80131500in the Configuration Manager console under MonitoringOverviewSoftware Update Point Synchronization Status: InSoftwareDistribution.logyou may also see the reference to specific .txt files missing from your WsusContent directory: Finally, when trying to query WSUS for the update using PowerShell, it will return a similar error message aswsyncmgr.log: Step 1: Validate the permissions on the WsusContent and UpdateServicesPackages shares To verify theNTFS and SMB permissions are correct for yourWsusContentandUpdateServicesPackagesfolders, reviewStep 2: Validate the Permissions on the WsusContent and UpdateServicesPackages Sharesin the following article: CreateDirectory failed Error when Publishing Third-Party Updates If any permission changes were made, perform a sync of your Software Update Point and validate if the issue still exists. If it does, move on to step 2. Step 2: Restore missing EULA .txt files in the WsusContent share If the NTFS and SMB permissions are correct for your WSUS content directories, it\u2019s likely the EULA .txt files have been deleted from the WsusContent directory. Note:you may have multiple Software Update Points in your environment, and some of them may be throwing this error. You will need to run the same remediation steps below on each Software Update Point impacted. You can see which SUP fails to sync and its errors by reading wsyncmgr.log. Performing a \u201creset\u201d is not as significant as it sounds. Microsoft have documentation on this issue and also recommend the same action: Synchronization fails because of issues with the EULA \u2013 Configuration Manager | Microsoft Learn You can still publish new third-party updates to WSUS while it is experiencing a reset, and you can also still synchronise your Software Update Point, too \u2013 it is not necessary to disable the Patch My PC Publisher or Software Update Point scheduled sync. Important:make sure your proxy or firewall is not blocking access to Microsoft to redownload these EULA .txt files. Depending on how many updates you have in WSUS requiring content, especially third-party updates, the reset process can take a long time. WSUS will enumerate every update in serial to validate its content. Once the reset process is complete, you will see the two log lines below inSoftwareDistribution.log: At this point, all missing EULA .txt files should be redownloaded into the WsusContent directory. Try synchronizing your Software Update Point again to validate the issue is resolved. Video Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/visual-studio-2022-custom/", "title": "Visual Studio Packaging, Custom App, Patch My PC", "raw_text": "How to package Visual Studio 2022 as a Custom App In this article, we will show you how you can prepare a package for Visual Studio 2022 and deploy it as a Custom App using Patch My PC Cloud or publish it as a Custom App using Patch My PC Publisher. With its modular installation model, Visual Studio allows you to select specific workloads based on development needs. However, this flexibility also means that packaging Visual Studio for deployment requires careful planning, especially when managing installation size, dependencies, and update strategies. The following guide will focus on thecore editor workloadonly for theCommunity Edition. This article serves as a guide to illustrate how Visual Studio can be packaged as a custom application. However, due to the many variables involved in configuring workloads and application settings, Patch My PC Support is unable to provide assistance with tailoring the package to meet specific customization needs. For detailed guidance on customizing the offline installer, including available command-line options, please refer to theofficial documentation Prepare a package for Visual Studio 2022 The steps below apply to the Community, Professional, and Enterprise editions of Visual Studio. To ensure you always install the latest version of the Current Channel for Visual Studio 2022, download the appropriate bootstrapper from the table below:- In the following example, we will prepare a package for theCommunityedition. Step 1: Download the Stub Installer Download the Visual Studio Community 2022 stub installer from:-https://aka.ms/vs/17/release/vs_community.exe Save it to a location where you have write permissions. Step 2: Create the Local Layout It is necessary to create a local layout which downloads the necessary workload modules and files using the stub installer. Additionally, the layout will set the language for the package. The only workload and component we will use for this example package isMicrosoft.VisualStudio.Component.CoreEditorandMicrosoft.VisualStudio.Workload.CoreEditor.For a full list of componenets and workloads for each edition, follow the links athttps://learn.microsoft.com/en-us/visualstudio/install/workload-and-component-ids?view=vs-2022 Additionally, we will use theen-USlanguage locale. For a full list of language locales, seehttps://learn.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio?view=vs-2022#list-of-language-locales Open a Command Prompt or PowerShell window as Administrator. Navigate to the directory where you saved the stub installer. Run the following command to create a minimal local layout:.\\vs_community.exe --layout .localVSlayout --add Microsoft.VisualStudio.Component.CoreEditor --add Microsoft.VisualStudio.Workload.CoreEditor --lang en-US .\\vs_community.exe --layout .localVSlayout --add Microsoft.VisualStudio.Component.CoreEditor --add Microsoft.VisualStudio.Workload.CoreEditor --lang en-US Wait for the download to complete. This may take some time depending on your internet connection. Step 3: Prepare the Layout Package Locate thelocalVSlayoutfolder created in Step 2. Compress the following files and folders into a ZIP archive:Select all folders and files withinlocalVSlayoutexceptvs_setup.exeRight-click and select \u201cCompress to ZIP file\u201d or use a tool like 7-ZipName the archivelocalVSlayout.zip Select all folders and files withinlocalVSlayoutexceptvs_setup.exe Right-click and select \u201cCompress to ZIP file\u201d or use a tool like 7-Zip Name the archivelocalVSlayout.zip Delete the original files and folders from.localVSlayoutafter confirming the ZIP file was created successfully. The compressed zip file should contain the following files and folders (the exact files and folders will vary depending on the edition you used and the workloads you specified in your layout). The localVSlayout folder should now only containlocalVSlayout.zipandvs_setup.exe Create the Custom App We now have the necessary files to create the custom app in Patch My PC Cloud. Navigate tohttps://portal.patchmypc.com/app-catalog/upload. ClickAdd Primary Install Fileand selectvs_setup.exe. ClickAdd Filesand selectlocalVSlayout.zip(The zip file is quite large so may take a short while to upload, you can still proceed through the wizard during the upload). ClickNext. On theGeneral Informationtab, enter the following information:-FieldDataApp IconProvide a suitable icon for the appApp NameVisual Studio Community 2022VendorMicrosoft CorporationDescriptionVisual Studio Community 2022 is Microsoft\u2019s free, fully-featured IDE for students, open-source contributors, and individual developers. It offers a comprehensive development environment for building applications across platform ClickNext. On theConfigurationtab, enter the following information:-FieldDataInstall ContextSystemArchitecture64-bitVersion17.3.1LanguageEnglishApps & Features NameVisual Studio Community 2022Conflicting processesdevenv.exeSilent Install Parameters\u2013\u2013quiet \u2013\u2013wait \u2013\u2013norestart ClickCreate. (You may not be able to click Create if the localVSlayout.zip has not finsihed uploading yet). Important:You must use the correctApps & Features NameandVersionfor the edition and version of Visual Studio 2022 you are creating as a Custom App. If you do not, the application will fail to be detected after it has installed. Patch My PC recommends to manually install Visual Studio 2022 using the stub installer to visually check theNameandVersionthat should be used when creating the Custom App. This can be done very easily be examining theNameandVersionin the Control Panel. Deploy Visual Studio 2022 with Patch My PC Cloud Once the Custom App has been created, it can be deployed using Patch My PC Cloud to Intune. Navigate to the Patch My PC portalhttps://portal.patchmypc.com/app-catalog. Search forVisual Studioand select the Custom App that was created for Visual Studio. ClickDeploy. On theConfigurationstab, selectScriptsand clickAdd +to add aPre Installscript. The pre-script is going to expand the zip archive so all the required files and folders are accesible for the main installer filevs_setup.exe. Paste the following script block into the script body window, name the scriptExpand-Archiveand clickSave.try {Get-ChildItem -Path $PSScriptRoot -Filter \"*.zip\" | ForEach-Object {Expand-Archive -Path $_.FullName -DestinationPath $PSScriptRoot -Force -ErrorAction Stop }} catch {exit 1} ClickNextto add your desiredAssignments. ClickDeploy Publish Visual Studio 2022 with Patch My PC Publisher Once the Custom App has been created, it can be Published using Patch My PC Publisher. Open Patch My PC Publishing Settings. Select either theConfigMgr Apps,Intune AppsorIntune Updatestab and find the Custom App (You may need to click the \u201cRefresh the list of products\u201d button indicated below). Select the check-box beside the app to enable it for publishing. Right-Click the app and clickAdd custom pre/post scripts. A pre-script is required to expand the zip archive so all the required files and folders are accesible for the main installer filevs_setup.exe Copy the following code into a file and name the fileExpand-Archive.ps1.try { Get-ChildItem -Path $PSScriptRoot -Filter \"*.zip\" | ForEach-Object { Expand-Archive -Path $_.FullName -DestinationPath $PSScriptRoot -Force -ErrorAction Stop }; } catch { exit 1 } Click theBrowsebutton for thePre Scriptand select theExpand-Archive.ps1file that we just created. Additionally, select the check box nameDon\u2019t attempt software update if the pre script returns an exit code other than 0 or 3010. ClickOK. The app is now ready to be published. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/page/20/", "title": "Patch Management, Endpoint Security, IT Operations", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 \u2026 19 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/publisher-overview/", "title": "PatchMyPC, KB Title, Windows Update", "raw_text": "Publisher High-Level Post Main KB Title of Article In this article, blah blah blah Topicscovered in this article: Topic 1: OR Determine if You are Affected Topic2 Topic3 Topic4 Topic5 Topic6 Topic 1:OR Determine if You are Affected Here\u2019s topic 1 Topic 2: Step2description Topic 3: Step3description Topic 4: Step4description Topic 5: Step3description Topic 6: Step3description Topic 6: Step3description Special Text Formatting and Common Text Common log files and intro indetermine if you are affected If affected, you will see the following error in the ENTERLOGFILESURLs file. List ofcommon server log fileswith links: PatchMyPC.logSMS_ISVUPDATES_SYNCAGENT.logSoftwareDistribution.log List of commonclient log fileswith links: WUAHandler.logWindowsUpdate.logPatchMyPC-ScriptRunner.log (For ConfigMgr Apps/Updates)PatchMyPC-ScriptRunner.log (For Intune Apps/Updates)PatchMyPC-SoftwareDetectionScript.logPatchMyPC-SoftwareUpdateDetectionScript.log CommonKB references modify published updates wizardWSUS signing certificatedeploy the WSUS signing certificate to clients Here\u2019sError Text: Example CMTace Error MessageExample CMTrace Warning Messagesample-powershell command line Note:Here is an example call out section for something super duper cool Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/page/2/", "title": "Patch Management, Endpoint Security, IT Operations", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 2 3 \u2026 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/code-signing-impact/", "title": "Public CA certificates, Code signing certificate changes, WSUS/Configuration Manager", "raw_text": "How The Publisher is Affected by Code Signing Certificate Changes Today I want to talk a bit about the Public CA code signing certificate changes that were introduced in June 2023. But first, I want to point out that this only applies to Patch My PC customers that are using code signing certificates issued from Public CAs. Most customers will remain unaffected by these changes I am outlining below. That being said, let\u2019s get into it! If you use the Publisher in conjunction with WSUS/Configuration Manager, you are required to have a trusted code-signed certificate so that Patch My PC can publish third-party updates in your environment. Unfortunately, this process has become more complicated as of June 1st, 2023.Industry standardshave changed to require private keys for standard code signing certificates to be stored on HSMs (hardware security modules). To use a certificate on an HSM, you need to have access to the HSM and the appropriate credentials to use the certificate stored on it. Since Patch My PC and the Publisher cannot access your private HSM, that means that we cannot use that certificate to publish updates in your environment. So, if you cannot use these public CA code signing certificates, what can you do? You have two options: You can transfer to a self-signed certificate (which you can read more about here:What is the WSUS Signing Certificate and How to Create It \u2013 Patch My PC). If your organization has an internal CA, you can request and use a code signing certificate from withinyour own organization. Hopefully this gives you an idea of how to work with the changes we\u2019ve seen to Public CA certificates earlier this year. If you need further assistance, please feel free to reach out to[email protected]. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-updates-fail-error/", "title": "Configuration Manager, Updates, Error 0x80246002, Hash Validation", "raw_text": "Third-Party Updates Fail with Error 0x80246002 in ConfigMgr (SCCM) Error0x80246002occurs when installing updates on a client in Configuration Manager (SCCM) when there is ahash validation issue. This article will review why0x80246002may happen and the steps to take to troubleshoot and hopefully resolve the issue. Determine if You are Affected If affected, you will seeerrors similar to the errors below: In theWUAHandler.logfile: Failed to download updates to the WUAgent datastore. Error = 0x80246002. In theWindowsUpdate.logfile: Hash check on file C:\\Windows\\SoftwareDistribution\\Download.cab using algorithm SHA256 failed; hash values did not match. If the update is set to bevisible in software center, the error show a message similar to below: Background of Windows Update Content Hash Validation Checking To understandhow hash validationworks and update content is transferred to clients, we will need to dig into the software update content flow, and where things could go wrong. Windows Server Update Services (WSUS) -> Windows updatesIn this step, your WSUS service willsync the latest updates available from Microsoft updatesorlocally published third-party software updates.The update file hashes are stored in the WSUS database and this is the authoritative source. In this step, your WSUS service willsync the latest updates available from Microsoft updatesorlocally published third-party software updates. The update file hashes are stored in the WSUS database and this is the authoritative source. ConfigMgr Updates -> WSUSIn the next step, ConfigMgr will sync its software update database from the latest WSUS database. This sync is tracked in thewsyncmgr.log. In the next step, ConfigMgr will sync its software update database from the latest WSUS database. This sync is tracked in thewsyncmgr.log. ConfigMgr Update DeploymentUpdates are downloaded to a deployment package, distributed, and deployed to clients via ConfigMgr. Updates are downloaded to a deployment package, distributed, and deployed to clients via ConfigMgr. Clients Install Updates from ConfigMgrClient computers will download the updates from distribution points toC:\\Windows\\CCMcacheand copy the update binaries toC:\\Windows\\SoftwareDistribution\\Download. Next, the ConfigMgr agent will call theWindows Update Agentto perform the actual update installation.TheWindows Update Agentwill then compare the update binary hash for theupdate binary download from your ConfigMgr distribution pointagainst thefile hash stored in the WSUS database. Client computers will download the updates from distribution points toC:\\Windows\\CCMcacheand copy the update binaries toC:\\Windows\\SoftwareDistribution\\Download. Next, the ConfigMgr agent will call theWindows Update Agentto perform the actual update installation. TheWindows Update Agentwill then compare the update binary hash for theupdate binary download from your ConfigMgr distribution pointagainst thefile hash stored in the WSUS database. In short, error0x80246002means the update binary file hash downloaded from the ConfigMgr distribution point doesn\u2019t match the expected value from the update in the WSUS database. Note:The hash error0x80246002is an issue thatisn\u2019t directly caused by Patch My PCor any configurations related to Patch My PC. We will try to cover some common reasons that could cause hash issues and possible workarounds. Possible Cause 1: Corrupt Deployment Package Content One of the more obvious root causes is a corrupteddeployment package.The deployment package is where theupdate binaries are downloadedfromWindows updates(or from the WSUS server for third-party updates). The deployment package is then used as the source for how the updates are distributed to distribution points. If the update content is evercorrupted during this process, clients\u2019 binary downloaded will fail with a hash error. A good first step is trying todelete problematic updatesfrom the ConfigMgrdeployment package(s). You can thendelete the problematic updatesfrom the deployment package. We recommendwaiting up to one hourto ensure the deletion of the updates from thedeployment package source folderand thecontent library. After waiting, you can then try tore-download the update(s)to a deployment package and verify the deployment package is distributed. Possible Cause 2: Updates Deleted from the WSUS Database and Published as Same UpdateID If youdeleted updates directly from WSUS, and the product is still enabled, this can cause hash errors. Note:The delete update buttonis not enabled by defaultbecause it can cause hash issues if an update is deleted, and that product is still enabled, causing the same UpdateID to be republished. If youdelete an updateandthe product is still enabled, it will publish again using thesame UpdateID. This is problematic because thehash of the update will be updated in the WSUS database, but thosehash changes will not sync to the ConfigMgr databasebased on our simulations. This means the ConfigMgr client willdownload the binary from the original updatebefore it was published again. However, the Windows Update Agent will evaluate against the update published second, causing error0x80246002. If facing this scenario, we recommend republishing the affected third-party updates as a new update using the processRepublishing Third-Party Updates to Create New Updates and UpdateID\u2019s Possible Cause 3: Was the Top-Level WSUS/SUP Server Rebuilt? If the WSUS server wascompletely rebuilt, it could cause issues similar to scenario 2, where the new update published with thesame UpdateID to WSUSmay not sync over the new hash and file to the ConfigMgr database. If facing this scenario, we recommend republishing the affected third-party updates as a new update using the processRepublishing Third-Party Updates to Create New Updates and UpdateID\u2019s Republishing Third-Party Updates to Create New Updates and UpdateID\u2019s We have a knowledge base article dedicated to the process of republishing third-party updates using our Publisher hereWhen and How to Republish Patch My PC Third-Party Updates Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/using-patch-my-pc-publisher/", "title": "Azure Update Manager, Patch My PC, Configuration Manager, Microsoft Intune", "raw_text": "Using Patch My PC Publisher with Azure Update Manager In this article, we discuss the high-level steps for implementation and key considerations when using Azure Update Manager (AUM) to manage third-party updates. While Patch My PC does not integrate directly with AUM, this knowledge base article aims to assist customers already using Azure Arc and AUM in incorporating third-party patching into their existing update management workflows. What is Azure Update Manager (AUM) As customers consider the new technologies and management platforms on offer from Microsoft, many will adopt Microsoft Intune to manage their user devices. This can ultimately lead them to reconsider the need for Configuration Manager for their remaining server estate. This \u201cmindset shift to cloud\u201d also raises questions about how to handle server patching. As customers might already be using Azure in some capacity, AUM automatically becomes very topical in these conversations as \u201csomething we could adopt\u201d. One common misconception is that moving to AUM eliminates the need for WSUS entirely. While this may be true for customers focusing solely on managing Microsoft first-party updates, it is important to understand that AUM provides no direct support for third-party patching outside of WSUS. Customers requiring third-party patching must still maintain their own WSUS instance, whether on-premises or hosted in Azure. Most third-party software vendors provide updates in the form of catalogs, specifically designed to integrate with WSUS. Currently, WSUS is the only Microsoft-supported mechanism for publishing third-party catalogs and distributing those updates to endpoints. Without WSUS, AUM lacks the capability to manage third-party updates entirely, making WSUS an indispensable component for customers with hybrid or multi-cloud environments who require comprehensive patching capabilities. The screenshot below shows first-party updates identified as required during a scan of Microsoft Update, and third-party updates identified as required during a scan of a local WSUS instance. Scenarios While AUM is an excellent tool for managing Microsoft first-party updates, customers requiring third-party patching must still incorporate WSUS into their update strategy. Below are two common scenarios where AUM and WSUS work together. 1. Using AUM with WSUS for All Updates While AUM provides powerful orchestration and compliance capabilities, it does not eliminate the need for WSUS. AUM has no native support for third-party updates outside of WSUS, making WSUS a critical component for any organization requiring comprehensive patch management. Customers should plan accordingly to maintain their WSUS infrastructure and understand its role in supporting both first-party and third-party updates in hybrid or multi-cloud environments. In this scneario, WSUS is deployed either on-premises or in Azure and serves as the source for both Microsoft first-party and third-party updates. AUM leverages Azure Arc to manage update compliance and patch orchestration for on-premises servers, while Patch My PC Publisher remains responsible for publishing third-party updates to the WSUS instance. For customers transitioning from Configuration Manager, it is important to recognize that WSUS updates now require approval, either manually or with automatic approvals, ensuring that both Microsoft and third-party updates are available for deployment. Patch My PC Publisherpublishes third-party updates to WSUS. WSUSSynchronizes first-party updates from Microsoft Update and serves as the distribution point for third-party updates, hosting the necessary metadata and content. Updates areapprovedfor devices (either manually or using automatic approval rules in WSUS). AUMconnects to Azure Arc-enabled servers and orchestrates the installation of updates, while WSUS ensures both Microsoft and third-party updates and content are accessible. Organizations that want a single WSUS instance to handle all update management and maintain full control over patch approval and distribution. This optionmustalso be used for customers wishing to install third-party updates on servers with an operating systemolder than Windows Server 2022. This is because Scan Source is not supported on older operating systems, meaning the devices cannot scan both Microsoft Update and WSUS simultaneously. 2. Using AUM with Windows Update for First-Party Updates and WSUS for Third-Party Updates In this scenario, Patch My PC Publisher manages the publishing of third-party updates to a WSUS instance, while first-party updates are obtained directly from Microsoft Update using the \u201cscan source\u201d configuration. AUM continues to orchestrate the assessment and deployment of updates, leveraging Azure Arc to manage on-premises servers. This approach significantly minimizes reliance on WSUS, as it is configured solely for third-party patching rather than handling the entire breadth of Microsoft first-party updates. By avoiding the need to configure WSUS for first-party updates, you drastically reduce the number of updates managed within the WSUS database. This optimization addresses some of WSUS\u2019s most notorious challenges, including bloated metadata, increased maintenance overhead, and performance degradation that can occur when managing thousands of updates. In this streamlined setup, WSUS is reserved exclusively for third-party updates, allowing it to operate more efficiently while still enabling AUM to handle patch compliance and orchestration for both first-party and third-party updates. Patch My PC Publisher\u00c2 publishes third-party updates to WSUS. WSUS\u00c2 serves as the distribution point for third-party updates, hosting the necessary metadata and content. Updates areapprovedfor devices (either manually or using automatic approval rules in WSUS). Scan Sourceconfiguration allows endpoints to:Retrieve Microsoft first-party updates directly from Microsoft Update.Retrieve third-party updates from WSUS which were published by Patch My PC Publisher. Retrieve Microsoft first-party updates directly from Microsoft Update. Retrieve third-party updates from WSUS which were published by Patch My PC Publisher. AUM\u00c2 connects to Azure Arc-enabled servers to orchestrate update compliance and installation for both first-party and third-party updates. Customers transitioning to a cloud-first model but still requiring robust third-party patching capabilities. This approach is ideal for those looking to reduce on-premises content storage requirements by shifting first-party update handling to Microsoft Update. This option canonlybe used for customers wishing to install third-party updates on servers with an operating system version ofWindows Server 2022 or higher. This is because Scan Source is not supported on older operating systems, meaning the device cannot scan both Microsoft Update and WSUS simultaneously. Note:By downloading first-party updates directly from Microsoft Update, organizations can significantly reduce the storage requirements for WSUS, as first-party update content no longer needs to be stored locally. However, since each server downloads its first-party updates directly from the internet, organizations must plan for potential bandwidth impacts. Unlike Configuration Manager, which can efficiently distribute content via on-premises distribution points, this approach may lead to higher network usage for large deployments. OS Requirements The following Windows operating systems are supported for use with AUM:- Windows Server 2012 R2 and higher (including Server Core)* Windows 10 and 11 clients are not supported by AUM. If customers are seeking a cloud only solution for client patch management, Microsoft Intune is recommended to manage and orchestrate update workloads using the Win32 app model. * IMPORTANT:While AUM supports Server 2012 R2 and higher, customers intending to adopt the scan source approach described inScenario 2must use Server 2022 or higher for the servers they wish to manage. This is because 2022 and later versions of Windows Server support the Windows Update client to scan both WSUS and Windows Update simultaneously. Policy Requirements The following policy settings should be reviewed to ensure devices are able to assess and install third-party updates orchestrated by AUM. 1. Configure the WSUS Server Location (Required) The client will need pointing to the WSUS instance for compliance reporting and to know where to get update copntent from. If you are moving from ConfigMgr for patching, these settings may already be configured in the local policy. Set theWUServerregistry value to yourhttp(s)WSUS instance (REG_SZ) WUServer = https://MyWSUSServer.contoso.com:8531WUStatusServer = https://MyWSUSServer.contoso.com:8531 HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate Note:TheWUStatusServeris not strictly required but it will be set if you use GPO or Local Policy Editor to confiure the WUServer location. Computer Configuration > Administrative Templates > Windows Components > Windows > Windows UpdateSpecify intranet Microsoft update service location Set the intranet update service for detecting updates = https://MyWSUSServer.contoso.com:8531Set the intranet statistics server = https://MyWSUSServer.contoso.com:8531 2. Configure the UseWUServer Policy (Required) TheUseWUServerpolicy setting specifies whether the device should get its updates from a WSUS server or directly from Microsoft Update. Set theUseWUServerregistry value to1 (DWORD) HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AUUseWUServer = 1\u2014 \u2013 When you configurespecify the intranet Microsoft update service locationusing the ADMX tempalte, this policy is automatically configured and set to 1. 3. Configure an Automatic Approval Rule in WSUS (Required) Configure an automatic approval rule in WSUS to ensure that third-party updates, are downloaded and available for deployment by AUM. This is essential because AUM relies on WSUS to host the necessary update metadata and content for the devices it orchestrates patching for. 4. Accept Trusted Publisher Certifcates (Required) TheAcceptTrustedPublisherCertspolicy allows you to specify whether the Windows update client accepts and processes updates signed by entities other than Microsoft, like Patch My PC, when the update is found on an intranet Microsoft update service location. Set theAcceptTrustedPublisherCertsregistry value to1 (DWORD) HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdateAcceptTrustedPublisherCerts= 1 Computer Configuration > Administrative Templates > Windows Components > Windows > Windows UpdateAllow signed updates from an intranet Microsoft update service location= Enabled Note:By downloading first-party updates directly from Microsoft Update, organizations can significantly reduce the storage requirements for WSUS, as first-party update content no longer needs to be stored locally. However, since each server downloads its first-party updates directly from the internet, organizations must plan for potential bandwidth impacts. Unlike Configuration Manager, which can efficiently distribute content via on-premises distribution points, this approach may lead to higher network usage for large deployments. 5. Disable Automatic Updates (Optional) To ensure that the Windows Update agent does not take independent actions, such as downloading or installing updates outside of AUM\u2019s control, configure the system to disable automatic updates. This setting ensures AUM retains full control over the patching process. Set theNoAutoUpdateregistry value to 1(DWORD) HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AUNoAutoUpdate = 1 Computer Configuration > Administrative Templates > Windows Components > Windows > Windows UpdateConfigure Automatic Updates= Disabled Scan Source Requirements (for Scenario 2) If your intent is to use WSUSonlyfor third-party updates as detailed inScenario 2, you will need to configure Scan Source policy to instruct the Windows Update agent to scan both WSUS and the Windows Update service. Note:Utilizing Scan Source to use Windows Update for Business and WSUS together is very well documented at:-https://learn.microsoft.com/en-us/windows/deployment/update/wufb-wsus The following Scan Source settings are documented well at:-https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-update Scan Source controls which update source the Windows Update agent will scan and honor for Feature, Driver, Quality and Other Updates (Note: Other does not mean third-party in this context). If your intent is for all Windows first-party updates to come from Windows Update, and all third-party updates to come from WSUS, configure all Scan Source policies to zero. Set the following registry values to0 (DWORD) HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate SetPolicyDrivenUpdateSourceForFeatureUpdates = 0SetPolicyDrivenUpdateSourceForDriverUpdates = 0SetPolicyDrivenUpdateSourceForOtherUpdates = 0SetPolicyDrivenUpdateSourceForQualityUpdates = 0 Additionally, set the UseUpdateClassPolicySource registry key to complete scan source configuration. Set theUseUpdateClassPolicySourceregistry value to1 (DWORD) HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AUUseUpdateClassPolicySource = 1 Computer Configuration > Administrative Templates > Windows Components > Windows > Windows UpdateSpecify source service for specific classes of Windows Updates= Windows Update Note:There is no scan source class specifically for third-party updates. \u201cOther Updates\u201d does not mean third-party updates.Scan source Key to Value:Windows Update = 0WSUS = 1 Important:Scan Source only works for Windows Server 2022 + even though AUM is supported on Windows Server 2012R2 + Install on Demand Currently, AUM\u2019s \u201cinstall on demand\u201d functionality, specifically for third-party updates from the Patch My PC catalog, has certain limitations. AUM relies on update IDs that follow a specific format traditionally used by Microsoft\u2019s updates, which differs from thePMPC-year-month-dayformat used in the Patch My PC catalog. This incompatibility can prevent AUM from targeting specific third-party updates for on-demand installation, as the update IDs do not align with the expectations of AUM\u2019s mechanisms. Patch My PC is exploring whether it is feasible to adopt a more compatible KB ID format for updates in our catalog to improve targeting capabilities. However, this effort is still in the exploratory phase, and no confirmed timeline is available for implementation. Customers should take this into account when planning third-party update orchestration with AUM, especially if they require precise on-demand installation functionality. Maintenance Configuration A commonly overlooked configuration when using AUM to orchestrate third-party updates is ensuring that the \u201cUpdates\u201d classification is included in the maintenance configuration. Ensure theUpdatesclassification is included forWindowsoperating systems in your maintenance configuration. Useful Logs The following logs are useful to understand the assessment and orchestration of updates usin AUM. Windows Update Logs:This log provides details about update scans, downloads, and installations. It also allows you to check which update source the device is scanning against.Location: UseGet-WindowsUpdateLogto generate this log file. This log provides details about update scans, downloads, and installations. It also allows you to check which update source the device is scanning against. Location: UseGet-WindowsUpdateLogto generate this log file. Event Viewer Logs:Path:Applications and Services Logs > Microsoft > Windows > WindowsUpdateClientThis event log is useful for tracking update installation progress and errors Path:Applications and Services Logs > Microsoft > Windows > WindowsUpdateClient This event log is useful for tracking update installation progress and errors Windows Update Extension Log:Path:C:\\ProgramData\\GuestConfig\\extension_logsMicrosoft.SoftwareUpdateManagement.WindowsOsUpdateExtensionWindowsUpdateExtension.logThis log is specifically used for troubleshootingupdate orchestration and managementby theAzure Update Manager(AUM) or other Azure-based update mechanisms Path:C:\\ProgramData\\GuestConfig\\extension_logsMicrosoft.SoftwareUpdateManagement.WindowsOsUpdateExtensionWindowsUpdateExtension.log This log is specifically used for troubleshootingupdate orchestration and managementby theAzure Update Manager(AUM) or other Azure-based update mechanisms Troubleshooting AUM plays a crucial role in the assessment and orchestration of Windows Updates, primarily focusing on determining update applicability and managing the scheduling of patch deployments. However, it relies heavily on the underlying Windows Update Agent to execute the actual update scan, download, and installation processes. As such, most troubleshooting steps for AUM overlap with traditional troubleshooting approaches for WSUS and Windows Update configurations. Microsoft has a detailed troubleshooting article for AUM athttps://learn.microsoft.com/en-us/azure/update-manager/troubleshoot?tabs=azure-machines Azure Arc Problems: Ensure the Azure Arc agent is functioning correctly and reporting health status as expected. Verify that the agent is installed, connected, and synchronized with Azure. Additionally, check the Azure Update Manager for any configuration issues, errors, or failed update tasks that may indicate problems with update orchestration or deployment Policy Conflicts: Ensure there are no conflicting group policies or local policies affecting the update scan or deployment. For example, verify that settings like Specify Intranet Microsoft Update Service Location and Configure Automatic Updates are correctly configured. Setting AUOptions may interfer with AUM orchestration as outlined athttps://learn.microsoft.com/en-us/azure/update-manager/configure-wu-agent#pre-download-updates Pre-download of updates isn\u2019t supported in Azure Update Manager. Don\u2019t use pre-download functionality through AUOptions while using Azure Update Manager default/advanced patching mechanisms which sets NoAutoUpdate=1 Certificate Issues: For third-party updates, confirm that the code-signing certificate is correctly deployed to the target devices.Ensure the certificate is placed in the Trusted Publishers store, and if it\u2019s self-signed, also in the Trusted Root Certification Authorities store. See this article for more information on deploying the code-signing certificate used for third-party updateshttps://patchmypc.com/how-to-deploy-the-wsus-signing-certificate-for-third-party-software-updates Network and Connectivity Problems: Ensure the server can reach the configured Windows Update source (e.g., WSUS or Microsoft Update). Check for firewalls, proxies, or network rules blocking access to required update endpoints. Scan Source Configuration: Below is an export from a server in the lab that was configured for Scan Source. This configuration allowed the server to \u201cdual scan\u201d both WSUS and Microsoft Update. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/security-validation-deep-dive/", "title": "IT Security Updates Validation", "raw_text": "Deep Dive Into Security Validation of Updates and Applications We understand IT security is an extremely critical aspect of organizations. IT Security is probably more vital to your organization than the industry on average considering you are actively looking into a third-party patch management solution to help reduce vulnerabilities. We often get asked how we validate the integrity of thethird-party updatesincluded in our catalog. This question is crucial for you to understand. In this post, we will describe in detail the procedures we take to ensure the quality and integrity of the patches we publish in our third-party software update catalog. Step 1: Creating Third-Party Updates and Storing the Hash The first step in our process for creating an update is todownloadthe update binary (EXE, MSI, or MSP) from the official vendor\u2019s download mirror. This update binary will be the file executed on client computers to update the product. The originalhashof the binary anddownload URLis stored in our catalog metadata. Thedownload URLis what will be used when downloading and publishing the update within your environment. Whenever we add new updates to our catalog, thecatalog metadatagets exported andsaved into a CAB file. This catalog (.CAB) is imported into your environment and used to publish updates. To ensure the integrity of the catalog when downloaded and import to your environment, wedual code-sign the catalog filewith our code-signing certificate. When the catalog gets downloaded in your environment, the import will only occur in our publishing service, SCCM 1806+, or SCUP if the catalog is code-signed from atrusted publisher. Step 2: Running the Update Installer Through VirusTotal Once we obtained the vendor\u2019sbinaryand filehash, we then will thenuploadthe binary toVirusTotal. VirusTotal will analyze the binary file through 55+ anti-virus engines. Here\u2019s an example of theSlack 3.3.1.0 MSIbinary file fromStep 1. We post all VirusTotal results for any third-party updates released in ourRSS feedandCatalog Release newsletter. Note:VirusTotal has a 650MB limit for file uploads, therefore, Patch My PC is not able to scan updates larger than 650MB with VirusTotal. Step 3: How Update Binaries are Verified During Publishing Before the catalog metadata is evaluated for publishing, there is adigital signature checkon the downloaded catalog file. This check validates the catalog is signed from Patch My PC. Once the catalog isvalidated, only then will the catalog metadata be evaluated for processing. Since we don\u2019t control theservers used for content downloads, it\u2019s essential to ensure the file downloaded from the vendor\u2019s website is theexact same file used when initially creating the updatethat went through the VirusTotal scans. When an updated binary is downloaded, we will compare thehashof thedownloaded binarywith thehash from the catalogand only publish the update if they match. Step 4: Trust Within Your Environment The final layer of trust for third-party software updates before client-side installation isbetween your servers and clients. Whenever third-party updates are published to your WSUS environment, they are added into a CAB file that getsdigitally signedusing the code-signing certificate that you configure within your environment. Client devices will only install third-party patches that are signed using a trusted certificate that you have configured and deployed to your devices. Dataflow Diagram for Update and Application Downloads Below you can find adataflow diagramof the download flow. A full list of the vendor website can be found atList of Domains for Whitelisting when Using Patch My PC\u2019s Catalog Detailed dataflow If you have any more detailed questions about our security testing, please visit ourSecurity Center. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-apps-vs-intune-updates/", "title": "Intune Apps, Intune Updates, Company Portal, Assignments", "raw_text": "Intune Apps vs Intune Updates This article will detail when to use Intune Apps or Intune Updates and the relevant assignments for each. Intune Apps & Intune Updates \u2013 What\u2019s The Difference? When talking about Intune Apps & Intune Updates in the Patch My PC Publisher there can be some confusion around when to use 1 or the other or both. For this article, we will look specifically at Google Chrome x64 as an example. When talking about Intune Apps I am referring to any Products selected under the Intune Apps tab in the Publisher and when talking about Intune Updates I am referring to any Products selected under the Intune Updates tab in the Publisher. The main difference between Intune Apps and Intune Updates lies in what you are hoping to achieve and cover 2 different scenarios below. Scenario 1 \u2013 Required Apps In Scenario 1, We want to ensure that all of our devices have Google Chrome x64 installed and always kept updated with the most recent version. To achieve this, We want to select theIntune Appfor Google Chrome x64 and set our assignments toRequiredonAll Devices With this assignment set, Any time a device checks in it will evaluate the following If Google Chrome x64 isn\u2019t installed, The device will pull down and install Google Chrome x64 If Google Chrome x64 is installed but requires an update, The device will pull down and install the most recent version of Google Chrome x64 Scenario 2 \u2013 Available Apps & Required Updates In Scenario 2, We want to make Chrome available to our users to install from the Company Portal but remain in control of keeping it up to date should they decide to install it. To achieve this, We want to select theIntune Appfor Google Chrome and set our Assignments toAvailabletoAll Users With this assignment set, Google Chrome will appear in the Company Portal for your users to install should they want to. Once we have this assignment set, We want to select theIntune Updatefor Google Chrome and set ourAssignmentstoRequiredonAll Devices With this assignment set, Any time a device checks in it will evaluate the following If Google Chrome x64 is not installed, Do nothing If Google Chrome x64 is installed and requires an update, The device will pull down and install the most recent version of Google Chrome x64 Note:You can find more information on Managing Intune Assignments here \u2013Manage Assignments Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-generate-code-signing-certificate/", "title": "Code Signing Certificate, PowerShell Script", "raw_text": "How to generate a code signing certificate and sign PowerShell .ps1 script This guide will show you how to issue a code signing certificate from your internal Certificate Authority, and how to use it to sign your code. Trying to sign code with no certificate available If you would like to sign your own files, and this is done on a machine where no code signing certificate is present, you will get an error. If you are usingSignToolto automatically select the best signing certificate, the verbose output will say:SignTool Error: No certificates were found that met all the given criteria. How to get a code signing certificate One option would be to purchase a code signing certificate online from authorities such asDigiCert. Another one would be to issue one from your internal Certificate Authority, which you can do by following these steps: Create and issue a signing certificate OpenCertification Authority(certsrv.msc) on a machine where you have installed the certification authority. Expand the name of theCertification Authority, then right-click onCertificate Templatesand chooseManage Right-Click onCode Signingunder theTemplate Display Namecolumn and chooseDuplicate template. On the properties of the new template, click on theGeneraltab and give it the name you want. Also, choose the validity period. Save change withApply. Go on theRequest Handlingtab, and make sureAllow private key to be exportedis enabled. On theSubject Nametab, set theSubject name formattoCommon Name. On theExtensionstab, make sure that the description ofKey UsagecontainsDigital Signature. On the Security tab, ensure that \u201cAuthenticated Users\u201d haveReadandEnrollpermissions. Note:You might not want all Authenticated Users to be able to Enroll the certificate, you can add your own custom security group which should have these permissions. You can now click OK and then close the Certificate Templates Console. Back toCertification Authority, right clickCertificate Templates, chooseNewand then selectCertificate Template to Issue. From theEnable Certificate Templates list, select your certificate template and confirm withOK. Requesting a certificate on a machine to use it for code signing On a domain joined machine, openmmc.exe. ClickFileand thenAdd/Remove Snap-in. SelectCertificatesand then click onAdd. In the dialog box which appears, selectMy user account, then confirm withFinish. In the console, expandCertificates \u2013 Current User, then expandPersonal. Right-clickCertificates, then go toAll Tasksand selectRequest New Certificate. In theCertificate Enrollmentwindow, clickNextuntil you see a list of certificates to request. The issues certificate should appear in this list. Select it and confirm withEnroll. The certificate should now be enrolled on that device and can be used for code signing. How to sign your code In terms of signing, you can either useSignToolor theSet-AuthenticodeSignaturePowerShell cmdlet. Example 1: SignTool In this example, we used the following arguments: sign = Digitally signs files. Digital signatures protect files from tampering, and enable users to verify the signer based on a signing certificate. /a = Automatically selects the best signing certificate. Sign Tool will find all valid certificates that satisfy all specified conditions and select the one that is valid for the longest time. In our case, it automatically selected the code signing certificate we enrolled. /v = Displays verbose output /fd = specifies the digest algorithm. In our case, we went with SHA256. Example 2: PowerShell cmdletSet-AuthenticodeSignature In this example, on the server where the Patch My PC Publishing service is installed, from an elevated PowerShell ISE instance: On line 1, we get the code signing certificate we enrolled. On line 3, we used the Set-AuthenticodeSignature cmdlet to sign ourC:test.ps1file using the WSUS code signing certificate. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/configmgr-app-manager/", "title": "ConfigMgr Application Manager, Patch My PC, ConfigMgr, Deployments", "raw_text": "ConfigMgr Application Manager Overview The ConfigMgr Application Manager in the Patch My PC Publisher is a tool to help you quickly and easily manage ConfigMgr Applications created by the Patch My PC Publisher. Open theConfigMgr Application Managerin theOptionswindow found in theConfigMgr Appstab in the Patch My PC Publisher. Available Actions to Perform on Published ConfigMgr Apps There are a variety of actions that are available for published ConfigMgr Applications published by Patch My PC. Extract Content\u2026 This option will open a a dialog box that will allow you to save the ConfigMgr application content for the specified application in the selected location. Note:Extracted application content will not automatically go into a new folder. It is recommended to extract to a destination folder instead of directly to the Desktop or similar location. Delete Deployments This option will delete all deployments for the selected application(s). Delete Applications This option will delete the selected application(s) from ConfigMgr.Associated application content will also be deleted. More information regarding this process can be found here Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/scan-intune-for-supported-products/", "title": "Microsoft Intune Patching Scan, Third Party Products", "raw_text": "Scan Microsoft Intune for Supported Third-Party Products for Patching Scan Microsoft Intune for Supported Third-Party Products for Patching The Patch My PC Publisher canscan Microsoft Intune inventoryto detect products that are supported for Win32 application creation. You can auto-enable products detected. This article discusses theIntune scanning feature. This article includes what features are available, existing limitations, and the planned features. The ability to scan Intune for products that are supported by Patch My PC is actively under development and will continue to change. Topics covered in this article: Current Features Limitations Current Features The intent with this feature was to provide some parity to our Configuration Manager scan feature shownhere. The Configuration Manager database contains a monumental amount of data allowing us to provide a good representation of what our product can patch in your environment. The Intune scanning UI can be seen below. Intune Connection: This Intune Connection will share the configuration of the other Intune based features in the product. The configuration for API permissions can be foundhere. There are additional permissions required with this feature beyond what is required for creating applications. Please review thearticleto ensure your permissions are configured correctly. Auto Publishing Rules: If this feature is enabled (checkbox in a checked stated) the Intune scanning will occur every time aPublisher synchronizationoccurs. Based on the results of the scan Win32 Intune Applications, or Intune Updates will be published to Intune if the count threshold is met.The number specified will act as a threshold. When the scan is performed, any software found onat leastthat number of devices will be automatically selected to be published as an Intune application.ie. The threshold set to 30, Zoom Meetings found on 55 devices, Zoom Meetings will be automatically selected for publishingThe dropdown \u201c1 selected\u2026\u201d box lets you configure certain options for the published applications, such as disabling the self-updater if supported The number specified will act as a threshold. When the scan is performed, any software found onat leastthat number of devices will be automatically selected to be published as an Intune application.ie. The threshold set to 30, Zoom Meetings found on 55 devices, Zoom Meetings will be automatically selected for publishing ie. The threshold set to 30, Zoom Meetings found on 55 devices, Zoom Meetings will be automatically selected for publishing The dropdown \u201c1 selected\u2026\u201d box lets you configure certain options for the published applications, such as disabling the self-updater if supported If you haveManage assignmentsconfigured at the product or vendor level, and a product becomes enabled via auto-publishing rules, the newly enabled product will not inherit the assignments. This is by design to prevent customers experiencing anIntune policy size limitissue. Filter: The table of data can be filtered based on four fieldsProductVendorCount greater than\u2026Already enabledThe radio buttons to the right of the filters provide the ability to include, or exclude products which are already enabled as Win32 Intune Applications Product Vendor Count greater than\u2026 Already enabledThe radio buttons to the right of the filters provide the ability to include, or exclude products which are already enabled as Win32 Intune Applications The radio buttons to the right of the filters provide the ability to include, or exclude products which are already enabled as Win32 Intune Applications The filter is cosmetic only, it does not affect the scans or the Export to CSV feature Export to CSV The data table can be exported out to a CSV file. This can be useful to pass to management or your cybersecurity team. Keep in mind the filters do not apply to the resulting CSV file. Click OK Intune Connection will be saved to your settingsAuto-publishing rules will be saved to your settingsAuto-publishing will occur during the next Publisher synchronization.Changes in product selection in the data table will be saved to your settings.Newly selected applications will be published during the next Publisher synchronization. Intune Connection will be saved to your settings Auto-publishing rules will be saved to your settingsAuto-publishing will occur during the next Publisher synchronization. Auto-publishing will occur during the next Publisher synchronization. Changes in product selection in the data table will be saved to your settings.Newly selected applications will be published during the next Publisher synchronization. Newly selected applications will be published during the next Publisher synchronization. Limitations: Because this feature is using theMicrosoft Graph API, we are subject to any limitations presented by the API. These limitations are discussed below. Inventoried Applications:Intune currently keeps inventory of a subset of the applications installed on a deviceMicrosoft details this limitation inthis docs pageWindows 10 Win32 Apps: Only MSI based apps on company-owned devicesThis limits our Graph API queries to returning MSI based products that we support, as opposed to the Configuration Manager scans which will detail all our supported products based on the database query results.Counts may not directly reflect the exact count of instances of installed software. This is the result of the data structure in Graph, where each version of the software is stored as an individual record for a device. The result is some applications being counted multiple times for a device. Intune currently keeps inventory of a subset of the applications installed on a device Microsoft details this limitation inthis docs pageWindows 10 Win32 Apps: Only MSI based apps on company-owned devices Windows 10 Win32 Apps: Only MSI based apps on company-owned devices This limits our Graph API queries to returning MSI based products that we support, as opposed to the Configuration Manager scans which will detail all our supported products based on the database query results. Counts may not directly reflect the exact count of instances of installed software. This is the result of the data structure in Graph, where each version of the software is stored as an individual record for a device. The result is some applications being counted multiple times for a device. Graph APIMicrosoft Graph API currently does not allow a query to return a full list of detected applications.The/devicemanagement/detectedAppsendpoint does exist, but it only lists Modern appsTo list MSI based inventory data each device must be queried directly.ThedetectedAppsrelationship can be expanded to get a devices MSI based detected appsBecause each device must be queried individually there is a lot of queries to performGraph batches are used to increase performanceGraph batches arelimited to 20 queries per batchGraph batchescannot be nestedFor the quickest Intune scanning, the Publisher will group devices into batches of 20 and perform the Graph API queries in parallel Microsoft Graph API currently does not allow a query to return a full list of detected applications.The/devicemanagement/detectedAppsendpoint does exist, but it only lists Modern apps The/devicemanagement/detectedAppsendpoint does exist, but it only lists Modern apps To list MSI based inventory data each device must be queried directly.ThedetectedAppsrelationship can be expanded to get a devices MSI based detected apps ThedetectedAppsrelationship can be expanded to get a devices MSI based detected apps Because each device must be queried individually there is a lot of queries to performGraph batches are used to increase performanceGraph batches arelimited to 20 queries per batchGraph batchescannot be nestedFor the quickest Intune scanning, the Publisher will group devices into batches of 20 and perform the Graph API queries in parallel Graph batches are used to increase performanceGraph batches arelimited to 20 queries per batchGraph batchescannot be nested Graph batches arelimited to 20 queries per batch Graph batchescannot be nested For the quickest Intune scanning, the Publisher will group devices into batches of 20 and perform the Graph API queries in parallel Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/deploying-the-wsus-code-signing-certificate-within-configuration-manager-using-a-ci/", "title": "WSUS Code Signing Certificate Deployment Config Management", "raw_text": "Deploying the WSUS Code Signing Certificate Within Configuration Manager Using a CI In this article, we will cover how aWSUS signing certificate,or other code-signing certificates can be deployed to your Configuration Manager clients by using aConfiguration Item. A code-signing certificate is a core component in Third-Party Patching. The certificates private key is used to sign the CAB files that will be published to WSUS, and ultimately installed on clients. The client musttrustthis certificate and thecertificate chain. There are use cases where deploying this certificate can be useful via Configuration Item as opposed to something likeGPO, or the built-in Client Settings. One that comes to mind is wanting the monitoring that a Configuration Item provides. Below is a step by step showing how a Configuration Item can be created usingthe script attached here. Additionally, there are steps to help gather the required information. Article Outline: Gathering Info Step 1: Create a New Configuration Item Step 2: Create the Associated Compliance Rule Step 3: Associate the CI with a Configuration Baseline Step 4: Deploy the Configuration Baseline Gathering Info The script itself will need to be edited with your specific Thumbprint and Base64 encoded certificate string. The function contained within the script discusses how to gather these values, but I\u2019ll also note them below. Also, if you are comfortable with Configuration Items within Configuration Manager, you can simply grab the script, adjust for your environment, and deploy away! Certificate Thumbprint:Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate.This can also be copied out of the Patch My PC Publisher, as shown below. Within the properties of your Code Signing certificate, go to the Details tab and scroll to down to the thumbnail area. This thumbprint will help us uniquely identify the certificate. This can also be copied out of the Patch My PC Publisher, as shown below. Base64 Encoded Certificate String:This can be acquired a handful of ways, but a simple way is to get a copy of the certificate as a file and run a PowerShell command similar to the belowSet-Clipboard -Value (::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Set-Clipboard -Value (::ToBase64String((Get-Content -Path .ExportedCert.cer -Encoding Byte))) Step 1: Create a New Configuration Item This process will require creating a new Configuration Item, which can be accessed in the context menu as shown below, or within the ribbon when in the node shown. The CI will return a Boolean value, either$trueor$falsebased on the presence of the specified certificate thumbprint. See below, for example, Discovery, and Remediation implementation. Note Data Type is set to Boolean, and the script is modified between Detection and Remediation. A$Remediatevariable is changed based on the purpose of the script. The$CodeSigningCertificateThumbprintand$EncodedCertStringvariables will also need to be populated and should be the same in both scripts. The below screenshots simply show placeholder text. Step 2: Create the Associate Compliance Rule When creating the Configuration Item, you will also configure a Compliance Rule. The compliance rule is the logic that dictates if the remediation script should run, or if the Configuration Item should return compliant or not. Note that we check the box for\u201cRun the specified remediation script when this setting is noncompliant.\u201dThis option is needed to ensure we can perform remediation. Step 3: Associate the CI with a Configuration Baseline With the CI created, we need to create a Configuration Baseline, which can be accessed in the context menu as shown below, or within the ribbon when in the node shown. Alternatively, you could add this CI to an existing baseline you have in place. See the below wizard for an example of the wizard for creating a Configuration Baseline where we are adding our previously created Configuration Item. Step 4: Deploy the Configuration Baseline Finally! The entire point of this article. What you select within this wizard is ultimately up to you. If you want theactionto happen, you, at a minimum, need the check the\u201cRemediate noncompliant rules when supported\u201dcheckbox. Whether you allow this outside maintenance windows, and on what schedule, targeting which devices etc. are all decisions that will be specific to your organization. Assuming all steps were followed, and the values for the base64 string and thumbprint are valid, you should be able to perform aMachine Policy Evaluation Cycleon a client that is targeted with the deployment, and check the Configurations tab as shown below. Once the Configuration Baseline has evaluated as compliant, the certificate should show in theTrusted Root Certificate Authoritiescertificate store and theTrusted Publisherscertificate store and with no \u2018content\u2019 needed! We can store the certificate as a string, very cool! Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/migrate-configmgr-to-intune/", "title": "ConfigMgr migration, Intune, Patching, Co-management", "raw_text": "Migrate Third-Party Application Management and Patching from ConfigMgr/SCCM to Intune This article provides adetailedstep-by-stepguide on how to make this transition, ensuring a seamless and efficient patch management process. Pre-requisites As a prerequisite, please ensure you have co-management configured in your environment and your devices enrolled into Intune. This article will not cover how to setup co-management, however, you can refer to the following tutorial on Microsoft Learn:Tutorial: Enable co-management for existing clients \u2013 Configuration Manager | Microsoft Learn Move the Client Apps Workload The Client Apps workload is unique because it doesn\u2019t fully transfer app management from ConfigMgr to Intune. Instead, it allows apps to be targeted by both platforms, consecutively. To enable Patch My PC Win32 apps and updates through Intune, the Client Apps workload must be moved. For more details, refer toCo-management workloads \u2013 Configuration Manager | Microsoft Learn Tip:The Company Portal app is now the cross-platform app portal experience for the Microsoft Intune family of products. By configuring co-managed devices to also use the Company Portal app, you can provide a consistent user experience on all devices. Read more atApps in Company Portal \u2013 Configuration Manager | Microsoft Learn To move the Client Apps workload, in the Configuration Manager console: Navigate throughAdministration->Cloud Services->Cloud Attach, right-clickCoMgmtSettingsProdand clickProperties. Go to theWorkloadsandset thesliderforClient appstoPilot IntuneorIntune.With the Client Apps workload moved to Intune or Pilot Intune, the co-managed devices will receive applications deployed from bothConfigMgrand Intune. If you moved the workload to thePilot Intuneposition, you will need to now click on the tabStagingand choose a collection of devices. ClickOKto save and close.Only the devices in this collection will have their Client Apps workload moved to Intune. Reviewing CoManagementHandler.log Connect to a client to make sure that the Client Apps workload has moved as expected. You can check this in two places: \u201cC:\\Windows\\CCM\\Logs\u201d. Open theCoManagementHandler.logand search for the stringCoManagementSettings_Capabilities. Open theConfiguration Manager PropertiesControl Panel appleton the client device. On theGeneraltab look for the fieldCo-Management capabilities. The table below contains workload values that indicate the Client Apps workload has been moved for that device. Configuring Intune Integration in the Patch My PC Publisher If you are already using Patch My PC Publisher today with your ConfigMgr/SCCM and you want to move your current software selection and configurations across to Intune, the process is simple. Firstly, you need to create an app registration in your Entra ID tenant to allow the Patch My PC Publisher to connect to Intune via the Microsoft Graph in order to create Win32 apps in Intune. The following documentation explains how to create the app registration and establish the connection in the Patch My PC Publisher:Azure App Registration | Getting Started (patchmypc.com) Once the app registration is in place, you can begin to configure Intune apps and updates. You can manually select the products and customizations, or copy your existing ConfigMgr apps and customizations from theUpdatestab. Repeat the process for the Intune Updates tab to bring across the same product selection and customizations for Intune Updates. You can find detailed information on setting up the Patch My PC Publisher for Intuneathttps://docs.patchmypc.com/installation-guides/intuneor you can also book a FREE Setup Call with one of our engineers athttps://patchmypc.com/schedule-setup-calland we can help youintegrate the Patch My PC Publisher to Intune yourenvironment. Stop targeting updates from ConfigMgr Co-managed devices are still able to receive applications and third-party updates from ConfigMgr. This may be undesirable if you have moved your Client apps and/or Windows Updates workload to Intune. If you are now using Windows Update for Business Policies from Intune to control first-party (Microsoft) updates and are also updating devices using the Win32 apps created by Patch My PC, you should consider disabling the \u201cSoftware Updates\u201d client setting for those co-managed devices. This will prevent the device from reaching out to WSUS to perform compliance scans and from receiving \u201cSoftware Update Deployments\u201d from ConfigMgr. Targeting third-party updates from both ConfigMgr and Intune is theoretically possible and will not cause any problems. The device will get updatedbutthere is no control over which platform will install the update \u2013 leading to confusion when reviewing deployment reports from either ConfigMgr or within the Intune Admin Center. Further Reading You can read more about how ConfigMgr controls the Windows Update agent with ScanSource Policy and DualScan atSCCM Co-management \u2013 Dual Scan and Scan Source Demystified \u2013 Patch My PC. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/what-is-scriptrunner/", "title": "PatchMyPC, ScriptRunner, Automation, Installation", "raw_text": "What is Patch My PC ScriptRunner? In this article we will explore what the Patch My PC ScriptRunner is and how it enables IT administrators to automate and customize the installation of third-party applications and software updates. What is PatchMyPC-Scriptrunner? PatchMyPC-ScriptRunner.exeisourwrapperthatisused to perform base application and update installations. In addition to installing and uninstalling apps, it is also responsible for any of the customisations configured from Patch My PC Publisher or Patch My PC Cloud. Is PatchMyPC-ScriptRunner.exe safe? PatchMyPC-ScriptRunner.exe is signed, ensuring its authenticity and integrity. It is signed by our EV (Extended Validation)code signing certificate. To avoid interference from security solutions, it is recommended thatPatchMyPC-ScriptRunner.exeand its associated binaries be whitelisted in ASR (Attack Surface Reduction) rules for Defender or the relevant rule for other, alternative, Endpoint Detection and Response (EDR) solutions:- NotificationLocalization.xml PatchMyPC-Enum.dll PatchMyPC-Localization.dll PatchMyPC-Models.dll PatchMyPC-PreventStart.exe PatchMyPC-Sccm.dll PatchMyPC-ScriptRunner.exe PatchMyPC-UINotification.exe Note:Additionally, some directories such as CCMCache and IMECache, where PatchMyPC-ScriptRunner.exe and its associated binaries are temporarily stored during an installation or update, should also be whitelisted to ensure successful application and update deployment. All Patch My PC recommended anti-virus exclusions are listed atPatch My PC \u2013 Recommended antivirus exclusions What does PatchMyPC-ScriptRunner do? PatchMyPC-ScriptRunner.exe plays a pivotal role in the Patch My PC solution. Its core responsibility is to install and update applications published via the Patch My PC Publisher. This involves executing installation commands, handling updates, and ensuring that the software is correctly deployed on target systems. Contextual OperationsWhether running as a standard user, an admin, or with SYSTEM-level permissions, ScriptRunner knows the difference and applies the appropriate settings. Command ExecutionScriptRunner uses a set of instructions (commands) referenced from various XML files to install or update software, ensuring the installation or update is performed as predetermined by the administrator. Manage Conflicting ProcessIf you use the Patch My PC feature\u2018manage conflicting processes\u2019, then ScriptRunner will also impersonate the user in order to launch a UI to ask the user to close the app in order for the update to be installed successfully. ScriptRunner checks for running processes that might interfere with the installation or update of software. If such processes are detected, ScriptRunner can prompt the user to close them, using components likePatchMyPC-UINotification.exeandNotificationLocalization.xml. ScriptRunner displays notifications to users, asking them to close the conflicting applications to proceed with the installation. Note:As ScriptRunner walks the running process list on a device to understand if an application should be closed in order for the update to be successful, it will inevitabilty touch LSASS.exe (Local Security Authority Subsystem Service). Some admins might have to make an exception to the the ASR rule\u201cBlock credential stealing from the Windows local security authority subsystem (lsass.exe)\u201d.You can read more about how this ASR rule can interfer with the manage conflicting processes feature atWindows Defender Exploit Guard breaks Google Chrome \u2013 Patch Tuesday Blog Available Customizations By leveraging our own wrapper, ScriptRunner, we can perform customized installations of applications and updates, over and above what the vendor offers natively, by deploying helper files with every application or update we publish. Customizations can include deleting the desktop shortcut, adding additional parameters for the installation, promptingusers to close conflicting apps, running custom scripts, etc. A full list of customizations that we offer within our tooling is documented atRight-Click Options Available for Updates and Applications \u2013 Patch My PC Diving Deeper You may come across a files calledpackage.xmlin the installation source folder for apps and updates that have been packaged by Patch My PC. ScriptRunner will use the content of this XML file to understand how it should customize the installation. In the above example,PatchMyPC-ScriptRunner.exewill call msiexec.exe and use the following parameters to customise the installation:- /MainFile=InventoryExtensions.msi /MainArg=REBOOT=ReallySuppress\u00ff\u201d/LoggingSwitch=/lv* {path}\u201d\u00ff/LoggingPath=C:\\Windows\\CCM\\LogsPatchMyPCInstallLogs\u00ff/LogRetentionDays=28 Some of the parameters aboveareunderstood by msiexec and othersareunderstood byPatchMyPC-ScriptRunner.exe. Logging ScriptRunner keeps logs of everything it does helping you track what happened during installations and troubleshoot any issues that arise. You can also enable verbose logs for all the MSI installers that support it and detailed logs will be generated that will definitely help in troubleshooting installation failures, or stuck deployment. References Troubleshoot Win32 apps in Microsoft Intune | Microsoft Learn Right-Click Options Available for Updates and Applications \u2013 Patch My PC Manage Conflicting Processes when Updating Third-Party Applications \u2013 Patch My PC Third-Party Patch Management for ConfigMgr and Intune \u2013 Patch My PC Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-disk-space-error/", "title": "WSUS Space Error Resolution", "raw_text": "An error occurred while publishing an update to WSUS: There is not enough space on the disk. In this article, we\u2019re going to review a common error code that can occur when the drive theWSUSContentfolder is located on has no more free space available. Determine if you are affected Resolution 1: Extend the disk to have more free space Resolution 2: Move the WSUSContent folder to a new drive Resolution 3: Cleanup unneeded update files from UpdateServicePackages Determine if you are affected If you are affected by this error, you will see errors similar to the errors below in thePatchMyPC.log,SMS_ISVUPDATES_SYNCAGENT.log, orSoftwareDistribution.log. The actual log file you see the error in may vary depending on thePublishing methodyou are using. An error occurred while publishing an update to WSUS: There is not enough space on the disk. Check if the drivehosting the WSUSContentfolder haslow disk space: Resolution 1: Extend the disk to have more free space The first possible resolution is toadd more disk space to the existing drive.This operation can be performed on virtual machines pretty easily, for example. Resolution 2: Move the WSUSContent folder to a new drive The second option is tomove the WSUSContent folder to a completely different drive. This can be performed using the WSUSUtil.exe tool that comes with WSUS. For a complete guide on moving the WSUSContent folder see:How to Move the WSUS Content Folder to a New Location Resolution 3: Cleanup unneeded update files from UpdateServicePackages Another option is to delete unneeded updates files in theUpdateServicePackagesfolder. A full guide is available atHow to Clean Up Third-Party Updates from the WSUS UpdateServicesPackages Folder. This operation can often save a lot of space on the drive hosting the WSUS content files. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/could-not-find-part-path/", "title": "WSUS errors, Schema folder, PatchMyPC", "raw_text": "Could not find a part of the path \u2018C:Program FilesUpdate ServicesSchemabaseapplicabilityrules.xsd\u2019 The error messageAn error occurred while parsing XML node of the catalog: Could not find a part of the path \u2018C:\\Program Files\\Update Services\\Schema\\baseapplicabilityrules.xsd\u2019will occur when theSchemafolder has been deleted from the WSUS installation directory. Determine if You are Affected If you are affected by this error, you will see the following errors in thePatchMyPC.logfile. An error occurred while parsing XML node of the catalog: Could not find a part of the path \u2018C:\\Program Files\\Update Services\\Schema\\baseapplicabilityrules.xsd\u2019. ] Root Cause for Missing Schema Folder Error This error can occur when theSchemafolder is deleted from theWSUS installation directory(Default path: C:\\Program Files\\Update Services). This error doesn\u2019t occur often, and we don\u2019t have any root cause of what may have caused the deletion of the folder for affected customers. In the example below, you can see there isno Schema folderin the Update Services folder. Resolution for Missing Schema Folder Error The resolution for this error is to restore theSchemafolder toC:\\Program Files\\Update Servicesfrom a valid WSUS installation. For easy access, we have attached the Schema folders from a few different versions of Windows Server. WSUS Schema Folder \u2013 Windows Server 2019 Download WSUS Schema Folder \u2013 Windows Server 2012 R2 Download Once the folder is copied to the WSUS server,restart the WSUS ServiceandPatchMyPCService. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/backup-restore-publisher-settings/", "title": "Publisher Settings Backup Restore", "raw_text": "Backup and Restore Publisher Settings or Migrating Publisher to a New Machine In this article, we are going to review the options available tobackupandrestorethe settings in the Patch My PCPublisher. The publisher\u2019s settings are stored in the%InstallDir%\\Settings.xmlfile. Backup the Publisher Settings By default, the Publisher willautomatically store the last 50 settings .cab filesin the%InstallDir%Backupdirectory. The automatic local backup of the Publishers settings to a local.cabfile can be helpful if there was a setting change made by accident, or you want to revert to a previous configuration on the same server. In theadvancedtab, you can also enableautomatic backup to a custom folder. This option will allow you to save the latest.cabin a custom folder automatically. For example, you could choose a remote network share so settings could be restored if the server running the Publisher crashed. You can also manually export the current settings to a.cabusing theExport settings to a file buttonin theAdvancedtab. Restore the Publisher Settings From theAdvancedtab, you can import any valid.cabfile saved from a backup. Click theImport settings from a filebutton in the Advanced tab. Once imported, you should see an import settings message box with anOKbutton. Please be aware although the settings will be reflected in the Publisher\u2019s UI, the settings will not take effect until you clickApply. Important:Please be aware that if you arerestoring the setting backup to a new machine, there are a few settings that you will need to update after the settings import manually if they were configured. The following settings will need to be manually updated: Entra ID app registration secret Proxy password SMS Provider connection account SMTP email password SQL connection account Webhooks specified for alerts Manage Conflicting Processes custom banner image If you are also referencing files on disk for features like the Local Content Repository, MST files, pre/post scripts, it is important that these folders and files are either accessible from, or manually brought over to, the new machine \u2013 preserving the original path. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-customize-your-teamviewer-app/", "title": "TeamViewer configuration, Patch My PC, MSI installer", "raw_text": "How to customize your TeamViewer App or Update Many applications have configuration options available where you can pass parameters, transformation files, or configuration files, to the installer in order to set user defaults, configuration, or install license keys. This article will provide instructions on configuring applications or updates using the Patch My PC Publisher using the right click optionsModify command line,Add MST transformation file, andAdd custom pre/post scripts. In order to understand how software can be customized via command line, mst file, or configuration file, please refer to the software vendor\u2019s documentation. Scenarios: For this guide, we will configure the TeamViewer full client for mass deployment on Windows Devices using the Patch My PC Publishing Tool.We will cover the following scenarios: Scenario 1 \u2013 Pass Parameters to the MSI/EXE installer Scenario 2 \u2013 Add a transformation file Scenario 3 \u2013 Pass a custom TeamViewer Options File (*.tvopt) to the installer Note:This KB article applies to the TeamViewer MSI installer.The TeamViewer MSI installer cannot be downloaded automatically using the Patch My PC Publishing tool, as it is not publicly available for download. You will have to manually download the installer and place it in thelocal content repository. Scenario 1: Pass parameters to the TeamViewer installer 1. Right click your TeamViewer app or update from within the Patch My PC Publisher and select theModify command lineoption: 2. Add your desired arguments here. If you are unsure what parameters to enter here, please refer toTeamViewer\u2019s documentation(or the software vendor\u2019s documentation if you\u2019re following along and not working with TeamViewer). Note:Any arguments you add here will be appended to the default arguments we apply. You can see what arguments we apply by default by right clicking on a product and choosingShow package info: title, command-line, download URL, etc. 3. Synchronize the Patch My PC Publisher For Intune Apps/Updates, please delete the package in Intune before syncing For everything else, syncing the Publisher alone is sufficient 4. Once the deployment is received on an endpoint, you will see the below log lines in PatchMyPC-ScriptRunner.log. Scenario 2: Add a transformation file 1. Right click your TeamViewer app or update from within the Patch My PC Publisher and select theAdd MST transformation fileoption. 2. Synchronize the Patch My PC Publisher For ConfigMgr/WSUS software updates, you mustrepublish the update. For ConfigMgr Apps, syncing the Publisher alone is sufficient. For Intune Apps/Updates, please delete the package in Intune before syncing. 3. Once the deployment is received on an endpoint, you will see the below log lines in PatchMyPC-ScriptRunner.log and content in ccmcache / IMECache / SoftwareDistribution. Scenario 3: Pass a custom TeamViewer Options File (*.tvopt) to the installer For this scenario, we will need to use a combination of theModify command lineoption (seeScenario 1), and theAdd custom pre/post scriptsoption to include the options file within the package. 1. Firstly, let\u2019s select the TeamViewer options file, and add it. Right-click the desired TeamViewer version, and select theAdd custom pre/post scriptsoption. 2. In theAdditional Filessection, browse and select your file, then confirm withOK. You don\u2019t need to add anything else here. 3. Now follow the steps fromScenario 1to add the custom parameter for specifying TeamViewer Options files. Here we will make use of the%CurrentDir%special variable within the Patch My PC Publisher in order to provide a valid path to the .tvopt file during installation. 4. Synchronize the Patch My PC Publisher For ConfigMgr/WSUS software updates, you mustrepublish the update. For ConfigMgr Apps, syncing the Publisher alone is sufficient For Intune Apps/Updates, please delete the package in Intune before syncing 5. Once the deployment is received on an endpoint, you will see the below log lines in PatchMyPC-ScriptRunner.log and content in ccmcache / IMECache / SoftwareDistribution. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-sign-package-error-was/", "title": "WSUS Content Folder Error, Package Signing Failure", "raw_text": "Failed to sign package; error was: 2147942403 When publishing third-party updates, a common error our customer may encounter is error code2147942403. The most common reason this error will occur is when theWSUSContentfolder from theregistryis different than theSUSDB database. Error2147942403=The system cannot find the path specified. Determine if You are Affected Depending on the method you are using to publish updates to WSUS, you will see one of the following errors in thePatchMyPC.log,SMS_ISVUPDATES_SYNCAGENT.log,orSoftareDistribution.log An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147942403 Error signing cab file: %Path%fdfec4101f23f3c1d1b9-6c38-4a7a-855c-d4e4746be71c_1.cab, result: 2147942403 Troubleshooting Step 1: Validate the WSUS Content Folder in the Registry Matches the SUSDB The first step we recommend is validating the WSUS folders are defined correctly, and the values in theregistrymatch the values in thedatabase (SUSDB). To check the WSUSContentDirin theRegistrycheck: HKLM\\SOFTWARE\\Microsoft\\Update Services\\Server\\Setup:ContentDir To check thevaluein theSUSDBrun the following query in SQL Management Studio against the SUSDB: SelectLocalContentCacheLocationfromtbConfigurationB Ensure the pathsresolve to the same root folderas shown below: Troubleshooting Step 2: If LocalContentCacheLocation Database Value doesn\u2019t Match ContentDir RegKey If the database value forLocalContentCacheLocationmatchestheContentDirthis step can be skipped. If the values do not match, please proceed below: Here\u2019s an example where the WSUS content directory is different and incorrect in the database: The safest method to correct the value in the database would be to perform a WSUS Content move to the correct directory using the KB:How to Move the WSUS Content Folder to a New Location If the value iscorrect in the registryand only thedatabase value is wrong, commonly occurs when youset up a second SUP with a different WSUS Content folder and used the same SUSDB. You may be able to correct the issue by editing the value forLocalContentCacheLocation. In the example below, theincorrectvalue in the database was: \u2018C:\\WSUS\\WsusContent\u2019 when the expected value should be: \u2018J:\\WSUS\\WsusContent\u2019 To change the path in the scenario above you could run the following SQL command against the SUSDB: UpdatetbConfigurationBSetLocalContentCacheLocation =\u2018J:\\WSUS\\WsusContent\u2019 Note:A common reason theContentDirregistry value andLocalContentCacheLocationvalue may not match is that a second SUP/WSUS has been added thatshared the same SUSDB, but the value for the WSUSContent folder was configured to a different directory than the primary software update. When third-party updates are published, the authoritative path used is the value defined in theLocalContentCacheLocationin the SUSDB, and not the path defined in theContentDirregistry value. Troubleshooting Step 3: Validate the WSUSContent and UpdateServicesPackages Folder Exist Validate theWSUSContentandUpdateServicesPackagesexist and are shared as shown below: If the folders or shares do not exist please seeCreateDirectory failed Error when Publishing Third-Party Updates | Patch My PC Resolution for Error 2147942403 when Publishing Third-Party Updates (Video Version) Please review the video guide below for the resolution for error \u201c2147942403\u201d Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-patch-my-pc-handles/", "title": "Patch My PC, Multiple Versions, Supported Applications, Update Rules", "raw_text": "How Patch My PC Handles Products with Multiple Versions Some applications within the Patch My PC Catalog have multiple versions that are all supported at the same time. This article will explain how Patch My PC supports updates for these applications and general rules for working with these applications and updates. Topic 1: Determining Products with Multiple Supported Versions Patch My PC supports a wide variety of applications and updates, some of the applications in the Patch My PC catalog support multiple major versions or tracks at the same time. Patch My PC attempts to support these multiple versions where possible. To determine Patch My PC products with multiple supported versions, look for a version number specified at the end of the product name in the Patch My PC Publisher. If using SCUP or the ConfigMgr built-in 3rd party updates feature, the category usually will specify the version number as well. For Patch My PC Updates (WSUS and Intune Updates) where the version is specified in the Publisher, the following applies: Patch My PC will not upgrade an older version of the software if it is older than the version specified in the Publisher Patch My PC will attempt to provide the latest available release of the version specified in the Publisher Note:To upgrade to a newer major version of a version locked app, deploy the ConfigMgr or Intune Application to the devices to be updated instead of the WSUS or Intune Update. Applications to not have version requirements for installs. Additionally the \u201cLatest\u201d designated update as described in this KB article can also be utilized to upgrade version locked applications (if available). Topic 2: List of Products Where Multiple Versions are Supported Topic 3: \u201cLatest\u201d Version Designation for Patch My PC Products Applications and Updates in Patch My PC with the word \u201cLatest\u201d in the product name willalwaysinstall the latest version of the specified application on devices whereanyolder version of the specified application is found. These Applications and Updates will also usually include a Pre-Script that will remove any older version of the software if found. Tips for \u201cLatest\u201d Version Designation Products: Patch My PC Products with the \u201cLatest\u201d version designation will never be auto-enabled via the database scan features. They must be manually selected in order to be published. Target updates with the \u201cLatest\u201d designation to a specific group of devices where the major version upgrade is to be performed Filter updates with a title containing the word \u201cLatest\u201d from ADRs for Patch my PC Updates, this will ensure that \u201cLatest\u201d version designated products are not accidentally deployed to all systems and can prevent unwanted upgrades. Topic 4: List of Products with \u201cLatest\u201d Version Behavior Available Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/delaying-configmgr-base-application-updates/", "title": "ConfigMgr updates, Delayed Updates, Patch My PC, ConfigMgr Publisher", "raw_text": "Delaying ConfigMgr Base Application Updates This article will explain the process of delaying the update of ConfigMgr base applications in the Patch My PC Publisher. Set the number of days to delay the application update In the Publisher, head to theConfigMgr Appstab and clickOptions. For the option highlighted below, you can set the number of days to delay updating base install ConfigMgr Applications published through the Patch My PC Publishing Service. This setting delaysallApplications published through the Publisher. How the delay works Each product in the catalog has a creation date which represents the date the product was added. When the Publisher syncs, each product\u2019s creation date is compared to the current date. Thedifference in days between the creation date and current date is compared to the configured delay. If the configured delay is met or exceeded then the application will be updated during that sync. If the delay is not met or exceeded then a subfolder is created under thePostponedBinariesfolder in the installation directory of the Publisher. Each delayed application will have its own folder containing the postponed binary as well as additional files with relevant metadata and update information. Below are three example scenarios of a delayed application update. Example 1: The Publisher syncs the same day the update is released The publisher is set to sync daily at 7:00 pm. The delay is configured to 3 days. On January 15th an update for Postman is released at 5:00 pm. On January 15th at 7:00 pm the Publisher syncs. A subfolder is created under the PostponedBinaries folder for Postman. Each day during the sync thecreated dateof the Postman subfolder is compared to the current date and the difference in days is checked against the configured delay. On January 16th and 17th, the delay is not met. On January 18th the delay is met and the application is updated in ConfigMgr using the postponed binaries. Example 2: The Publisher syncs the day after the update is released The publisher is set to sync daily at 7:00 pm. The delay is configured to 3 days. On January 15th at 7:00 pm the Publisher syncs. On January 15th an update for Postman is released at 8:00 pm. On January 16th at 7:00 pm the Publisher syncs. A subfolder is created under the PostponedBinaries folder for Postman. Each day during the sync thecreated dateof the Postman subfolder is compared to the current date and the difference in days is checked against the configured delay. On January 16th, 17th, and 18th the delay is not met. On January 19th the delay is met and the application is updated in ConfigMgr using the postponed binaries. Example 3: The Publisher syncs after the delay has been exceeded The publisher is set to sync Monthly on the 15th at 7:00 pm. The delay is configured to 3 days. On January 10th an update for Postman is released at 8:00 pm. On January 15th at 7:00 pm the Publisher syncs. The difference between January 10th and 15th is 5 days, exceeding the configured 3-day delay. The delay is exceeded and the application is updated in ConfigMgr, bypassing the postpone process. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/cve-import-matching/", "title": "CVE Import Wizard, Bulk Matching, Security Vulnerability, Patch Management", "raw_text": "How the CVE Import Wizard Works for Matching CVE IDs The ability tobulk matchCommon Vulnerabilities and Exposures (CVEs) has been a popular request on ourUserVoice. We\u2019re excited to release ourCVE Import Wizardfeature that will allow you to bulk match a list of CVEs from aCSVorTextfile and display details about the status of the CVEs in the document. The Basics of the CVE Import Wizard Our CVE Import Wizard is designed tohelp track the status of a list of CVEs. The most common use case is a security team will provide a .CSV file containing a list of CVEs for tracking. Our tool will then query thefollowing data sourcesto determine if the CVE has any matches: Software updates already published to WSUS/SCCM All available updates in our third-party update catalog metadata The CVE scan will quickly allow you tobulk match a list of CVEsto understand if the fix for the security vulnerability is available from Patch My PC or if you may need to resolve the vulnerability using another mechanism. How the CVE Import Wizard Works To open the CVE Import Wizard, go to theUpdatestab in the Publisher and click theSecurity Documentbutton. Click theBrowse\u2026button to select a CSV file containing a list of CVE IDs and then clickProcess. After the processing is complete, you will see the list of all CVE IDs detected in the table grouped by the state. Available= An update is available within the catalog, but it is not published within your environment yet. Published= The update is already published to WSUS/SCCM and is available for deployment. Unavailable= No update is published that contains that CVE ID and there is no update in our catalog matching it. Here\u2019s an example of a CSV file that contained15 CVE IDswithin it. You can also check the checkbox toGroup By Products. When enabled, the wizard willgroup the list of CVE IDs to the Productthat had a match for that CVE ID. Importing Available Updates Matching CVE IDs One importantactionable itemin the CVE Import Wizard is publishingthird-party updates on-demandbased on the scan results. If updates are in anAvailablestate, they can be selected and published on-demand. You can either individually select updates in anAvailablestate or click theSelect All Availablebutton. Once you have selected the updates you want to publish-on-demand, you can click theImport Selected Patches. After clicking the Import Selected Patches button, you will receive a dialog box to monitor thePatchMyPC.log file. ThePatchMyPC.logfile will show the selected updates being published. Note:Even if the product for a selected update isn\u2019t enabled in theUpdatestab, any update selected in the CVE Import Wizard will beautomatically published on-demandif the Import Selected Patches is clicked. Alerts for On-Demand Importing of Patches for CVEs When using the Import Select Patches options, you will receive anemail alertafter the synchronization of selected updates is complete ifSMTP emails are enabled. The email will contain important details about the CVE ID scan against the CSV file. IfMicrosoft Teams alerts are enabled, you will receive normal teams alerts for any published updatesin real-timeas shown below: Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/failed-create-self-signed-certificate/", "title": "Failed Certificate Creation, Windows Server Update Services, WSUS Error", "raw_text": "Failed to create a self-signed certificate: Cannot save configuration because the server is still processing a previous configuration change In this article, we will review why the error above is received when you attempt to generate a self-signed certificate with the Publisher. Determine if you are affected You may receive the following dialogue box when you attempt to generate a self-signed certificate using the Patch My PC Publisher. PatchMyPC.logwill indicate:- An error occured while extracting the certificate from WSUS: C:\\UsersAppData\\Local\\TempPMP-xxxxxxxxxxxxxxx.tmp : The system cannot find the file specified Failed to extract the certificate from WSUS SoftwareDistribution.logwill indicate:- Discarding stack trace for user DOMAIN, IP Address ::1, exception System.ComponentModel.Win32Exception (0x80004005): The system cannot find the file specified SqlException occurred. Number 50000 and message spSetConfiguration was called while a Reset Process was Needed/InProgress cannot change Configuration at this time Discarding stack trace for user DOMAIN, IP Address ::1, exception System.InvalidOperationException: Cannot save configuration because the server is still processing a previous Reason This error generally occurs when WSUS is \u201cbusy\u201d running another stored procedure. The excerpt below is the result of a recentwsusutil movecontentcommand being run.SoftwareDistribution.logindicates that WSUS is attempting to validate the calculated hash for each update in the database. Until this reconciliation has completed, we cannot use the Publisher to generate a self-signed certificate. Workaround The Publisher utilises the WSUS API to create a self-signed certificate with an exportable private key. If WSUS is running a stored procedure, the Publisher won\u2019t be able to create a self-signed certifiacte with an exportable key until the current stored procedure has completed. Option 1 If you have recently attempted to run awsusutilreset, orwsusutil movecontentcommand, you may need to wait for that stored procedure to complete before you can run other commands against WSUS. You can check theSoftwareDistribution.logto understand what stored procedures are running against the WSUS database. Option 2 If you do not want to wait for the current stored procedure to complete you can still use the Publisher to generate a self-signed code signing certificate but you would need to disable the private key export. There is not the same reliance on the WSUS API when generating a self-signed certificate without an exportable private key. To genereate a self-signed certificate, from the Publisher, without marking the private key as exportable, you should:- On theGeneraltab in the Publisher, clickGenerate a Self-Signed Certificate Check theDisable Private Key Exportcheck-box ClickGenerate Certificate Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/update-publishing-fails-when-proxy/", "title": "Proxy, Timestamping, Publishing, Fail", "raw_text": "Update Publishing Fails When Proxy is in Use, and Timestamping is Enabled The most common publishing failure we see is related to proxies and timestamping. We will be reviewing in detail why this scenario can cause issues and how to fix it! Determine if You are Affected by This Scenario Below is a list of possible error codes that may be returned in thePatchMyPC.log. The actual error code you see will depend onhow the proxy/firewall handles HTTP web requests with no proxy defined. Error Codes: An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954402 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954429 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954430 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2147954407 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2148086027 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2149122451 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2149122455 An error occurred while publishing an update to WSUS: Failed to sign package; error was: 2149122449 Additional Details: 2147954402 = The operation timed out2147954429 = A connection with the server could not be established2147954407 = The server name or address could not be resolved2148086027 = ASN1 bad tag value met.2149122451 = Forbidden (403).2149122455 = Proxy authentication required (407).2149122449 = Unauthorized (401). A Little Background on This Error Within our publishing service, we always havetimestampingenabled by default, as shown in the image below. By enabling timestamping, it allows clients to trust updates published even after the code-signing certificate has expired. For example, the example below shows a WSUS Signing Certificate that expires onMay 20, 2023. If timestamping is enabled, clients will trust updates even if they are installed after the expiration date. In thePatchMyPC.log, you can also see the timestamping during the publishing attempt. Why Publishing May Fail when Timestamping One issue that can arise here is related to the way the WSUS publishing API performs the timestamping operation during the publishing. The WSUS API uses theWindows CryptoAPIto perform the timestamp on the updates CAB file. The CryptoAPI uses the proxy defined at theSYSTEM levelon the WSUS server. Because of this, the publishing operation with timestamping can often error out when a proxy is required for internet access. So, even if the proxy is defined within our publishing service or on-site system in Configuration Manager, it will not be used during the publishing operating for timestamping. Workaround 1 \u2013 Set the SYSTEM Level Proxy Using PSEXEC and Internet Explorer To resolve this issue, you will need to configure the proxy at the SYSTEM level on the server. The easiest method to change the proxy at the SYSTEM level is using PSEXEC.exe and Internet Explorer. Download PSEXEC.exe fromhttps://live.sysinternals.com/ Open command prompt as Administrator Launch Internet Explorer as SYSTEM using command line:psexec.exe -s -i \u201cC:\\Program Files\\internet exploreriexplore.exe\u201d In Internet Explorer to Settings > Connections > LAN Settings > Enable \u201cUse a proxy server for your LAN\u201d, configure the IP Address and port, click OK, and close IE Workaround 2 \u2013 Set the SYSTEM Level Proxy Using netsh If you prefer not to use PsExec, or it\u2019s not permitted for use in your organization, you can configure your server\u2019s winhttp proxy usingnetsh. Launch Command Prompt as administrator (cmd.exe) Run the following command line (where the server name and port are set for your environment:) Note:The netsh command doesn\u2019t allow the configuration of explicit authentication to a proxy server. If your proxy server is configured for explicit authentication we recommend making an allowance for the machine account where the publisher is installed. Workaround 3 \u2013 Disable Timestamping Within the Publishing Service Although it\u2019s probably not the best long-term solution, you candisable timestampingwithin the publishing service. Disabling timestamping can also be an excellent method to test if it\u2019s the timestamping operation causing the updates to fail to publish. If you are disabling timestamping for testing purposes, we recommend you only publish a single product such as 7-Zip. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-remove-third-party-updates/", "title": "WSUS, SCCM, Decline, Delete", "raw_text": "How to Remove Third-Party Updates from WSUS and SCCM To remove a third-party update from WSUS, you can eitherdeclineordeletethe update completely. We will review how to delete or decline third-party updates in this article. Option 1: Decline the Third-Party Updates from WSUS and SCCM The first option to remove a third-party software update is todeclineit. When youdecline an update, clients will no longer scan against the update, and it willshow expired in Configuration Manager. To decline a third-party update, perform thefollowing steps: Open theModify Published Updates Wizardfrom the Updates (tab) > Options (button) in thePublisher. Checkthe updates to decline from WSUS, and clickDecline ClickCloseon the dialog box that list the status of the declining operation. After the updates aredeclined in the Publisher, you can manuallysync your software update pointin SCCM for the changes to occur immediately. After the software update point sync is complete, you should see thedeclined updates show as expiredin SCCM and will no longer be deployed. In the example below, you can see the declined 7-Zip updates show expired. Note:Expired updates will be automatically purged from the Configuration Manager after7 days. Option 2: Delete the Third-Party Updates from WSUS and SCCM The second option is todelete the updatecompletely from WSUS. The delete option isnot recommended in most scenariosas it can cause hash issues if the deleted updates are ever published again. As a result, wedon\u2019t enable the Delete buttonby default. To enable the delete button, you need to set the following registry value: HKEY_LOCAL_MACHINE\\Software\\Patch My PC Publishing Service:EnableDeleteUpdates= 1 (REG_DWORD) Note:Thedelete optionmay be a help if you need to delete updates to clean up the UpdateServicePackages folder:How to Clean Up Third-Party Updates from the WSUS UpdateServicesPackages Folder Todeletean update after setting theEnableDeleteUpdatesregistry value, open theModify Published Updates Wizardfrom the Updates (tab) > Options (button) in thePublisher. Checkthe updates to delete from WSUS, and clickDelete After the updates aredeleted in the Publisher, you can manuallysync your software update pointin SCCM for the changes to occur immediately. After the software update point sync is complete, you should see thedeleted updates show as expiredin SCCM and will no longer be deployed. In the example below, you can see the deleted 7-Zip updates show expired. Note:Expired updates will be automatically purged from the Configuration Manager after7 days. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-clean-up-third-party/", "title": "WSUS Content Folder, WSUS UpdateServicesPackages, Declined Updates, Cleanup Operation", "raw_text": "How to Clean Up Third-Party Updates from the WSUS UpdateServicesPackages Folder This article and video will describe the steps required to clean up obsolete/declined updates from the WSUS Database and how to properly remove the content folders for these updates from theUpdateServicesPackagesfolder. What is the WSUS Content Folder TheWSUSContentfolder is the folder where published third-party updates (.CAB files) are stored. TheWSUSContentfolder maps to theContentvirtual directly in theWSUS Administrationwebsite. TheContentvirtual directory is where the updates are downloaded by clients or downloaded to a Configuration Manager deployment package. If you review theContentvirtual directory in IIS, you can see how it maps to the WSUSContent directory on the file system. When reviewing theContent Informationtab in the properties of a software update in Configuration Manager, you can view the download path for the third-party update from theWSUSContentfolder. If you enabled theWSUS Maintenancefeature in Configuration Manager 1906 or newer, older declined update content should be removed automatically. For a deeper look into theWSUSContent, please review the video guide below. What is the WSUS UpdateServicesPackages Folder TheUpdateServicesPackagesfolder is used primarily for third-party update publishing operations. It\u2019s common for theUpdateServicesPackagesto become bloated with content from obsolete updates. Each folder within theUpdateServicesPackagescorresponds to a third-party update and contains the content downloaded from the vendor and the digitally signed CAB file used for a specific UpdateID. In the folder93171a38-662f-47a7-92c1-4862cbf16146, from the screenshot above, you can find the original binaries downloaded from the vendor for the software update. For a deeper look into theUpdateServicesPackagesand how to clean up obsolete updates from this directory, please review the video guide below. Automatically Cleanup Declined/Deleted Updates from the UpdateServicesPackages Folder Inbuild 2.0.7 of the Publisher, we added a feature to run the UpdateServicesPackages cleanup automatically based onUserVoice idea 797. When enabled, this feature willautomatically delete any declined third-party updates from Patch My PCand thendelete any unreferenced update foldersfrom the UpdateServicesPackages folder. By default, we only delete declined updates for \u201cPatch My PC\u201d updates. If you would like, you can uncheck \u201cOnly delete declined Patch My PC third-party updates.\u201c. When unchecked, we will also delete third-party updates for declined updates of other vendors such as Dell, HP, Lenovo, etc. You also have the option toAutomatically run the Unneeded files clean action in the WSUS Server Cleanup Wizard.This will help clean up the WSUS content folder. Note:If you have downstream WSUS servers that do not share the same SUSDB you may want to disable the automatic deletion and cleanup feature. Update cleanup in a WSUS infrastructure should be performed from the bottom up per bullet 2 in theMicrosoft documentation. Video Guide on Manually Deleting Obsolete Update Content from the UpdateServicesPackages Folder Please review the video guide below for a deep dive into how to properly clean up unreferenced updates from theUpdateServicesPackages. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/error-code-193-subscribing-sccm/", "title": "Error Code, SCCM Catalog, Third Party Updates", "raw_text": "Error Code 193 When Adding Patch My PC Catalog to SCCM? In this post, we will cover an issue you might encounter when trying to subscribe to our third-party software update catalog in Microsoft System Center Configuration Manager. When attempting to subscribe to the custom catalog added for your subscription to Patch My PC, configuration manager will show the following error message \u201cUnable to create the subscription. The console failed to download the catalog from (URL) because oferror code 193.\u201d Why does this happen? This will happens when you are only subscribed to theBasic subscriptionor your subscription hasexpired. This basic subscription is only compatible withMicrosoft System Center Updates Publisher (SCUP)and not the third-party software update catalogsfeature in SCCM 1806 and newer. Why does the Catalog Cost More for SCCM? One of our primary goals is to ensure we provide an affordable solution for third-party patch management in SCCM, so it\u2019s important to address why theEnterprise Subscriptionis required to support SCCMin-console publishing. The reason is related to a new catalog format required for SCCM to support importing and publishing the catalog. The new catalog format is more complex form an engineering perspective. This new format causes overhead for every catalog release. If we take a look into the new catalog format, you will notice there is a new folder called \u201cContentCertificates\u201d Whenever we release a new catalog update, we need to ensure we include every certificate used to sign all update binary files within oursupported productsfor our catalog. The added content certificates allow SCCM to have a layer of trust when publishing all third-party update content. There are currently around 119 certificates we need to manage and maintain when new certificates are used to code-sign update files. Since SCCM doesn\u2019t support any filtering when publishing updates from a catalog, we wanted to ensure we came up with a solution that allows our customers to publish specific products while using our catalog with SCCM. We came up with an optional parameter you can use for onlyimporting specific products into SCCM. The solution for importing the catalog by product requires us to manage a separate catalog for each product on our backend. Whenever new products are updated, we need to maintain the main catalog in addition to a catalog for each product and the content certificates required for each product catalog. We currently support over 150 unique products. Microsoft released av3 catalog formatthat includes filtering options and options for staging content. This new format requires significant work on our end to maintain. Wrapping Up? Hopefully, this has been helpful, and you understand why we decided to require the \u201cCatalog + Automation\u201d subscription to use our catalog with Microsoft SCCM. The \u201cCatalog + Automation\u201d subscription will also allow you to alternatively use ourpublishing servicethat allows more customization such as killing application processes, skipping the update if the application is running, adding custompre/post scripts, and we are working on more awesome features! Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/remote-wsus-connection-not-https/", "title": "Remote WSUS connection HTTPS Certificate", "raw_text": "Remote WSUS connection is not HTTPS. This prevents software update point from getting the signing certificate for third-party updates. Since the release of Configuration Manager 1806, some customers report that theWSUS signing certificateisn\u2019t being populated in theThird Party Updates tabof the software update point. It occurs even when the optionConfiguration Manager manages the certificateis enabled. Configuration Manager Manages the Certificate Overview The option to haveConfiguration Manager manages the certificatewill allow ConfigMgr to create a self-signed WSUS signing certificate or todeploy an existing signing certificate. More details about the option toAutomatically manage the WSUS signing certificatecan be found onMicrosoft Docs Why\u2019s Does This Option Not Work? The most common reason why the WSUS signing certificate doesn\u2019t automatically get generated during a software update point synchronization (wsyncmgr.log) is that the software update point site system role is remote from your site server and theremote WSUS server isn\u2019t configured for HTTPS. For example, in the screenshot belowSCCM3-DPMPSUP-1is our Software update point and it\u2019s remote from the primary site serverSCCM3-SITESVR-2 When your software update point is remote from your site server, the optionConfiguration Manager managed the certificatewill only work if the WSUS/SUP is configured for HTTPS/SSL as described in theMicrosoft Docs. If the WSUS server doesn\u2019t have aweb server certificateand hasn\u2019t been properlyenabled for SSL, you will see the following warning in thewsyncmgr.logduring a synchronization. Warning: Remote WSUS connection is not HTTPS. This prevents software update point from getting the signing certificate for third-party updates. Possible Resolutions for SUP not in HTTPS Mode with this Option Enabled You have two options to work around this issue: The first workaround is to create a self-signed or import a PKI-based code-signing certificate for the WSUS Signing Certificate using ourPublishing Serviceand deploy the certificate to clients using an alternative method mentionedhow to deploy the WSUS signing certificate. If you choose this method, you can change the option toManually manage the certificatein SCCM. This option will generally be the most straightforward because you won\u2019t need to request a web server certificate for WSUS and configureWSUS to use SSL. The one disadvantage to this option is clients won\u2019t have the WSUS Signing Certificate automatically deployed to their Trusted Root and Trusted Publishers certificate store natively using the SCCMclient settingto enable third-party updates. Configure the WSUS/SUP to use SSL/HTTPS to use the built-in option for Configuration Manager manages the certificate. Here are some resources that may help configure WSUS to use SSL. \u2013 PKI certificate requirements for System Center Configuration Manager \u2013 How to Configure the WSUS Web Site to Use SSL \u2013How To Configure Microsoft SCCM to Use HTTPS/PKI Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/system-error-1612-installation-source/", "title": "System Error 1612, Installation Source, Windows Installer", "raw_text": "System Error 1612 \u2013 The installation source for this product is not available. When uninstalling, repair or attempting to patch a product you may receive an error with anexit code of 1603, 1612, or 0x8024002D (-2145124307), or 0X80240022 (-2145124318). The message generated in log files or Event Viewer can indicate that the product failed to uninstall/repair/patch due to some arbitrary reason e.g. \u201cFailed to remove\u201d or \u201ccannot be removed\u201c. Determine if You Are Affected If you are lucky, you will get a more obvious clue like \u201cInstallation source for this product is not available\u201c. Here\u2019s an example of error messages we typically see in thevendor\u2019s MSI log file. Google Chrome \u2014 Error 1714. The older version of Google Chrome cannot be removed. Contact your technical support group. System Error 1612. Windows Installer installed the product. Product Name: Google Chrome. Product Version: 68.46.66. Product Language: 1033. Manufacturer: Google LLC. Installation success or error status: 1603. Error 1714.The older version of Adobe Flash Player 32 ActiveX cannot be removed. Contact your technical support group. System Error 1612. Here is an example of what you might see inWUAHandler.log: Update 1 (x) finished installing (0x8024002d), Reboot Required? No Installation job encountered some failures. Job Result = 0x80240022. The error will often be returned withexit code 1603, which can be vague or troublesome to diagnose, or sometimes it is1612 or 0x8024002D. If you run the installer manually, you will likely see an error similar toThe feature you are trying to use is on a network resource that\u2019s unavailable Root Cause for System Error 1612 (The installation source for this product is not available) The error code1612is the most helpful to determine the root cause. If you perform an error lookup in CMTrace.exe, it will returnThe installation source for this product is not available. Verify that the source exists and that you can access it. 0x8024002D (-2145124307)resolves toA full-file update could not be installed because it required the source. When an MSI-based product is uninstalled, repaired, or upgraded, the previousinstaller (.msi file) must be availableto complete the operation. Access to the original MSI generally isn\u2019t an issue because, during installation, the windows installer shouldcopy the MSI filetoC:\\Windows\\Installer. When a product is uninstalled,Windows Installerwill first try to perform the uninstall using the MSI file cached toC:\\Windows\\Installer. If the MSI filedoes not exist in C:\\Windows\\Installer, it will fall back to the original path used to perform the install. The path to the cached installer is read by Windows Installer from the registry valueLocalPackageof keyHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Products\\Install\\Properties. The path to the original source folder is read from the registry valueInstallSourceof the same registry key. You can see a Google Chrome installer (C:\\Windows\\CCMcache\\3w\\GoogleChromeStandaloneEnterprise64.msi) is installed and is in ccmcache. You can also see the file was cached toC:\\Windows\\Installer67aa2f8a.msi. It is worth noting that for repairs operations (the/fswitch ofmsiexec), we noticed that the path(s) listed in the value(s) of registry keyHKEY_CLASSES_ROOT\\Installer\\Products\\SourceList\\Netare used to find the cached or original installer, instead of the previously mentioned registry values under HKLM. If the MSI file doesn\u2019t exist in theC:\\Windows\\Installerororiginal source folder, you will receive this error. For example, we deleted both files above and attempted to uninstall or upgradeGoogle Chrome87.0.4280.88 to anything newer. You can see it\u2019s unable to perform the upgrade in this scenario since the previous version fails to uninstall due to missing installer. Note:It\u2019s common for the MSI InstallSource to not be accessible if it were in theccmcache folderand it was purged. However the primary issue is when the installer is deleted fromC:\\Windows\\Installer. You should avoid deleting any files withinC:\\Windows\\Installer. The common need to do this is to alleviate storage pressures because over time, after installing many applications, its storage capacity can be relatively large on thinly provisioned storage. Instead of deleting the files or the whole folder itself to regain storage space, it is recommended to uninstall unneeded applications. Another common cause for missing installers is with the vendors MSI installer not caching itself toC:\\Windows\\Installer. How to Resolve MSI Error 1612 / System Error 1612 During MSI Upgrade or Uninstall When you receive this error, you will needthe same version of the MSI file,and it also needs to bethe same nameas it appears in thePackageNameregistry value of keyHKEY_CLASSES_ROOT\\Installer\\Products\\SourceList(or what the file name is being prompted for by the Windows Installer dialogue as shown above). Once you have sourced the original file, you have a couple of options: If you have a small number of impacted devices, consider manually restoring and renaming the MSI file to the paths referenced in the registry (InstallSourceandLocalPackageof keyHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Products\\Install\\Properties) Otherwise, using something like Configuration Manager or Intune, you could create an application/package which downloads the file to a predictable path on disk and then update the aforementioned registry values.This method carries a significant risk of causing irreversible damageto the systems in scope. It is highly recommended you fully understand the issue and perform lots of testing before committing to this approach. A safer approach could be including a script within the application/package that tries to determine the needed paths to restore the MSI to and copies + renames it to them. A tool such asFixMissingMSIcan also be an excellent tool in this situation. It will scan the local registry for all installed MSI applications that Windows Installer knows about, and verifies the cached or original installer is still accessible on the system. If it isn\u2019t, it will clearly show you which ones are missing and offer an easy way to restore the file(s) if you have them. Alternatively, you could use consider Microsoft\u2019sProgram Install and Uninstall troubleshooter. Additional Resources Below you will find a list of additional resources related to this scenario: Windows Installer source list update fails \u2013 Configuration Manager | Microsoft Docs Can you safely delete files in the %windir%Installer directory? | Microsoft Docs Restore the missing Windows Installer cache files \u2013 SQL Server | Microsoft Docs Software Deployment : MSI cache locations and deploying with SCCM (itninja.com) Wise Packaging \u2013 Symantec Enterprise (broadcom.com) Windows Installer Error 1612 | Desktop App | Autodesk Knowledge Network Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/remove-java8-upgrade/", "title": "Java Runtime Environment, Upgrade Process, Patch My PC, Removal Scripts", "raw_text": "Remove Previous Versions of Java 8 Runtime During Upgrade This article will describe your options foruninstalling old versions of Oracle Javawhile updating Java with Patch My PC. Video Guide for Java Runtime Environment Uninstall Process Please review the step-by-step video guide for information on how to add the JRE removal during the update as a pre-update script. Note:The video shows the process of manually including pre-update scripts to remove JRE. Skip this video and readOPTION 1for the Patch My PC defined scripts. OPTION 1: Using Patch My PC Defined Scripts The Patch My PC defined scripts will allow you to automatically uninstall all versions ofJava Runtime Environment 8 (32-Bit)andJava Runtime Environment 8 (64-Bit). The defined scripts will appear as a right-click option in the Update Rules tab. For example, by default, the install forJRE 8 (32-bit)installations will remove older versions of Oracle Java 8 (x86) prior to installing the latest update. To view this script, right-click theOracle Java 8 (x86)product in ourpublishing servicesUpdate Rules tab and choose Patch My PC defined pre/post update installation scripts. The script will automatically be inserted into the Pre-Update Script box. This option is also available forOracle Java 8 (x64)andOracle Java SE Development Kit 8 (x64)/(x86). OPTION 2: Add REMOVEOUTOFDATEJRES=1 as Custom Command Line This option isNOTrecommended if your environment usesboth the (32-bit) and (64-bit) versions of JRE 8onWindows 64-bit operating systems. The reason we don\u2019t recommend it in this scenario is that theREMOVEOUTOFDATEJRES=1parameter will automaticallyremove both (32-bit) and (64-bit) JRE 8 installs regardless of the version being updated. This causes the other version to become not applicable as a software update, therefore, leaving only one installed version where a machine previously would have had both versions installed. This option shouldonly be used if you are only running a single JRE 8 architecture within your environment. For example only if you use the (32-bit) exclusively or you only use the (64-bit) exclusively. To use this method to remove previous versions during the latest JRE 8 update, right-click theOracle Java 8 (x86) /Oracle Java 8 (x64)and choose toModify command line for product. In the input box for the additional argument addREMOVEOUTOFDATEJRES=1 This command line should have theJRE 8installer automatically remove previous versions using Oracle\u2019snative installer. Note:Neither of these options is supported if you are using the SCCM 1806+ in-console publishing option rather than our publishing service. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/azure-app-registration-win32/", "title": "Azure App Registration, Intune Permissions, Graph API", "raw_text": "Configure Azure App Registration Permissions for Win32 Applications in Intune This article covers integrating the Patch My PC Publisher with yourIntune tenant. We will go over creating anapp registrationin yourAzure ADenvironment and configuring the Graph API permissions required for the Publisher to automatically create, update and assignWin32 applicationsin your Intune tenant; as well as configuring the tenant authority, application ID and application secret within the Publisher. Step 1: Registering the Patch My PC Application in Azure AD In order for our service to have permissions to your Intune tenant for application management, start by navigating to your environment\u2019sAzure AD portal, head toApp registrations,and clickNew registrationin the top left of the main pane. Give your app registration a relevant name such as \u201cPatch My PC \u2013 Intune Connector\u201d. Configure the account types base on your tenant requirements. For the Redirect URI, leave it default unless you have specific requirements for configuring the Redirect URI. Then clickRegister. Step 2: Configure API Permissions for the New Application After you register a new application, we will need to delegate certain permissions in order for the Patch My PC Publisher to create and update Win32 applications in your Intune tenant, as well as view Azure groups and create assignments for the applications automatically. Once the new app is registered, navigate to theAPI permissionsnode in the left column of the newly created app\u2019s page. In theAPI permissionspage, click the button toAdd a permission, then in the right pane that appears, select theMicrosoft GraphAPI. Then, you are prompted for what type of permissions your app requires, selectApplication permissions. In theSelect permissionstable view, search for \u201cDeviceManagement\u201d and under those permissions, enable the following: DeviceManagementApps.ReadWrite.AllView and create applications in Intune View and create applications in Intune DeviceManagementConfiguration.Read.AllView properties and relationships of assignment filters View properties and relationships of assignment filters DeviceManagementManagedDevices.Read.AllView device inventory for the auto-publish feature View device inventory for the auto-publish feature DeviceManagementRBAC.Read.AllView scopes to be assigned to applications View scopes to be assigned to applications DeviceManagementServiceConfig.ReadWrite.AllUpdate Enrollment Status Page configurations Update Enrollment Status Page configurations Then, search for \u201cGroupMember\u201d, and under Group permissions, enable: GroupMember.Read.AllView Azure AD groups to enable automatic application deployment View Azure AD groups to enable automatic application deployment ClickAdd permissions. To approve the new permissions, clickGrant admin consent for. ChooseYesif you are prompted to consent for the required permissions. You must be logged into an Azure AD account with permissions to perform this task. The result is shown below. Note:Granting admin consent may require one of the following roles:Global AdministratororPrivileged Role Administrator. Step 3: Getting the Client Secret and Application ID Now, we must add a client secret, a string that our app will use to prove its identity when requesting a token. Navigate to theCertificates & secrets nodein the left column, and click the button to add aNew client secret. Decide on a description and expiration date (in months) that best suits your organization\u2019s needs, then clickAdd. Copy theValuefor the Client Secret you created. Save this value to a secure location, you will enter the value underApplication Secretin theIntune Optionsof the Publisher. Then, navigate to theOverviewnode, and copy theApplication (client) ID. Save this value to a secure location along with your secret key value. You may receive an error similar to\u2018An error occurred while connecting to Intune: AADSTS7000215: Invalid client secret is provided.\u2019within the PatchMyPC.log file. If you receive this error pleaserepeat step 3 aboveto create a new secret, or review your existing secret configuration within the Publisher to ensure you are using the correct value. In addition to the client secret, certificate-based authentication is also available in the Patch My PC Publisher. For more information, see the Microsoft documentation for more information:Create a self-signed public certificate to authenticate your application. Step 4: Configuring the Patch My PC Publisher to Connect to the Intune Tenant If you do not know your Intune tenant domain, navigate to thetenant status pagein your Intune tenant, and look at the property forTenant name. Now, it is time to go to thePatch My PC Publisherand input theAuthority,Application ID, andApplication Secretinto theIntune Optionswindow of the Publisher. Replace with theTenant nameyou found in thetenant status pageof your Intune tenant. Paste theApplication IDandApplication Secretthat was saved from earlier. ClickTestto view theIntune Connection Statusand validate that thePublishercan connect to your Intune tenant. If the listed permissions all have a green checkmark underEnabled, you can now begin to publish applications to your Intune tenant. In addition to the client secret, certificate-based authentication is also available in the Patch My PC Publisher. For more information, see the Microsoft documentation for more information:Create a self-signed public certificate to authenticate your application. If you would like to use certificate-based authentication, choose the radio optionCertificateand browse out to select the certificate. The certificate needs to be in the local machine\u2019s Personal store. If the associated tenant is on GCC High, the changes below are required: Authority:https://login.microsoftonline.us Authentication URL:https://graph.microsoft.us Graph Base URL:https://graph.microsoft.us/beta Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/supported-versions-configuration-manager-wsus/", "title": "Configuration Manager, WSUS, Patch My PC, Publisher", "raw_text": "Supported Versions of Configuration Manager and WSUS for Patch My PC We\u2019re often asked whether thePatch My PC Software Update CatalogorPublisher Softwareis supported on the latest versions ofConfiguration Managerbefore customers perform site upgrades. In this article, we will review supported versions ofConfiguration ManagerandWSUS. We generally support thesupportedversions of Configuration Manager current branch as documented by Microsoft. Note:The Publisher primarily interacts with the Configuration ManagerConsole API\u2019s, therefore, it\u2019s unlikely there would be any compatibility issues due to a Configuration Manager site upgrade even if there\u2019s a Configuration Manager version that isn\u2019t listed below as being tested and supported. Versions of Configuration Manager Officially Tested by Patch My PC The versions ofConfiguration Managerlisted below have been tested by our team to ensure core function compatibility including: Feature Support CM 2309 CM 2403 CM 2409 CM 2503 = Feature is tested and supported= Support has been deprecated= Feature is not supported Upgrade Tip:If the Patch My PC Publisher software isinstalled on the site server, we recommend stopping thePatchMyPCServicebefore the site upgrade is started. This step will ensure the service doesn\u2019t have any locks on console files during the console upgrade portion of the site upgrade on the site server. Versions of WSUS Officially Tested by Patch My PC The versions ofWSUSlisted below have been tested by our team to ensure core function compatibility including: Feature Support Server 2008 R2 or Before Server 2012 Server 2012 R2 Server 2016 Server 2019 Server 2022 = Feature is tested and supported = Support has been deprecated Newer versions of the publisher aren\u2019t supported on deprecated versions of WSUS. You can download anolder version of the publisherthat was tested for deprecated versions of WSUS. = Feature is not supported Patch My PC Publisher System Requirements and Prerequisites Install on top-most WSUS/Software Update Point in the environment Configuration Manager Console Installed (For SUP Sync and ConfigMgr App features) Supported Operating SystemsWindows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022Windows Server Update Services (WSUS) installed and configured Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 Windows Server Update Services (WSUS) installed and configured Internet ConnectionList of Domains Used for Downloads List of Domains Used for Downloads Microsoft .NET Framework 4.6.2 Supported Operating SystemsWindows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022When using Windows Server, only the WSUS API component needs to be installed, not full WSUS. The WSUS API can be installed using PowerShell with the command: Install-WindowsFeature UpdateServices-APIWindows 10/11 x64When using Windows 10, theRSAT: Windows Server Updates Servicesneeds to be installed. Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022When using Windows Server, only the WSUS API component needs to be installed, not full WSUS. The WSUS API can be installed using PowerShell with the command: Install-WindowsFeature UpdateServices-API When using Windows Server, only the WSUS API component needs to be installed, not full WSUS. The WSUS API can be installed using PowerShell with the command: Install-WindowsFeature UpdateServices-API Windows 10/11 x64When using Windows 10, theRSAT: Windows Server Updates Servicesneeds to be installed. When using Windows 10, theRSAT: Windows Server Updates Servicesneeds to be installed. Internet ConnectionList of Domains Used for Downloads List of Domains Used for Downloads Microsoft .NET Framework 4.6.2 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/configapi-not-responding-error/", "title": "ConfigApi error, troubleshooting, patching", "raw_text": "ConfigApi is not responding. An unhandled exception occurred In this article we troubleshoot why this error might occur when launching the Patch My PC Publisher UI and how to resolve it. Determine if You are Affected When you launch the Publisher, you might receive the following error. The PatchMyPCService is running, but the ConfigApi is not responding. Cloud features will not be available. Please see PatchMyPC.log for more information When you click OK, you get a further warning. An unhandled exception occurred: :9001] Both of these errors can be found in the %ProgramFiles%Patch My PCPatch My PC Publishing ServicePatchMyPC.log Run the following command to verify you are missing a configuration setting on the host which means the Publisher cannot bind to the ConfigApi on the loopback adapter. netsh http show iplisten If 127.0.0.1 is not present in the list, this will cause the error listed in this article. Workaround The ConfigApi is bound to the loopback adapter address 127.0.0.1 or the DNS name LOCALHOST. A legacy misconfiguration can result in the IP Listener configuration for 127.0.0.1 being removed from the host. Run the following command to add 127.0.0.1 back as an IP Listener. netsh http add iplisten 127.0.0.1 Verify the addition of 127.0.0.1 was successful by running the following command. netsh http show iplisten Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/powershell-policy-bug/", "title": "PowerShell Execution Policy Bug Remediation", "raw_text": "Application Creation Bug if PowerShell Execution Policy is Set via GPO As of June 16, 2021, the Patch My PC team was made aware of a bug in the Publisher that affectedapproximately 116 customers. At this time the team has releasedbuild 2.0.6of the Publisher which resolves this issue. The article below describes the scope and remediation steps. Bug Timeline What Caused the Issue: Inbuild 2.0.5(released to self-update channel June 14), a change was made that could cause application creation to fail if the PowerShell execution policy is set via GPO. The error in thePatchMyPC.logwould show: An error occurred while signing the file: Security error. This issue would cause applications that attempted to update in place to fail. For example, ifGoogle Chrome 91.0.4472.101was upgrading toGoogle Chrome 91.0.4472.106,the creation of the newer application would fail. This issue would also cause the content source folder for the previous version ofGoogle Chrome 91.0.4472.101to be deleted. When was the Error Fixed Inbuild 2.0.6(released to self-update channel June 16), we resolved the issue where code-signing of our detection method scripts would fail. What Issue Needs to be Manually Resolved If an application failed to update from build 2.0.4.1, it would cause any future application updates created with build 2.0.6 to lose the association. This means the new version will be created as a new application rather thanupdating the existing application in place. Manual Resolution:We recommend that you copy any assignments (if any) from the old version to the newer version of the application. You would also need to replace the older application with the newer application in any task sequences. Once completed, we recommend deleting the older duplicate version of the application. Remediation Steps and Tools for this Issue The following applications were released after posting build 2.0.5 which may result in duplicate applications if your PowerShell execution policy is set via GPO. We also made aPowerShell scriptavailable to help you identify possible duplicate applications if this scenario applies to you. Info:The script needs to be run on the SMSProvider or you can provide the $ProviderMachineName parameter to the script and specify the SMS Provider name. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sql-connection-error/", "title": "network-related error, sql server connection, troubleshooting steps", "raw_text": "A network-related or instance-specific error occurred while establishing a connection to sql server. The errora network-related or instance-specific error occurred while establishing a connection to sql serverhas been an error we have been tracking via ourproactive customer care program. Determine if You are Affected When affected, you will see an error that starts with the error below in thePatchMyPC.log. A network-related or instance-specific error occurred while establishing a connection to SQL Server. Note:The will likely be another sentence or two in the log error line that isn\u2019t always unique. Each of these errors will have similar troubleshooting steps. A few examples we have seen are: the server was not found or was not accessible. verify that the instance name is correct and that sql server is configured to allow remote connections. (provider: named pipes provider, error: 40 \u2013 could not open a connection to sql server) the server was not found or was not accessible. verify that the instance name is correct and that sql server is configured to allow remote connections. (provider: sql network interfaces, error: 26 \u2013 error locating server/instance specified) the server was not found or was not accessible. verify that the instance name is correct and that sql server is configured to allow remote connections. (provider: tcp provider, error: 0 \u2013 the remote computer refused the network connection.) the server was not found or was not accessible. verify that the instance name is correct and that sql server is configured to allow remote connections. (provider: tcp provider, error: 0 \u2013 the wait operation timed out.) Troubleshooting Step 1: Is the MSSQLSERVER Service Running? The first step is to validate theMSSQLSERVERservice isrunningon the SQL Server hosting the WSUS database. In our example image below, we can see it\u2019s in astoppedstate. If you are using aWID (Windows Internal Database)you can perform the same check on your WSUS Server where the WID is installed. Troubleshooting Step 2: Is the SQL Server DNS Name Resolvable? You can receive theSQL Server DNS namefrom the WSUS server registry with the followingRegValue: HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Update Services\\Server\\Setup:SqlServerName In our example below, we can see the WSUS server isunable to resolve the DNS name of the SQL Serverdefined for the database server. Troubleshooting Step 3: Validate SQL Permissions for WSUS Computer Account The next step if to connect to SQL Server usingSQL Server Management Studio. Check theSUSDB>Security>Usersand ensure the computer account of theWSUS server existand it\u2019s been assigned theWebServicedatabase role membership. Troubleshooting Step 4: Check if SQL Ports are Blocked If all the steps above are correct, the next thing to check isfirewalls may be blocking the SQL portused to connect to the SQL Server from the WSUS Server. You can download use the Microsoft toolPortQryUIto run a port query check. On theWSUS server, openPortQryUIand enter theSQL Server hostname/IPand add theSQL server port number(default is1433) and check the result. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/simple-guide-wsus-maintenance-optimization/", "title": "WSUS Optimization ConfigMgr Maintenance Performance", "raw_text": "The Simple Guide to WSUS Maintenance and Optimization in ConfigMgr In this article, we are going to break down thekey factors involved in ensuring your WSUS server and software update point are healthy and optimizedfor performance. There are many excellent guides out there around WSUS maintenance, includingMicrosoft Docs. Relationship Between WSUS and the ConfigMgr Software Update Point (SUP) Before I dig into why WSUS maintenance is essential, let\u2019s get abasic overview of how Configuration Managerinteracts with WSUS. Even if you have never opened the WSUS console, when a software update point is installed, ConfigMgr configures the top-levelWSUS server to synchronize automatically from theMicrosoft Update Catalog. If you have multiple software update points, any child-SUP will sync from the top-level SUP. When a software update point synchronization runs, ConfigMgr tells WSUS to go sync from theMicrosoft Update Catalog. If you review the ConfigMgr logwsyncmgr.log, you can better see this happening in real-time. Here\u2019s an example of somekey lines in the wsyncmgr.logwhen synchronization is running. Note:In the past, the Microsoft Update Catalog was relatively small, and WSUS would often work great without any type of optimization. It used to be pretty common to hear in the ConfigMgr space that you shouldn\u2019t ever touch WSUS. Why Performing WSUS Maintenance is Now Essential As theMicrosoft Update Catalog grew, the WSUS database did as well. As I recall, the issue of WSUS maintenance started to become a topic around 2017 when customers started tosee timeouts due to an unmaintained WSUS environmentwith a large number of software updates. The timeout error would generally show in thewsyncmgr.log as the following error: Sync failed: The operation has timed out. Source: Microsoft.UpdateServices.Internal.DatabaseAccess.ApiRemotingCompressionProxy.GetWebResponseSync failed. Will retry in 60 minutes At first glance, you may think this is a networking or proxy error since the logline contains the text \u201cApiRemotingCompressionProxy\u201c, but it\u2019s generally not related to the proxy at all. It\u2019s an API call to theWSUS AdministrationIIS website timing out when running aSQL query to get all published updates. This issue generally happens because SQL maintenance such asre-indexing,custom index creation,and otherWSUS maintenance stepshave never been performed. Step 1: Check Current WSUS Performance First, you should get a baseline of how your WSUS database performs before enabling any WSUS maintenance. The stored procedure below will retrieve all updates in WSUS. ThespSearchUpdatesstored produce is called during each software update point synchronization in ConfigMgr. We would hope to see this query executed inunder 30 seconds in a healthy environment. If the query takeslonger than 150 seconds, you may have sync failures and other WSUS performance issues. Perform the following actions inSQL Management Studio>Connect to the SQL or WID Instance>Right-Click the SUSDB>New Query > Type:execspSearchUpdates > Execute or F5 Step 2: Enable the Built-In WSUS Maintenance in ConfigMgr 1906 and Newer The easiest way to ensure WSUS performs well and is optimized is to enable thebuilt-in cleanup and maintenance process. To enable this, navigate to >Administration>Sites>Right-Click the Site>Configure Site Components>Software Update Point In the WSUS Maintenance tab, check the following checkboxes: Decline expired updates in WSUS according to supersedence rules Add non-clustered indexes to the WSUS database Remove obsolete updates from the WSUS database Once enabled, thewsyncmgrcomponent willperform a WSUS cleanup after successfully synchronizingthe software update point. You can see the actions taking place in thewsyncmgr.log Important:Before the next software update point sync is performed, you should ensure theWsusPool in IIS is optimizedusing the steps belowOptimizing WSUS AppPool in IIS for Better Performanceto improve WSUS IIS performance. Step 3: Validate Non-Clustered Indexes Were Created Successfully from Step 2 Based on our research and information inMicrosoft Docs, the single most significant factor to WSUS database performance and the root cause for timeouts is not having the customnon-clustered indexeson the WSUS database (SUSDB). If you successfully performed a software update point sync afterStep 2: Enable the Built-In WSUS Maintenance in ConfigMgr, the non-clustered indexes should be automatically created. However, there are a few scenarios where the automatic creation may fail: The synchronization of the software update point is failing, which causes the step toadd non-clustered indexesnever to attempt. WSUS/SUP uses a remote Windows Internal Database (WID), soConfigMgr can\u2019t automatically create the custom indexes. If the WSUS database is on a remote SQL Server using a non-default port, indexesmight not be added. To verify the non-clustered indexes were created automatically, copy the followingSQL Queryand ensure the result of the query in SQL Management Studio returnsnclLocalizedPropertyID index exists,andnclSupercededUpdateID index exists If the custom indexesweren\u2019t created automatically, you should use the following step tocreate the custom indexes manually:Step 7: Create Non-Clustered Indexes on SUSDB Manually (As Needed) Step 4: Optimizing WSUS AppPool in IIS for Better Performance One WSUS optimization that isnot automatically enabledis changing the WSUS Administration websites AppPool settings in IIS. PerMicrosoft\u2019s WSUS best practice, you should perform the following changes. OpenInternet Information Services (IIS) Manager>Application Pools>Right Click WsusPool>Advanced Settings\u2026 In theAdvanced Settings pane, perform the following changes: Queue Length 2000 (up from default of 1000) Idle Time-out (minutes) 0 (down from the default of 20) Ping Enabled False (from default of True) Private Memory Limit (KB) 0 (unlimited, up from the default of 1,843,200 KB) Regular Time Interval (minutes) 0 (to prevent a recycle, and modified from the default of 1740) ClickOKto save the settings thenright-click the WsusPooland clickRecycle\u2026 Step 5: Check for Un-Needed Products that are Enabled We also highly recommend reviewing theproducts you have enabledto see if there areany products that are no longer needed. For example, it\u2019s not uncommon for us to review this with customers to find unsupported products such as the following enabled: Windows XP Windows 7 Windows Server 2003 etc. To check the products enabled, navigate to >Administration>Sites>Right-Click the Site>Configure Site Components>Software Update Point Uncheckanyunneeded productsand clickOK Step 6: Reindex the WSUS Database (Recommended) While stillconnected to the SUSDB in SQL Server Management Studioopen aNew Query for the SUSDB Copy and paste theT-SQL scriptfrom the Microsoft Docs articleReindex the WSUS databaseand clickExecute. Note:TheReindex the WSUS database T-SQL scriptcan take some time to complete depending on how fragmented the WSUS database indexes are. We also recommend you set up a SQL maintenance plan to re-index the database on a schedule as described in the following video:Top 10 Tips for Optimizing WSUS Performance and Reliability Step 7: Create Non-Clustered Indexes on SUSDB Manually (As Needed) There is a scenario where theBuilt-In WSUS Maintenance in ConfigMgrmay not work if you are already in a very unhealthy WSUS state. If you recall in the step above, the WSUS cleanup and maintenance is performed by thewsyncmgr componentand onlyafter a successful software update point sync. If you are already in an unhealthy WSUS state, you may constantly be receiving timeout errors as shown below in thewsyncmgr.log: Sync failed: The operation has timed out. Source: Microsoft.UpdateServices.Internal.DatabaseAccess.ApiRemotingCompressionProxy.GetWebResponseSync failed. Will retry in 60 minutes When this happens, theWSUS clean up task will never triggerbecause it only occurs after a successful software update point sync. If you happen to be in this unhealthy WSUS state, you will need tomanually perform some of the tasksgenerally automated byBuilt-In WSUS Maintenance in ConfigMgr. After manually performing WSUS optimization and you are able to complete a successful sync the built-in maintenance can take over. We found performing the following two actions will generally be enough to get WSUS in a state to successfully sync. Create custom indexes Create Custom Indexes Manually To createcustom indexes manually, perform the following steps. OpenMicrosoft SQL Server Management Studio>Connect to the SQL Server Running the WSUS Database (SUSDB) > Right-Click SUSDB > New Query Paste in theSQL Query from Microsoft Docsto create the WSUS custom indexes and clickExecute. Video Guide: Top 10 Tips for Optimizing WSUS Performance and Reliability If you prefer learning by video, you can check out the deep dive video we did on WSUS performance and reliability below Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/free-power-bi-report-microsoft/", "title": "Power BI Configuration Manager Updates, Compliance Monitoring, Patch Management", "raw_text": "Free Power BI Report for Microsoft and Third-Party Updates in Configuration Manager The Patch My PC Power BI dashboard can monitor the compliance and deployment ofthird-party and Microsoft security updates through Configuration Manager. Video Guide for Power Bi Dashboard Step 1: Requirements Step 2: Download and Configure the Report Step 3: Exploring the Power BI Report Step 4: Updating your Data Video Guide for Power Bi Dashboard Optionally, you can also check out the video guide below to learn more about the setup and usage of the Power BI Software Update Dashboard for ConfigMgr. Step 1: Requirements To utilize this report, you will need to meet the following requirements. Required Have Power BI Desktop (Free) Installed Have the DB Reader Role on the ConfigMgr databaseOur report does not leverage the RBAC views, so Configuration Manager roles will not provide access. Our report does not leverage the RBAC views, so Configuration Manager roles will not provide access. A copy of the Power BI template, included in this article. Optional Power BI Pro License Power BI Gateway server installed and configured Step 2: Download and Configure the Report To get started, download the latest Power BI template file for software updates. Download the Dashboard: PatchMyPC-ConfigMgr-1.0.9 Updated 12/6/2021 Fixed Collection Filter Fixed Internal Data Model Map Updated Company Logo Initial Public Version We present the file in a zipped format, so you will need toextract the template fileonce downloaded. Once you\u2019ve downloaded the file, go ahead and open it to get started. Opening the file will present you with three fields to fill in. \u00c2 MEMCM SQL Server Name MEMCM SQL DB Name Collection Filter Below is an example of what you might put in each field. Note:The Percent sign here is used as a wild card to return all machines, related to all collections. You can use this to only return machines from specific collections as needed. When you first run this report, you will need toauthorize the SQL queries to run, assuming that you trust the content of those queries. You can find the contents of these queries publicly available, along with an explanation behind their logic, on ourlearning website. The security setting under the options governs the default behavior of Power BI and, we do not recommend unchecking the pictured option. Once you have approved all of the queries, the report will load, keep in mind itmay take some time based on the size of your environment. Step 3: Exploring the Power BI Report The Patch My PC PowerBI dashboard is broken up into three different components. You can navigate through these components by using the tabs located at the bottom of the report. Compliance Overview Filters \u2013 This section can be used to filter the report, only to show information about patches released over X date range, patches in a specific software update group, or to only grade based on deployed updates. Workstation and server Patch compliance, with a total ring that sets a target of 90% Configuration Manager Agent Compliance. This helps find Gaps in your environment for devices that might be missing the agent, therefore not reporting their associated risk. Workstation Compliance This report tab is filtered specifically to workstation-only information. Filters allow you to filter down to the criteria you care about. Currently selected patches you are grading against. Running tally of the device\u2019s name and the number of patches missing vs. Installed. Detailed information on what that patch is and its current state. Please note this report was written with the idea of being actionable, and as a result, \u2018Unknown\u2019 or \u2018fuzzy\u2019 data is largely excluded. Server Compliance This report tab is filtered specifically to server-only information. Filters allow you to filter down to the criteria you care about. Currently selected patches you are grading against. Running tally of the device\u2019s name and the number of patches missing vs. Installed. Detailed information on what that patch is and its current state. Step 4: Updating your Data This dataset can be updated in one of two ways. First, you can at any time click \u2018refresh\u2018 from the ribbon in the Power BI desktop app. This report has also been tested with a Power BI gateway and does supportautomatic refreshif you have a gateway properly set up and configured. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/preview-channel/", "title": "Publisher Preview Channel, New Features, Feedback, Release Notes", "raw_text": "Publisher Preview Channel The Publisher Preview Channel provides the opportunity to try out new features before we release them to our Production Channel. What to Expect If you opt in to the Publisher Preview Channel, you will get the latest release of the preview build when it becomes available. More information about what features, improvements, and fixes have been released in preview can be found on the following page:Preview Release notes. While using the preview build, feel free to share your feedback or suggestions using the happy face or frown face in the publisher. Your feedback will help us make improvements and changes to the publisher. Note:If you have Disabled self-updates within the publisher, you can click theUpgrade nowbutton under theAdvancedtab to install the latest preview version General Cadence vs. Production Releases Releases to the preview channel will occur before production channel releases. Production releases can contain multiple features, improvements, and fixes from Preview. Our release notes for production and preview releases can be found on the following page:Release History. How to Opt-In If you would like to opt-in to the preview builds, you can do so by checking theInstall preview buildsbox in theAbouttab. If you are opting into preview for the first time, you will need to selectUpgrade Nowto install that latest preview build. After upgrading to the latest preview build the new version will be on the title bar. How to Opt-Out If you currently have theInstall preview buildsoptions checked and would like to opt-out, you can do so by unchecking the option under theAbouttab. With that option unchecked you will no longer receive the latest preview builds of the publisher. When the next production build is released, you will be updated to latest version on the production channel. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/power-bi-reports-microsoft-intune/", "title": "Power BI, Microsoft Intune, Third-party updates", "raw_text": "Power BI Reports for Microsoft Intune Third-Party Update and Application Deployments Our Power BI dashboards can be used to monitor the compliance and deployment ofthird-party updatesandapplicationsin Microsoft Intune. Step 1: Download the Latest Power BI Template File Step 2: Save the Latest Assignment Statistics via the Publisher Step 3: Open the Power BI Report and Import the CSV File Step 4: Explore the Power BI Report Step 1: Download the Latest Power BI Template File The first step is to download the latest Power BI template file for our third-party update and application dashboard Patch My PC Intune Dashboard v1.0.2 Step 2: Save the Latest Assignment Statistics via the Publisher The next step is toexportthe latest assignment statics to a.CSVfile in bulk using our Publisher. Perform the following actions:Open the Intune Application Manager Utility>Export Step 3: Open the Power BI Report and Import the CSV File Open the Power BI file, and navigate to theCSV filethat contains the latest export for assignment statistics from Microsoft Intune third-party updates and applications. After importing, you should see a dashboard for boththird-party software updatesandWin32 application assignmentsin Microsoft Intune. Step 4: Explore the Power BI Report There are two pages the will show you compliance statistics forthird-party updateorthird-party applicationassignments Intune Patching Overview Tab The Intune Patching Overview tab will displaycompliance statisticsfor any third-party update assignments within your Microsoft Intune tenant.Some of the charts can beshown as a data point tableto review specific compliance data. For example, if you right-click theUpdate Timeline, you can drill into updates deployed on a specific day. Here\u2019s an example of thisdata point: Intune Application Overview Tab The Intune Application Overview tab will displaycompliance statisticsfor any third-party applications (Win32 applications for initial deployment) within your Microsoft Intune tenant. Dashboard components explained Intune Patching Overview Applications Patching =the total number ofIntune Updatespublished using PMPC. Publishers Patching= Out of the total number ofApplication Patching, it informs you how many unique vendors the updates come from. Assigned Patches =The number of publishedPMPC Intune Updateswith an active Intune assignment. Un-assigned patches= The number ofPMPC Intune UpdateswithnoIntune assignment. PatchesInstalled= The total number of PMPC Intune Updates installed on Intune devices. PatchesPending= The total number of PMPC Intune Updates with an active assignment, but the installation is still pending. Applications Deployed=The total number ofIntune Appspublished using PMPC. Publishers deployed= Out of the total number ofApplications deployed, it informs you how many unique vendors they come from. Assigned applications= Out of the total number ofApplications deployed, it informs you how many have an active Intune assignment. Un-assigned Applications= Out of the total number ofApplications deployed, it informs you how many don\u2019t have any Intune assignments. Applications Installed= Out of the total number ofApplications deployedwithActive Assignments, it informs you how many are installed on Intune devices. Applications pending= Out of the total number ofApplications deployedwithActive Assignments, it informs you on how many devices the installation ispending. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-products-are-handled-end/", "title": "End of Life Removal Notification", "raw_text": "How Products are Handled at End-Of-Life (EOL) or Become Incompatible We remove products from oursupported productslist for a few reasons. The primary reasons for products being removed from our catalog are: The product isEnd-of-Life(EOL) by the vendor Other compatibility issues related to silent install or versioning Process and Timeline for Products Reaching End-of-Life When a product nears it\u2019s official end-of-life date, the following actions will be taken by Patch My PC. Patch My PC will attempt to adhere to the following timeline, assuming we are aware of the scheduled end-of-life of an application. 3 Months Prior to End-of-LifeNotification incatalog release notes pageandnewsletterof EOL and removal of application from the Patch My PC Catalog Notification incatalog release notes pageandnewsletterof EOL and removal of application from the Patch My PC Catalog 1 Month Prior to End-of-LifeNotification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC Catalog Notification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC Catalog 1 Week Prior to End-of-LifeNotification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC Catalog Notification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC Catalog Day of End-of-LifeNotification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC CatalogUnsupported application is expired in the Patch My PC Catalog, and can no longer be publishedProduct is made unavailable as a ConfigMgr App, Intune App and Intune UpdateProduct will remain available under \u201cUpdates\u201d tab so that the Publisher can expire the Update in WSUS on the next sync Notification in catalog release notes page and newsletter of EOL and removal of application from the Patch My PC Catalog Unsupported application is expired in the Patch My PC Catalog, and can no longer be published Product is made unavailable as a ConfigMgr App, Intune App and Intune UpdateProduct will remain available under \u201cUpdates\u201d tab so that the Publisher can expire the Update in WSUS on the next sync Product will remain available under \u201cUpdates\u201d tab so that the Publisher can expire the Update in WSUS on the next sync 1 Month Post Application End-of-LifeUnsupported application is removed from the Patch My PC Catalog Unsupported application is removed from the Patch My PC Catalog List of Products Removed due to End-of-Life or Compatability Issues The table below lists products removed from our catalog due to the end-of-life by the vendor. Note:If there are any products where compatibility issues list above may be resolved in a newer update, pleaseopen a technical support caseto let us know. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/what-are-metadata-only-updates/", "title": "Metadata Only Updates, WSUS, Configuration Manager", "raw_text": "What Are Metadata-Only Updates and How to Download and Deploy Metadata-Only Updates? (Blue Icons) In this article, we will cover the topic ofmetadata-only updates. This is a useful feature that is available in WSUS, and subsequently Configuration Manager. What is a Metadata-Only Update (Blue Icon) To clarify what metadata-only updates are, let\u2019s first discuss what the metadata is for updates. The metadata for updates in WSUS contains allthe information about an update, and they appear in the console with a blue icon next to them. Note:Ametadata only update will not show up in a ConfigMgr Automatic Deployment Rule (ADR) Preview for updates. This is because they are not deployable and would not be processed by the ADR. WSUS Update Metadataincludes information such as: Title Description Update Severity Update Classification Superseded Updates Applicability RulesIsInstalledIsSupersededIsInstallable IsInstalled IsSuperseded IsInstallable Command Line Return Code Behavior Note:The above is not a complete list of what is included in update metadata, but provides a summary of important attributes included. Knowing the above information aboutWSUS metadata, a metadata-only update is simplyan update with no content, only metadata. This means themetadata-only updates will not have the content downloaded to the \u2018UpdateServicesPackages\u2019 or \u2018WSUSContent\u2019 directorieswhich WSUS manages. As there is no content the publishing action for an update as metadata-only will be very quick! There is no binary to codesign. But,because this content does not exist the update cannot be \u2018downloaded\u2019 within the Configuration Manager console, as it is a metadata-only update. Below is an example of an update that is published with full content. Note that we do see our applicability based metadata, required, installed, not required. More importantly,this update has a content source path. We can look at the same set of information below for an update that ispublished as metadata-only. You can determine if updates aremetadata-onlyfrom theAll Software Updatesnode if the updates are displayed with ablue icon. Aside from the icon, the \u2018Metadata Only\u2018 column is marked with a \u2018Yes\u2019 and we can also see theContent Information tab shows no source path for the update. This is the key difference for metadata-only updates. Attempting to download an update that is metadata-only will present an error message box stating \u2018All software updates in this selection are expired or meta-data only, and cannot be downloaded.\u2018 Note:Updatesdo not need to be deployedto receive applicability statistics such as required, installed, and not required. The update only needs to be in the WSUS catalog as metadata-only, or full content. Manually Download By Publishing One method of publishing an update as full content is to manually \u2018Publish Third-Party Software Update Content\u2018 as shown below. You can review the full-content publishing progress in theSMS_ISVUPDATES_SYNCAGENT.log. The log is located on the top-level software update point in the site system Logs folder. Once the publishing of third-party update content is complete, you cansync your software update pointfor SCCM to pick up the change from metadata-only to full-content faster. Once the software update point sync is complete, the third-party updates should show in anormal statewith a green icon meaning they are available for software update deployment. Automatically Download Via Stage Content (v3 catalog, ConfigMgr 1910+) Microsoft has made many improvements to the built-in third-party patching features in Configuration Manager. Most notably, starting inConfigMgr 1910you canset a custom schedule for catalogs,set a schedule per catalog, and full support for theversion 3 catalogfor updates. The key improvement with the version 3 catalog is the ability toselect individual categories to synchronize. This is key to ensuring the WSUS catalog is kept to a minimal number of updates. The greater the number of updates in a WSUS infrastructure, the more resources are required on the server, and the more resources are used when a client performs a Windows Update scan. To use these features, \u2018Subscribe to Catalog\u2018 on the desired third-party software update catalog. This will bring up a wizard that is shown below. Within the \u2018Select Categories\u2018 of the wizard, the list of categories provided by the vendor is listed. With the \u2018Select categories for synchronization\u2019 option selected it is possible to specify any number of categories to select. This allows only updates that are of interest to synchronize instead of the entire catalog. Beyond just select certain categories for synchronization, specific categories can also be selected such that ConfigMgr will \u2018Stage the content for the selected categories automatically.\u2019 When the updates are automatically staged for a category, any new updates will bepublished with full contentand automatically downloaded into the WSUSContent directory according to the schedule associated with the catalog. This removes the manual step of selecting updates publishing them. Automatically Publish Updates as Full Content Using the Publisher When using the Patch My PC Publisher, the option is provided to select if an update is published as full content, or metadata-only.By default, all updates will be published as full content, but it is very simple toright-click any update, vendor, or the \u2018all products\u2019 node in the publisher and select to publish as metadata only. The behavior is otherwise identical. Updates will publish into the console as expected according to the configuration specified in the Publisher. Note:If you are publishing updates using the Publisher,only use the Publisher to change from metadata-only to full content. If you have previously published an update as metadata-only, you can open the Publisher back up, right-click the update, and select full content publishing. The next synchronization will ensure the update is published with full content. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-to-delete-applications-created-by-patch-my-pc-in-sccm-2/", "title": "ConfigMgr Application Manager Patch My PC SCCM Applications Delete", "raw_text": "How to use the ConfigMgr Application Manager to Delete Applications Created by Patch My PC How to Delete Applications Created by Patch My PC in SCCM In this article, we will review how to delete applications created by Patch My PC from SCCM. There are a few scenarios where you may want to do this. Youno longer need Patch My PCfor application management There was an update in the publishing service tofix an application-specific issuethat requires recreation of an application to take effect The followingtwo methodsare available for application deletion: Method 1 \u2013 SCCM Application Manager Utility Method 2 \u2013 Manual Application Deletion Method 1 \u2013 SCCM Application Manager Utility Step 1: Delete the Applications Using the Utility Step 2: Recreation of All Applications (optional) Note:Whenusing the SCCM Application Manager to delete applications, we will alsoremove the source files automatically. The steps for manually deleting the application include the process for manually deleting application source files. The manual deletion shouldnotbe needed when using the SCCM Application Manager. Step 1: Delete the Applications Using the Utility Within the Publisher, you can navigate through the UI as shown below. ConfigMgr Apps Options Run SCCM Application Manager Utility Delete ApplicationsNote:Only the applications you have highlighted will be deleted. You can hold CTRL and select multiple applications for deletion. Note:Only the applications you have highlighted will be deleted. You can hold CTRL and select multiple applications for deletion. Step 2: Recreation of All Applications (optional) Please refer to the recreation stephere. Method 2 \u2013 Manual Application Deletion Manual deletion is a multi-step process covered below. Step 1: Deleting the Application Source Content Step 2: Delete the Application(s) from SCCM Step 3: Recreation of All Applications (optional) Step 1: Deleting the Application Source Content If you only need to delete a single application, the easiest method is to delete the source content and application from SCCM manually. In this example, we will be deleting the source content for7-Zip 19.00 (MSI-x64). Open the application\u2019s deployment type in the SCCM console Copy the content location path from the Content tab of the deployment type Open the folder in file explorer and delete the GUID folder for the application If you need to delete all application content, you can remove all the vendor folders from the application source directory that was defined in the application options in the publishing service. Find the source folder specified in the base install options of the publishing service Go to this directory in file explorer to find the applications subfolder and delete all of the vendor folders within Step 2: Delete the Application(s) from SCCM To delete individual applications in the SCCM console: Go to theApplications nodein the Software Library Right-clickthe desired application and clickDelete To delete all applications in the SCCM console: Click the blue tab in the top left corner of the console andConnect Via Windows Powershell Run the following command in the Powershell windowGet-CMApplication | Where-Object {($_.SDMPackageXML -like \u2018*PatchMyPC-ScriptRunner.exe*\u2019)} | Remove-CMApplication -Force -Verbose Get-CMApplication | Where-Object {($_.SDMPackageXML -like \u2018*PatchMyPC-ScriptRunner.exe*\u2019)} | Remove-CMApplication -Force -Verbose The following verbose logging will show each application being deleted: Any active deployments or task sequence references must be removed before the application can be successfully deleted. If an application is deployed or referenced in a task sequence, you will get the following error: Step 3: Recreation of All Applications (optional) If applications were deleted due to a recommendation from the Patch My PC support team due to a bug in a previous version, here is the process to quickly recreate the applications. Manually run a publishing service sync in the Sync Schedule tab of the publishing service Monitor the sync process by opening the PatchMyPC.log in the General Settings tab Once all applications are recreated, verify in the console under the Comments column of the application that the \u201cCreated by Patch My PC\u2026\u201d version matches the version in the About tab in the publishing service Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/advanced-pre-post-scripts/", "title": "Custom Script, Post Installation, PowerShell, Plugin", "raw_text": "Advanced Application Configuration using Pre/Post Scripts Many applications have advanced configurations that cannot be specified usingcommand-line parametersand must be provided via configuration files or other means. This article will provide instructions on configuring applications or updates using the Patch My PC Publisher using acustom post-installation scriptandadditional file(s). For this scenario, we will be adding acustom pluginto the installation or update ofNotepad++. We will do so by providing a custom PowerShell Script and a zip file of the plugin. Walkthrough First, we willdownload the Pluginfrom GitHub here:https://github.com/pnedev/comparePlus/releases/latest. We willsave the plugin as a zip filewith our PowerShell Script in a location accessible by the Patch My PC Publisher, outside of the actual application\u2019s content folder. Next, we will create the following PowerShell script and save it in the same folder as our downloaded plugin. 1. Create a new folder called \u201cComparePlus\u201d in the Notepad++ \u201cplugins\u201d folder 2. Extract the contents of the provided Compare Plus Plugin zip file to the Notepad++ \u201cplugins\u201d folder ThePowerShell fileandZip filewere saved to a location that the publisher can access. Next, we can configure them in the Patch My PC Publisher. Open the Publisher and navigate to the product to be customized.Right-clickthe desired product and select \u201cAdd custom pre/post update installation scripts\u201c Add a Pre/Post Update Script byright-clicking the productto add the script to. In the \u201cChoose Custom Pre/Post Update Script(s)\u201d window, click \u201cBrowse\u2026\u201d next to \u201cPost Script\u201c, navigate to the share where the Powershell script created earlier is stored, and select it. Next, click \u201cBrowse\u2026\u201d next to the \u201cAdditional Files\u201d option and select the zip file containing the Notepad++ plugin that was downloaded earlier. Then select \u201cOK\u201c Use the \u201cBrowse..\u201d buttons to select the Pre/Post Update Scripts or Extra Files/Folders to include. Once complete, ensure that Notepad++ is checked for sync, navigate to the \u201cSync Schedule\u201d tab and click \u201cRun Publishing Service Sync\u201c.Once the sync completes, your update should be configured to install the Notepad++ plugin after any update. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/modify-delete-decline-third-party/", "title": "Modify, Decline, Re-sign, Filter", "raw_text": "Modify, Delete, and Decline Third-Party Updates in WSUS with Patch My PC You canview,delete,decline, and showapplicability rules, much more for third-party updates within WSUS using themodify published updateswizard. Themodify published updates wizardcan help perform various actions on third-party updates that are published to WSUS. The wizard can be accessed with the button shown below in theOptionswindow that can be opened from theUpdates tabin thePublisher. Open theModify Published Updateswizard in theOptionswindow found in the updates tab. Filter Selections for Published Updates Once all updates have loaded, you can easily filter the list of published updates. You can filter updates byvendor,declinedstatus,expiredstatus,metadatastatus,supersededstatus, orenabledstatus. If you select multiple updates in the list view, you can check the checkbox by clicking the space key on your keyboard. Note: The filter forEnabled Statuscan be a great option todeclineordeleteold updates for products not currently enabled. If you filter by those that are not enabled, you will find all WSUS updates which are published, but no longer selected in the list of products.\u00c2 Available Actions to Perform on Published Third-Party Updates There are a variety of actions that are available for published third-party updates within WSUS. Patch My PC Modify Updates Wizard Available Options Re-Sign Update The re-sign update will allow you to re-sign an already published update with a newWSUS Code-Signing Certificate. Re-signing can be helpful if your WSUS Code-Signing certificate expired andtimestamping was disabled. Important: If timestamping is enabled (enabled by default), clients would stilltrust updates signed after the certificate\u2019s expiration date. Important: If updates are re-signed, you will need todelete all re-signed third-party updates from your ConfigMgr deployment package, trigger a software update sync, andredownloadthe updates for re-signed updates to be used by clients. Decline This option willdeclinethe third-party update in WSUS. When a third-party update is declined, clients will no longer scan against the third-party update. After an update is declined and a software update point sync is performed, the update will show asexpiredin the Configuration Manager console. Un-Decline This option will revert the declined status in WSUS. Clients will start toscan against this update,and the status will show asnormalin Configuration Manager after the next software update point sync. Delete This option willcompletely delete the updatefrom the WSUS database. We don\u2019t recommend deleting an update if the product for the update is still enabled for publishing. The delete update buttonis not enabled by defaultbecause it can cause hash issues if an update is deleted, and that product is still enabled, causing the same UpdateID to be republished. If you have a scenario to delete updates, such as cleaning upvendors from WSUSyou can enable the button using the value below: REG ADD \u201cHKLM\\SOFTWARE\\Patch My PC Publishing Service\u201d /v EnableDeleteUpdates /t REG_DWORD /d 1 /f Show in WSUS This option will configure the update toshow directly in the WSUS console. By default, third-party updates aren\u2019t visible directly in the WSUS console, and if you are using configuration manager, they don\u2019t need to be visible. This option can be helpful when using standalone WSUS for updates. Hide in WSUS This option will configure the update tonot show in the WSUS console. By default, third-party updates aren\u2019t visible directly in the WSUS console. Show Applicability Rules This option can be helpful if you aretroubleshooting the update detection stateson a device. When clicked, you will be able to see the applicability for theinstallableandinstalledlogic for the update. More Details This option will show moreadvanced detailsabout the published updates in WSUS. This may be helpful for moretroubleshooting scenarios. Extract Content This option will open a a window and allow you to save the WSUS content for the specified update in the selected location. Update content is saved as a .cab file in the selected extraction folder. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sms_isvupdates_syncagent_updatecontent_no_metadata-error/", "title": "SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATA, Third-Party, Software Updates, Metadata", "raw_text": "SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATA Error You may receive errorSMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATAwhen attempting to right-click a third-party software update and choosingPublish Third-Party Software Update Content. Determine if You are Affected If you are affected by this error, you will see one of the following errors in theSMS_ISVUPDATES_SYNCAGENT.log when using an automatic deployment rule STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATA). STATMSG: (SRVMSG_SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_FAIL). If you are trying tomanually download the update to a deployment package using the ConfigMgr console, you will see the errorAll software updates in this selection are expired to meta-data only, and cannot be downloaded. This error occurs because the update you are trying to download to a deployment package in only published withmetadata onlyand not full-content. This is also a known issuedocumented in Microsoft Docs. Resolve Error SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATA (Post) When yousubscribe to a custom third-party software update catalogusing theSCCM 1806+ third-party software update catalogs feature, updates are published as metadata-only during the catalog synchronization until you manually choose to publish the update content. You can determine if updates aremetadata-onlyfrom theAll Software Updatesnode if the updates are displayed with ablue icon. Updates published asmetadata-onlycan\u2019t be deployed until they are-published with full-content. If you attempt to download a metadata-only update into a deployment package, you will receive the error \u201cAll software updates in this selection are expired or meta-data only, and cannot be downloaded.\u201c In order to download and deploy third-party updates in a metadata-only state, you will need to right-click the update(s) and choose to \u201cPublish Third-Party Software Update Content\u201c. You can review the full-content publishing progress in theSMS_ISVUPDATES_SYNCAGENT.log. The log is located on the top-level software update point in the site system Logs folder. Once the publishing of third-party update content is complete, you cansync your software update pointfor SCCM to pick up the change from metadata-only to full-content faster. Once the software update point sync is complete, the third-party updates should show in anormal statewith a green icon meaning they are available for software update deployment. Starting in ConfigMgr 2002 and the v3 catalog format, you can now automatically choose to publish updates withfull-content using the stage content option. You may also consider using thePatch My PC Publisherfor syncing the catalog automatically with full-content rather than the in-console publishing: What\u2019s the Difference Between the Publisher and SCCM In-Console for Update Publishing? Resolve Error SMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATA (Video) Please review the step-by-step video guide below for information about why theSMS_ISVUPDATES_SYNCAGENT_UPDATECONTENT_NO_METADATAerror occurs while publishing third-party software update content and the resolution. Additional Details To enable the Delete button in our publishing service, create a new DWORD registry value:Computer\\HKEY_LOCAL_MACHINE\\Software\\Patch My PC Publishing Service:EnableDeleteUpdates = 1 This scenario is also documented on theMicrosoft Docs \u2013 Third-Party Software Updates Known Issues page. The third-party software update synchronization service can\u2019t publish content to metadata-only updates that were added to WSUS by another application, tool, or script, such as SCUP. The Publish third-party software update content action fails on these updates. If you need to deploy third-party updates that this feature doesn\u2019t yet support, use your existing process in full for deploying those updates. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/when-new-application-update-available/", "title": "New Application Update, SCCM, Deployment", "raw_text": "When a New Application Update is Available for SCCM Base Installations In this article, we will explain the options available when anapplication update is available. This information will help clarify the functionality of some of our base install options, which are highlight below. Option 1: Update existing application\u2019s metadata, deployment type, detection method, and content files (Default) When this option is selected, the Patch My PC Publisher will automatically update the various pieces of metadata associate with the application, as well as the content files themselves. The metadata that will be updated is: Title:Based on customer settings, such as not including the version, or custom application name Based on customer settings, such as not including the version, or custom application name Version:Updated to reflect the new version synchronized from the catalog Updated to reflect the new version synchronized from the catalog Detection Method:PowerShell based detection method updated to ensure the new version is detectedThe script will be re-signed based on customer settings PowerShell based detection method updated to ensure the new version is detected The script will be re-signed based on customer settings Alongside this metadata, the content itself will be updated. This means the binaries for the old version of the application will be removed, and the new binaries will be copied to the application source directory. Once complete, the Publisher will trigger a content update on the Deployment Type for the Application or a package refresh if it is a package. Because we are updating the existing application in this scenario, we have some consideration to keep in mind. Existing Deployments:If the application which was updated has required deployments then the targeted devices will receive the updated policy on their next Machine Policy refresh, including the new detection method, as we\u2019ve created an application revision. The result is that machines may run this installation and update the software based off this application deployment. Be aware of this when creating any required deployments of the Patch My PC managed applications.If the application which was updated has available deployments then the targeted devices will be installing the latest available version of these applications which Patch My PC provides when the user selects install. If the application which was updated has required deployments then the targeted devices will receive the updated policy on their next Machine Policy refresh, including the new detection method, as we\u2019ve created an application revision. The result is that machines may run this installation and update the software based off this application deployment. Be aware of this when creating any required deployments of the Patch My PC managed applications. If the application which was updated has available deployments then the targeted devices will be installing the latest available version of these applications which Patch My PC provides when the user selects install. Task Sequences:If you are referencing these Patch My PC managed applications within a task sequence then you will always be deploying the latest available version of these applications which Patch My PC provides. If you are referencing these Patch My PC managed applications within a task sequence then you will always be deploying the latest available version of these applications which Patch My PC provides. General Consideration:We will be performing an \u2018update content\u2019 on these packages and applications. Any requests for this content while it is being refreshed will, of course, fail, stating that content is not available. Be aware of this, especially with task sequences that reference the content. It could be good to coordinate your publisher\u2019s sync schedule with your high-traffic imaging days and times. We will be performing an \u2018update content\u2019 on these packages and applications. Any requests for this content while it is being refreshed will, of course, fail, stating that content is not available. Be aware of this, especially with task sequences that reference the content. It could be good to coordinate your publisher\u2019s sync schedule with your high-traffic imaging days and times. When a new version of an application is released, delay the in-place application upgrade by\u2026 When this option is checkedallapplications managed by the Publisher will have their creation delayed by the specified number of days. The delayed date is based on the date the new application version was synchronized by the Publisher. For example, if Google Chrome was synchronized on February 3rd, and this setting was configured for a 3-day delay, you would expect to see the application be updated in Configuration Manager during a publisher synchronization on February 6th. This feature will result in a logline similar to the below. The updating of the SCCM Application\u2026 is delayed due to settings Option 2: Create a new application without modifying any previous applications This scenario is much more straight forward. Whenever a new application update is available a new application will be created. The publisher will not take any action on the previously created application versions. Even with simplicity comes a couple of considerations. Application Sprawl:If left unchecked this approach could end up leaving tens of application versions per app, or more, in your Configuration Manager environment.Periodically review old application versions and deployments. If left unchecked this approach could end up leaving tens of application versions per app, or more, in your Configuration Manager environment.Periodically review old application versions and deployments. Periodically review old application versions and deployments. Task Sequences:Task sequences that reference Patch My PC managed applications will likely be referencing old versions of the application.Periodically review and update your task sequence references as needed Task sequences that reference Patch My PC managed applications will likely be referencing old versions of the application.Periodically review and update your task sequence references as needed Periodically review and update your task sequence references as needed Retain up to X previously created applications Specify a number between 0 and 10 as the number of applications you would like to retain in your environment. Setting this to the value of 0 would ensure, regardless of what radio option you have set from above, that you only have the latest version of applications in your environment. Setting the value between 1 and 10, regardless of what radio option you have set from above, would keep that number of revised applications in your environment. For example, setting it to the value of 1 would mean you would always have n-1 applications for Google Chrome: the latest, and the version prior. This provides you with the benefit of having access to older versions of applications in your environment, as well as the latest, ready to deploy if you need to roll back your devices to a last known good verison. It also keeps your environment tidy by maintaining a set number of applications. Remove administrative categories from retained applications By default, all administrative categories that are associated with a ConfigMgr application are left intact.If this option is selected, then all administrative categories are removed from retained applications. Only the latest published application will have the administrative categories associated with it. One use case for this is ConfigMgr operating system deployment frontends that use administrative categories to populate a list of applications. Delete applications even if they have a deployment This is an optional checkbox which only becomes available when you configure theRetain up to X previously created applicationssetting. It controls whether the Publisher can or can not delete applications in the retaining chain with active deployments. Enabling this option allows the Publisher to delete applications in the chain, even if they have deployments. Leaving this option unchecked does not delete applications in the chain if they have deployments. Note:The Publisher will not delete an application if it is used in a task sequence, even if you have this option enabled. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/custom-apps-msps-using-patch/", "title": "Managed Service Providers, Patch My PC, Custom Apps", "raw_text": "Custom Apps for MSPs using Patch My PC Publisher In this article, we will learn how Managed Service Providers (MSPs) can create and manage custom apps and updates to be deployed using Patch My PC Publisher. If you are an MSP using the Publisher and want to take advantage of the Custom Apps feature to add an application not currently supported in thePatch My PC Catalog, you can onboard the Patch My PC Cloud portal to add in-house applications and publish them for each tenant configured in the Publisher. Onboarding to Patch My PC Cloud As an MSP onboarding to Patch My PC Cloud, you\u2019ll need to first create your company profile in the Patch My PC Cloud portal. Importantly, you will set the connection name in both the Cloud portal and the Publisher toyourbusiness name. The customers that you manage in Patch My PC Publisherdo nothave their own Patch My PC Cloud portal instance or individual custom app catalogs. Both the Patch My PC Cloud portal and the Cloud connection in the Publisher will be associated to the MSP, not the customers you manage. IMPORTANT:Please refer tohttps://docs.patchmypc.com/patch-my-pc-cloud/onboarding-to-cloudfor up-to-date instructions on how to onboard to Patch My PC Cloudusing the information below as a guide. Onboarding InformationWhen onboarding to Patch My PC Cloud, selectCreate Companyand enteryourbusiness name in theCompany Namefield. Once onboarding to Patch My PC Cloud has been completed, you will need to create a connection to the Publisher. Create a connection between the Publisher and Patch My PC Cloud Before we can create a custom app, we need to create a connection between the Publisher and Patch My PC Cloud. IMPORTANT:Please refer tohttps://docs.patchmypc.com/installation-guides/patch-my-pc-cloud/administration/manage-connections/add-a-connectionfor up-to-date instructions on how to create a connection between Patch My PC Cloud and the Publisher,using the information below as a guide. Publisher Connection InformationTheConnection Namethat you enter when configuring theCloud tabin the Publisher should be your MSP business name. Create a Custom App Please refer tohttps://docs.patchmypc.com/installation-guides/patch-my-pc-cloud/custom-apps/create-a-custom-appfor up-to-date instructions on how to create a Custom App. Managing Custom Apps across multiple Intune tenants When a Custom App is created, it will appear in the Publisher across all Intune tabs as both an application and an update for all tenants. You can individually enable and customize each app or update uniquely for every tenant, using right-click options to apply specific configurations. Each tenant\u2019s selection and customization within the Publisher remains unique, even though the app is available across all tenants configured in the Publisher. Note:Removing a Custom App from the Cloud Portal will also remove it across all tenant Intune tabs in the Publisher Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/list-products-patch-my-pc/", "title": "Patch My PC Defined Scripts, AdoptOpenJDK, Hotspot", "raw_text": "List of Products with Patch My PC Defined Scripts Our Patch My PC defined scripts feature is a way we ensure products that are a little more complicated and require custom actions to happen can be performed by default. Please review our documentation video below for more details about this feature. List of Products Using Patch My PC Defined Scripts AdoptOpenJDK JRE with Hotspot 8 (x86)This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Hotspot 8 (x86) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Hotspot 8 (x86) installs automatically before installing the latest update. AdoptOpenJDK JRE with Hotspot 8 (x64)This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Hotspot 8 (x64) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Hotspot 8 (x64) installs automatically before installing the latest update. AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x86)This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x86) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x86) installs automatically before installing the latest update. AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x64)This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x64) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous AdoptOpenJDK JRE with Eclipse OpenJ9 8 (x64) installs automatically before installing the latest update. Amazon Corretto 8 (x86)This recommended pre-update installation script will remove previous Amazon Corretto 8 (x86) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous Amazon Corretto 8 (x86) installs automatically before installing the latest update. Amazon Corretto 8 (x64)This recommended pre-update installation script will remove previous Amazon Corretto 8 (x64) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous Amazon Corretto 8 (x64) installs automatically before installing the latest update. Java 8 (x86)This recommended pre-update installation script will remove previous Java Runtime Environment 8 (x86) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous Java Runtime Environment 8 (x86) installs automatically before installing the latest update. Java 8 (x64)This recommended pre-update installation script will remove previous Java Runtime Environment 8 (x64) installs automatically before installing the latest update. This recommended pre-update installation script will remove previous Java Runtime Environment 8 (x64) installs automatically before installing the latest update. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/installation-fails-msi-error-code/", "title": "Installation Error, MSI, Windows Installer, Fatal Error", "raw_text": "Installation Fails with MSI Error Code 1603 Installationerror 1603is one of the more common errors we see for application or update installations. This article will review installation error1603and explain how to get more details about why the installation failed. Error code 1603 is a generic Windows Installer error and translates to: \u201cFatal error during installation.\u201c Determine if You are Affected The log file where you see error code 1603 may vary depending on the method used to start the installation. Some examples of where the errors would log are listed below: When using anapplicationin Configuration Manager, you will see of logline similar to below inAppEnforce.log Unmatched exit code (1603) is considered an execution failure. If the installation fails as asoftware update, you will see errors similar to below inWUAHandler.log Update 1 (0a91b273-404a-475f-b065-b2f54b99c7b1) finished installing (0x80070643)Installation job encountered some failures. Job Result = 0x80240022. WUAHandler Error0x80070643translates toFatal error during installation.Error0x80240022translates toOperation failed for all the updates. In thePatchMyPC-ScriptRunner.logyou will likely see the following error lines: End of installation. Exit code is: 1603End of Script Runner. Exit code is: 1603 How to Troubleshoot Install Error Code 1603 Unfortunately, error 1603 is generic, and it\u2019s going to have adifferent root causefor each failure. There is a variety of common reasons that could cause it. The application could bein use,permission issues to the folders or registry keys, etc. For Patch My PC support to help you with error 1603, we will need the actualinstallers log filespecific to the application or update that is failing; otherwise, we will be unable to provide any assistance. How to Enable Installation Logging via Patch My PC Patch My PC has an option that simplifies enabling logging for a product installer using our Publisher\u2019scustom right-click options. This option enables loggingduring the installation of the update or applicationon the client device. When enabled, the installer will create a directory (default path:C:\\Windows\\CCM\\LogsPatchMyPCInstallLogs) that will store the vendor\u2019s installation log product, providing greater detail when troubleshooting is necessary. Additional checkbox options enableverbose logging,prefix the logwith the client device\u2019s computer name, and designate abackup locationto store log files for failed installations. Available At:All Products, Vendors, and Products Applicable To:Software Updates, Applications If logging was enabledafter a product has already been published, you would need toRun Publishing Server Syncfrom the Sync Schedule tab. Note:If you are enabling theManage Installation Loggingfeature for anIntune application or updatethen you will need todelete the application out of Intuneand then Run Publishing Server Sync. Similarly if this is for a WSUS update then you may need to republish the update depending on what options are currently configured. Please refer tothis articleto understand when it is necessary to republish an update. Check for Installation Logs in C:\\Windows\\Temp Even if Patch My PC logging wasn\u2019t enabled before the installation failed witherror 1603, some installers may save a log folder to the %temp% folder by default. You can check theC:\\Windows\\Tempfolder to see if there are any logs specific to the failed update or application install. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/troubleshooting-why-third-party-updates/", "title": "Third-Party Updates, SCCM, WSUS", "raw_text": "Troubleshooting Why Third-Party Updates Don\u2019t Show in SCCM In this article, we will review the process to troubleshoot whythird-party software update(s) may not appear in the SCCMconsole All Software Updates node. It\u2019s essential to understand the flow of how third-party updates sync betweenWSUSandSCCM. Step 1: Validate Third-Party Update(s) are Publishing to WSUS Before any third-party updates can sync into SCCM, they need to bepublished to WSUS. The publishing operating can be performed using the following methods: Patch My PC\u2019s Publisher SCCM\u2019s Third-Party Software Update Catalogs Feature System Center Updates Publisher (SCUP) NOTE: When using our publishing service or the third-party software update catalog feature in SCCM, the publishing of third-party updates to WSUS is performed by abackground service. If an update fails to publish to WSUS, you will need to review theSMS_ISVUPDATES_SYNCAGENT.logif using the third-party software update catalog feature in SCCM. If using the Patch My PCPublisher, you can review thePatchMyPC.login the installation directory. If there are no errors in the logs, the next step is toreview if third-party updates exist in WSUS. Since the WSUS doesn\u2019t directly expose third-party software updates in the WSUS console, you will need to use ourpublisher. In theUpdatestab of our publishing service, you can selectOptionsand run theModify Published Updateswizard to view what updates are published to WSUS. If the third-party updates that aren\u2019t appearing in the SCCM consoledo exist in WSUS, proceed to the next troubleshooting steps. Step 2: Validate Software Update Point Synchronizes from WSUS If the third-party updates were published successfully to WSUS, the next step in the process that could cause and issue is the synchronization between WSUS and SCCM. We recommend performing a manualsynchronizationof your software update point within the SCCM console. Once the sync has started, you should review thewsyncmgr.logusing the CMTrace log viewing tool. You will want to verify in the log file the sync succeeded. In the Configuration Manager console underMonitoring>Software Update Point Synchronization,you can also verify if the last sync was successful. If the software update point synchronization is failing, you will need toresolve the sync issuebefore any third-party software updates will show up in the SCCM console. Step 3: Verify the Patch My PC Vendor is Enabled in the Software Update Point Products In your SCCM console, you will need to ensurePatch My PCvendor andSCUP Updatesproduct is enabled in the Software Update Point Products. Within the SCCM console, navigate toAdministration>Site Configuration>Sites>Configure Site Components>Software Update Point If the product shown above is not enabled, you need to enable the product, click Apply then running another Software Update Point synchronization should resolve the issue for third-party software updates not appearing in SCCM. Important:If you seemultiple Patch My PC Productsand one is not checked, please see the following articleDuplicate Patch My PC Category Listed in Software Update Point Products Tab Step 4: Verify Classifications are Enable in the Software Update Point If updates have been published to WSUS and there are no synchronization issues between WSUS and SCCM, you may not have the requiredupdate classificationsenabled in SCCM. For our third-party updates, we will useCritical, Security Updates, and Updatesclassifications depending on what best matches the release of a specific third-party software update. Within themodify published updates wizard, you can see what classification third-party updates are classified as. If anupdate classification isn\u2019t enabled in the Classificationstab of the software update point, the update will not appear in SCCM unless that classification is enabled and another software update point synchronization is performed. In the screenshot below, we can see the Updates classification isn\u2019t enabled, and that would cause many third-party software updates to not appear in SCCM. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/how-to-setup-microsoft-intune/", "title": "Microsoft Intune Setup, Deployment, Management", "raw_text": "How to Setup Microsoft Intune Microsoft Intune Deployment and Getting Started Guide Microsoft Intune helps you manage your corporate devices. The guide below will describe how toset up and configure Microsoft Intune and activate a 90-day trial. Many of the steps in the video and article below are also available on the Microsoft docsQuickstart \u2013 Try Microsoft Intune for free. Topicscovered in this article: Video Guide for Microsoft Intune Setup Request a 30-Day Intune Trial Set Up a Custom Domain Name (Optional) Enable Automatic Enrollment for Windows Devices and Enterprise Mobility + Security E5 90-Day Free Trial Create User for Intune Enrollment via Windows Autopilot Enable Company Branding in Azure Active Directory (Optional) Disable Windows Hello for Business Enroll a Windows 11 Device Into Microsoft Intune Using Windows Autopilot Video Guide for Microsoft Intune Setup If youprefer to learn using video guides, you can review the video below that covers all the steps in the article below. Request a 30-Day Intune Trial Trying out Microsoft Intune is free. To start, request a 30-day trial atMicrosoft Intune 30-Day Trial Request. On the Microsoft Intune Trial page,enter your work emailand clicknext. Note:In the example above, the domain used for the email was \u201cpatchmypc.com\u201c. If there is any Intune instance setup for the domain, the option will be \u201cSign In\u201d or \u201cCreate a new account instead\u201c. If Intune hasn\u2019t been set up for your domain, the button will say \u201cSet up account\u201c. If Intune hasn\u2019t been used before for your email domain, clickSet up account. If Intune has been configured for your domain before, you can create a new Intune tenant by clicking \u201cCreate a new account instead\u201c. Complete theTell us about yourselfform and clickNext You will need to verify you are a person using theText meorCall meoption.Enter your phone numberand clickSend verification code. On theHow you\u2019ll sign inform, you will need to enter thetenant\u2019s username,Domain name,andpasswordand clickNext. You will be redirected to theConfirmation detailsscreen, which shows details about the Intune tenant. Set Up a Custom Domain Name (Optional) If you don\u2019t have a domain name already purchased, you canbuy a custom domain namethat you can optionally use for Microsoft Intune user accounts. Purchasing a domain name is generally under $10. Note: Using a custom domain is optional. If you don\u2019t use a custom domain, you can log in using the[email protected]domain for example rather than[email protected]. For this guide, we are going to use a custom domain setupmem.com. I usedCloudflareto purchase the domain name. Tobuy a domain in Cloudflare, you follow the steps below. Log in to Cloudflare and navigate to theRegister Domainpage. Search for yourdesired domain nameand clickPurchase. Complete the prompts to purchase the domain. After purchasing the domain, navigate to theAdd a domainwizard in the Microsoft 365 admin center. Enter thedomain nameand clickUse this domain. You can find more about adding a custom domain name atAdd a domain to Microsoft 365 \u2013 Microsoft 365 admin. ClickVerifyon theVerify you own your domain page. If your domain registrar supports theMicrosoft Domain Connect feature, the Verify wizard will automatically add a text record in DNS for you. Cloudflare does support this feature. ClickAuthorizein the popup to validate the domain name. ClickDoneon theDomain setup is completedialog. Congrats, you have now added a custom domain to your tenant! Enable Automatic Enrollment for Windows Devices and Enterprise Mobility + Security E5 90-Day Free Trial The Microsoft Intune subscription doesn\u2019t include automatic enrollment. If you want to enableautomatic enrollmentfor Windows devices, you can request a90-day free trial of Enterprise Mobility + Security E5. Log in to theMicrosoft Endpoint Managerand navigate toDevices>Windows>Windows enrollment>Automatic Enrollment. Click the message aboutAutomatic MDM enrollment, expand the Free trial for Enterprise Mobility + Security E5, and clickActivate. Note: The trial may take a few minutes to activate. Once activated, you can enable Automatic enrollment for Windows devices. The Enterprise Mobility + Security E5 includes the Microsoft Intune license. Navigate to theLicenses pagein the Microsoft 365 admin center. Assigna license for the Enterprise Mobility + Security E5 to the user account you used to create the tenant. Refresh the Microsoft Endpoint Manager page, and navigate toDevices>Windows>Windows enrollment>Automatic Enrollment. If the trial license is applied, you can enableAllfor theMDM user scopeandMAM user scopeand clickSave. Create User for Intune Enrollment via Windows Autopilot Next, we will create a standard Azure AD user account that we will use forWindows Autopilot. Navigate to theActive users pagein the Microsoft 365 admin center. Clickadd a user. In our example, we created a user namedJohn Smithwith the email of[email protected]. Note:If you added a custom domain and it doesn\u2019t show up in the Domain drop-down menu, try torefresh the Active users pageand try again. It may take a few minutes to become available after verifying the domain name. In theProduct licensesdialog, assign the license forEnterprise Mobility + Security E5and clickNext. ClickNexton theOptional settings,then clickFinish addingon theReview and finishdialog andCloseon the confirmation page. Enable Company Branding in Azure Active Directory (Optional) If you want to be fancy (and why wouldn\u2019t you), you can enableCompany brandinginAzure Active Directory. To enableCompany branding,navigateto theCompany branding page in Azure Active Directory. Click the Default locale, and upload the branding images, which include thefollowings sizes: 1920x1080px 280x60px 240x240px (light theme) 240x240px (dark theme) If you want, you can download thePatch My PC Company brandingwe usedhere. Tip: Want more Patch My PC themed content? Download a variety of wallpapers atPatch My PC Logos, Wallpapers, and Brand Resources Disable Windows Hello for Business Since this is a lab environment, we will disableWindows Hello for Business. Enrolling devices in atest lab is easier without this feature enabled. To disable Windows Hellow for Business, log in to theMicrosoft Endpoint Managerand navigate toDevices>Windows>Windows enrollment>Windows Hello for Business. For the settings \u201cConfigure Windows Hello for Business:\u201d and \u201cUse security keys for sign-in:\u201d choosedisabledon the drop-down menu and clickSave. Note:You probably wouldn\u2019t want to disable Windows Hello for Business in aproduction environment. Enroll a Windows 11 Device Into Microsoft Intune Using Windows Autopilot Now you are ready toenroll your first Windows device into Microsoft Intune. We installed Windows 11 on a virtual machine and booted to theAutopilot/OOBE(Out of the Box Experience). We clickednexton the screens related toregions,keyboards, andlanguages. In theLet\u2019s set things up for your work of schooldialog, we entered our user\u2019s email of[email protected]and clickedNext. After clicking Next, we can see thecustom Company brandingis now available. Enter thepasswordand clickSign in. In theChoose privacy settings for your devicedialog, choose the options you prefer and clickAccept. Once logged in, you can openSettings>Accounts>Access work or school. Click theInfobutton for your user\u2019s account in theAccess work or school. You will see theDevice sync statusif the device automatically enrolled in Microsoft Intune successfully. ClickSyncto initiate a sync for the device to Microsoft Intune. Thedevice should appear in the Microsoft Endpoint Manager console in a few minutes! Congrats, we have now set up Microsoft Intune ! Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/log4j-cve-2021-44228/", "title": "Apache Log4j Vulnerability, Patch My PC, CVE-2021-44228, Catalog Updates", "raw_text": "Apache Log4j Vulnerability CVE-2021-44228 Patch My PC engineers are hard at work monitoring and releasing catalog updates as they are released by vendors, and the Patch My PC Publisher does not use the Log4J library. Patch My PC Publisher The Patch My PC Publishing Service application does not utilize the Log4j library. Our terms of service list the in-use open-source software as dependencies in our software, which you can read here:https://patchmypc.com/terms-of-service Patch My PC Catalog If products in the Patch My PC catalog utilize the Log4j library, we are beholden to the vendor to release a software update to mitigate the vulnerability. When vendors release new versions, we will update our catalog accordingly. What is the turnaround time for a third-party software update to be added to the catalog?https://patchmypc.com/frequently-asked-questions#update-turnaround-time Due to the severity of this issue, we will continue to monitor and release new versions into our catalog as soon as vendors make them available. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/enable-products-inventory/", "title": "SCCM Inventory Automated Enablement", "raw_text": "Automatically Enable Products Based on SCCM Inventory Scans Today, we are excited to release a new feature that allows automated scanning and product enablement based on products being detected in your environment. This new feature is directly from customer feedback on ourUserVoice. In theUpdatesorConfigMgr Appstab you can click thedatabase iconto launch the scan feature. The scan feature allows you to perform a one-time query against your environment as well as automated scanning during scheduled synchronizations and automatic product enabling. How does Scanning Work? Each time a synchronization is performed, the service will query the SCCM database and evaluate if any of our supported products match entries in the v_GS_INSTALLED_SOFTWARE, v_Add_Remove_Programs, V_GS_ADD_REMOVE_PROGRAMS,andv_GS_ADD_REMOVE_PROGRAMS_64 viewscollected via hardware inventory in SCCM. If a product is detected and exceeds the count, it will automatically be enabled for publishing. Excluding Products? In the event you want to exclude any existing products, you can right-click the product in the update or application rules tab in the publishing service. SQL Permissions Required? For better performance, the query is performed directly against the SQL server and does not go through the SMSProvider. When running the query in the publishing service user interface, it\u2019s performed under the logged on users context. When the query is performed during a synchronization, it\u2019s performed using the SYSTEM account of the WSUS server where the publishing service is installed. If the WSUS server is remote from the SQL server, you will likely need to grant the computer account theminimum permissions required to run the SQL query. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/custom-sync-schedule/", "title": "Publisher Sync Schedule, Task Scheduler, Custom Synchronization, Publishing Service", "raw_text": "Custom Sync Schedule for Patch My PC Publisher There might be a scenario where you would like the publisher to sync at a frequency that is not available in the Sync Schedule tab. For example, every two weeks on Friday. This article will go over the current Publisher Sync Schedule options and how to use Task Scheduler to create a custom Publisher sync schedule. Current Publisher Sync Schedule Options In theSync Scheduletab of the Patch My PC Publisher, you can set the cadence for publishing new third-party updates and applications to your ConfigMgr, WSUS, and Intune environments. The Publisher runs as a service in the background on the device where it is installed. Based on the schedule you set, the service will run and evaluate if Patch My PC has released any new catalog updates for the products you have enabled. You can also use theRun Publishing Service Syncoption to trigger a manual orSelective Sync. How to Create a Custom Publisher Sync Schedule You can use Task Scheduler to synchronize the Publisher on a schedule that isn\u2019t available under the Sync Schedule tab. The following steps will guide you on how to use Task Scheduler to trigger a synchronization of the Publisher on a custom schedule. First, openTask Scheduler. Rights-ClickTask Scheduler Libraryand selectCreate Task. In theCreate Taskwindow, enter a name for the task under theGeneraltab and set theSecurity options. You have a couple of options for theSecurity optionssection: Option 1:To run as a specific account (forexample a Service Account)selectRun whether user is logged on or notand enter the detailsrequired Option 2:To run as System\u2013selectChange Userand enterSystemthenclickCheck NamesandOK. We are going to useOption 2and run the Task asSystem. Next, move to theTriggerstab and selectNew. In theBegin the taskdrop down, selectOn a schedule. Choose your frequency in the Settings section and selectOK. In our example, we have chosen Weekly and Recur every 2 weeks on Friday. Next, move to theActionstab and selectNew. For theActiondrop down, selectStart a program. In theSettingssection underProgram/script, browse to the installation location of the publisher. The default location is\u201cC:\\Program Files\\Patch My PCPatch My PC Publishing ServicePatchMyPC-Settings.exe\u201d In theAdd arguments (optional)section enter:/syncnow Lastly, selectOKto save the new task. After the task is created,you can disable the sync schedule in thepublisher,so itdoesn\u2019tsyncautomatically outside the new scheduled task. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/page/19/", "title": "Patch Management, Endpoint Security, IT Operations", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 \u2026 18 19 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/sup-sync-failure-permission-error/", "title": "Software Update Point, Sync Failure, Request Permission, ConfigMgr", "raw_text": "Software Update Point Sync Failure \u2013 Request for Principal Permission failed (0x80131500 / 0x8013150A) We recently encountered this error when running a sync on a remote Software Update Point. In this example, we are usingCM1.corp.contoso.comas the primary site server andSP1.corp.contoso.comas the remote site system with the software update point role configured. Determine if You are Affected You will see the following error inwsyncmgr.log: MessageSync failed: Request for principal permission failed. Source: Microsoft.UpdateServices.Administration.AdminProxy.CreateUpdateServer STATMSG: ID=6703 SEV=E LEV=M SOURCE=\u201dSMS Server\u201d COMP=\u201dSMS_WSUS_SYNC_MANAGER\u201d SYS=CM1.corp.contoso.com SITE=CHQ PID=2836 TID=9640 GMTDATE=Fri Aug 02 20:54:26.571 2024 ISTR0=\u201dMicrosoft.UpdateServices.Administration.AdminProxy.CreateUpdateServer\u201d ISTR1=\u201dRequest for principal permission failed\u201d ISTR2=\u201d\u201d ISTR3=\u201d\u201d ISTR4=\u201d\u201d ISTR5=\u201d\u201d ISTR6=\u201d\u201d ISTR7=\u201d\u201d ISTR8=\u201d\u201d ISTR9=\u201d\u201d NUMATTRS=0 LE=0X8013150a Sync failed. Will retry in 60 minutes Understanding 0X8013150A or 0X80131500 The0x80131500error typically means that you are unable to connect to the Software Update Point. This can be due to several different reasons. (Another reason can be found here:The Microsoft Software License Terms have not been completely downloaded and cannot be accepted (0x80131500) \u2013 Patch My PC.) The primary logs we will look at during this sync arewsyncmgr.logandWCM.log. Unfortunately, the CMTrace error lookup feature (Ctrl + L) cannot help with the error code. Note:This error message is different from a previous build of ConfigMgr. When setting up this scenario, we were running the latest build of ConfigMgr. Configuration Manager 2403. In older builds, the error was 0x80131500 instead of 0x8013150A. Troubleshooting Steps MergeWCM.logandwsyncmgr.loginCMTrace. Review the connecting account. In this case, the credentials forCORPService-SCCMare being used for the network connection. This account is unable to connect to the remote WSUS server. The account used to connect to the Software Update Point is found underAdministration>Servers and Site System Roles> (Your Software Update Point) >Properties>Proxy and Account Settings Resolution Theminimum permissionsrequired for this account is to be inWSUS Administratorson the Software Update Point Site Server (in this example, we added SRVC_SCCM to the WSUS Administrators on SP1.corp.contoso.com). If you were to uncheck the box for \u201cUse Credentials to connect to the WSUS Server\u201d the computer name of your primary site server would need to be added to theWSUS Administratorsgroup on the Software Update Point. This scenario may have occured as a result of the Software Update Point (SP1.corp.contoso.com) being set up when the service account (SRVC_SCCM) was a Domain Admin or had higher privileges. The account was then removed from Domain Admins, and the SUP began to fail. Once the appropriate permissions were added. The Software Update Point synced correctly. Note:Minimum permissions for all ConfigMgr accounts can be found here:https://learn.microsoft.com/en-us/mem/configmgr/core/plan-design/hierarchy/accounts Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-software-updates-maximum/", "title": "Third Party Software Updates, Maximum Runtime, ConfigMgr Settings", "raw_text": "Third Party Software Updates Maximum Runtime in ConfigMgr This article will detail the requirement to increase the maximum runtime for third party software updates in Microsoft Configuration Manager (SCCM / MEMCM / MECM / ConfigMgr). Maximum Run Time Explained All software updates in Configuration Manager have a configured maximum allowed time to run, measured in minutes. This is referred to as maximum run time. It is the allotted time for software updates to complete on client computers. If the updatetakes longer than the maximum run-time value, Configuration Manager stops tracking the software updates installationandreturns a failurestatus message. The software update installation will continue in the background, howeverthe client will no longer track its progress nor return its actual result. You may find after the next time the clients performs a scheduled software update scan evaluation cycle, the update may eventually report back as compliant, however this assumes the installation was a success. Maximum Run Timespecifies the maximum number of minutes allotted for a software update installation to complete before the installation is stopped by Configuration Manager. This setting is also used to determine whether there is enough available time remaining to install the update before the end of a maintenance window. The default setting is 60 minutes for service packs. For other software update types, the default is 10 minutes if you did a fresh install of Configuration Manager version 1511 or higher and 5 minutes when you upgraded from a previous version. Values can range from 5 to 9999 minutes. \u2013 Microsoft documentationConfigure software update settings | Set maximum run time. Some products in the Patch My PC catalog takelonger than the default maximum run timeout in ConfigMgr, for example Autodesk Revit. Microsoft expose options to change the default maximum run timeout for different types of software updates in Configuration Manager.However, at the time of writing this, these options do not apply to third party updates(see image below). You can check your updates\u2019 current maximum run time value by adding the column to the All Software Updates view in-console forMaximum Run Time (Mins). You can also check an individual update\u2019s maximum run time by right clicking on the software update >Properties>Maximum Run Timetab. Determine if You Are Affected On the client side, when a software update exceeds the maximum allowed run time, you can expect to see the following: Execution cancelled by job. Update will not be monitored(UpdatesHandler.log) CTargetedUpdate::RaiseEnforcementStateMessage, m_eUpdateAction = 1(UpdatesDeployment.log)CTargetedUpdate::RaiseEnforcementStateMessage, ulMessageId = -1073730111(UpdatesDeployment.log)CTargetedUpdate::RaiseEnforcementStateMessage, m_hrError = -2016410012(UpdatesDeployment.log)CTargetedUpdate::RaiseEnforcementStateMessage, MessageUserFlags = STATE_USERFLAG_CI_USER_ENFORCED(UpdatesDeployment.log)Raised update (TopicID) (Site_x/SUM_x) enforcement state message successfully. TopicType = STATE_TOPICTYPE_SUM_CI_ENFORCEMENT, StateId = 11, StateName = CI_ENFORCEMENT_UPDATE_FAILED, StateCriticality = 1, TopicIdVersion = 1(UpdatesDeployment.log)Update (Site_x/SUM_x) Progress: Status = ciStateError, PercentComplete = 0, DownloadSize = x, Result = 0x87d00664(UpdatesDeployment.log) 0x87d00664resolves toUpdates handler job was cancelled. Changing the Maximum Run Time Value For accurate reporting of software update installation, it is recommend to change the maximum run time for updates which typically exceed the default run time. Adjust its value by right clicking on the software update >Properties>Maximum Run Timetab: Note:if the software update was already deployed and you change its maximum run time value, in order for the client to recognise the changed maximum run time valueyou must remove the deployment and re-deploy it. Solution Moving Forward Microsoft released a Technical Preview version of Configuration Manager which exposes the option on the Software Update Point to change the default maximum run time for all other software pudates, which includes third party software updates. See the release notes forTechnical Preview 2112when they added this improvement. Customers using Configuration Manager must wait for Microsoft to merge this change into the production Current Branch versions of Configuration Manager. Until Microsoft implement this feature for all customers, you mustupdate the maximum run time value for all software updates that need it. At this time, we are aware of the following updates that require this change (this list not is not maintained): Autodesk Revit Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/third-party-updates-fail-to-install-with-error-0x800b0101/", "title": "WSUS error, Certificate expiration, Update installation, Timestamping", "raw_text": "Third-Party Updates Fail to Install with Error 0x800b0101 in SCCM When installing some, or all, third-party software updates, you receive the error code0x800b0101. Determine if you are affected \u2013 Possible Cause 1 InWindowsUpdate.logyou will see the following error in the log: Failed WS error: The date in the certificate is invalid or has expired *FAILED* Web service call InWUAHandler.logyou will see the following error in the log: OnSearchComplete \u2013 Failed to end search job. Error = 0x800b0101. Scan failed with error = 0x800b0101. Step 1: Renew the SSL certificate bound to the WSUS instance in IIS The error suggests that the certificate bound to the WSUS instance in IIS has expired. You will need to generate a new SSL certificate and bind it to the site Determine if You are Affected \u2013 Possible Cause 2 This error generally will occur when attempting toinstall some (not always all) third-party software updates. You may see the following error in software center: InWUAHandler.logandUpdatesHandler.logyou will see the following error in the log: Failed to download updates to the WUAgent datastore. Error = 0x800b0101. Failed to initiate install of WSUS updates, error = 0x800b0101Failed to start batch install through WSUS Install handler , error = 0x800b0101InstallUpdatesInBatch failed with error 0x800b0101 InWindowsUpdate.logyou may see something similar to the below: Error: 0x800b0101 when verifying trust for C:\\Windows\\SoftwareDistribution\\DownloadCopy update to cache failed with exit code = 0x800B0101ISusInternal:: CopyUpdateToCache2 failed, hr=800B0101 0x800b0101 = A required certificate is not within its validity period when verifying against the current system clock or the timestamp in the signed file. This error occurs when a client attempts to install a software update which is signed with a code signing certificate that isexpired, and itwas not timestamped. By default,timestampingis enabled in the Patch My PC Publisher to provide you with the flexibility of ensuring software updates can still install on your devices even if your code signing certificate has expired. However if timestamping is disabled, and updates were not timestamped, you will experience this error when clients attempt to install said updatesafter the code signing certificate has expired. Sometimes customersdisable timestamping in the Publisherto workaround proxy or firewall issues totimestamp.digicert.com. We do not recommend disabling timestamping. To determine if have timestamping enabled or disabled in the Publisher, check the registry valueHKEY_LOCAL_MACHINE\\Software\\Patch My PC Publishing Service:DisableTimestamping. A value of 1 means it is disabled, whereas 0 or a non-existent registry value means it is enabled (the default). You can see the certificate used to sign an update and whether it is timestamped by right clicking on the .cab file and going in toProperties. The .cab file for the problem update can be found inccmcacheon the client, or theWsusContentdirectory on the WSUS/SUP server. Go to theDigital Signaturestab, select the certificate from the list and chooseDetails. From here you can see if the .cab file is timestamped in theCountersignaturessection at the botom. ClickView Certificateand verify if the certificate has expired. Step 1: Renew your code signing certificate and import it into the Publisher If you use an internally issued certificate from your own PKI root / intermediate Certificate Authorities,re-issue a new code signing certificate. Ensure your devices have this new certificate in theirTrusted Publisherscertificate store. If you use a self-signed certificate, regenerate a new code signing certificate and ensure your devices have this new certificate in theirTrusted RootandTrusted Publisherscertificate store. After you have obtaineda new valid certificate, import it into the Publisher. Note:If your SUP is remote from your site server, ensure this new certificate is also in theTrusted RootandTrusted Publisherscertificate storeon the site serveritself. Step 2: Re-publish the software update(s) Next, you mustre-publish the problem updates,so they are recreated in WSUS witha new .cab file using a new code signing certificate. We have an article that discussesWhen and How to Republish Patch My PC Third-Party Updatesin more detail if you want to learn more. Right-click on the offending updates and chooseRepublish update(s) for these product(s) during the next sync schedule. For the subsequent pop-ups, selectYesfor the first pop-up, and we recommend you consider selectingYesfor the second pop-up.\u00c3\u0082 Step 3: Sync, the Publisher, download the updates, distribute, and deploy After that, you need tosync the Publisherto republish the software update to WSUS again. In theSync Scheduletab, clickRun Publishing Service Sync. Once the Publisher has finished synchronizing and your SCCM SUP has synchronized with WSUS, you can now download, distribute and deploy the newly republished software update(s),which will be code signed using the new certificate. You can verify the republished update is using the new certificate by observing the certificate on the .cab file stored in the WsusContent directory on your WSUS/SUP server as shown previously at the end of theDetermine if You are Affected section. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/page/18/", "title": "Patch Management, Endpoint Security, IT Operations, Optimization", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 \u2026 17 18 19 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/page/3/", "title": "Patch Management, Endpoint Security, IT Operations, Optimization", "raw_text": "Knowledge Base Articles Get expert insights, how-to guides, product updates, and best practices for streamlining patch management, improving endpoint security, and optimizing IT operations. 1 2 3 4 \u2026 20 Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/view-applicability-troubleshoot/", "title": "Third-party updates, Configuration Manager, Troubleshooting", "raw_text": "View Applicability Rules and Troubleshoot Detection States for Third-Party Updates Viewing theapplicability rulesof athird-party updatecan help determine why an update does not appear in software center or install within SCCM. This article looks at how theupdate applicabilityis determined forthird-party updateswithin our catalog. This guide will be helpful to determine why third-party software updates may not install on devices or report as required in Configuration Manager. Step 1: Understand the Different Software Update States Here\u2019s a review of thestatesavailable for software updates within Configuration Manager and WSUS. Compliant= The software update has been detected as being installed.Required= The software update has been detected as being needed, but it hasn\u2019t been reported as installed.Not Required= The software update has been detected as not being applicable. This status is what we will be looking deeper into here.Unknown= The software update hasn\u2019t been evaluated yet on the client. Step 2: Determine the Detection State of a Software Update on All Systems When you are troubleshooting why a third-party software update isn\u2019t appearing in software center or installing on a specific device or a large number of devices, the best first step is to click the update within theAll Software Updates nodeand review what is theoverall detectionfor all systems. The overall detection results can be helpful in understanding if the detection seems incorrect for all systems or if only a few devices seem not to be detecting the update state correctly. For example, if a large number of devices have anUnknowndetection state, it\u2019s likely an issue where the WSUS Administration IIS application pool is stopped, or the clients have a WSUS GPO conflict causing machines not to scan against the software update successfully. Step 3: Determine the Detection State of a Software Update on a Specific Computer If you are troubleshooting a specific computer not receiving a third-party update, run the following built-in report within Configuration Managers console underMonitoring>Reporting>Reports>Software Updates \u2013 A Compliance>Compliance 5 \u2013 Specific computer. This report will allow you to review if the software update is detecting asInstalledorRequiredon the specific computer in question. Step 4: Determine the Detection State of a Software Update on a Device Collection Next, you can expand the search to review the detect states on aspecific collection of devices. For example, you could choose a collection where the software update has been deployed. From the Configuration Managers consol navigate toMonitoring>Reporting>Reports>Software Updates \u2013 A Compliance>Compliance 2 \u2013 Specific software update. Review the differentdetection statesfor thespecific software updatein question. Step 5: Check the Software Update Group\u2019s Deployment Completion Statistics If the detect state looks correct and the update(s) in question appear as required, the next step is to review the deployment completion statistics from the Deployments node of the console. From the Configuration Managers console navigate toMonitoring>Deployments>Select the Software Update Group\u2019s Deployment, and review theCompletion Statisticschart. Review the differentstatesthat devices are in for the deployment. If you have a large number of devices in anIn ProgressorFailedstate, this could explain why machines aren\u2019t installing the software update. Click theView Statuslink below the chart to review a more detailed view of devices in specific states. For example, if a large number of devices are in anIn Progressstate, it could be because the software update deployment package isn\u2019t fully distributed or boundaries and boundary groups aren\u2019t configured correctly for all clients. Determining Software Update Applicability Rules when the State is Reporting Inaccurately If the software update is detecting asNot Applicableon a device where it should (Anolder version of the product is installed), you can review the detection rules of the software update using one of the processes below. Modify Updates Wizard One way to get the applicability rules for the software updateNotepad++ 8.1.3 (x64)is to launch theModify Published Updateswizard in theOptionsmenu of theUpdatestab. Select the update that isn\u2019t being detected as Required and clickShow Applicability Rules. Show Package Info Another way to view applicability rules for an update is by using the \u2018Show package info\u2026\u2018 right-click option. Once you have selectedshow package info from the right-click menuyou candouble-clickon any given product listed and view the applicability rules. Note:When you double click a product from the \u2018Show Package Info\u2019 tool you are querying thelatest catalogfor applicability rules. When you select an update in the Modify Updates wizard you are viewing theapplicability rules for the selected update. In this wizard, you can review the rules determined to show if an update will be detected as required on a client machine in theIsInstallable Rulessection. For the updateNotepad++ 8.1.3 (x64)to show as required, the following registry conditions need to exist: HKEY_LOCAL_MACHINE Subkey=\u201dSOFTWARE\\Microsoft\\WindowsCurrentVersion\\Uninstall\\Notepad++:DisplayVersion\u201d exis HKEY_LOCAL_MACHINE Subkey=\u201dSOFTWARE\\Microsoft\\WindowsCurrentVersion\\Uninstall\\Notepad++:DisplayVersion\u201d < \u201c8.1.3.0\u201d On a client machine, you can then review if the rules would evaluate. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/using-dns-aliases-wsus-third/", "title": "WSUS configuration, DNS alias, HTTPS, certificates", "raw_text": "Using DNS aliases with WSUS and third-party patching In this KB we will discuss another scenario which can cause the error \u201cCreateDirectory failed\u201d seen inPatchMyPC.log and SoftwareDistribution.logwhen trying to publish new third-party software updates into WSUS and/or Configuration Manager. While there are a few other solutions to this problem, as detailed in theCreateDirectory failed Error when Publishing Third-Party Updatesarticle, this is an alternative solution proposed to address the error. However, your applicability for the solutions proposed in this article depends on whether your WSUS service is configured to use HTTPS and if you are using a DNS alias for your WSUS server address. It may be desirable for organisations to use a DNS alias for WSUS, especially if WSUS is exposed across the Internet; it can simplify certificate requirements and help obfuscate internal hostnames. It is strongly advised to first read theDetermine if you are affectedsection below to determine if either of the proposed solutions are applicable to you. Topicscovered in this article: Determine if You are Affected Solution 1: Reconfigure your WSUS HTTPS config to match the AD FQDN address Solution 2: Configure a CIFS Service Principle for your WSUS server with your CNAME alias Determine if You are Affected Before you execute either solution proposed in this article, it is recommended you understand if you are affected and meet the criteria. You can do this by verifying the three conditions below: Firstly, to be affected by this issue, in the below registry key, the valueUsingSSLwill equal to 1 butServerCertificateNamewill be a different address compared to the server\u2019s Active Directory (AD) FQDN address (that\u2019s assuming the WSUS server is domain-joined, otherwise it would be different to the server\u2019s hostname.) HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Update Services\\Server\\Setup If the above is true for you, this means you likely have a DNS record configured, on a DNS server you manage, likely of type CNAME (although this can be an A record if WSUS is Internet-accessible and using a public DNS), pointing to your WSUS server\u2019s IP address. Secondly, you will also see the below errors inPatchMyPC.log and SoftwareDistribution.logwhile attempting to publish new third-party software updates: PatchMyPC.log: The publishing failed with error: CreateDirectory failed (timestamping was enabled). We will attempt to publish the update again with timestamping disabled. CreateDirectory failed. ErrorCode:-2147467259 NativeErrorCode:1326 HResult:-2147467259 MethodName:CreateDirectory. This error appears to be a known error. Please see our KB article https://patchmypc.com/an-error-occurred-while-publishing-an-update-to-wsus-createdirectory-failed for the resolution. SoftwareDistribution.log: ErrorPatchMyPC-Service.8Publisher.PublishPackagePublishPackage(): Operation Failed with Error: CreateDirectory failed Lastly, if you perform aProcess Monitor capturewhile the Patch My PC Publisher is synchronising and produces the error, you will see aLOGON FAILUREwhenPatchMyPC-Service.exetries toCreateFilein theUpdateServicesPackagesshared folder. You will also notice the path includes the DNS alias hostname, and not the server\u2019s Active Directory domain name. This is what causes the Kerberos logon failure; there is a bug in the WSUS SDK where the HostHeader registry value is ignored (if configured) and WSUS tries to reach out to theUpdateServicesPackagesshared folder using the host\u2019s alias in the path (via theServerCertificateNameregistry value). Note:WSUS writes date times to SoftwareDistribution.log always in UTC, irrespective of your server\u2019s configured time zone. At the same time as the above, you will also see theevent ID 4625 on the WSUS server\u2019s security event logalso for logon failures. If all the conditions above are the same for you, it\u2019s highly likely this article can help you and either of the proposed solutions below will fix the issue. Note:Whichever solution you decide, ultimately, the choice of solution is a matter of personal preference. Patch My PC does not have any recommendation or preference which you should consider. Solution 1: Reconfigure your WSUS HTTPS config to match the AD FQDN address This solution is choice one of two; and focuses on reconfiguring your WSUS server to use a HTTPS configuration and certificate with a domain matching its AD domain name (or its own hostname, if it\u2019s not domain joined.) Some customers like to implement a DNS alias for their WSUS server because it might be Internet accessible and prefer to keep the URL simple and not expose the server\u2019s internal hostname. If this is your scenario and your WSUS server is domain joined, you may prefer Solution 2 below by configuring aService Principal. To reconfigure WSUS to use the correct hostname and certificate, first, you will need tore-issue your server authentication certificatefrom your trusted Certificate Authority (CA)containing the WSUS server\u2019s FQDN in the Subject Alternative Name (SAN)attribute. Note:This article will not walk you through reissuing your new server authentication certificate, as PKI usage and implementation can vary between environments \u2013 it is recommended you consult your PKI administrator. Once you have the .pfx file for your new certificate (containing the private key), transfer it to the WSUS server and install it in the server\u2019s Local Computer Personal store: Right-click on the start menu and chooseRun\u2026 Typecertlm.mscand press enter ExpandPersonal, right-click onCertificates, and chooseAll Tasks > Import\u2026 Browse out and choose your newly issued certificate .pfx file, and enter the password for the .pfx file (this would have been set at the time of creating the .pfx file.) Thereafter, configure Internet Information Services (IIS) to use this newly imported certificate: Right-click on the start menu and chooseRun\u2026 TypeInetMgr.exeand press enter In theConnectionspane on the left, expand the server >Sites Right-click on theWSUS Administrationsite and chooseEdit Bindings In the dropdown forSSL certificate, choose your new certificate: Next, you need to reconfigure WSUS HTTPS configuration. This will update the ServerCertificateName registry value to that of the correct SAN in your new certificate: Open Command Prompt (cmd.exe) as administrator Navigate to C:\\Program Files\\Update Services\\Tools Call the WsusUtil.exe to configuressl, setting your server\u2019s AD FQDN address, as per the SAN on your new certificate: Navigate to the below key in the registry and verify the ServerCertificateName value matches the address you entered in the previous step At this point, solution 1 is complete and you should now be able to publish third-party updates successfully into WSUS. You may want to consider the additional follow-up tasks below, which this article will not cover: Updating any GPOs in your domain with the settingSpecify intranet Microsoft update service locationto use your new WSUS server address, e.g.https://FQDN:8531(i.e. the WSUS server\u2019s AD FQDN address.) If you are using ConfigMgr, then you should not need to do this step as ConfigMgr clients automatically set this WSUS local policy with the correct value via its agent. Ensure the endpoints you\u2019re patching with ConfigMgr/WSUS can reach the WSUS server via its FQDN address over ports tcp/8531 and tcp/8530, and the DNS address resolves correctly. Note:it\u2019s possible to also use WSUS with ports tcp/80 and tcp/443, or any other adjacent port numbers. If that\u2019s the case for your WSUS server, then please verify connectivity with those ports instead. Solution 2: Configure a CIFS Service Principle for your WSUS server with your CNAME alias This solution is an alternative option for you to consider which can also resolve the issue. However, for this solution to work, your WSUS servermust be domain-joined, andyou need to be a domain administrator. Log in as a domain administrator on either the WSUS server or Domain Controller (DC) Launch cmd.exe and execute the below command: For example, my alias and ServerCertificateName registry value is wsus.codaamok.lab, and my WSUS server\u2019s Active Directory domain name is cm.codaamok.lab, therefore the command I need to enter is: Finally, you can either reboot the WSUS server, or run the belowklistcommand in an elevated cmd.exe window: At this point, solution 2 is complete and you should now be able to publish third-party updates successfully into WSUS. There are no additional follow-up tasks or considerations required, unlike in solution 1 above. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/integrating-patch-my-pc-products/", "title": "Patch My PC Solutions, GCC High, Intune, Compliance", "raw_text": "Integrating Patch My PC Products with GCC High Intune Tenants At Patch My PC, we currently offer two solutions designed to simplify the process of publishing third-party software in Intune. 1. Patch My PC PublisherAn on-premises application that provides a user-friendly console to automate app publishing in Intune. It leverages an Entra ID App Registration for authentication within your environment. 2. Patch My PC CloudOur cloud-based SaaS solution offers similar functionality to the Publisher, simplifying third-party app publishing. While the Portal is still evolving toward feature parity with the on-premises Publisher, it offers seamless integration using an Enterprise Application (service principal) within Entra ID to securely publish apps. Choosing the Right Solution for GCC High Customers For most customers, both solutions are available, with the SaaS solution often being preferred due to no infrastructure requirements. However, forGCC High customers,Patch My PC Publisheris currently the only compatible option. This is due to the specific restrictions and compliance requirements in GCC High environments, which are not yet supported by our SaaS solution. Why Patch My PC Cloud is Not Compatible with GCC High Environments There are some key factors that prevent our SaaS solution from being used in GCC High environments: In GCC High environments, services like Entra ID and Microsoft Graph use isolated API endpoints unique to the environment. While commercial applications leverage common endpoints likemicrosoftonline.comorgraph.microsoft.com, GCC High requires endpoints specific to its domain, such as*.microsoftonline.us. Curerntly we do not support these GCC High required endpoints. GCC High environments require stringent compliance measures, likeFedRAMP certification. At present, our SaaS solution is notFedRAMPcertified, meaning it does meet the compliance standards for government organizations and contractors working with controlled unclassified information (CUI) and other sensitive data. Summary For organizations operating in GCC High environments,Patch My PC Publisherremains the best and only option for publishing third-party apps to Intune. We are committed to enhancing our SaaS offering to eventually support government cloud environments. If you want to be notified when we do support this, please cast a vote onthis idea. In the meantime, our on-premises solution ensures you can still automate and streamline your third-party app publishing in a compliant manner. If you\u2019d like to explore our products further or see them in action, feel free tobook a free demowith one of our engineers Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/intune-application-manager-statistics/", "title": "Intune Application Manager, Patch My PC, Graph API, Endpoint", "raw_text": "Intune Application Manager Application Statistics Not Populating UPDATE This issue was fixed in the Patch My PC Publisherproduction build 2.1.16. Issue The Patch My PC Intune Scan Wizard does not populate any application statistics. Current Intune Application Manager functionality Expected Intune Application Manager functionality Cause Microsoft has removed the following Graph API Endpoints /deviceAppManagement/mobileApps/{mobileAppId}/installSummary /deviceAppManagement/mobileApps/{mobileAppId}/installSummary /deviceAppManagement/mobileApps/{mobileAppId}/deviceStatuses /deviceAppManagement/mobileApps/{mobileAppId}/deviceStatuses /deviceAppManagement/mobileApps/{mobileAppId}/userStatuses /deviceAppManagement/mobileApps/{mobileAppId}/userStatuses Resolution Microsoft has confirmed that a change was put forward earlier this year to remove these endpoints; however, that change was not publicly visible. Patch My PC is rewriting the Intune App Manager functionality to use a different Graph API endpoint that provides the same data but in a different format, as Microsoft will not be reverting the change and restoring those endpoints. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
{"url": "https://patchmypc.com/kb/wsus-publish-error-2147942512/", "title": "WSUS error, disk space, update files, caching", "raw_text": "An error occurred while publishing an update to WSUS: failed to create cab; error was: 2147942512 In this article, we\u2019re going to review a common error code that can occur when the drive theWSUSContentfolder is located on has no more free space available. Determine if you are affected If you are affected by this error, you will see errors similar to the errors below in thePatchMyPC.log,SMS_ISVUPDATES_SYNCAGENT.log, orSoftwareDistribution.log. The actual log file you see the error in may vary depending on thePublishing methodyou are using. An error occurred while publishing an update to WSUS: failed to create cab; error was: 2147942512 Check if the drivehosting the WSUSContentfolder haslow disk space: Resolution 1: Extend the disk to have more free space The first possible resolution is toadd more disk space to the existing drive.This operation can be performed on virtual machines pretty easily, for example. Resolution 2: Move the WSUSContent folder to a new drive The second option is tomove the WSUSContent folder to a completely different drive. This can be performed using the WSUSUtil.exe tool that comes with WSUS. For a complete guide on moving the WSUSContent folder see:How to Move the WSUS Content Folder to a New Location Resolution 3: Cleanup unneeded update files from UpdateServicePackages Another option is to delete unneeded updates files in theUpdateServicePackagesfolder. A full guide is available atHow to Clean Up Third-Party Updates from the WSUS UpdateServicesPackages Folder. This operation can often save a lot of space on the drive hosting the WSUS content files. Free Trial Schedule Demo Schedule a Setup Call Schedule a Q&A Call ROI Calculator Advanced Insights Patch My PC Cloud Patch My PC Publisher Home Updater CVE Insights PSAppDeployToolkit (PSADT) MEM Patching Optimizer About Us Careers Events & Webinars Customer Reviews Contact Us Call Us: 1 800 250 2334 FAQs Knowledge Base Catalog Release History Product Documentation Release Notes Partners & Resellers Feature Request Product Roadmap Patch Tuesday Blog Patch My PC Blog Support Forum Supported Products"}
